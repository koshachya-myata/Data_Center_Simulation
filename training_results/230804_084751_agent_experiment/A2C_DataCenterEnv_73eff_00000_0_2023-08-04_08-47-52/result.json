{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -324.91566772460936, "policy_loss": -2165596.53125, "vf_loss": 2713447.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "sampler_results": {"episode_reward_max": -1162.8376886118865, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1277.9018369041585, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534308746719009, "mean_inference_ms": 0.3769534478906566, "mean_action_processing_ms": 0.09221968884604821, "mean_env_wait_ms": 3.335852406843187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.0029484430948893228, "ViewRequirementAgentConnector_ms": 0.06783008575439453}}, "episode_reward_max": -1162.8376886118865, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1277.9018369041585, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534308746719009, "mean_inference_ms": 0.3769534478906566, "mean_action_processing_ms": 0.09221968884604821, "mean_env_wait_ms": 3.335852406843187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.0029484430948893228, "ViewRequirementAgentConnector_ms": 0.06783008575439453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 87.58322076675819, "num_env_steps_trained_throughput_per_sec": 87.58322076675819, "timesteps_total": 121080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 121080, "timers": {"training_iteration_time_ms": 4110.362, "sample_time_ms": 4094.548, "load_time_ms": 0.409, "load_throughput": 880265.9, "learn_time_ms": 14.616, "learn_throughput": 24631.056, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "done": false, "episodes_total": 817, "training_iteration": 161, "trial_id": "73eff_00000", "date": "2023-08-04_08-48-11", "timestamp": 1691128091, "time_this_iter_s": 12.333593130111694, "time_total_s": 1742.1643199920654, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.333593130111694, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.37222222222222, "ram_util_percent": 61.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.9666666666666666e-06, "entropy_coeff": 0.05, "policy_entropy": -326.3040710449219, "policy_loss": -20179.631640625, "vf_loss": 2185941.6625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520}, "sampler_results": {"episode_reward_max": -1131.2123810460853, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1225.6552294227201, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.559089250396852, "mean_inference_ms": 0.37443026190936785, "mean_action_processing_ms": 0.09152221174884798, "mean_env_wait_ms": 2.532969207497061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003923688616071429, "StateBufferConnector_ms": 0.002738407679966518, "ViewRequirementAgentConnector_ms": 0.0657728740147182}}, "episode_reward_max": -1131.2123810460853, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1225.6552294227201, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.559089250396852, "mean_inference_ms": 0.37443026190936785, "mean_action_processing_ms": 0.09152221174884798, "mean_env_wait_ms": 2.532969207497061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003923688616071429, "StateBufferConnector_ms": 0.002738407679966518, "ViewRequirementAgentConnector_ms": 0.0657728740147182}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520, "num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.11534827172225, "num_env_steps_trained_throughput_per_sec": 111.11534827172225, "timesteps_total": 122520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 122520, "timers": {"training_iteration_time_ms": 3612.935, "sample_time_ms": 3599.818, "load_time_ms": 0.345, "load_throughput": 1042063.106, "learn_time_ms": 12.0, "learn_throughput": 29999.279, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520}, "done": false, "episodes_total": 821, "training_iteration": 162, "trial_id": "73eff_00000", "date": "2023-08-04_08-48-24", "timestamp": 1691128104, "time_this_iter_s": 12.962107181549072, "time_total_s": 1755.1264271736145, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 25.295700311660767, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.389473684210525, "ram_util_percent": 62.11052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.166666666666667e-06, "entropy_coeff": 0.05, "policy_entropy": -324.114453125, "policy_loss": 103187.2828125, "vf_loss": 2056061.1125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1194.9146426048299, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.574787732888708, "mean_inference_ms": 0.3728660731516744, "mean_action_processing_ms": 0.09122893882522463, "mean_env_wait_ms": 2.172639728338046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003996762362393466, "StateBufferConnector_ms": 0.002774325284090909, "ViewRequirementAgentConnector_ms": 0.06537220694802025}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1194.9146426048299, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.574787732888708, "mean_inference_ms": 0.3728660731516744, "mean_action_processing_ms": 0.09122893882522463, "mean_env_wait_ms": 2.172639728338046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003996762362393466, "StateBufferConnector_ms": 0.002774325284090909, "ViewRequirementAgentConnector_ms": 0.06537220694802025}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.90931884505525, "num_env_steps_trained_throughput_per_sec": 110.90931884505525, "timesteps_total": 123960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 123960, "timers": {"training_iteration_time_ms": 3243.786, "sample_time_ms": 3232.764, "load_time_ms": 0.302, "load_throughput": 1190624.066, "learn_time_ms": 9.951, "learn_throughput": 36175.465, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "done": false, "episodes_total": 825, "training_iteration": 163, "trial_id": "73eff_00000", "date": "2023-08-04_08-48-37", "timestamp": 1691128117, "time_this_iter_s": 12.986087799072266, "time_total_s": 1768.1125149726868, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 38.28178811073303, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.211111111111112, "ram_util_percent": 62.22777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.327777777777778e-06, "entropy_coeff": 0.05, "policy_entropy": -322.9702514648437, "policy_loss": -1222724.7109375, "vf_loss": 2319484.2125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1193.5149892911309, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.586679187069651, "mean_inference_ms": 0.3720983345570345, "mean_action_processing_ms": 0.09110424347143603, "mean_env_wait_ms": 1.9576805859424562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037860870361328125, "StateBufferConnector_ms": 0.0027640660603841147, "ViewRequirementAgentConnector_ms": 0.06513595581054688}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1193.5149892911309, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.586679187069651, "mean_inference_ms": 0.3720983345570345, "mean_action_processing_ms": 0.09110424347143603, "mean_env_wait_ms": 1.9576805859424562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037860870361328125, "StateBufferConnector_ms": 0.0027640660603841147, "ViewRequirementAgentConnector_ms": 0.06513595581054688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.32750556263788, "num_env_steps_trained_throughput_per_sec": 110.32750556263788, "timesteps_total": 125400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 125400, "timers": {"training_iteration_time_ms": 3253.627, "sample_time_ms": 3242.738, "load_time_ms": 0.287, "load_throughput": 1252654.256, "learn_time_ms": 9.84, "learn_throughput": 36584.614, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "done": false, "episodes_total": 829, "training_iteration": 164, "trial_id": "73eff_00000", "date": "2023-08-04_08-48-50", "timestamp": 1691128130, "time_this_iter_s": 13.054563999176025, "time_total_s": 1781.1670789718628, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 51.33635210990906, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.894736842105264, "ram_util_percent": 62.23684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.1277777777777774e-06, "entropy_coeff": 0.05, "policy_entropy": -324.6080383300781, "policy_loss": -1292581.8109375, "vf_loss": 2855461.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1210.5240533047186, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.59290906846038, "mean_inference_ms": 0.3715249189027935, "mean_action_processing_ms": 0.09101507999129174, "mean_env_wait_ms": 1.8128441469255656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037055266530890215, "StateBufferConnector_ms": 0.0027681651868318256, "ViewRequirementAgentConnector_ms": 0.0652363425806949}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1210.5240533047186, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.59290906846038, "mean_inference_ms": 0.3715249189027935, "mean_action_processing_ms": 0.09101507999129174, "mean_env_wait_ms": 1.8128441469255656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037055266530890215, "StateBufferConnector_ms": 0.0027681651868318256, "ViewRequirementAgentConnector_ms": 0.0652363425806949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.84615798114197, "num_env_steps_trained_throughput_per_sec": 110.84615798114197, "timesteps_total": 126840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 126840, "timers": {"training_iteration_time_ms": 3257.209, "sample_time_ms": 3246.408, "load_time_ms": 0.288, "load_throughput": 1251408.454, "learn_time_ms": 9.762, "learn_throughput": 36876.694, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "done": false, "episodes_total": 833, "training_iteration": 165, "trial_id": "73eff_00000", "date": "2023-08-04_08-49-03", "timestamp": 1691128143, "time_this_iter_s": 12.993443727493286, "time_total_s": 1794.160522699356, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 64.32979583740234, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.98888888888889, "ram_util_percent": 62.11111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9277777777777773e-06, "entropy_coeff": 0.05, "policy_entropy": -324.8860168457031, "policy_loss": -3384018.300390625, "vf_loss": 3072503.1875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1211.739922134837, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5975247059713835, "mean_inference_ms": 0.3709971332100229, "mean_action_processing_ms": 0.09093727091942178, "mean_env_wait_ms": 1.7066152703518682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037846357926078463, "StateBufferConnector_ms": 0.0027521796848462977, "ViewRequirementAgentConnector_ms": 0.06544486336086107}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1211.739922134837, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5975247059713835, "mean_inference_ms": 0.3709971332100229, "mean_action_processing_ms": 0.09093727091942178, "mean_env_wait_ms": 1.7066152703518682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037846357926078463, "StateBufferConnector_ms": 0.0027521796848462977, "ViewRequirementAgentConnector_ms": 0.06544486336086107}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.83711617417983, "num_env_steps_trained_throughput_per_sec": 110.83711617417983, "timesteps_total": 128280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 128280, "timers": {"training_iteration_time_ms": 3248.98, "sample_time_ms": 3238.187, "load_time_ms": 0.29, "load_throughput": 1239797.553, "learn_time_ms": 9.743, "learn_throughput": 36949.88, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "done": false, "episodes_total": 837, "training_iteration": 166, "trial_id": "73eff_00000", "date": "2023-08-04_08-49-16", "timestamp": 1691128156, "time_this_iter_s": 12.994580030441284, "time_total_s": 1807.1551027297974, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 77.32437586784363, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.105263157894736, "ram_util_percent": 61.973684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -325.71449584960936, "policy_loss": -2291842.44375, "vf_loss": 2810423.3875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 133.0, "diff_num_grad_updates_vs_sampler_policy": 132.0}}, "num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1224.5613793376294, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.601576757898475, "mean_inference_ms": 0.37055218642460264, "mean_action_processing_ms": 0.09086941595042344, "mean_env_wait_ms": 1.625428034025738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037140316433376735, "StateBufferConnector_ms": 0.0027223869606300636, "ViewRequirementAgentConnector_ms": 0.06530108275236907}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1224.5613793376294, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.601576757898475, "mean_inference_ms": 0.37055218642460264, "mean_action_processing_ms": 0.09086941595042344, "mean_env_wait_ms": 1.625428034025738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037140316433376735, "StateBufferConnector_ms": 0.0027223869606300636, "ViewRequirementAgentConnector_ms": 0.06530108275236907}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720, "num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.21274143557194, "num_env_steps_trained_throughput_per_sec": 110.21274143557194, "timesteps_total": 129720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 129720, "timers": {"training_iteration_time_ms": 3255.122, "sample_time_ms": 3244.269, "load_time_ms": 0.293, "load_throughput": 1226803.25, "learn_time_ms": 9.792, "learn_throughput": 36765.981, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720}, "done": false, "episodes_total": 841, "training_iteration": 167, "trial_id": "73eff_00000", "date": "2023-08-04_08-49-29", "timestamp": 1691128169, "time_this_iter_s": 13.068206787109375, "time_total_s": 1820.2233095169067, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 90.392582654953, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.06666666666667, "ram_util_percent": 61.838888888888896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -325.4458312988281, "policy_loss": -816864.94375, "vf_loss": 2411402.1625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 152.0}}, "num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1224.11251290673, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.605758050619629, "mean_inference_ms": 0.37019172601062644, "mean_action_processing_ms": 0.09081599206978208, "mean_env_wait_ms": 1.560508309146349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037600917200888355, "StateBufferConnector_ms": 0.002717202709567162, "ViewRequirementAgentConnector_ms": 0.06524747417819116}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1224.11251290673, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.605758050619629, "mean_inference_ms": 0.37019172601062644, "mean_action_processing_ms": 0.09081599206978208, "mean_env_wait_ms": 1.560508309146349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037600917200888355, "StateBufferConnector_ms": 0.002717202709567162, "ViewRequirementAgentConnector_ms": 0.06524747417819116}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160, "num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.10626631368284, "num_env_steps_trained_throughput_per_sec": 110.10626631368284, "timesteps_total": 131160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 131160, "timers": {"training_iteration_time_ms": 3264.583, "sample_time_ms": 3253.77, "load_time_ms": 0.301, "load_throughput": 1197327.286, "learn_time_ms": 9.751, "learn_throughput": 36920.968, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160}, "done": false, "episodes_total": 845, "training_iteration": 168, "trial_id": "73eff_00000", "date": "2023-08-04_08-49-42", "timestamp": 1691128182, "time_this_iter_s": 13.080914974212646, "time_total_s": 1833.3042244911194, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 103.47349762916565, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.09473684210526, "ram_util_percent": 62.000000000000014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -324.55845947265624, "policy_loss": -887320.1265625, "vf_loss": 2431044.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 172.0}}, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1223.9491111700418, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.609888461067172, "mean_inference_ms": 0.3699082189202874, "mean_action_processing_ms": 0.09077756402817268, "mean_env_wait_ms": 1.5068832848089466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037356785365513395, "StateBufferConnector_ms": 0.0027091162545340402, "ViewRequirementAgentConnector_ms": 0.0654050282069615}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1223.9491111700418, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.609888461067172, "mean_inference_ms": 0.3699082189202874, "mean_action_processing_ms": 0.09077756402817268, "mean_env_wait_ms": 1.5068832848089466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037356785365513395, "StateBufferConnector_ms": 0.0027091162545340402, "ViewRequirementAgentConnector_ms": 0.0654050282069615}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.31185072042078, "num_env_steps_trained_throughput_per_sec": 110.31185072042078, "timesteps_total": 132600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 132600, "timers": {"training_iteration_time_ms": 3263.059, "sample_time_ms": 3252.219, "load_time_ms": 0.301, "load_throughput": 1196094.297, "learn_time_ms": 9.772, "learn_throughput": 36838.368, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "done": false, "episodes_total": 849, "training_iteration": 169, "trial_id": "73eff_00000", "date": "2023-08-04_08-49-55", "timestamp": 1691128195, "time_this_iter_s": 13.056567907333374, "time_total_s": 1846.3607923984528, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 116.53006553649902, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 20.477777777777778, "ram_util_percent": 62.23333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -323.8339599609375, "policy_loss": -1735582.9375, "vf_loss": 3046376.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 192.0}}, "num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1230.0969938121732, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.613271353153045, "mean_inference_ms": 0.36967349527875965, "mean_action_processing_ms": 0.09074600617078679, "mean_env_wait_ms": 1.4622362406834264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036979332948342348, "StateBufferConnector_ms": 0.0027106358454777645, "ViewRequirementAgentConnector_ms": 0.06537743103809845}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1230.0969938121732, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.613271353153045, "mean_inference_ms": 0.36967349527875965, "mean_action_processing_ms": 0.09074600617078679, "mean_env_wait_ms": 1.4622362406834264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036979332948342348, "StateBufferConnector_ms": 0.0027106358454777645, "ViewRequirementAgentConnector_ms": 0.06537743103809845}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040, "num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.3717334812023, "num_env_steps_trained_throughput_per_sec": 110.3717334812023, "timesteps_total": 134040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 134040, "timers": {"training_iteration_time_ms": 3263.475, "sample_time_ms": 3252.668, "load_time_ms": 0.301, "load_throughput": 1196757.898, "learn_time_ms": 9.74, "learn_throughput": 36960.19, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040}, "done": false, "episodes_total": 853, "training_iteration": 170, "trial_id": "73eff_00000", "date": "2023-08-04_08-50-08", "timestamp": 1691128208, "time_this_iter_s": 13.049687623977661, "time_total_s": 1859.4104800224304, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 129.57975316047668, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.900000000000006, "ram_util_percent": 62.34736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -323.2312316894531, "policy_loss": -3534566.8484375, "vf_loss": 2862542.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 213.0, "diff_num_grad_updates_vs_sampler_policy": 212.0}}, "num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1235.4679634603988, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.616642556219636, "mean_inference_ms": 0.3694625270589103, "mean_action_processing_ms": 0.09071888871118584, "mean_env_wait_ms": 1.4243240378495414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038263409636741462, "StateBufferConnector_ms": 0.002699120100154433, "ViewRequirementAgentConnector_ms": 0.06531560143759084}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -1413.55906477191, "episode_reward_mean": -1235.4679634603988, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.616642556219636, "mean_inference_ms": 0.3694625270589103, "mean_action_processing_ms": 0.09071888871118584, "mean_env_wait_ms": 1.4243240378495414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038263409636741462, "StateBufferConnector_ms": 0.002699120100154433, "ViewRequirementAgentConnector_ms": 0.06531560143759084}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480, "num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.74007302392573, "num_env_steps_trained_throughput_per_sec": 109.74007302392573, "timesteps_total": 135480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 135480, "timers": {"training_iteration_time_ms": 3270.818, "sample_time_ms": 3260.056, "load_time_ms": 0.296, "load_throughput": 1217799.371, "learn_time_ms": 9.708, "learn_throughput": 37082.002, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480}, "done": false, "episodes_total": 857, "training_iteration": 171, "trial_id": "73eff_00000", "date": "2023-08-04_08-50-21", "timestamp": 1691128221, "time_this_iter_s": 13.124603986740112, "time_total_s": 1872.5350840091705, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 142.7043571472168, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.478947368421053, "ram_util_percent": 62.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -322.1162414550781, "policy_loss": -2649373.613671875, "vf_loss": 6069873.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 232.0}}, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -1917.1354867763175, "episode_reward_mean": -1260.2730752880318, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.619473068827395, "mean_inference_ms": 0.36928585732619557, "mean_action_processing_ms": 0.0906958163737995, "mean_env_wait_ms": 1.391624056317056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003847162774268617, "StateBufferConnector_ms": 0.002709855424596908, "ViewRequirementAgentConnector_ms": 0.06529879062733751}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -1917.1354867763175, "episode_reward_mean": -1260.2730752880318, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.619473068827395, "mean_inference_ms": 0.36928585732619557, "mean_action_processing_ms": 0.0906958163737995, "mean_env_wait_ms": 1.391624056317056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003847162774268617, "StateBufferConnector_ms": 0.002709855424596908, "ViewRequirementAgentConnector_ms": 0.06529879062733751}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.51110241955693, "num_env_steps_trained_throughput_per_sec": 110.51110241955693, "timesteps_total": 136920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 136920, "timers": {"training_iteration_time_ms": 3270.781, "sample_time_ms": 3259.972, "load_time_ms": 0.297, "load_throughput": 1213688.16, "learn_time_ms": 9.761, "learn_throughput": 36881.558, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "done": false, "episodes_total": 861, "training_iteration": 172, "trial_id": "73eff_00000", "date": "2023-08-04_08-50-34", "timestamp": 1691128234, "time_this_iter_s": 13.033116102218628, "time_total_s": 1885.5682001113892, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 155.73747324943542, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.794444444444444, "ram_util_percent": 62.23888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -321.3364196777344, "policy_loss": -3332509.30625, "vf_loss": 7298910.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 253.0, "diff_num_grad_updates_vs_sampler_policy": 252.0}}, "num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2101.032635633623, "episode_reward_mean": -1321.1619908913397, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.621742408028721, "mean_inference_ms": 0.3691265571462876, "mean_action_processing_ms": 0.09067355707810365, "mean_env_wait_ms": 1.3630790168020728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003800205155914905, "StateBufferConnector_ms": 0.002708622053557751, "ViewRequirementAgentConnector_ms": 0.06520748138427734}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2101.032635633623, "episode_reward_mean": -1321.1619908913397, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.621742408028721, "mean_inference_ms": 0.3691265571462876, "mean_action_processing_ms": 0.09067355707810365, "mean_env_wait_ms": 1.3630790168020728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003800205155914905, "StateBufferConnector_ms": 0.002708622053557751, "ViewRequirementAgentConnector_ms": 0.06520748138427734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360, "num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.8536488470862, "num_env_steps_trained_throughput_per_sec": 110.8536488470862, "timesteps_total": 138360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 138360, "timers": {"training_iteration_time_ms": 3256.788, "sample_time_ms": 3245.972, "load_time_ms": 0.297, "load_throughput": 1212810.795, "learn_time_ms": 9.766, "learn_throughput": 36864.0, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360}, "done": false, "episodes_total": 865, "training_iteration": 173, "trial_id": "73eff_00000", "date": "2023-08-04_08-50-47", "timestamp": 1691128247, "time_this_iter_s": 12.992708206176758, "time_total_s": 1898.560908317566, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 168.73018145561218, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.826315789473682, "ram_util_percent": 62.06842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.316666666666667e-06, "entropy_coeff": 0.05, "policy_entropy": -321.0930480957031, "policy_loss": -3057443.7875, "vf_loss": 7234213.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 273.0, "diff_num_grad_updates_vs_sampler_policy": 272.0}}, "num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2416.190648722425, "episode_reward_mean": -1388.2502973395958, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.623164597079019, "mean_inference_ms": 0.36919984946101575, "mean_action_processing_ms": 0.09070013418997154, "mean_env_wait_ms": 1.3383451234471222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037947568026455965, "StateBufferConnector_ms": 0.0027175383134321733, "ViewRequirementAgentConnector_ms": 0.06562146273526279}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2416.190648722425, "episode_reward_mean": -1388.2502973395958, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.623164597079019, "mean_inference_ms": 0.36919984946101575, "mean_action_processing_ms": 0.09070013418997154, "mean_env_wait_ms": 1.3383451234471222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037947568026455965, "StateBufferConnector_ms": 0.0027175383134321733, "ViewRequirementAgentConnector_ms": 0.06562146273526279}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800, "num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.17690461157045, "num_env_steps_trained_throughput_per_sec": 110.17690461157045, "timesteps_total": 139800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 139800, "timers": {"training_iteration_time_ms": 3254.4, "sample_time_ms": 3243.39, "load_time_ms": 0.302, "load_throughput": 1191281.609, "learn_time_ms": 9.928, "learn_throughput": 36261.559, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800}, "done": false, "episodes_total": 869, "training_iteration": 174, "trial_id": "73eff_00000", "date": "2023-08-04_08-51-01", "timestamp": 1691128261, "time_this_iter_s": 13.072541952133179, "time_total_s": 1911.633450269699, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 181.80272340774536, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.90555555555556, "ram_util_percent": 62.12222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7166666666666666e-06, "entropy_coeff": 0.05, "policy_entropy": -320.701318359375, "policy_loss": -4112887.70625, "vf_loss": 8368210.85}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2423.127366069789, "episode_reward_mean": -1447.8835326417309, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624784672330964, "mean_inference_ms": 0.3692941061003913, "mean_action_processing_ms": 0.09072881261330293, "mean_env_wait_ms": 1.3165016789934678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003769438145524364, "StateBufferConnector_ms": 0.0027090816174523305, "ViewRequirementAgentConnector_ms": 0.06561845035876258}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2423.127366069789, "episode_reward_mean": -1447.8835326417309, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624784672330964, "mean_inference_ms": 0.3692941061003913, "mean_action_processing_ms": 0.09072881261330293, "mean_env_wait_ms": 1.3165016789934678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003769438145524364, "StateBufferConnector_ms": 0.0027090816174523305, "ViewRequirementAgentConnector_ms": 0.06561845035876258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.03424378410887, "num_env_steps_trained_throughput_per_sec": 109.03424378410887, "timesteps_total": 141240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 141240, "timers": {"training_iteration_time_ms": 3273.175, "sample_time_ms": 3262.152, "load_time_ms": 0.303, "load_throughput": 1188936.567, "learn_time_ms": 9.93, "learn_throughput": 36252.94, "synch_weights_time_ms": 0.747}, "counters": {"num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "done": false, "episodes_total": 873, "training_iteration": 175, "trial_id": "73eff_00000", "date": "2023-08-04_08-51-14", "timestamp": 1691128274, "time_this_iter_s": 13.209619998931885, "time_total_s": 1924.843070268631, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 195.01234340667725, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.10526315789474, "ram_util_percent": 62.126315789473686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1166666666666666e-06, "entropy_coeff": 0.05, "policy_entropy": -320.15733032226564, "policy_loss": -3572992.18125, "vf_loss": 9080956.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 313.0, "diff_num_grad_updates_vs_sampler_policy": 312.0}}, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2423.127366069789, "episode_reward_mean": -1498.2526012512888, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.62600954660631, "mean_inference_ms": 0.36935147397850365, "mean_action_processing_ms": 0.09074858118021467, "mean_env_wait_ms": 1.2968167457482616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037446854606507317, "StateBufferConnector_ms": 0.0027016987876286582, "ViewRequirementAgentConnector_ms": 0.06553823985750713}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2423.127366069789, "episode_reward_mean": -1498.2526012512888, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.62600954660631, "mean_inference_ms": 0.36935147397850365, "mean_action_processing_ms": 0.09074858118021467, "mean_env_wait_ms": 1.2968167457482616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037446854606507317, "StateBufferConnector_ms": 0.0027016987876286582, "ViewRequirementAgentConnector_ms": 0.06553823985750713}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.47354523305903, "num_env_steps_trained_throughput_per_sec": 111.47354523305903, "timesteps_total": 142680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 142680, "timers": {"training_iteration_time_ms": 3284.869, "sample_time_ms": 3273.986, "load_time_ms": 0.298, "load_throughput": 1208829.91, "learn_time_ms": 9.816, "learn_throughput": 36674.717, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "done": false, "episodes_total": 877, "training_iteration": 176, "trial_id": "73eff_00000", "date": "2023-08-04_08-51-27", "timestamp": 1691128287, "time_this_iter_s": 12.920450925827026, "time_total_s": 1937.763521194458, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 207.93279433250427, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.652631578947368, "ram_util_percent": 62.126315789473686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -319.5825622558594, "policy_loss": -353003.581640625, "vf_loss": 7859286.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 333.0, "diff_num_grad_updates_vs_sampler_policy": 332.0}}, "num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2423.127366069789, "episode_reward_mean": -1542.410166795982, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627055959389594, "mean_inference_ms": 0.3694201383444254, "mean_action_processing_ms": 0.09076937523100921, "mean_env_wait_ms": 1.279120117331998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037723512791875582, "StateBufferConnector_ms": 0.0027119223751238923, "ViewRequirementAgentConnector_ms": 0.06563521143215806}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2423.127366069789, "episode_reward_mean": -1542.410166795982, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627055959389594, "mean_inference_ms": 0.3694201383444254, "mean_action_processing_ms": 0.09076937523100921, "mean_env_wait_ms": 1.279120117331998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037723512791875582, "StateBufferConnector_ms": 0.0027119223751238923, "ViewRequirementAgentConnector_ms": 0.06563521143215806}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120, "num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.36411601842418, "num_env_steps_trained_throughput_per_sec": 110.36411601842418, "timesteps_total": 144120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 144120, "timers": {"training_iteration_time_ms": 3261.026, "sample_time_ms": 3250.139, "load_time_ms": 0.297, "load_throughput": 1210283.296, "learn_time_ms": 9.82, "learn_throughput": 36659.224, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120}, "done": false, "episodes_total": 881, "training_iteration": 177, "trial_id": "73eff_00000", "date": "2023-08-04_08-51-40", "timestamp": 1691128300, "time_this_iter_s": 13.050632953643799, "time_total_s": 1950.8141541481018, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 220.98342728614807, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.355555555555558, "ram_util_percent": 62.13888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -319.8122131347656, "policy_loss": -754332.5328125, "vf_loss": 8796394.55}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 352.0}}, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2423.127366069789, "episode_reward_mean": -1583.6137103005515, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627845529014206, "mean_inference_ms": 0.369468458999217, "mean_action_processing_ms": 0.09078457364734012, "mean_env_wait_ms": 1.2630682644768565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037854825946646675, "StateBufferConnector_ms": 0.002761961708606129, "ViewRequirementAgentConnector_ms": 0.06562051638750963}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2423.127366069789, "episode_reward_mean": -1583.6137103005515, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627845529014206, "mean_inference_ms": 0.369468458999217, "mean_action_processing_ms": 0.09078457364734012, "mean_env_wait_ms": 1.2630682644768565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037854825946646675, "StateBufferConnector_ms": 0.002761961708606129, "ViewRequirementAgentConnector_ms": 0.06562051638750963}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.10267560940709, "num_env_steps_trained_throughput_per_sec": 111.10267560940709, "timesteps_total": 145560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 145560, "timers": {"training_iteration_time_ms": 3247.181, "sample_time_ms": 3236.207, "load_time_ms": 0.297, "load_throughput": 1213883.303, "learn_time_ms": 9.916, "learn_throughput": 36303.843, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "done": false, "episodes_total": 885, "training_iteration": 178, "trial_id": "73eff_00000", "date": "2023-08-04_08-51-53", "timestamp": 1691128313, "time_this_iter_s": 12.963621854782104, "time_total_s": 1963.777776002884, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 233.94704914093018, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.11578947368421, "ram_util_percent": 62.30526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -319.0832580566406, "policy_loss": 132220.9125, "vf_loss": 7641472.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 373.0, "diff_num_grad_updates_vs_sampler_policy": 372.0}}, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2423.127366069789, "episode_reward_mean": -1618.2396098189352, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628563782651738, "mean_inference_ms": 0.3694992685461414, "mean_action_processing_ms": 0.09079607971928667, "mean_env_wait_ms": 1.2483658985317647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037663777669270835, "StateBufferConnector_ms": 0.002758026123046875, "ViewRequirementAgentConnector_ms": 0.06567192077636719}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2423.127366069789, "episode_reward_mean": -1618.2396098189352, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628563782651738, "mean_inference_ms": 0.3694992685461414, "mean_action_processing_ms": 0.09079607971928667, "mean_env_wait_ms": 1.2483658985317647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037663777669270835, "StateBufferConnector_ms": 0.002758026123046875, "ViewRequirementAgentConnector_ms": 0.06567192077636719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.85214123402753, "num_env_steps_trained_throughput_per_sec": 110.85214123402753, "timesteps_total": 147000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 147000, "timers": {"training_iteration_time_ms": 3253.286, "sample_time_ms": 3242.453, "load_time_ms": 0.297, "load_throughput": 1211642.947, "learn_time_ms": 9.771, "learn_throughput": 36844.75, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "done": false, "episodes_total": 889, "training_iteration": 179, "trial_id": "73eff_00000", "date": "2023-08-04_08-52-06", "timestamp": 1691128326, "time_this_iter_s": 12.992845058441162, "time_total_s": 1976.770621061325, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 246.93989419937134, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 19.033333333333335, "ram_util_percent": 62.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -318.92714233398436, "policy_loss": -4556694.7875, "vf_loss": 8886631.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 393.0, "diff_num_grad_updates_vs_sampler_policy": 392.0}}, "num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2430.9518334120344, "episode_reward_mean": -1650.9833968649416, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629329834593923, "mean_inference_ms": 0.3695195714783242, "mean_action_processing_ms": 0.09080481004492161, "mean_env_wait_ms": 1.2348357326759054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037425681005550334, "StateBufferConnector_ms": 0.002751169325430182, "ViewRequirementAgentConnector_ms": 0.06567617005939726}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2430.9518334120344, "episode_reward_mean": -1650.9833968649416, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629329834593923, "mean_inference_ms": 0.3695195714783242, "mean_action_processing_ms": 0.09080481004492161, "mean_env_wait_ms": 1.2348357326759054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037425681005550334, "StateBufferConnector_ms": 0.002751169325430182, "ViewRequirementAgentConnector_ms": 0.06567617005939726}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440, "num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.34062487622802, "num_env_steps_trained_throughput_per_sec": 110.34062487622802, "timesteps_total": 148440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 148440, "timers": {"training_iteration_time_ms": 3247.854, "sample_time_ms": 3237.05, "load_time_ms": 0.298, "load_throughput": 1207186.952, "learn_time_ms": 9.749, "learn_throughput": 36925.302, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440}, "done": false, "episodes_total": 893, "training_iteration": 180, "trial_id": "73eff_00000", "date": "2023-08-04_08-52-19", "timestamp": 1691128339, "time_this_iter_s": 13.05308485031128, "time_total_s": 1989.8237059116364, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 259.9929790496826, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.694736842105264, "ram_util_percent": 62.59473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -318.55437622070315, "policy_loss": -2938025.971875, "vf_loss": 8472543.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 412.0}}, "num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2430.9518334120344, "episode_reward_mean": -1683.6892788849989, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630078272776132, "mean_inference_ms": 0.369525020576442, "mean_action_processing_ms": 0.09081060115828024, "mean_env_wait_ms": 1.2223848023602943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003756959754300405, "StateBufferConnector_ms": 0.0027567507272743316, "ViewRequirementAgentConnector_ms": 0.06567512650087655}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2430.9518334120344, "episode_reward_mean": -1683.6892788849989, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630078272776132, "mean_inference_ms": 0.369525020576442, "mean_action_processing_ms": 0.09081060115828024, "mean_env_wait_ms": 1.2223848023602943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003756959754300405, "StateBufferConnector_ms": 0.0027567507272743316, "ViewRequirementAgentConnector_ms": 0.06567512650087655}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880, "num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.37139261911916, "num_env_steps_trained_throughput_per_sec": 110.37139261911916, "timesteps_total": 149880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 149880, "timers": {"training_iteration_time_ms": 3259.452, "sample_time_ms": 3248.636, "load_time_ms": 0.298, "load_throughput": 1207186.952, "learn_time_ms": 9.742, "learn_throughput": 36953.768, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880}, "done": false, "episodes_total": 897, "training_iteration": 181, "trial_id": "73eff_00000", "date": "2023-08-04_08-52-32", "timestamp": 1691128352, "time_this_iter_s": 13.04960012435913, "time_total_s": 2002.8733060359955, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 273.04257917404175, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.183333333333337, "ram_util_percent": 62.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.388888888888888e-07, "entropy_coeff": 0.05, "policy_entropy": -318.3618103027344, "policy_loss": -1774560.465625, "vf_loss": 9301176.05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 433.0, "diff_num_grad_updates_vs_sampler_policy": 432.0}}, "num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2525.392746105252, "episode_reward_mean": -1713.1722556472798, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630877550964389, "mean_inference_ms": 0.36952174320302467, "mean_action_processing_ms": 0.09081409953551625, "mean_env_wait_ms": 1.21090347405703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037675616384922773, "StateBufferConnector_ms": 0.002756612054232893, "ViewRequirementAgentConnector_ms": 0.06563142798412805}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2525.392746105252, "episode_reward_mean": -1713.1722556472798, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630877550964389, "mean_inference_ms": 0.36952174320302467, "mean_action_processing_ms": 0.09081409953551625, "mean_env_wait_ms": 1.21090347405703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037675616384922773, "StateBufferConnector_ms": 0.002756612054232893, "ViewRequirementAgentConnector_ms": 0.06563142798412805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320, "num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.83710321199904, "num_env_steps_trained_throughput_per_sec": 109.83710321199904, "timesteps_total": 151320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 151320, "timers": {"training_iteration_time_ms": 3269.511, "sample_time_ms": 3258.623, "load_time_ms": 0.296, "load_throughput": 1216719.936, "learn_time_ms": 9.813, "learn_throughput": 36685.32, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320}, "done": false, "episodes_total": 901, "training_iteration": 182, "trial_id": "73eff_00000", "date": "2023-08-04_08-52-45", "timestamp": 1691128365, "time_this_iter_s": 13.113000869750977, "time_total_s": 2015.9863069057465, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 286.1555800437927, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.094736842105263, "ram_util_percent": 62.2421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.388888888888889e-07, "entropy_coeff": 0.05, "policy_entropy": -317.61767578125, "policy_loss": 202596.153125, "vf_loss": 7983154.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 453.0, "diff_num_grad_updates_vs_sampler_policy": 452.0}}, "num_env_steps_sampled": 152760, "num_env_steps_trained": 152760, "num_agent_steps_sampled": 152760, "num_agent_steps_trained": 152760}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2525.392746105252, "episode_reward_mean": -1739.7089950114198, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631361230060264, "mean_inference_ms": 0.36951457366496226, "mean_action_processing_ms": 0.09081640099292251, "mean_env_wait_ms": 1.200210962156741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037515556419288718, "StateBufferConnector_ms": 0.002753079592526614, "ViewRequirementAgentConnector_ms": 0.06560519501403138}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2525.392746105252, "episode_reward_mean": -1739.7089950114198, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631361230060264, "mean_inference_ms": 0.36951457366496226, "mean_action_processing_ms": 0.09081640099292251, "mean_env_wait_ms": 1.200210962156741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037515556419288718, "StateBufferConnector_ms": 0.002753079592526614, "ViewRequirementAgentConnector_ms": 0.06560519501403138}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152760, "num_agent_steps_trained": 152760, "num_env_steps_sampled": 152760, "num_env_steps_trained": 152760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.49030548808291, "num_env_steps_trained_throughput_per_sec": 112.49030548808291, "timesteps_total": 152760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 152760, "timers": {"training_iteration_time_ms": 3243.435, "sample_time_ms": 3232.602, "load_time_ms": 0.297, "load_throughput": 1212908.218, "learn_time_ms": 9.778, "learn_throughput": 36816.272, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 152760, "num_env_steps_trained": 152760, "num_agent_steps_sampled": 152760, "num_agent_steps_trained": 152760}, "done": false, "episodes_total": 905, "training_iteration": 183, "trial_id": "73eff_00000", "date": "2023-08-04_08-52-58", "timestamp": 1691128378, "time_this_iter_s": 12.803852081298828, "time_total_s": 2028.7901589870453, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 298.95943212509155, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.27777777777778, "ram_util_percent": 62.20555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -318.4105712890625, "policy_loss": -5015480.703125, "vf_loss": 9376215.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2525.392746105252, "episode_reward_mean": -1768.1884767307315, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631383600760253, "mean_inference_ms": 0.3695084697418454, "mean_action_processing_ms": 0.09081811707962073, "mean_env_wait_ms": 1.1903111034471638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037328820479543587, "StateBufferConnector_ms": 0.0027563697413394324, "ViewRequirementAgentConnector_ms": 0.06561003233257093}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2525.392746105252, "episode_reward_mean": -1768.1884767307315, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631383600760253, "mean_inference_ms": 0.3695084697418454, "mean_action_processing_ms": 0.09081811707962073, "mean_env_wait_ms": 1.1903111034471638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037328820479543587, "StateBufferConnector_ms": 0.0027563697413394324, "ViewRequirementAgentConnector_ms": 0.06561003233257093}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200, "num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.31252202890764, "num_env_steps_trained_throughput_per_sec": 113.31252202890764, "timesteps_total": 154200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 154200, "timers": {"training_iteration_time_ms": 3208.926, "sample_time_ms": 3198.161, "load_time_ms": 0.299, "load_throughput": 1205740.989, "learn_time_ms": 9.709, "learn_throughput": 37079.361, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200}, "done": false, "episodes_total": 909, "training_iteration": 184, "trial_id": "73eff_00000", "date": "2023-08-04_08-53-11", "timestamp": 1691128391, "time_this_iter_s": 12.711014986038208, "time_total_s": 2041.5011739730835, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 311.67044711112976, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 25.56666666666667, "ram_util_percent": 62.2611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -317.6997314453125, "policy_loss": -1124085.84375, "vf_loss": 8202501.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 493.0, "diff_num_grad_updates_vs_sampler_policy": 492.0}}, "num_env_steps_sampled": 155640, "num_env_steps_trained": 155640, "num_agent_steps_sampled": 155640, "num_agent_steps_trained": 155640}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -1790.097746343661, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631480264650585, "mean_inference_ms": 0.3694967716099659, "mean_action_processing_ms": 0.0908181914996808, "mean_env_wait_ms": 1.1810945252283946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037145132970328285, "StateBufferConnector_ms": 0.002754095828894413, "ViewRequirementAgentConnector_ms": 0.06561881363993943}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -1790.097746343661, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.8376886118865, -1413.55906477191, -1257.3087573286784, -1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631480264650585, "mean_inference_ms": 0.3694967716099659, "mean_action_processing_ms": 0.0908181914996808, "mean_env_wait_ms": 1.1810945252283946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037145132970328285, "StateBufferConnector_ms": 0.002754095828894413, "ViewRequirementAgentConnector_ms": 0.06561881363993943}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155640, "num_agent_steps_trained": 155640, "num_env_steps_sampled": 155640, "num_env_steps_trained": 155640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.10951414154309, "num_env_steps_trained_throughput_per_sec": 110.10951414154309, "timesteps_total": 155640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 155640, "timers": {"training_iteration_time_ms": 3211.556, "sample_time_ms": 3200.694, "load_time_ms": 0.297, "load_throughput": 1213688.16, "learn_time_ms": 9.785, "learn_throughput": 36791.602, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 155640, "num_env_steps_trained": 155640, "num_agent_steps_sampled": 155640, "num_agent_steps_trained": 155640}, "done": false, "episodes_total": 913, "training_iteration": 185, "trial_id": "73eff_00000", "date": "2023-08-04_08-53-24", "timestamp": 1691128404, "time_this_iter_s": 13.080834150314331, "time_total_s": 2054.582008123398, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 324.7512812614441, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.994736842105265, "ram_util_percent": 62.24736842105262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -319.49192504882814, "policy_loss": -5400416.446875, "vf_loss": 10492596.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 513.0, "diff_num_grad_updates_vs_sampler_policy": 512.0}}, "num_env_steps_sampled": 157080, "num_env_steps_trained": 157080, "num_agent_steps_sampled": 157080, "num_agent_steps_trained": 157080}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -1828.1043782335068, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634389568704535, "mean_inference_ms": 0.36925362531318917, "mean_action_processing_ms": 0.09077437577344341, "mean_env_wait_ms": 1.1075906766840504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037081241607666016, "StateBufferConnector_ms": 0.0027458667755126953, "ViewRequirementAgentConnector_ms": 0.06550812721252441}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -1828.1043782335068, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1131.2123810460853, -1225.9614648708705, -1226.0065306310823, -1162.7007186985284, -1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634389568704535, "mean_inference_ms": 0.36925362531318917, "mean_action_processing_ms": 0.09077437577344341, "mean_env_wait_ms": 1.1075906766840504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037081241607666016, "StateBufferConnector_ms": 0.0027458667755126953, "ViewRequirementAgentConnector_ms": 0.06550812721252441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157080, "num_agent_steps_trained": 157080, "num_env_steps_sampled": 157080, "num_env_steps_trained": 157080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.45133784004246, "num_env_steps_trained_throughput_per_sec": 111.45133784004246, "timesteps_total": 157080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 157080, "timers": {"training_iteration_time_ms": 3255.983, "sample_time_ms": 3245.046, "load_time_ms": 0.298, "load_throughput": 1208733.141, "learn_time_ms": 9.854, "learn_throughput": 36532.478, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 157080, "num_env_steps_trained": 157080, "num_agent_steps_sampled": 157080, "num_agent_steps_trained": 157080}, "done": false, "episodes_total": 917, "training_iteration": 186, "trial_id": "73eff_00000", "date": "2023-08-04_08-53-37", "timestamp": 1691128417, "time_this_iter_s": 12.923237800598145, "time_total_s": 2067.505245923996, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 337.67451906204224, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 20.0, "ram_util_percent": 62.111111111111114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -317.6649658203125, "policy_loss": -2360579.7125, "vf_loss": 8501702.35}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 532.0}}, "num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520}, "sampler_results": {"episode_reward_max": -1103.525330980603, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -1875.0690238995367, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.636550226632303, "mean_inference_ms": 0.36910957986860177, "mean_action_processing_ms": 0.09076418058592486, "mean_env_wait_ms": 1.0686561806558783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037055015563964844, "StateBufferConnector_ms": 0.0027518272399902344, "ViewRequirementAgentConnector_ms": 0.06552410125732422}}, "episode_reward_max": -1103.525330980603, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -1875.0690238995367, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1131.7213331050361, -1163.961734295675, -1165.266064312773, -1103.525330980603, -1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.636550226632303, "mean_inference_ms": 0.36910957986860177, "mean_action_processing_ms": 0.09076418058592486, "mean_env_wait_ms": 1.0686561806558783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037055015563964844, "StateBufferConnector_ms": 0.0027518272399902344, "ViewRequirementAgentConnector_ms": 0.06552410125732422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520, "num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.4510219173802, "num_env_steps_trained_throughput_per_sec": 110.4510219173802, "timesteps_total": 158520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 158520, "timers": {"training_iteration_time_ms": 3245.812, "sample_time_ms": 3234.881, "load_time_ms": 0.297, "load_throughput": 1210574.393, "learn_time_ms": 9.868, "learn_throughput": 36482.695, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520}, "done": false, "episodes_total": 921, "training_iteration": 187, "trial_id": "73eff_00000", "date": "2023-08-04_08-53-50", "timestamp": 1691128430, "time_this_iter_s": 13.04048204421997, "time_total_s": 2080.545727968216, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 350.7150011062622, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 19.857894736842105, "ram_util_percent": 62.163157894736834}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -318.1834777832031, "policy_loss": -10173554.05, "vf_loss": 10679183.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 553.0, "diff_num_grad_updates_vs_sampler_policy": 552.0}}, "num_env_steps_sampled": 159960, "num_env_steps_trained": 159960, "num_agent_steps_sampled": 159960, "num_agent_steps_trained": 159960}, "sampler_results": {"episode_reward_max": -1136.5044958926526, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -1922.6989506338443, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.637677022241905, "mean_inference_ms": 0.3690623749359597, "mean_action_processing_ms": 0.09076510733228701, "mean_env_wait_ms": 1.045170796033868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037076473236083984, "StateBufferConnector_ms": 0.002744913101196289, "ViewRequirementAgentConnector_ms": 0.06558942794799805}}, "episode_reward_max": -1136.5044958926526, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -1922.6989506338443, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1200.1650710123834, -1175.6634711296242, -1173.9526816883788, -1208.8825468834486, -1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.637677022241905, "mean_inference_ms": 0.3690623749359597, "mean_action_processing_ms": 0.09076510733228701, "mean_env_wait_ms": 1.045170796033868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037076473236083984, "StateBufferConnector_ms": 0.002744913101196289, "ViewRequirementAgentConnector_ms": 0.06558942794799805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159960, "num_agent_steps_trained": 159960, "num_env_steps_sampled": 159960, "num_env_steps_trained": 159960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.13709475440925, "num_env_steps_trained_throughput_per_sec": 111.13709475440925, "timesteps_total": 159960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 159960, "timers": {"training_iteration_time_ms": 3248.181, "sample_time_ms": 3237.224, "load_time_ms": 0.299, "load_throughput": 1203722.449, "learn_time_ms": 9.884, "learn_throughput": 36423.556, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 159960, "num_env_steps_trained": 159960, "num_agent_steps_sampled": 159960, "num_agent_steps_trained": 159960}, "done": false, "episodes_total": 925, "training_iteration": 188, "trial_id": "73eff_00000", "date": "2023-08-04_08-54-03", "timestamp": 1691128443, "time_this_iter_s": 12.959688901901245, "time_total_s": 2093.505416870117, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 363.67469000816345, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.97222222222222, "ram_util_percent": 62.4388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -317.2096313476562, "policy_loss": -1034385.18125, "vf_loss": 8089034.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 573.0, "diff_num_grad_updates_vs_sampler_policy": 572.0}}, "num_env_steps_sampled": 161400, "num_env_steps_trained": 161400, "num_agent_steps_sampled": 161400, "num_agent_steps_trained": 161400}, "sampler_results": {"episode_reward_max": -1136.5044958926526, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -1968.1744770646412, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.638243384449016, "mean_inference_ms": 0.36901675207158147, "mean_action_processing_ms": 0.09076345684081928, "mean_env_wait_ms": 1.028599803457678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710508346557617, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.06559872627258301}}, "episode_reward_max": -1136.5044958926526, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -1968.1744770646412, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1244.5148114862398, -1311.6149855455071, -1219.7459732611637, -1321.3564031297763, -1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.638243384449016, "mean_inference_ms": 0.36901675207158147, "mean_action_processing_ms": 0.09076345684081928, "mean_env_wait_ms": 1.028599803457678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710508346557617, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.06559872627258301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161400, "num_agent_steps_trained": 161400, "num_env_steps_sampled": 161400, "num_env_steps_trained": 161400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.78934300602562, "num_env_steps_trained_throughput_per_sec": 109.78934300602562, "timesteps_total": 161400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 161400, "timers": {"training_iteration_time_ms": 3251.483, "sample_time_ms": 3240.571, "load_time_ms": 0.299, "load_throughput": 1204586.709, "learn_time_ms": 9.844, "learn_throughput": 36570.879, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 161400, "num_env_steps_trained": 161400, "num_agent_steps_sampled": 161400, "num_agent_steps_trained": 161400}, "done": false, "episodes_total": 929, "training_iteration": 189, "trial_id": "73eff_00000", "date": "2023-08-04_08-54-16", "timestamp": 1691128456, "time_this_iter_s": 13.118864297866821, "time_total_s": 2106.624281167984, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 376.7935543060303, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.2, "ram_util_percent": 62.394736842105274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -317.4292907714844, "policy_loss": -3595422.81875, "vf_loss": 9185628.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 592.0}}, "num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840}, "sampler_results": {"episode_reward_max": -1136.5044958926526, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -2014.882071552565, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6389936976272335, "mean_inference_ms": 0.3689883954854702, "mean_action_processing_ms": 0.0907635169947271, "mean_env_wait_ms": 1.0158105384769287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037076473236083984, "StateBufferConnector_ms": 0.002735614776611328, "ViewRequirementAgentConnector_ms": 0.06556582450866699}}, "episode_reward_max": -1136.5044958926526, "episode_reward_min": -2570.598418320598, "episode_reward_mean": -2014.882071552565, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1162.9638933065667, -1229.712986600487, -1136.5044958926526, -1340.879820511894, -1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6389936976272335, "mean_inference_ms": 0.3689883954854702, "mean_action_processing_ms": 0.0907635169947271, "mean_env_wait_ms": 1.0158105384769287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037076473236083984, "StateBufferConnector_ms": 0.002735614776611328, "ViewRequirementAgentConnector_ms": 0.06556582450866699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840, "num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.27538365068146, "num_env_steps_trained_throughput_per_sec": 110.27538365068146, "timesteps_total": 162840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 162840, "timers": {"training_iteration_time_ms": 3265.021, "sample_time_ms": 3254.14, "load_time_ms": 0.297, "load_throughput": 1213785.723, "learn_time_ms": 9.823, "learn_throughput": 36647.123, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840}, "done": false, "episodes_total": 933, "training_iteration": 190, "trial_id": "73eff_00000", "date": "2023-08-04_08-54-29", "timestamp": 1691128469, "time_this_iter_s": 13.061043977737427, "time_total_s": 2119.6853251457214, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 389.8545982837677, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 18.061111111111114, "ram_util_percent": 62.472222222222236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -316.8474487304687, "policy_loss": 199591.6359375, "vf_loss": 7840473.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 613.0, "diff_num_grad_updates_vs_sampler_policy": 612.0}}, "num_env_steps_sampled": 164280, "num_env_steps_trained": 164280, "num_agent_steps_sampled": 164280, "num_agent_steps_trained": 164280}, "sampler_results": {"episode_reward_max": -1150.5528584993647, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2063.8323223461043, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639617551803433, "mean_inference_ms": 0.36898791828425925, "mean_action_processing_ms": 0.09076688935866083, "mean_env_wait_ms": 1.005677108973026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.002732515335083008, "ViewRequirementAgentConnector_ms": 0.06549286842346191}}, "episode_reward_max": -1150.5528584993647, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2063.8323223461043, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1309.4649924010873, -1351.6074976798568, -1244.9471068837597, -1287.119436050045, -1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639617551803433, "mean_inference_ms": 0.36898791828425925, "mean_action_processing_ms": 0.09076688935866083, "mean_env_wait_ms": 1.005677108973026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.002732515335083008, "ViewRequirementAgentConnector_ms": 0.06549286842346191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164280, "num_agent_steps_trained": 164280, "num_env_steps_sampled": 164280, "num_env_steps_trained": 164280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.47694457365355, "num_env_steps_trained_throughput_per_sec": 110.47694457365355, "timesteps_total": 164280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 164280, "timers": {"training_iteration_time_ms": 3266.554, "sample_time_ms": 3255.729, "load_time_ms": 0.299, "load_throughput": 1205259.77, "learn_time_ms": 9.78, "learn_throughput": 36809.182, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 164280, "num_env_steps_trained": 164280, "num_agent_steps_sampled": 164280, "num_agent_steps_trained": 164280}, "done": false, "episodes_total": 937, "training_iteration": 191, "trial_id": "73eff_00000", "date": "2023-08-04_08-54-42", "timestamp": 1691128482, "time_this_iter_s": 13.037248611450195, "time_total_s": 2132.7225737571716, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 402.8918468952179, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 17.96315789473684, "ram_util_percent": 62.23157894736841}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.711111111111111e-07, "entropy_coeff": 0.05, "policy_entropy": -317.31231079101565, "policy_loss": -1109370.15, "vf_loss": 8875138.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 633.0, "diff_num_grad_updates_vs_sampler_policy": 632.0}}, "num_env_steps_sampled": 165720, "num_env_steps_trained": 165720, "num_agent_steps_sampled": 165720, "num_agent_steps_trained": 165720}, "sampler_results": {"episode_reward_max": -1150.5528584993647, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2104.4914366525363, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640155982594406, "mean_inference_ms": 0.3690033943929829, "mean_action_processing_ms": 0.09077320444088834, "mean_env_wait_ms": 0.9972105355472667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699064254760742, "StateBufferConnector_ms": 0.0027413368225097656, "ViewRequirementAgentConnector_ms": 0.06551408767700195}}, "episode_reward_max": -1150.5528584993647, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2104.4914366525363, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1288.7434676582202, -1150.5528584993647, -1256.1839978228716, -1188.8503340121745, -1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640155982594406, "mean_inference_ms": 0.3690033943929829, "mean_action_processing_ms": 0.09077320444088834, "mean_env_wait_ms": 0.9972105355472667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699064254760742, "StateBufferConnector_ms": 0.0027413368225097656, "ViewRequirementAgentConnector_ms": 0.06551408767700195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165720, "num_agent_steps_trained": 165720, "num_env_steps_sampled": 165720, "num_env_steps_trained": 165720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.38950066150264, "num_env_steps_trained_throughput_per_sec": 109.38950066150264, "timesteps_total": 165720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 165720, "timers": {"training_iteration_time_ms": 3273.461, "sample_time_ms": 3262.619, "load_time_ms": 0.301, "load_throughput": 1195715.426, "learn_time_ms": 9.786, "learn_throughput": 36785.866, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 165720, "num_env_steps_trained": 165720, "num_agent_steps_sampled": 165720, "num_agent_steps_trained": 165720}, "done": false, "episodes_total": 941, "training_iteration": 192, "trial_id": "73eff_00000", "date": "2023-08-04_08-54-55", "timestamp": 1691128495, "time_this_iter_s": 13.166781187057495, "time_total_s": 2145.889354944229, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 416.0586280822754, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.557894736842105, "ram_util_percent": 62.147368421052626}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1111111111111113e-07, "entropy_coeff": 0.05, "policy_entropy": -316.9533935546875, "policy_loss": -2825042.353125, "vf_loss": 8904258.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 652.0}}, "num_env_steps_sampled": 167160, "num_env_steps_trained": 167160, "num_agent_steps_sampled": 167160, "num_agent_steps_trained": 167160}, "sampler_results": {"episode_reward_max": -1198.5688919970612, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2151.544295850579, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640332307121944, "mean_inference_ms": 0.3690250580808596, "mean_action_processing_ms": 0.0907799736115632, "mean_env_wait_ms": 0.9901069496571014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037004947662353516, "StateBufferConnector_ms": 0.0027420520782470703, "ViewRequirementAgentConnector_ms": 0.06548738479614258}}, "episode_reward_max": -1198.5688919970612, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2151.544295850579, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1228.7479942575083, -1227.4127459734182, -1236.0013586148395, -1198.5688919970612, -1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640332307121944, "mean_inference_ms": 0.3690250580808596, "mean_action_processing_ms": 0.0907799736115632, "mean_env_wait_ms": 0.9901069496571014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037004947662353516, "StateBufferConnector_ms": 0.0027420520782470703, "ViewRequirementAgentConnector_ms": 0.06548738479614258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167160, "num_agent_steps_trained": 167160, "num_env_steps_sampled": 167160, "num_env_steps_trained": 167160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.80395381558577, "num_env_steps_trained_throughput_per_sec": 110.80395381558577, "timesteps_total": 167160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 167160, "timers": {"training_iteration_time_ms": 3269.976, "sample_time_ms": 3259.014, "load_time_ms": 0.303, "load_throughput": 1189404.837, "learn_time_ms": 9.887, "learn_throughput": 36412.577, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 167160, "num_env_steps_trained": 167160, "num_agent_steps_sampled": 167160, "num_agent_steps_trained": 167160}, "done": false, "episodes_total": 945, "training_iteration": 193, "trial_id": "73eff_00000", "date": "2023-08-04_08-55-08", "timestamp": 1691128508, "time_this_iter_s": 12.998863220214844, "time_total_s": 2158.888218164444, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 429.05749130249023, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 20.116666666666667, "ram_util_percent": 62.133333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": -317.0371337890625, "policy_loss": -4921392.48125, "vf_loss": 8884810.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 673.0, "diff_num_grad_updates_vs_sampler_policy": 672.0}}, "num_env_steps_sampled": 168600, "num_env_steps_trained": 168600, "num_agent_steps_sampled": 168600, "num_agent_steps_trained": 168600}, "sampler_results": {"episode_reward_max": -1206.0913016315412, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2199.525211017829, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640241848852458, "mean_inference_ms": 0.36904648749899993, "mean_action_processing_ms": 0.09078529655749296, "mean_env_wait_ms": 0.9842024614299192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003694772720336914, "StateBufferConnector_ms": 0.002744913101196289, "ViewRequirementAgentConnector_ms": 0.06544733047485352}}, "episode_reward_max": -1206.0913016315412, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2199.525211017829, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1341.2014913093765, -1237.8954210565105, -1206.0913016315412, -1350.375653725876, -1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640241848852458, "mean_inference_ms": 0.36904648749899993, "mean_action_processing_ms": 0.09078529655749296, "mean_env_wait_ms": 0.9842024614299192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003694772720336914, "StateBufferConnector_ms": 0.002744913101196289, "ViewRequirementAgentConnector_ms": 0.06544733047485352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168600, "num_agent_steps_trained": 168600, "num_env_steps_sampled": 168600, "num_env_steps_trained": 168600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.8763491298184, "num_env_steps_trained_throughput_per_sec": 109.8763491298184, "timesteps_total": 168600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 168600, "timers": {"training_iteration_time_ms": 3271.389, "sample_time_ms": 3260.404, "load_time_ms": 0.3, "load_throughput": 1198753.128, "learn_time_ms": 9.906, "learn_throughput": 36340.54, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 168600, "num_env_steps_trained": 168600, "num_agent_steps_sampled": 168600, "num_agent_steps_trained": 168600}, "done": false, "episodes_total": 949, "training_iteration": 194, "trial_id": "73eff_00000", "date": "2023-08-04_08-55-21", "timestamp": 1691128521, "time_this_iter_s": 13.108545064926147, "time_total_s": 2171.99676322937, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 442.1660363674164, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 16.952631578947365, "ram_util_percent": 62.16315789473683}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": -316.80097045898435, "policy_loss": 55077.32734375, "vf_loss": 7871002.05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 693.0, "diff_num_grad_updates_vs_sampler_policy": 692.0}}, "num_env_steps_sampled": 170040, "num_env_steps_trained": 170040, "num_agent_steps_sampled": 170040, "num_agent_steps_trained": 170040}, "sampler_results": {"episode_reward_max": -1221.4617458287837, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2241.3179913304875, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640140974245519, "mean_inference_ms": 0.36907098895117735, "mean_action_processing_ms": 0.0907910757203605, "mean_env_wait_ms": 0.9790172524684516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036897659301757812, "StateBufferConnector_ms": 0.002748250961303711, "ViewRequirementAgentConnector_ms": 0.0655052661895752}}, "episode_reward_max": -1221.4617458287837, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2241.3179913304875, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1358.3576897830221, -1255.8505226521625, -1251.629948086856, -1285.5015096003538, -1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640140974245519, "mean_inference_ms": 0.36907098895117735, "mean_action_processing_ms": 0.0907910757203605, "mean_env_wait_ms": 0.9790172524684516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036897659301757812, "StateBufferConnector_ms": 0.002748250961303711, "ViewRequirementAgentConnector_ms": 0.0655052661895752}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170040, "num_agent_steps_trained": 170040, "num_env_steps_sampled": 170040, "num_env_steps_trained": 170040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.37252816192704, "num_env_steps_trained_throughput_per_sec": 110.37252816192704, "timesteps_total": 170040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 170040, "timers": {"training_iteration_time_ms": 3267.384, "sample_time_ms": 3256.409, "load_time_ms": 0.3, "load_throughput": 1199324.416, "learn_time_ms": 9.898, "learn_throughput": 36371.966, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 170040, "num_env_steps_trained": 170040, "num_agent_steps_sampled": 170040, "num_agent_steps_trained": 170040}, "done": false, "episodes_total": 953, "training_iteration": 195, "trial_id": "73eff_00000", "date": "2023-08-04_08-55-34", "timestamp": 1691128534, "time_this_iter_s": 13.049726963043213, "time_total_s": 2185.0464901924133, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 455.2157633304596, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.663157894736845, "ram_util_percent": 62.1578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": -317.1282043457031, "policy_loss": -83845.806640625, "vf_loss": 8870494.55}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 713.0, "diff_num_grad_updates_vs_sampler_policy": 712.0}}, "num_env_steps_sampled": 171480, "num_env_steps_trained": 171480, "num_agent_steps_sampled": 171480, "num_agent_steps_trained": 171480}, "sampler_results": {"episode_reward_max": -1221.4617458287837, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2286.199946002007, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639839012185669, "mean_inference_ms": 0.3691011141333675, "mean_action_processing_ms": 0.09079682633562786, "mean_env_wait_ms": 0.9744717261199679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003684520721435547, "StateBufferConnector_ms": 0.0027506351470947266, "ViewRequirementAgentConnector_ms": 0.06546211242675781}}, "episode_reward_max": -1221.4617458287837, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2286.199946002007, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1221.4617458287837, -1342.651661739012, -1626.4632153962307, -1917.1354867763175, -1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639839012185669, "mean_inference_ms": 0.3691011141333675, "mean_action_processing_ms": 0.09079682633562786, "mean_env_wait_ms": 0.9744717261199679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003684520721435547, "StateBufferConnector_ms": 0.0027506351470947266, "ViewRequirementAgentConnector_ms": 0.06546211242675781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171480, "num_agent_steps_trained": 171480, "num_env_steps_sampled": 171480, "num_env_steps_trained": 171480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.69596527272692, "num_env_steps_trained_throughput_per_sec": 109.69596527272692, "timesteps_total": 171480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 171480, "timers": {"training_iteration_time_ms": 3272.588, "sample_time_ms": 3261.718, "load_time_ms": 0.3, "load_throughput": 1201615.025, "learn_time_ms": 9.805, "learn_throughput": 36716.542, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 171480, "num_env_steps_trained": 171480, "num_agent_steps_sampled": 171480, "num_agent_steps_trained": 171480}, "done": false, "episodes_total": 957, "training_iteration": 196, "trial_id": "73eff_00000", "date": "2023-08-04_08-55-48", "timestamp": 1691128548, "time_this_iter_s": 13.129940032958984, "time_total_s": 2198.1764302253723, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 468.3457033634186, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.566666666666666, "ram_util_percent": 62.23888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": -317.9068603515625, "policy_loss": -2113941.425, "vf_loss": 10771311.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 733.0, "diff_num_grad_updates_vs_sampler_policy": 732.0}}, "num_env_steps_sampled": 172920, "num_env_steps_trained": 172920, "num_agent_steps_sampled": 172920, "num_agent_steps_trained": 172920}, "sampler_results": {"episode_reward_max": -1962.960291686983, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2319.524766373839, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639470074230213, "mean_inference_ms": 0.3691287729040668, "mean_action_processing_ms": 0.09080241351507067, "mean_env_wait_ms": 0.9704611071353035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036814212799072266, "StateBufferConnector_ms": 0.0027480125427246094, "ViewRequirementAgentConnector_ms": 0.06544899940490723}}, "episode_reward_max": -1962.960291686983, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2319.524766373839, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1962.960291686983, -2101.032635633623, -2024.8229128174596, -2057.6111567827647, -2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639470074230213, "mean_inference_ms": 0.3691287729040668, "mean_action_processing_ms": 0.09080241351507067, "mean_env_wait_ms": 0.9704611071353035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036814212799072266, "StateBufferConnector_ms": 0.0027480125427246094, "ViewRequirementAgentConnector_ms": 0.06544899940490723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172920, "num_agent_steps_trained": 172920, "num_env_steps_sampled": 172920, "num_env_steps_trained": 172920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.1126438464806, "num_env_steps_trained_throughput_per_sec": 111.1126438464806, "timesteps_total": 172920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 172920, "timers": {"training_iteration_time_ms": 3256.469, "sample_time_ms": 3245.649, "load_time_ms": 0.3, "load_throughput": 1201615.025, "learn_time_ms": 9.754, "learn_throughput": 36906.078, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 172920, "num_env_steps_trained": 172920, "num_agent_steps_sampled": 172920, "num_agent_steps_trained": 172920}, "done": false, "episodes_total": 961, "training_iteration": 197, "trial_id": "73eff_00000", "date": "2023-08-04_08-56-01", "timestamp": 1691128561, "time_this_iter_s": 12.962569952011108, "time_total_s": 2211.1390001773834, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 481.3082733154297, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 20.042105263157893, "ram_util_percent": 62.421052631578945}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": -317.4258056640625, "policy_loss": -6937614.66875, "vf_loss": 10081607.05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 753.0, "diff_num_grad_updates_vs_sampler_policy": 752.0}}, "num_env_steps_sampled": 174360, "num_env_steps_trained": 174360, "num_agent_steps_sampled": 174360, "num_agent_steps_trained": 174360}, "sampler_results": {"episode_reward_max": -2122.9026199355308, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2332.8919333774147, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63911384284002, "mean_inference_ms": 0.36916021621964185, "mean_action_processing_ms": 0.09080904131731657, "mean_env_wait_ms": 0.9669194116197848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00368499755859375, "StateBufferConnector_ms": 0.002750873565673828, "ViewRequirementAgentConnector_ms": 0.06555342674255371}}, "episode_reward_max": -2122.9026199355308, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2332.8919333774147, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2416.190648722425, -2123.851749666542, -2311.5597998949597, -2122.9026199355308, -2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63911384284002, "mean_inference_ms": 0.36916021621964185, "mean_action_processing_ms": 0.09080904131731657, "mean_env_wait_ms": 0.9669194116197848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00368499755859375, "StateBufferConnector_ms": 0.002750873565673828, "ViewRequirementAgentConnector_ms": 0.06555342674255371}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174360, "num_agent_steps_trained": 174360, "num_env_steps_sampled": 174360, "num_env_steps_trained": 174360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.86818385189012, "num_env_steps_trained_throughput_per_sec": 110.86818385189012, "timesteps_total": 174360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 174360, "timers": {"training_iteration_time_ms": 3247.645, "sample_time_ms": 3236.849, "load_time_ms": 0.299, "load_throughput": 1204106.411, "learn_time_ms": 9.736, "learn_throughput": 36974.671, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 174360, "num_env_steps_trained": 174360, "num_agent_steps_sampled": 174360, "num_agent_steps_trained": 174360}, "done": false, "episodes_total": 965, "training_iteration": 198, "trial_id": "73eff_00000", "date": "2023-08-04_08-56-14", "timestamp": 1691128574, "time_this_iter_s": 12.99145793914795, "time_total_s": 2224.1304581165314, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 494.29973125457764, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 19.766666666666666, "ram_util_percent": 62.34444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": -316.7309509277344, "policy_loss": -117840.828125, "vf_loss": 8173363.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 773.0, "diff_num_grad_updates_vs_sampler_policy": 772.0}}, "num_env_steps_sampled": 175800, "num_env_steps_trained": 175800, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175800}, "sampler_results": {"episode_reward_max": -2154.1352993964365, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2335.268717642579, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639196629819037, "mean_inference_ms": 0.3690840087702894, "mean_action_processing_ms": 0.09079184616756299, "mean_env_wait_ms": 0.9634961417265441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036835670471191406, "StateBufferConnector_ms": 0.0027534961700439453, "ViewRequirementAgentConnector_ms": 0.06561422348022461}}, "episode_reward_max": -2154.1352993964365, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2335.268717642579, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2200.3896231210447, -2194.5982781593057, -2423.127366069789, -2253.246804834198, -2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639196629819037, "mean_inference_ms": 0.3690840087702894, "mean_action_processing_ms": 0.09079184616756299, "mean_env_wait_ms": 0.9634961417265441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036835670471191406, "StateBufferConnector_ms": 0.0027534961700439453, "ViewRequirementAgentConnector_ms": 0.06561422348022461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175800, "num_env_steps_sampled": 175800, "num_env_steps_trained": 175800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.89892611605934, "num_env_steps_trained_throughput_per_sec": 108.89892611605934, "timesteps_total": 175800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 175800, "timers": {"training_iteration_time_ms": 3267.572, "sample_time_ms": 3256.655, "load_time_ms": 0.301, "load_throughput": 1195999.556, "learn_time_ms": 9.832, "learn_throughput": 36614.954, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 175800, "num_env_steps_trained": 175800, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175800}, "done": false, "episodes_total": 969, "training_iteration": 199, "trial_id": "73eff_00000", "date": "2023-08-04_08-56-27", "timestamp": 1691128587, "time_this_iter_s": 13.226173877716064, "time_total_s": 2237.3566319942474, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 507.5259051322937, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 26.510526315789473, "ram_util_percent": 62.40526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": -316.71746826171875, "policy_loss": -2588994.140625, "vf_loss": 8497477.35}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 793.0, "diff_num_grad_updates_vs_sampler_policy": 792.0}}, "num_env_steps_sampled": 177240, "num_env_steps_trained": 177240, "num_agent_steps_sampled": 177240, "num_agent_steps_trained": 177240}, "sampler_results": {"episode_reward_max": -2154.1352993964365, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2335.1590448661273, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639117581658284, "mean_inference_ms": 0.36899714417547486, "mean_action_processing_ms": 0.09077283306581638, "mean_env_wait_ms": 0.9602900777560961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681659698486328, "StateBufferConnector_ms": 0.002752542495727539, "ViewRequirementAgentConnector_ms": 0.06561517715454102}}, "episode_reward_max": -2154.1352993964365, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2335.1590448661273, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2217.9185742411123, -2253.8234536920722, -2193.7652829229373, -2299.2781421129653, -2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639117581658284, "mean_inference_ms": 0.36899714417547486, "mean_action_processing_ms": 0.09077283306581638, "mean_env_wait_ms": 0.9602900777560961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681659698486328, "StateBufferConnector_ms": 0.002752542495727539, "ViewRequirementAgentConnector_ms": 0.06561517715454102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177240, "num_agent_steps_trained": 177240, "num_env_steps_sampled": 177240, "num_env_steps_trained": 177240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.71363201920096, "num_env_steps_trained_throughput_per_sec": 109.71363201920096, "timesteps_total": 177240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 177240, "timers": {"training_iteration_time_ms": 3281.611, "sample_time_ms": 3270.711, "load_time_ms": 0.301, "load_throughput": 1196852.758, "learn_time_ms": 9.832, "learn_throughput": 36615.575, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 177240, "num_env_steps_trained": 177240, "num_agent_steps_sampled": 177240, "num_agent_steps_trained": 177240}, "done": false, "episodes_total": 973, "training_iteration": 200, "trial_id": "73eff_00000", "date": "2023-08-04_08-56-40", "timestamp": 1691128600, "time_this_iter_s": 13.128170013427734, "time_total_s": 2250.484802007675, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 520.6540751457214, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 19.394736842105264, "ram_util_percent": 62.231578947368426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": -316.593798828125, "policy_loss": -448574.13125, "vf_loss": 8543359.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 813.0, "diff_num_grad_updates_vs_sampler_policy": 812.0}}, "num_env_steps_sampled": 178680, "num_env_steps_trained": 178680, "num_agent_steps_sampled": 178680, "num_agent_steps_trained": 178680}, "sampler_results": {"episode_reward_max": -2154.1352993964365, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2339.3448314222214, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639243437818297, "mean_inference_ms": 0.36892355007417876, "mean_action_processing_ms": 0.09075671985246984, "mean_env_wait_ms": 0.9574056852509324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036821365356445312, "StateBufferConnector_ms": 0.0027582645416259766, "ViewRequirementAgentConnector_ms": 0.06564116477966309}}, "episode_reward_max": -2154.1352993964365, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2339.3448314222214, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2329.7560845124826, -2207.0794890338925, -2241.584920360119, -2173.146802593084, -2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639243437818297, "mean_inference_ms": 0.36892355007417876, "mean_action_processing_ms": 0.09075671985246984, "mean_env_wait_ms": 0.9574056852509324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036821365356445312, "StateBufferConnector_ms": 0.0027582645416259766, "ViewRequirementAgentConnector_ms": 0.06564116477966309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 178680, "num_agent_steps_trained": 178680, "num_env_steps_sampled": 178680, "num_env_steps_trained": 178680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.76117676062914, "num_env_steps_trained_throughput_per_sec": 109.76117676062914, "timesteps_total": 178680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 178680, "timers": {"training_iteration_time_ms": 3283.975, "sample_time_ms": 3273.082, "load_time_ms": 0.297, "load_throughput": 1210962.74, "learn_time_ms": 9.81, "learn_throughput": 36698.516, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 178680, "num_env_steps_trained": 178680, "num_agent_steps_sampled": 178680, "num_agent_steps_trained": 178680}, "done": false, "episodes_total": 977, "training_iteration": 201, "trial_id": "73eff_00000", "date": "2023-08-04_08-56-53", "timestamp": 1691128613, "time_this_iter_s": 13.122222661972046, "time_total_s": 2263.607024669647, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 533.7762978076935, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.72222222222222, "ram_util_percent": 62.05555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.388888888888888e-08, "entropy_coeff": 0.05, "policy_entropy": -318.47606201171874, "policy_loss": -2854425.321875, "vf_loss": 10996896.45}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 832.0}}, "num_env_steps_sampled": 180120, "num_env_steps_trained": 180120, "num_agent_steps_sampled": 180120, "num_agent_steps_trained": 180120}, "sampler_results": {"episode_reward_max": -2154.1352993964365, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2344.497391504685, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639276091206406, "mean_inference_ms": 0.36883790376249964, "mean_action_processing_ms": 0.09073852776651135, "mean_env_wait_ms": 0.9547127215760526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003689289093017578, "StateBufferConnector_ms": 0.002757549285888672, "ViewRequirementAgentConnector_ms": 0.06565093994140625}}, "episode_reward_max": -2154.1352993964365, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2344.497391504685, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2298.6133551146027, -2273.7156006615805, -2206.235883116987, -2316.527417115191, -2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639276091206406, "mean_inference_ms": 0.36883790376249964, "mean_action_processing_ms": 0.09073852776651135, "mean_env_wait_ms": 0.9547127215760526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003689289093017578, "StateBufferConnector_ms": 0.002757549285888672, "ViewRequirementAgentConnector_ms": 0.06565093994140625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180120, "num_agent_steps_trained": 180120, "num_env_steps_sampled": 180120, "num_env_steps_trained": 180120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.08946434363, "num_env_steps_trained_throughput_per_sec": 112.08946434363, "timesteps_total": 180120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 180120, "timers": {"training_iteration_time_ms": 3250.827, "sample_time_ms": 3239.886, "load_time_ms": 0.298, "load_throughput": 1207959.552, "learn_time_ms": 9.863, "learn_throughput": 36499.804, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 180120, "num_env_steps_trained": 180120, "num_agent_steps_sampled": 180120, "num_agent_steps_trained": 180120}, "done": false, "episodes_total": 981, "training_iteration": 202, "trial_id": "73eff_00000", "date": "2023-08-04_08-57-06", "timestamp": 1691128626, "time_this_iter_s": 12.849646806716919, "time_total_s": 2276.456671476364, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 546.6259446144104, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 22.272222222222222, "ram_util_percent": 62.1111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.388888888888888e-08, "entropy_coeff": 0.05, "policy_entropy": -317.1255126953125, "policy_loss": -3888726.63828125, "vf_loss": 10525982.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 853.0, "diff_num_grad_updates_vs_sampler_policy": 852.0}}, "num_env_steps_sampled": 181560, "num_env_steps_trained": 181560, "num_agent_steps_sampled": 181560, "num_agent_steps_trained": 181560}, "sampler_results": {"episode_reward_max": -2154.1352993964365, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2352.554659600736, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639466174867548, "mean_inference_ms": 0.36876125348087796, "mean_action_processing_ms": 0.09072223951524513, "mean_env_wait_ms": 0.9522746749086505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036940574645996094, "StateBufferConnector_ms": 0.002718210220336914, "ViewRequirementAgentConnector_ms": 0.06560444831848145}}, "episode_reward_max": -2154.1352993964365, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2352.554659600736, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2217.369470322039, -2246.131695834633, -2313.7608395278767, -2154.1352993964365, -2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639466174867548, "mean_inference_ms": 0.36876125348087796, "mean_action_processing_ms": 0.09072223951524513, "mean_env_wait_ms": 0.9522746749086505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036940574645996094, "StateBufferConnector_ms": 0.002718210220336914, "ViewRequirementAgentConnector_ms": 0.06560444831848145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181560, "num_agent_steps_trained": 181560, "num_env_steps_sampled": 181560, "num_env_steps_trained": 181560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.1755557795778, "num_env_steps_trained_throughput_per_sec": 109.1755557795778, "timesteps_total": 181560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 181560, "timers": {"training_iteration_time_ms": 3260.911, "sample_time_ms": 3249.931, "load_time_ms": 0.298, "load_throughput": 1206415.34, "learn_time_ms": 9.916, "learn_throughput": 36305.589, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 181560, "num_env_steps_trained": 181560, "num_agent_steps_sampled": 181560, "num_agent_steps_trained": 181560}, "done": false, "episodes_total": 985, "training_iteration": 203, "trial_id": "73eff_00000", "date": "2023-08-04_08-57-19", "timestamp": 1691128639, "time_this_iter_s": 13.192578077316284, "time_total_s": 2289.6492495536804, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 559.8185226917267, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.978947368421053, "ram_util_percent": 62.1157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.05, "policy_entropy": -316.66953735351564, "policy_loss": -240966.73515625, "vf_loss": 8567166.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 873.0, "diff_num_grad_updates_vs_sampler_policy": 872.0}}, "num_env_steps_sampled": 183000, "num_env_steps_trained": 183000, "num_agent_steps_sampled": 183000, "num_agent_steps_trained": 183000}, "sampler_results": {"episode_reward_max": -2158.8291126560316, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2359.416416745299, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6396847293291845, "mean_inference_ms": 0.3686913387759573, "mean_action_processing_ms": 0.09070688558893598, "mean_env_wait_ms": 0.9500904450984485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003693819046020508, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.0655522346496582}}, "episode_reward_max": -2158.8291126560316, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2359.416416745299, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2430.9518334120344, -2158.8291126560316, -2159.7579664018735, -2310.1787034403037, -2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6396847293291845, "mean_inference_ms": 0.3686913387759573, "mean_action_processing_ms": 0.09070688558893598, "mean_env_wait_ms": 0.9500904450984485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003693819046020508, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.0655522346496582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183000, "num_agent_steps_trained": 183000, "num_env_steps_sampled": 183000, "num_env_steps_trained": 183000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.77084586812063, "num_env_steps_trained_throughput_per_sec": 109.77084586812063, "timesteps_total": 183000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 183000, "timers": {"training_iteration_time_ms": 3287.023, "sample_time_ms": 3276.126, "load_time_ms": 0.3, "load_throughput": 1201806.304, "learn_time_ms": 9.843, "learn_throughput": 36575.84, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 183000, "num_env_steps_trained": 183000, "num_agent_steps_sampled": 183000, "num_agent_steps_trained": 183000}, "done": false, "episodes_total": 989, "training_iteration": 204, "trial_id": "73eff_00000", "date": "2023-08-04_08-57-32", "timestamp": 1691128652, "time_this_iter_s": 13.121039867401123, "time_total_s": 2302.7702894210815, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 572.9395625591278, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 18.410526315789475, "ram_util_percent": 62.17368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.05, "policy_entropy": -316.934130859375, "policy_loss": -1098365.2703125, "vf_loss": 8821553.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 893.0, "diff_num_grad_updates_vs_sampler_policy": 892.0}}, "num_env_steps_sampled": 184440, "num_env_steps_trained": 184440, "num_agent_steps_sampled": 184440, "num_agent_steps_trained": 184440}, "sampler_results": {"episode_reward_max": -2171.3068990388224, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2366.064252697461, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6398950039905325, "mean_inference_ms": 0.3686273366265538, "mean_action_processing_ms": 0.0906923761544908, "mean_env_wait_ms": 0.948108387234144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003697633743286133, "StateBufferConnector_ms": 0.0027222633361816406, "ViewRequirementAgentConnector_ms": 0.06553077697753906}}, "episode_reward_max": -2171.3068990388224, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2366.064252697461, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2393.328028482476, -2261.463348672873, -2407.523847054996, -2256.2065709141725, -2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6398950039905325, "mean_inference_ms": 0.3686273366265538, "mean_action_processing_ms": 0.0906923761544908, "mean_env_wait_ms": 0.948108387234144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003697633743286133, "StateBufferConnector_ms": 0.0027222633361816406, "ViewRequirementAgentConnector_ms": 0.06553077697753906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184440, "num_agent_steps_trained": 184440, "num_env_steps_sampled": 184440, "num_env_steps_trained": 184440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.46462196096597, "num_env_steps_trained_throughput_per_sec": 109.46462196096597, "timesteps_total": 184440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 184440, "timers": {"training_iteration_time_ms": 3286.777, "sample_time_ms": 3275.94, "load_time_ms": 0.3, "load_throughput": 1199705.578, "learn_time_ms": 9.788, "learn_throughput": 36779.773, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 184440, "num_env_steps_trained": 184440, "num_agent_steps_sampled": 184440, "num_agent_steps_trained": 184440}, "done": false, "episodes_total": 993, "training_iteration": 205, "trial_id": "73eff_00000", "date": "2023-08-04_08-57-46", "timestamp": 1691128666, "time_this_iter_s": 13.157721042633057, "time_total_s": 2315.9280104637146, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 586.0972836017609, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.466666666666665, "ram_util_percent": 62.08888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.05, "policy_entropy": -318.20020751953126, "policy_loss": -3610459.615625, "vf_loss": 10334686.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 913.0, "diff_num_grad_updates_vs_sampler_policy": 912.0}}, "num_env_steps_sampled": 185880, "num_env_steps_trained": 185880, "num_agent_steps_sampled": 185880, "num_agent_steps_trained": 185880}, "sampler_results": {"episode_reward_max": -2171.3068990388224, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2368.9228998543185, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640067839992355, "mean_inference_ms": 0.3685718841126044, "mean_action_processing_ms": 0.09067891944581678, "mean_env_wait_ms": 0.946267611651416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003698587417602539, "StateBufferConnector_ms": 0.002712249755859375, "ViewRequirementAgentConnector_ms": 0.06550431251525879}}, "episode_reward_max": -2171.3068990388224, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2368.9228998543185, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2196.203378349357, -2201.8457826941353, -2525.392746105252, -2376.334186709659, -2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640067839992355, "mean_inference_ms": 0.3685718841126044, "mean_action_processing_ms": 0.09067891944581678, "mean_env_wait_ms": 0.946267611651416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003698587417602539, "StateBufferConnector_ms": 0.002712249755859375, "ViewRequirementAgentConnector_ms": 0.06550431251525879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185880, "num_agent_steps_trained": 185880, "num_env_steps_sampled": 185880, "num_env_steps_trained": 185880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.5284481661408, "num_env_steps_trained_throughput_per_sec": 110.5284481661408, "timesteps_total": 185880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 185880, "timers": {"training_iteration_time_ms": 3271.296, "sample_time_ms": 3260.476, "load_time_ms": 0.3, "load_throughput": 1200946.027, "learn_time_ms": 9.774, "learn_throughput": 36833.964, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 185880, "num_env_steps_trained": 185880, "num_agent_steps_sampled": 185880, "num_agent_steps_trained": 185880}, "done": false, "episodes_total": 997, "training_iteration": 206, "trial_id": "73eff_00000", "date": "2023-08-04_08-57-59", "timestamp": 1691128679, "time_this_iter_s": 13.031118869781494, "time_total_s": 2328.959129333496, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 599.1284024715424, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 20.589473684210525, "ram_util_percent": 62.4421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.194444444444444e-08, "entropy_coeff": 0.05, "policy_entropy": -316.35670166015626, "policy_loss": 200030.484375, "vf_loss": 7893343.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 933.0, "diff_num_grad_updates_vs_sampler_policy": 932.0}}, "num_env_steps_sampled": 187320, "num_env_steps_trained": 187320, "num_agent_steps_sampled": 187320, "num_agent_steps_trained": 187320}, "sampler_results": {"episode_reward_max": -2171.3068990388224, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2367.392845395129, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64016001438959, "mean_inference_ms": 0.36852557416104614, "mean_action_processing_ms": 0.09066739395614716, "mean_env_wait_ms": 0.9445378155167361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.06557250022888184}}, "episode_reward_max": -2171.3068990388224, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2367.392845395129, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2325.1772294499224, -2342.948248358323, -2393.8102389473015, -2205.5965879703717, -2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64016001438959, "mean_inference_ms": 0.36852557416104614, "mean_action_processing_ms": 0.09066739395614716, "mean_env_wait_ms": 0.9445378155167361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.06557250022888184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187320, "num_agent_steps_trained": 187320, "num_env_steps_sampled": 187320, "num_env_steps_trained": 187320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.20715478587675, "num_env_steps_trained_throughput_per_sec": 110.20715478587675, "timesteps_total": 187320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 187320, "timers": {"training_iteration_time_ms": 3263.703, "sample_time_ms": 3252.835, "load_time_ms": 0.3, "load_throughput": 1200086.981, "learn_time_ms": 9.815, "learn_throughput": 36678.637, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 187320, "num_env_steps_trained": 187320, "num_agent_steps_sampled": 187320, "num_agent_steps_trained": 187320}, "done": false, "episodes_total": 1001, "training_iteration": 207, "trial_id": "73eff_00000", "date": "2023-08-04_08-58-12", "timestamp": 1691128692, "time_this_iter_s": 13.069270849227905, "time_total_s": 2342.028400182724, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 612.1976733207703, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 18.977777777777774, "ram_util_percent": 62.43888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.194444444444444e-08, "entropy_coeff": 0.05, "policy_entropy": -318.8374450683594, "policy_loss": -8343079.8125, "vf_loss": 11120022.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 953.0, "diff_num_grad_updates_vs_sampler_policy": 952.0}}, "num_env_steps_sampled": 188760, "num_env_steps_trained": 188760, "num_agent_steps_sampled": 188760, "num_agent_steps_trained": 188760}, "sampler_results": {"episode_reward_max": -2171.3068990388224, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2373.9628453105447, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640581471079534, "mean_inference_ms": 0.3684826643519823, "mean_action_processing_ms": 0.09065643425470343, "mean_env_wait_ms": 0.9429958830981887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.0027060508728027344, "ViewRequirementAgentConnector_ms": 0.06559324264526367}}, "episode_reward_max": -2171.3068990388224, "episode_reward_min": -2656.777246334409, "episode_reward_mean": -2373.9628453105447, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2519.6868500660385, -2356.788396026371, -2380.114401777733, -2407.7970955101428, -2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640581471079534, "mean_inference_ms": 0.3684826643519823, "mean_action_processing_ms": 0.09065643425470343, "mean_env_wait_ms": 0.9429958830981887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.0027060508728027344, "ViewRequirementAgentConnector_ms": 0.06559324264526367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188760, "num_agent_steps_trained": 188760, "num_env_steps_sampled": 188760, "num_env_steps_trained": 188760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.66855138549217, "num_env_steps_trained_throughput_per_sec": 108.66855138549217, "timesteps_total": 188760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 188760, "timers": {"training_iteration_time_ms": 3285.206, "sample_time_ms": 3274.318, "load_time_ms": 0.301, "load_throughput": 1195999.556, "learn_time_ms": 9.829, "learn_throughput": 36628.099, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 188760, "num_env_steps_trained": 188760, "num_agent_steps_sampled": 188760, "num_agent_steps_trained": 188760}, "done": false, "episodes_total": 1005, "training_iteration": 208, "trial_id": "73eff_00000", "date": "2023-08-04_08-58-25", "timestamp": 1691128705, "time_this_iter_s": 13.25442624092102, "time_total_s": 2355.282826423645, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 625.4520995616913, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.189473684210526, "ram_util_percent": 62.43684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": -317.14703369140625, "policy_loss": -2989965.62421875, "vf_loss": 8816513.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 973.0, "diff_num_grad_updates_vs_sampler_policy": 972.0}}, "num_env_steps_sampled": 190200, "num_env_steps_trained": 190200, "num_agent_steps_sampled": 190200, "num_agent_steps_trained": 190200}, "sampler_results": {"episode_reward_max": -2171.3068990388224, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2376.2969898608617, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6413893285218775, "mean_inference_ms": 0.36843767997199206, "mean_action_processing_ms": 0.09064564165554763, "mean_env_wait_ms": 0.9415521806077873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037124156951904297, "StateBufferConnector_ms": 0.002702474594116211, "ViewRequirementAgentConnector_ms": 0.06557679176330566}}, "episode_reward_max": -2171.3068990388224, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2376.2969898608617, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2171.3068990388224, -2570.598418320598, -2269.437954220697, -2230.4283270228298, -2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6413893285218775, "mean_inference_ms": 0.36843767997199206, "mean_action_processing_ms": 0.09064564165554763, "mean_env_wait_ms": 0.9415521806077873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037124156951904297, "StateBufferConnector_ms": 0.002702474594116211, "ViewRequirementAgentConnector_ms": 0.06557679176330566}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190200, "num_agent_steps_trained": 190200, "num_env_steps_sampled": 190200, "num_env_steps_trained": 190200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.2453696900178, "num_env_steps_trained_throughput_per_sec": 110.2453696900178, "timesteps_total": 190200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 190200, "timers": {"training_iteration_time_ms": 3291.708, "sample_time_ms": 3280.823, "load_time_ms": 0.3, "load_throughput": 1199419.684, "learn_time_ms": 9.823, "learn_throughput": 36648.547, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 190200, "num_env_steps_trained": 190200, "num_agent_steps_sampled": 190200, "num_agent_steps_trained": 190200}, "done": false, "episodes_total": 1009, "training_iteration": 209, "trial_id": "73eff_00000", "date": "2023-08-04_08-58-38", "timestamp": 1691128718, "time_this_iter_s": 13.06461501121521, "time_total_s": 2368.3474414348602, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 638.5167145729065, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 19.447368421052634, "ram_util_percent": 62.378947368421045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": -316.6687438964844, "policy_loss": -3205562.1140625, "vf_loss": 8298023.45}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 993.0, "diff_num_grad_updates_vs_sampler_policy": 992.0}}, "num_env_steps_sampled": 191640, "num_env_steps_trained": 191640, "num_agent_steps_sampled": 191640, "num_agent_steps_trained": 191640}, "sampler_results": {"episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2377.361387041136, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6421589411436885, "mean_inference_ms": 0.36839786032310284, "mean_action_processing_ms": 0.09063611361571441, "mean_env_wait_ms": 0.9402051167626828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.06559610366821289}}, "episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2377.361387041136, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2256.8627863993956, -2306.617235772901, -2377.7961187862047, -2483.190305082199, -2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6421589411436885, "mean_inference_ms": 0.36839786032310284, "mean_action_processing_ms": 0.09063611361571441, "mean_env_wait_ms": 0.9402051167626828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.06559610366821289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191640, "num_agent_steps_trained": 191640, "num_env_steps_sampled": 191640, "num_env_steps_trained": 191640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.71675906404765, "num_env_steps_trained_throughput_per_sec": 109.71675906404765, "timesteps_total": 191640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 191640, "timers": {"training_iteration_time_ms": 3283.238, "sample_time_ms": 3272.379, "load_time_ms": 0.299, "load_throughput": 1204682.815, "learn_time_ms": 9.803, "learn_throughput": 36723.507, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 191640, "num_env_steps_trained": 191640, "num_agent_steps_sampled": 191640, "num_agent_steps_trained": 191640}, "done": false, "episodes_total": 1013, "training_iteration": 210, "trial_id": "73eff_00000", "date": "2023-08-04_08-58-51", "timestamp": 1691128731, "time_this_iter_s": 13.127444982528687, "time_total_s": 2381.474886417389, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 651.6441595554352, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.06111111111111, "ram_util_percent": 62.18333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": -318.60504760742185, "policy_loss": -5402803.478125, "vf_loss": 11247623.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 1012.0}}, "num_env_steps_sampled": 193080, "num_env_steps_trained": 193080, "num_agent_steps_sampled": 193080, "num_agent_steps_trained": 193080}, "sampler_results": {"episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2379.601770253858, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.643041373474755, "mean_inference_ms": 0.3683654025488141, "mean_action_processing_ms": 0.09062826311330006, "mean_env_wait_ms": 0.9389318203439332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003712892532348633, "StateBufferConnector_ms": 0.0027098655700683594, "ViewRequirementAgentConnector_ms": 0.06561875343322754}}, "episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2379.601770253858, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2413.758412175305, -2509.213190008592, -2248.529197328251, -2270.844862337363, -2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.643041373474755, "mean_inference_ms": 0.3683654025488141, "mean_action_processing_ms": 0.09062826311330006, "mean_env_wait_ms": 0.9389318203439332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003712892532348633, "StateBufferConnector_ms": 0.0027098655700683594, "ViewRequirementAgentConnector_ms": 0.06561875343322754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193080, "num_agent_steps_trained": 193080, "num_env_steps_sampled": 193080, "num_env_steps_trained": 193080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.22812071916402, "num_env_steps_trained_throughput_per_sec": 110.22812071916402, "timesteps_total": 193080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 193080, "timers": {"training_iteration_time_ms": 3277.525, "sample_time_ms": 3266.634, "load_time_ms": 0.299, "load_throughput": 1203722.449, "learn_time_ms": 9.833, "learn_throughput": 36611.225, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 193080, "num_env_steps_trained": 193080, "num_agent_steps_sampled": 193080, "num_agent_steps_trained": 193080}, "done": false, "episodes_total": 1017, "training_iteration": 211, "trial_id": "73eff_00000", "date": "2023-08-04_08-59-04", "timestamp": 1691128744, "time_this_iter_s": 13.066636085510254, "time_total_s": 2394.541522502899, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 664.7107956409454, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 18.742105263157892, "ram_util_percent": 62.257894736842125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0166666666666665e-08, "entropy_coeff": 0.05, "policy_entropy": -317.628857421875, "policy_loss": -1801965.27578125, "vf_loss": 9219187.45}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1033.0, "diff_num_grad_updates_vs_sampler_policy": 1032.0}}, "num_env_steps_sampled": 194520, "num_env_steps_trained": 194520, "num_agent_steps_sampled": 194520, "num_agent_steps_trained": 194520}, "sampler_results": {"episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2379.3313233597273, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.643946464585342, "mean_inference_ms": 0.36833597343499264, "mean_action_processing_ms": 0.09062170815474456, "mean_env_wait_ms": 0.937712639255956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003711700439453125, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.0656130313873291}}, "episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2379.3313233597273, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2319.8222161499316, -2246.9519322822516, -2264.5671799633665, -2496.125807729351, -2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.643946464585342, "mean_inference_ms": 0.36833597343499264, "mean_action_processing_ms": 0.09062170815474456, "mean_env_wait_ms": 0.937712639255956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003711700439453125, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.0656130313873291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194520, "num_agent_steps_trained": 194520, "num_env_steps_sampled": 194520, "num_env_steps_trained": 194520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.868679974562, "num_env_steps_trained_throughput_per_sec": 109.868679974562, "timesteps_total": 194520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 194520, "timers": {"training_iteration_time_ms": 3276.218, "sample_time_ms": 3265.291, "load_time_ms": 0.302, "load_throughput": 1192316.361, "learn_time_ms": 9.854, "learn_throughput": 36532.832, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 194520, "num_env_steps_trained": 194520, "num_agent_steps_sampled": 194520, "num_agent_steps_trained": 194520}, "done": false, "episodes_total": 1021, "training_iteration": 212, "trial_id": "73eff_00000", "date": "2023-08-04_08-59-17", "timestamp": 1691128757, "time_this_iter_s": 13.109678745269775, "time_total_s": 2407.651201248169, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 677.8204743862152, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.57222222222222, "ram_util_percent": 62.272222222222226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4166666666666664e-08, "entropy_coeff": 0.05, "policy_entropy": -316.54705810546875, "policy_loss": -1206579.834375, "vf_loss": 8519556.05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1053.0, "diff_num_grad_updates_vs_sampler_policy": 1052.0}}, "num_env_steps_sampled": 195960, "num_env_steps_trained": 195960, "num_agent_steps_sampled": 195960, "num_agent_steps_trained": 195960}, "sampler_results": {"episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2380.3591176866753, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.644860082767927, "mean_inference_ms": 0.36830492015134175, "mean_action_processing_ms": 0.09061484657540882, "mean_env_wait_ms": 0.9365784897185798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037119388580322266, "StateBufferConnector_ms": 0.002710580825805664, "ViewRequirementAgentConnector_ms": 0.06566977500915527}}, "episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2380.3591176866753, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2346.273808021538, -2371.8983165761083, -2376.0523754515452, -2211.991913744344, -2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.644860082767927, "mean_inference_ms": 0.36830492015134175, "mean_action_processing_ms": 0.09061484657540882, "mean_env_wait_ms": 0.9365784897185798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037119388580322266, "StateBufferConnector_ms": 0.002710580825805664, "ViewRequirementAgentConnector_ms": 0.06566977500915527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195960, "num_agent_steps_trained": 195960, "num_env_steps_sampled": 195960, "num_env_steps_trained": 195960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.91493006450948, "num_env_steps_trained_throughput_per_sec": 110.91493006450948, "timesteps_total": 195960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 195960, "timers": {"training_iteration_time_ms": 3253.528, "sample_time_ms": 3242.583, "load_time_ms": 0.302, "load_throughput": 1190624.066, "learn_time_ms": 9.854, "learn_throughput": 36532.037, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 195960, "num_env_steps_trained": 195960, "num_agent_steps_sampled": 195960, "num_agent_steps_trained": 195960}, "done": false, "episodes_total": 1025, "training_iteration": 213, "trial_id": "73eff_00000", "date": "2023-08-04_08-59-31", "timestamp": 1691128771, "time_this_iter_s": 12.985728025436401, "time_total_s": 2420.6369292736053, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 690.8062024116516, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 19.373684210526314, "ram_util_percent": 62.28421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -317.71702270507814, "policy_loss": -9104002.95, "vf_loss": 11070298.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1073.0, "diff_num_grad_updates_vs_sampler_policy": 1072.0}}, "num_env_steps_sampled": 197400, "num_env_steps_trained": 197400, "num_agent_steps_sampled": 197400, "num_agent_steps_trained": 197400}, "sampler_results": {"episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2385.906838208848, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6457088159765565, "mean_inference_ms": 0.36827636008572107, "mean_action_processing_ms": 0.09060827385653379, "mean_env_wait_ms": 0.9355462549750445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.0027055740356445312, "ViewRequirementAgentConnector_ms": 0.06568431854248047}}, "episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2385.906838208848, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2465.6276459156793, -2502.047492862722, -2457.434038186842, -2342.8824452498166, -2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6457088159765565, "mean_inference_ms": 0.36827636008572107, "mean_action_processing_ms": 0.09060827385653379, "mean_env_wait_ms": 0.9355462549750445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.0027055740356445312, "ViewRequirementAgentConnector_ms": 0.06568431854248047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197400, "num_agent_steps_trained": 197400, "num_env_steps_sampled": 197400, "num_env_steps_trained": 197400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.13734125812609, "num_env_steps_trained_throughput_per_sec": 109.13734125812609, "timesteps_total": 197400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 197400, "timers": {"training_iteration_time_ms": 3273.259, "sample_time_ms": 3262.416, "load_time_ms": 0.3, "load_throughput": 1199514.967, "learn_time_ms": 9.767, "learn_throughput": 36858.961, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 197400, "num_env_steps_trained": 197400, "num_agent_steps_sampled": 197400, "num_agent_steps_trained": 197400}, "done": false, "episodes_total": 1029, "training_iteration": 214, "trial_id": "73eff_00000", "date": "2023-08-04_08-59-44", "timestamp": 1691128784, "time_this_iter_s": 13.197391986846924, "time_total_s": 2433.8343212604523, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 704.0035943984985, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 19.216666666666665, "ram_util_percent": 62.33888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -316.43609619140625, "policy_loss": -66217.6234375, "vf_loss": 8188366.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1093.0, "diff_num_grad_updates_vs_sampler_policy": 1092.0}}, "num_env_steps_sampled": 198840, "num_env_steps_trained": 198840, "num_agent_steps_sampled": 198840, "num_agent_steps_trained": 198840}, "sampler_results": {"episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2383.7535613562463, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.646504490669659, "mean_inference_ms": 0.3682556103053372, "mean_action_processing_ms": 0.09060296982413851, "mean_env_wait_ms": 0.9345692265532196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.0027112960815429688, "ViewRequirementAgentConnector_ms": 0.0657198429107666}}, "episode_reward_max": -2185.0337813319175, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2383.7535613562463, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2348.475162041304, -2574.800085957895, -2656.777246334409, -2185.0337813319175, -2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.646504490669659, "mean_inference_ms": 0.3682556103053372, "mean_action_processing_ms": 0.09060296982413851, "mean_env_wait_ms": 0.9345692265532196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.0027112960815429688, "ViewRequirementAgentConnector_ms": 0.0657198429107666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198840, "num_agent_steps_trained": 198840, "num_env_steps_sampled": 198840, "num_env_steps_trained": 198840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.46382313023112, "num_env_steps_trained_throughput_per_sec": 110.46382313023112, "timesteps_total": 198840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 198840, "timers": {"training_iteration_time_ms": 3261.021, "sample_time_ms": 3250.183, "load_time_ms": 0.297, "load_throughput": 1211059.865, "learn_time_ms": 9.763, "learn_throughput": 36875.073, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 198840, "num_env_steps_trained": 198840, "num_agent_steps_sampled": 198840, "num_agent_steps_trained": 198840}, "done": false, "episodes_total": 1033, "training_iteration": 215, "trial_id": "73eff_00000", "date": "2023-08-04_08-59-57", "timestamp": 1691128797, "time_this_iter_s": 13.03868579864502, "time_total_s": 2446.8730070590973, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 717.0422801971436, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 19.042105263157897, "ram_util_percent": 62.55789473684209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -316.6417724609375, "policy_loss": -2383227.75, "vf_loss": 8828891.15}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1113.0, "diff_num_grad_updates_vs_sampler_policy": 1112.0}}, "num_env_steps_sampled": 200280, "num_env_steps_trained": 200280, "num_agent_steps_sampled": 200280, "num_agent_steps_trained": 200280}, "sampler_results": {"episode_reward_max": -2186.067380429254, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2379.228743807409, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.647320125634974, "mean_inference_ms": 0.3682414835133362, "mean_action_processing_ms": 0.09059883090903323, "mean_env_wait_ms": 0.9336155690892696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037190914154052734, "StateBufferConnector_ms": 0.002716541290283203, "ViewRequirementAgentConnector_ms": 0.06574273109436035}}, "episode_reward_max": -2186.067380429254, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2379.228743807409, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2492.236012131668, -2186.067380429254, -2264.067480773901, -2316.6795903231264, -2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.647320125634974, "mean_inference_ms": 0.3682414835133362, "mean_action_processing_ms": 0.09059883090903323, "mean_env_wait_ms": 0.9336155690892696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037190914154052734, "StateBufferConnector_ms": 0.002716541290283203, "ViewRequirementAgentConnector_ms": 0.06574273109436035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200280, "num_agent_steps_trained": 200280, "num_env_steps_sampled": 200280, "num_env_steps_trained": 200280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.12236280472963, "num_env_steps_trained_throughput_per_sec": 110.12236280472963, "timesteps_total": 200280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 200280, "timers": {"training_iteration_time_ms": 3272.777, "sample_time_ms": 3261.949, "load_time_ms": 0.297, "load_throughput": 1211642.947, "learn_time_ms": 9.763, "learn_throughput": 36872.192, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 200280, "num_env_steps_trained": 200280, "num_agent_steps_sampled": 200280, "num_agent_steps_trained": 200280}, "done": false, "episodes_total": 1037, "training_iteration": 216, "trial_id": "73eff_00000", "date": "2023-08-04_09-00-10", "timestamp": 1691128810, "time_this_iter_s": 13.079221963882446, "time_total_s": 2459.9522290229797, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 730.121502161026, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 19.15, "ram_util_percent": 62.65555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.388888888888889e-09, "entropy_coeff": 0.05, "policy_entropy": -317.5633239746094, "policy_loss": -6309327.075, "vf_loss": 10151814.15}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1133.0, "diff_num_grad_updates_vs_sampler_policy": 1132.0}}, "num_env_steps_sampled": 201720, "num_env_steps_trained": 201720, "num_agent_steps_sampled": 201720, "num_agent_steps_trained": 201720}, "sampler_results": {"episode_reward_max": -2188.715792141322, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2383.5482618178235, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64808476266674, "mean_inference_ms": 0.3682291914084739, "mean_action_processing_ms": 0.09059517101206026, "mean_env_wait_ms": 0.9327222691569493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037224292755126953, "StateBufferConnector_ms": 0.0027103424072265625, "ViewRequirementAgentConnector_ms": 0.06574749946594238}}, "episode_reward_max": -2188.715792141322, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2383.5482618178235, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2402.304566878063, -2423.4323697947916, -2464.260001514419, -2299.6196396096243, -2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64808476266674, "mean_inference_ms": 0.3682291914084739, "mean_action_processing_ms": 0.09059517101206026, "mean_env_wait_ms": 0.9327222691569493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037224292755126953, "StateBufferConnector_ms": 0.0027103424072265625, "ViewRequirementAgentConnector_ms": 0.06574749946594238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201720, "num_agent_steps_trained": 201720, "num_env_steps_sampled": 201720, "num_env_steps_trained": 201720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.8211986757314, "num_env_steps_trained_throughput_per_sec": 108.8211986757314, "timesteps_total": 201720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 201720, "timers": {"training_iteration_time_ms": 3282.702, "sample_time_ms": 3271.91, "load_time_ms": 0.298, "load_throughput": 1207380.01, "learn_time_ms": 9.748, "learn_throughput": 36931.353, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 201720, "num_env_steps_trained": 201720, "num_agent_steps_sampled": 201720, "num_agent_steps_trained": 201720}, "done": false, "episodes_total": 1041, "training_iteration": 217, "trial_id": "73eff_00000", "date": "2023-08-04_09-00-23", "timestamp": 1691128823, "time_this_iter_s": 13.235488176345825, "time_total_s": 2473.1877171993256, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 743.3569903373718, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.563157894736843, "ram_util_percent": 62.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.388888888888889e-09, "entropy_coeff": 0.05, "policy_entropy": -316.8652282714844, "policy_loss": -2354264.75234375, "vf_loss": 8659878.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1153.0, "diff_num_grad_updates_vs_sampler_policy": 1152.0}}, "num_env_steps_sampled": 203160, "num_env_steps_trained": 203160, "num_agent_steps_sampled": 203160, "num_agent_steps_trained": 203160}, "sampler_results": {"episode_reward_max": -2188.715792141322, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2380.7292332640345, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648861166972117, "mean_inference_ms": 0.3682191406040472, "mean_action_processing_ms": 0.09059191530922032, "mean_env_wait_ms": 0.9318715968609408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037267208099365234, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.06580209732055664}}, "episode_reward_max": -2188.715792141322, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2380.7292332640345, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2500.443258165243, -2385.8453571600326, -2466.9473595192253, -2335.586532723374, -2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648861166972117, "mean_inference_ms": 0.3682191406040472, "mean_action_processing_ms": 0.09059191530922032, "mean_env_wait_ms": 0.9318715968609408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037267208099365234, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.06580209732055664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203160, "num_agent_steps_trained": 203160, "num_env_steps_sampled": 203160, "num_env_steps_trained": 203160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.54263701811428, "num_env_steps_trained_throughput_per_sec": 110.54263701811428, "timesteps_total": 203160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 203160, "timers": {"training_iteration_time_ms": 3280.848, "sample_time_ms": 3270.011, "load_time_ms": 0.298, "load_throughput": 1207283.473, "learn_time_ms": 9.786, "learn_throughput": 36786.762, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 203160, "num_env_steps_trained": 203160, "num_agent_steps_sampled": 203160, "num_agent_steps_trained": 203160}, "done": false, "episodes_total": 1045, "training_iteration": 218, "trial_id": "73eff_00000", "date": "2023-08-04_09-00-36", "timestamp": 1691128836, "time_this_iter_s": 13.029506921768188, "time_total_s": 2486.2172241210938, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 756.38649725914, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 18.836842105263155, "ram_util_percent": 62.51052631578946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": -316.7733154296875, "policy_loss": -2717505.35, "vf_loss": 9500601.85}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1173.0, "diff_num_grad_updates_vs_sampler_policy": 1172.0}}, "num_env_steps_sampled": 204600, "num_env_steps_trained": 204600, "num_agent_steps_sampled": 204600, "num_agent_steps_trained": 204600}, "sampler_results": {"episode_reward_max": -2188.715792141322, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2378.3640121851863, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.649611882350714, "mean_inference_ms": 0.36820983820922815, "mean_action_processing_ms": 0.09058893655115458, "mean_env_wait_ms": 0.931058407032355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003721952438354492, "StateBufferConnector_ms": 0.002709627151489258, "ViewRequirementAgentConnector_ms": 0.06581425666809082}}, "episode_reward_max": -2188.715792141322, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2378.3640121851863, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2373.14430175212, -2304.155119017695, -2448.826686077945, -2188.715792141322, -2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.649611882350714, "mean_inference_ms": 0.36820983820922815, "mean_action_processing_ms": 0.09058893655115458, "mean_env_wait_ms": 0.931058407032355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003721952438354492, "StateBufferConnector_ms": 0.002709627151489258, "ViewRequirementAgentConnector_ms": 0.06581425666809082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204600, "num_agent_steps_trained": 204600, "num_env_steps_sampled": 204600, "num_env_steps_trained": 204600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.63944641335125, "num_env_steps_trained_throughput_per_sec": 109.63944641335125, "timesteps_total": 204600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 204600, "timers": {"training_iteration_time_ms": 3281.913, "sample_time_ms": 3271.072, "load_time_ms": 0.297, "load_throughput": 1210283.296, "learn_time_ms": 9.794, "learn_throughput": 36758.821, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 204600, "num_env_steps_trained": 204600, "num_agent_steps_sampled": 204600, "num_agent_steps_trained": 204600}, "done": false, "episodes_total": 1049, "training_iteration": 219, "trial_id": "73eff_00000", "date": "2023-08-04_09-00-49", "timestamp": 1691128849, "time_this_iter_s": 13.13693881034851, "time_total_s": 2499.3541629314423, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 769.5234360694885, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 18.33888888888889, "ram_util_percent": 62.40555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": -316.97431030273435, "policy_loss": -1395092.803125, "vf_loss": 9426458.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 1192.0}}, "num_env_steps_sampled": 206040, "num_env_steps_trained": 206040, "num_agent_steps_sampled": 206040, "num_agent_steps_trained": 206040}, "sampler_results": {"episode_reward_max": -2191.2499447807522, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2381.8859420919603, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.650373145772317, "mean_inference_ms": 0.36819977338494797, "mean_action_processing_ms": 0.09058571585325614, "mean_env_wait_ms": 0.9302987447722098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037276744842529297, "StateBufferConnector_ms": 0.0027115345001220703, "ViewRequirementAgentConnector_ms": 0.06582784652709961}}, "episode_reward_max": -2191.2499447807522, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2381.8859420919603, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2424.68953018099, -2479.7772252939917, -2411.4967227351444, -2323.5716590642337, -2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.650373145772317, "mean_inference_ms": 0.36819977338494797, "mean_action_processing_ms": 0.09058571585325614, "mean_env_wait_ms": 0.9302987447722098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037276744842529297, "StateBufferConnector_ms": 0.0027115345001220703, "ViewRequirementAgentConnector_ms": 0.06582784652709961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206040, "num_agent_steps_trained": 206040, "num_env_steps_sampled": 206040, "num_env_steps_trained": 206040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.58049259677342, "num_env_steps_trained_throughput_per_sec": 109.58049259677342, "timesteps_total": 206040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 206040, "timers": {"training_iteration_time_ms": 3282.185, "sample_time_ms": 3271.403, "load_time_ms": 0.298, "load_throughput": 1209217.138, "learn_time_ms": 9.732, "learn_throughput": 36989.888, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 206040, "num_env_steps_trained": 206040, "num_agent_steps_sampled": 206040, "num_agent_steps_trained": 206040}, "done": false, "episodes_total": 1053, "training_iteration": 220, "trial_id": "73eff_00000", "date": "2023-08-04_09-01-03", "timestamp": 1691128863, "time_this_iter_s": 13.143716096878052, "time_total_s": 2512.4978790283203, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 782.6671521663666, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.789473684210527, "ram_util_percent": 62.378947368421066}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": -316.4061218261719, "policy_loss": 146260.70234375, "vf_loss": 8144577.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1213.0, "diff_num_grad_updates_vs_sampler_policy": 1212.0}}, "num_env_steps_sampled": 207480, "num_env_steps_trained": 207480, "num_agent_steps_sampled": 207480, "num_agent_steps_trained": 207480}, "sampler_results": {"episode_reward_max": -2191.2499447807522, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2378.761115612145, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651104232108154, "mean_inference_ms": 0.3681914415001728, "mean_action_processing_ms": 0.09058283752707971, "mean_env_wait_ms": 0.9295535224165536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003796100616455078, "StateBufferConnector_ms": 0.0027115345001220703, "ViewRequirementAgentConnector_ms": 0.06586408615112305}}, "episode_reward_max": -2191.2499447807522, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2378.761115612145, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2386.519705819319, -2222.4386571021705, -2296.7606343673906, -2534.4751496347358, -2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651104232108154, "mean_inference_ms": 0.3681914415001728, "mean_action_processing_ms": 0.09058283752707971, "mean_env_wait_ms": 0.9295535224165536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003796100616455078, "StateBufferConnector_ms": 0.0027115345001220703, "ViewRequirementAgentConnector_ms": 0.06586408615112305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207480, "num_agent_steps_trained": 207480, "num_env_steps_sampled": 207480, "num_env_steps_trained": 207480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.75645753024291, "num_env_steps_trained_throughput_per_sec": 109.75645753024291, "timesteps_total": 207480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 207480, "timers": {"training_iteration_time_ms": 3284.342, "sample_time_ms": 3273.522, "load_time_ms": 0.299, "load_throughput": 1204490.619, "learn_time_ms": 9.776, "learn_throughput": 36823.814, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 207480, "num_env_steps_trained": 207480, "num_agent_steps_sampled": 207480, "num_agent_steps_trained": 207480}, "done": false, "episodes_total": 1057, "training_iteration": 221, "trial_id": "73eff_00000", "date": "2023-08-04_09-01-16", "timestamp": 1691128876, "time_this_iter_s": 13.122756958007812, "time_total_s": 2525.620635986328, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 795.7899091243744, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 18.163157894736845, "ram_util_percent": 62.41052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.711111111111111e-09, "entropy_coeff": 0.05, "policy_entropy": -317.3306823730469, "policy_loss": -5288689.7625, "vf_loss": 10509512.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1233.0, "diff_num_grad_updates_vs_sampler_policy": 1232.0}}, "num_env_steps_sampled": 208920, "num_env_steps_trained": 208920, "num_agent_steps_sampled": 208920, "num_agent_steps_trained": 208920}, "sampler_results": {"episode_reward_max": -2191.2499447807522, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2380.4758182295404, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6518670663563215, "mean_inference_ms": 0.36818543035553153, "mean_action_processing_ms": 0.0905801523513593, "mean_env_wait_ms": 0.9288399336584786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037987232208251953, "StateBufferConnector_ms": 0.002705097198486328, "ViewRequirementAgentConnector_ms": 0.06587791442871094}}, "episode_reward_max": -2191.2499447807522, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2380.4758182295404, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2336.538945109372, -2395.1042118133764, -2306.6364511873157, -2444.864089168272, -2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6518670663563215, "mean_inference_ms": 0.36818543035553153, "mean_action_processing_ms": 0.0905801523513593, "mean_env_wait_ms": 0.9288399336584786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037987232208251953, "StateBufferConnector_ms": 0.002705097198486328, "ViewRequirementAgentConnector_ms": 0.06587791442871094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208920, "num_agent_steps_trained": 208920, "num_env_steps_sampled": 208920, "num_env_steps_trained": 208920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.66338747610924, "num_env_steps_trained_throughput_per_sec": 110.66338747610924, "timesteps_total": 208920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 208920, "timers": {"training_iteration_time_ms": 3268.038, "sample_time_ms": 3257.231, "load_time_ms": 0.299, "load_throughput": 1202572.029, "learn_time_ms": 9.756, "learn_throughput": 36901.027, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 208920, "num_env_steps_trained": 208920, "num_agent_steps_sampled": 208920, "num_agent_steps_trained": 208920}, "done": false, "episodes_total": 1061, "training_iteration": 222, "trial_id": "73eff_00000", "date": "2023-08-04_09-01-29", "timestamp": 1691128889, "time_this_iter_s": 13.01514220237732, "time_total_s": 2538.6357781887054, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 808.8050513267517, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 18.9, "ram_util_percent": 62.41666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.111111111111111e-09, "entropy_coeff": 0.05, "policy_entropy": -317.05821533203124, "policy_loss": -2647886.866796875, "vf_loss": 9692497.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1253.0, "diff_num_grad_updates_vs_sampler_policy": 1252.0}}, "num_env_steps_sampled": 210360, "num_env_steps_trained": 210360, "num_agent_steps_sampled": 210360, "num_agent_steps_trained": 210360}, "sampler_results": {"episode_reward_max": -2191.2499447807522, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2379.0293644360904, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652718765787255, "mean_inference_ms": 0.3681808286337812, "mean_action_processing_ms": 0.09057761214444536, "mean_env_wait_ms": 0.9281338810136208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003801584243774414, "StateBufferConnector_ms": 0.0027000904083251953, "ViewRequirementAgentConnector_ms": 0.06581473350524902}}, "episode_reward_max": -2191.2499447807522, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2379.0293644360904, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2294.017086345512, -2268.207764206921, -2426.958574481688, -2222.99981970181, -2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652718765787255, "mean_inference_ms": 0.3681808286337812, "mean_action_processing_ms": 0.09057761214444536, "mean_env_wait_ms": 0.9281338810136208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003801584243774414, "StateBufferConnector_ms": 0.0027000904083251953, "ViewRequirementAgentConnector_ms": 0.06581473350524902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210360, "num_agent_steps_trained": 210360, "num_env_steps_sampled": 210360, "num_env_steps_trained": 210360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.5784488404452, "num_env_steps_trained_throughput_per_sec": 109.5784488404452, "timesteps_total": 210360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 210360, "timers": {"training_iteration_time_ms": 3269.321, "sample_time_ms": 3258.525, "load_time_ms": 0.3, "load_throughput": 1198182.384, "learn_time_ms": 9.734, "learn_throughput": 36984.181, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 210360, "num_env_steps_trained": 210360, "num_agent_steps_sampled": 210360, "num_agent_steps_trained": 210360}, "done": false, "episodes_total": 1065, "training_iteration": 223, "trial_id": "73eff_00000", "date": "2023-08-04_09-01-42", "timestamp": 1691128902, "time_this_iter_s": 13.144051790237427, "time_total_s": 2551.779829978943, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 821.9491031169891, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.563157894736843, "ram_util_percent": 62.43157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -317.2104064941406, "policy_loss": -4111396.446875, "vf_loss": 9931374.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1273.0, "diff_num_grad_updates_vs_sampler_policy": 1272.0}}, "num_env_steps_sampled": 211800, "num_env_steps_trained": 211800, "num_agent_steps_sampled": 211800, "num_agent_steps_trained": 211800}, "sampler_results": {"episode_reward_max": -2191.2499447807522, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2381.822555072816, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653410673420504, "mean_inference_ms": 0.3681690114693096, "mean_action_processing_ms": 0.09057350826913052, "mean_env_wait_ms": 0.9274773997414766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037872791290283203, "StateBufferConnector_ms": 0.0026934146881103516, "ViewRequirementAgentConnector_ms": 0.0655367374420166}}, "episode_reward_max": -2191.2499447807522, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2381.822555072816, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2226.7976044897046, -2339.4368029541274, -2191.2499447807522, -2302.91044231454, -2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653410673420504, "mean_inference_ms": 0.3681690114693096, "mean_action_processing_ms": 0.09057350826913052, "mean_env_wait_ms": 0.9274773997414766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037872791290283203, "StateBufferConnector_ms": 0.0026934146881103516, "ViewRequirementAgentConnector_ms": 0.0655367374420166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211800, "num_agent_steps_trained": 211800, "num_env_steps_sampled": 211800, "num_env_steps_trained": 211800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.44433866952174, "num_env_steps_trained_throughput_per_sec": 110.44433866952174, "timesteps_total": 211800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 211800, "timers": {"training_iteration_time_ms": 3267.833, "sample_time_ms": 3257.133, "load_time_ms": 0.299, "load_throughput": 1205355.983, "learn_time_ms": 9.638, "learn_throughput": 37351.688, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 211800, "num_env_steps_trained": 211800, "num_agent_steps_sampled": 211800, "num_agent_steps_trained": 211800}, "done": false, "episodes_total": 1069, "training_iteration": 224, "trial_id": "73eff_00000", "date": "2023-08-04_09-01-55", "timestamp": 1691128915, "time_this_iter_s": 13.040956974029541, "time_total_s": 2564.8207869529724, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 834.9900600910187, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 20.705555555555556, "ram_util_percent": 62.59444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -317.91197509765624, "policy_loss": -6128279.00625, "vf_loss": 10131624.65}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1293.0, "diff_num_grad_updates_vs_sampler_policy": 1292.0}}, "num_env_steps_sampled": 213240, "num_env_steps_trained": 213240, "num_agent_steps_sampled": 213240, "num_agent_steps_trained": 213240}, "sampler_results": {"episode_reward_max": -2194.0649010324832, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2386.257619853058, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653997458985036, "mean_inference_ms": 0.36814915484115107, "mean_action_processing_ms": 0.0905675153938192, "mean_env_wait_ms": 0.926860894257139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037887096405029297, "StateBufferConnector_ms": 0.002695322036743164, "ViewRequirementAgentConnector_ms": 0.06549501419067383}}, "episode_reward_max": -2194.0649010324832, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2386.257619853058, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2317.915187981128, -2427.697201049842, -2354.1323225243073, -2283.61939702327, -2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653997458985036, "mean_inference_ms": 0.36814915484115107, "mean_action_processing_ms": 0.0905675153938192, "mean_env_wait_ms": 0.926860894257139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037887096405029297, "StateBufferConnector_ms": 0.002695322036743164, "ViewRequirementAgentConnector_ms": 0.06549501419067383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 213240, "num_agent_steps_trained": 213240, "num_env_steps_sampled": 213240, "num_env_steps_trained": 213240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.01672094628675, "num_env_steps_trained_throughput_per_sec": 111.01672094628675, "timesteps_total": 213240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 213240, "timers": {"training_iteration_time_ms": 3261.809, "sample_time_ms": 3251.032, "load_time_ms": 0.306, "load_throughput": 1176889.665, "learn_time_ms": 9.717, "learn_throughput": 37046.701, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 213240, "num_env_steps_trained": 213240, "num_agent_steps_sampled": 213240, "num_agent_steps_trained": 213240}, "done": false, "episodes_total": 1073, "training_iteration": 225, "trial_id": "73eff_00000", "date": "2023-08-04_09-02-08", "timestamp": 1691128928, "time_this_iter_s": 12.973687171936035, "time_total_s": 2577.7944741249084, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 847.9637472629547, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 20.07894736842105, "ram_util_percent": 62.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -318.059228515625, "policy_loss": -5844824.58125, "vf_loss": 10598929.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1313.0, "diff_num_grad_updates_vs_sampler_policy": 1312.0}}, "num_env_steps_sampled": 214680, "num_env_steps_trained": 214680, "num_agent_steps_sampled": 214680, "num_agent_steps_trained": 214680}, "sampler_results": {"episode_reward_max": -2194.0649010324832, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2387.2742931879357, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654545018544666, "mean_inference_ms": 0.3681308769787446, "mean_action_processing_ms": 0.09056178337049497, "mean_env_wait_ms": 0.926300130592708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003805398941040039, "StateBufferConnector_ms": 0.0026950836181640625, "ViewRequirementAgentConnector_ms": 0.06551241874694824}}, "episode_reward_max": -2194.0649010324832, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2387.2742931879357, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2224.9609889630283, -2226.0945960111353, -2511.404480313409, -2504.363239458284, -2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654545018544666, "mean_inference_ms": 0.3681308769787446, "mean_action_processing_ms": 0.09056178337049497, "mean_env_wait_ms": 0.926300130592708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003805398941040039, "StateBufferConnector_ms": 0.0026950836181640625, "ViewRequirementAgentConnector_ms": 0.06551241874694824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214680, "num_agent_steps_trained": 214680, "num_env_steps_sampled": 214680, "num_env_steps_trained": 214680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.29089601866173, "num_env_steps_trained_throughput_per_sec": 109.29089601866173, "timesteps_total": 214680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 214680, "timers": {"training_iteration_time_ms": 3259.943, "sample_time_ms": 3249.062, "load_time_ms": 0.305, "load_throughput": 1178727.119, "learn_time_ms": 9.82, "learn_throughput": 36658.957, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 214680, "num_env_steps_trained": 214680, "num_agent_steps_sampled": 214680, "num_agent_steps_trained": 214680}, "done": false, "episodes_total": 1077, "training_iteration": 226, "trial_id": "73eff_00000", "date": "2023-08-04_09-02-21", "timestamp": 1691128941, "time_this_iter_s": 13.17923903465271, "time_total_s": 2590.973713159561, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 861.1429862976074, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 18.12777777777778, "ram_util_percent": 62.727777777777774}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.7921081542969, "policy_loss": -121362.2296875, "vf_loss": 8511627.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1333.0, "diff_num_grad_updates_vs_sampler_policy": 1332.0}}, "num_env_steps_sampled": 216120, "num_env_steps_trained": 216120, "num_agent_steps_sampled": 216120, "num_agent_steps_trained": 216120}, "sampler_results": {"episode_reward_max": -2194.0649010324832, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2385.469779315342, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655234867860877, "mean_inference_ms": 0.368112739033887, "mean_action_processing_ms": 0.090555716142104, "mean_env_wait_ms": 0.9257628820205379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003798246383666992, "StateBufferConnector_ms": 0.002685070037841797, "ViewRequirementAgentConnector_ms": 0.06541919708251953}}, "episode_reward_max": -2194.0649010324832, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2385.469779315342, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2366.465908286173, -2494.5475132601646, -2568.398939947285, -2471.4067041198914, -2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655234867860877, "mean_inference_ms": 0.368112739033887, "mean_action_processing_ms": 0.090555716142104, "mean_env_wait_ms": 0.9257628820205379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003798246383666992, "StateBufferConnector_ms": 0.002685070037841797, "ViewRequirementAgentConnector_ms": 0.06541919708251953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216120, "num_agent_steps_trained": 216120, "num_env_steps_sampled": 216120, "num_env_steps_trained": 216120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.98189517205377, "num_env_steps_trained_throughput_per_sec": 109.98189517205377, "timesteps_total": 216120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 216120, "timers": {"training_iteration_time_ms": 3282.545, "sample_time_ms": 3271.691, "load_time_ms": 0.306, "load_throughput": 1174966.493, "learn_time_ms": 9.798, "learn_throughput": 36742.005, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 216120, "num_env_steps_trained": 216120, "num_agent_steps_sampled": 216120, "num_agent_steps_trained": 216120}, "done": false, "episodes_total": 1081, "training_iteration": 227, "trial_id": "73eff_00000", "date": "2023-08-04_09-02-34", "timestamp": 1691128954, "time_this_iter_s": 13.095860958099365, "time_total_s": 2604.0695741176605, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 874.2388472557068, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 18.515789473684208, "ram_util_percent": 62.678947368421056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.42816772460935, "policy_loss": -93069.69375, "vf_loss": 8158804.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1353.0, "diff_num_grad_updates_vs_sampler_policy": 1352.0}}, "num_env_steps_sampled": 217560, "num_env_steps_trained": 217560, "num_agent_steps_sampled": 217560, "num_agent_steps_trained": 217560}, "sampler_results": {"episode_reward_max": -2194.0649010324832, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2388.038226559013, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655876349357132, "mean_inference_ms": 0.3680946334764254, "mean_action_processing_ms": 0.09054987960644797, "mean_env_wait_ms": 0.9252069957465394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038022994995117188, "StateBufferConnector_ms": 0.002686023712158203, "ViewRequirementAgentConnector_ms": 0.0654764175415039}}, "episode_reward_max": -2194.0649010324832, "episode_reward_min": -2728.9664835297244, "episode_reward_mean": -2388.038226559013, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2223.5374564778685, -2562.3679951806216, -2557.05774246906, -2274.6098254096764, -2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655876349357132, "mean_inference_ms": 0.3680946334764254, "mean_action_processing_ms": 0.09054987960644797, "mean_env_wait_ms": 0.9252069957465394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038022994995117188, "StateBufferConnector_ms": 0.002686023712158203, "ViewRequirementAgentConnector_ms": 0.0654764175415039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217560, "num_agent_steps_trained": 217560, "num_env_steps_sampled": 217560, "num_env_steps_trained": 217560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.9985703349492, "num_env_steps_trained_throughput_per_sec": 109.9985703349492, "timesteps_total": 217560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 217560, "timers": {"training_iteration_time_ms": 3281.099, "sample_time_ms": 3270.301, "load_time_ms": 0.299, "load_throughput": 1203338.731, "learn_time_ms": 9.758, "learn_throughput": 36891.29, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 217560, "num_env_steps_trained": 217560, "num_agent_steps_sampled": 217560, "num_agent_steps_trained": 217560}, "done": false, "episodes_total": 1085, "training_iteration": 228, "trial_id": "73eff_00000", "date": "2023-08-04_09-02-47", "timestamp": 1691128967, "time_this_iter_s": 13.093930006027222, "time_total_s": 2617.1635041236877, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 887.332777261734, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 16.733333333333334, "ram_util_percent": 62.416666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.62132568359374, "policy_loss": -2964386.625, "vf_loss": 8977623.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 1372.0}}, "num_env_steps_sampled": 219000, "num_env_steps_trained": 219000, "num_agent_steps_sampled": 219000, "num_agent_steps_trained": 219000}, "sampler_results": {"episode_reward_max": -2194.0649010324832, "episode_reward_min": -2739.1272319308114, "episode_reward_mean": -2390.0998103864536, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65646298265451, "mean_inference_ms": 0.3680777128918308, "mean_action_processing_ms": 0.09054435278647155, "mean_env_wait_ms": 0.9246631300620115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038056373596191406, "StateBufferConnector_ms": 0.0026922225952148438, "ViewRequirementAgentConnector_ms": 0.06547212600708008}}, "episode_reward_max": -2194.0649010324832, "episode_reward_min": -2739.1272319308114, "episode_reward_mean": -2390.0998103864536, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2488.6075867088584, -2572.9517344659293, -2327.5394094715452, -2335.4024804801224, -2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65646298265451, "mean_inference_ms": 0.3680777128918308, "mean_action_processing_ms": 0.09054435278647155, "mean_env_wait_ms": 0.9246631300620115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038056373596191406, "StateBufferConnector_ms": 0.0026922225952148438, "ViewRequirementAgentConnector_ms": 0.06547212600708008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219000, "num_agent_steps_trained": 219000, "num_env_steps_sampled": 219000, "num_env_steps_trained": 219000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.48815502621868, "num_env_steps_trained_throughput_per_sec": 110.48815502621868, "timesteps_total": 219000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 219000, "timers": {"training_iteration_time_ms": 3262.085, "sample_time_ms": 3251.291, "load_time_ms": 0.3, "load_throughput": 1200850.517, "learn_time_ms": 9.745, "learn_throughput": 36941.924, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 219000, "num_env_steps_trained": 219000, "num_agent_steps_sampled": 219000, "num_agent_steps_trained": 219000}, "done": false, "episodes_total": 1089, "training_iteration": 229, "trial_id": "73eff_00000", "date": "2023-08-04_09-03-00", "timestamp": 1691128980, "time_this_iter_s": 13.03590703010559, "time_total_s": 2630.1994111537933, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 900.3686842918396, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 19.378947368421056, "ram_util_percent": 62.373684210526314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.73450927734376, "policy_loss": -3404008.028125, "vf_loss": 9284883.15}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1393.0, "diff_num_grad_updates_vs_sampler_policy": 1392.0}}, "num_env_steps_sampled": 220440, "num_env_steps_trained": 220440, "num_agent_steps_sampled": 220440, "num_agent_steps_trained": 220440}, "sampler_results": {"episode_reward_max": -2194.0649010324832, "episode_reward_min": -2739.1272319308114, "episode_reward_mean": -2387.1976748616075, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.657014165188409, "mean_inference_ms": 0.3680597933427687, "mean_action_processing_ms": 0.09053901734954621, "mean_env_wait_ms": 0.9241569213775438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038025379180908203, "StateBufferConnector_ms": 0.0026879310607910156, "ViewRequirementAgentConnector_ms": 0.0654900074005127}}, "episode_reward_max": -2194.0649010324832, "episode_reward_min": -2739.1272319308114, "episode_reward_mean": -2387.1976748616075, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2399.8446090368807, -2369.6415539869395, -2375.045752838956, -2459.8545949475197, -2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.657014165188409, "mean_inference_ms": 0.3680597933427687, "mean_action_processing_ms": 0.09053901734954621, "mean_env_wait_ms": 0.9241569213775438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038025379180908203, "StateBufferConnector_ms": 0.0026879310607910156, "ViewRequirementAgentConnector_ms": 0.0654900074005127}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220440, "num_agent_steps_trained": 220440, "num_env_steps_sampled": 220440, "num_env_steps_trained": 220440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.14869964396634, "num_env_steps_trained_throughput_per_sec": 109.14869964396634, "timesteps_total": 220440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 220440, "timers": {"training_iteration_time_ms": 3279.365, "sample_time_ms": 3268.584, "load_time_ms": 0.3, "load_throughput": 1199133.926, "learn_time_ms": 9.738, "learn_throughput": 36967.158, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 220440, "num_env_steps_trained": 220440, "num_agent_steps_sampled": 220440, "num_agent_steps_trained": 220440}, "done": false, "episodes_total": 1093, "training_iteration": 230, "trial_id": "73eff_00000", "date": "2023-08-04_09-03-14", "timestamp": 1691128994, "time_this_iter_s": 13.19569206237793, "time_total_s": 2643.3951032161713, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 913.5643763542175, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 18.322222222222223, "ram_util_percent": 62.44444444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -320.6675720214844, "policy_loss": -12868853.35625, "vf_loss": 13482767.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1413.0, "diff_num_grad_updates_vs_sampler_policy": 1412.0}}, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "sampler_results": {"episode_reward_max": -2194.0649010324832, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2394.2875791648303, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.657558185776834, "mean_inference_ms": 0.36804362488517567, "mean_action_processing_ms": 0.09053416269770889, "mean_env_wait_ms": 0.9237078417860155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038042068481445312, "StateBufferConnector_ms": 0.002688884735107422, "ViewRequirementAgentConnector_ms": 0.06548905372619629}}, "episode_reward_max": -2194.0649010324832, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2394.2875791648303, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2263.980521683714, -2304.7800051246572, -2383.945220098542, -2194.0649010324832, -2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.657558185776834, "mean_inference_ms": 0.36804362488517567, "mean_action_processing_ms": 0.09053416269770889, "mean_env_wait_ms": 0.9237078417860155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038042068481445312, "StateBufferConnector_ms": 0.002688884735107422, "ViewRequirementAgentConnector_ms": 0.06548905372619629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.69167996162842, "num_env_steps_trained_throughput_per_sec": 109.69167996162842, "timesteps_total": 221880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 221880, "timers": {"training_iteration_time_ms": 3281.262, "sample_time_ms": 3270.482, "load_time_ms": 0.301, "load_throughput": 1197517.202, "learn_time_ms": 9.733, "learn_throughput": 36988.439, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "done": false, "episodes_total": 1097, "training_iteration": 231, "trial_id": "73eff_00000", "date": "2023-08-04_09-03-27", "timestamp": 1691129007, "time_this_iter_s": 13.130566835403442, "time_total_s": 2656.5256700515747, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 926.694943189621, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.92105263157895, "ram_util_percent": 62.37368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -318.5456176757813, "policy_loss": -2727291.6328125, "vf_loss": 10779532.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1433.0, "diff_num_grad_updates_vs_sampler_policy": 1432.0}}, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "sampler_results": {"episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2399.875703441542, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658064508769111, "mean_inference_ms": 0.36802491680231314, "mean_action_processing_ms": 0.09052882694242409, "mean_env_wait_ms": 0.9232774149334938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037992000579833984, "StateBufferConnector_ms": 0.002687215805053711, "ViewRequirementAgentConnector_ms": 0.06543707847595215}}, "episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2399.875703441542, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2457.2967838767795, -2467.5476262966135, -2383.7210386348174, -2615.966847459326, -2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658064508769111, "mean_inference_ms": 0.36802491680231314, "mean_action_processing_ms": 0.09052882694242409, "mean_env_wait_ms": 0.9232774149334938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037992000579833984, "StateBufferConnector_ms": 0.002687215805053711, "ViewRequirementAgentConnector_ms": 0.06543707847595215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.7927950353627, "num_env_steps_trained_throughput_per_sec": 110.7927950353627, "timesteps_total": 223320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 223320, "timers": {"training_iteration_time_ms": 3272.078, "sample_time_ms": 3261.249, "load_time_ms": 0.301, "load_throughput": 1197517.202, "learn_time_ms": 9.771, "learn_throughput": 36844.48, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "done": false, "episodes_total": 1101, "training_iteration": 232, "trial_id": "73eff_00000", "date": "2023-08-04_09-03-40", "timestamp": 1691129020, "time_this_iter_s": 12.999997854232788, "time_total_s": 2669.5256679058075, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 939.6949410438538, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 19.742105263157896, "ram_util_percent": 62.49473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.90087890625, "policy_loss": -8122115.446875, "vf_loss": 9311647.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1453.0, "diff_num_grad_updates_vs_sampler_policy": 1452.0}}, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "sampler_results": {"episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2397.1535857346425, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658470700218929, "mean_inference_ms": 0.3680062993488087, "mean_action_processing_ms": 0.0905237641050449, "mean_env_wait_ms": 0.922854149648729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038156509399414062, "StateBufferConnector_ms": 0.002688884735107422, "ViewRequirementAgentConnector_ms": 0.06547379493713379}}, "episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2397.1535857346425, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2307.5751531960304, -2728.9664835297244, -2538.636955142861, -2322.622606543396, -2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658470700218929, "mean_inference_ms": 0.3680062993488087, "mean_action_processing_ms": 0.0905237641050449, "mean_env_wait_ms": 0.922854149648729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038156509399414062, "StateBufferConnector_ms": 0.002688884735107422, "ViewRequirementAgentConnector_ms": 0.06547379493713379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.96941364166003, "num_env_steps_trained_throughput_per_sec": 109.96941364166003, "timesteps_total": 224760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 224760, "timers": {"training_iteration_time_ms": 3263.924, "sample_time_ms": 3252.975, "load_time_ms": 0.302, "load_throughput": 1192410.519, "learn_time_ms": 9.871, "learn_throughput": 36471.68, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "done": false, "episodes_total": 1105, "training_iteration": 233, "trial_id": "73eff_00000", "date": "2023-08-04_09-03-53", "timestamp": 1691129033, "time_this_iter_s": 13.097346067428589, "time_total_s": 2682.623013973236, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 952.7922871112823, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 20.049999999999997, "ram_util_percent": 62.56666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -318.1867614746094, "policy_loss": -16775944.3, "vf_loss": 11725106.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1473.0, "diff_num_grad_updates_vs_sampler_policy": 1472.0}}, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "sampler_results": {"episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2395.3091561484516, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658818694447268, "mean_inference_ms": 0.3679929321802672, "mean_action_processing_ms": 0.0905194300647662, "mean_env_wait_ms": 0.9224289606452706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003821134567260742, "StateBufferConnector_ms": 0.0026934146881103516, "ViewRequirementAgentConnector_ms": 0.0656425952911377}}, "episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2395.3091561484516, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2412.612622261557, -2227.2972582590537, -2435.092123372443, -2273.209312737243, -2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658818694447268, "mean_inference_ms": 0.3679929321802672, "mean_action_processing_ms": 0.0905194300647662, "mean_env_wait_ms": 0.9224289606452706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003821134567260742, "StateBufferConnector_ms": 0.0026934146881103516, "ViewRequirementAgentConnector_ms": 0.0656425952911377}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.63016530670758, "num_env_steps_trained_throughput_per_sec": 111.63016530670758, "timesteps_total": 226200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 226200, "timers": {"training_iteration_time_ms": 3253.271, "sample_time_ms": 3242.303, "load_time_ms": 0.302, "load_throughput": 1192787.298, "learn_time_ms": 9.858, "learn_throughput": 36517.988, "synch_weights_time_ms": 0.761}, "counters": {"num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "done": false, "episodes_total": 1109, "training_iteration": 234, "trial_id": "73eff_00000", "date": "2023-08-04_09-04-06", "timestamp": 1691129046, "time_this_iter_s": 12.902605056762695, "time_total_s": 2695.525619029999, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 965.694892168045, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 21.511111111111113, "ram_util_percent": 62.833333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.49144287109374, "policy_loss": 38103.728125, "vf_loss": 8997118.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1493.0, "diff_num_grad_updates_vs_sampler_policy": 1492.0}}, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "sampler_results": {"episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2396.845197058989, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659031649180945, "mean_inference_ms": 0.3679864689637796, "mean_action_processing_ms": 0.09051635213930449, "mean_env_wait_ms": 0.9220102522460562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038213729858398438, "StateBufferConnector_ms": 0.0026924610137939453, "ViewRequirementAgentConnector_ms": 0.06561684608459473}}, "episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2396.845197058989, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2494.6731393097834, -2256.6697836663434, -2333.139415468694, -2564.022428868131, -2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659031649180945, "mean_inference_ms": 0.3679864689637796, "mean_action_processing_ms": 0.09051635213930449, "mean_env_wait_ms": 0.9220102522460562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038213729858398438, "StateBufferConnector_ms": 0.0026924610137939453, "ViewRequirementAgentConnector_ms": 0.06561684608459473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.37784333371476, "num_env_steps_trained_throughput_per_sec": 112.37784333371476, "timesteps_total": 227640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 227640, "timers": {"training_iteration_time_ms": 3219.74, "sample_time_ms": 3208.818, "load_time_ms": 0.301, "load_throughput": 1197897.215, "learn_time_ms": 9.832, "learn_throughput": 36616.819, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "done": false, "episodes_total": 1113, "training_iteration": 235, "trial_id": "73eff_00000", "date": "2023-08-04_09-04-19", "timestamp": 1691129059, "time_this_iter_s": 12.816715002059937, "time_total_s": 2708.3423340320587, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 978.511607170105, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 20.22105263157895, "ram_util_percent": 62.81052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -319.06593627929686, "policy_loss": -7917456.115625, "vf_loss": 10890577.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1513.0, "diff_num_grad_updates_vs_sampler_policy": 1512.0}}, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "sampler_results": {"episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2397.5151657143074, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65916286345328, "mean_inference_ms": 0.3679835585598225, "mean_action_processing_ms": 0.09051382769550757, "mean_env_wait_ms": 0.9216088180935721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038204193115234375, "StateBufferConnector_ms": 0.0026895999908447266, "ViewRequirementAgentConnector_ms": 0.06564712524414062}}, "episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2397.5151657143074, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2394.155665509656, -2291.9343944985126, -2302.8055306929828, -2426.4053817353097, -2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65916286345328, "mean_inference_ms": 0.3679835585598225, "mean_action_processing_ms": 0.09051382769550757, "mean_env_wait_ms": 0.9216088180935721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038204193115234375, "StateBufferConnector_ms": 0.0026895999908447266, "ViewRequirementAgentConnector_ms": 0.06564712524414062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.82978107902281, "num_env_steps_trained_throughput_per_sec": 111.82978107902281, "timesteps_total": 229080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 229080, "timers": {"training_iteration_time_ms": 3217.201, "sample_time_ms": 3206.239, "load_time_ms": 0.301, "load_throughput": 1195336.795, "learn_time_ms": 9.861, "learn_throughput": 36505.893, "synch_weights_time_ms": 0.755}, "counters": {"num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "done": false, "episodes_total": 1117, "training_iteration": 236, "trial_id": "73eff_00000", "date": "2023-08-04_09-04-32", "timestamp": 1691129072, "time_this_iter_s": 12.87951397895813, "time_total_s": 2721.221848011017, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 991.3911211490631, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 21.05, "ram_util_percent": 62.794444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.5358581542969, "policy_loss": -1973467.6109375, "vf_loss": 8207409.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1533.0, "diff_num_grad_updates_vs_sampler_policy": 1532.0}}, "num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520}, "sampler_results": {"episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2397.150043742357, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659228811503258, "mean_inference_ms": 0.3679810607829181, "mean_action_processing_ms": 0.09051123083612989, "mean_env_wait_ms": 0.9212226082414133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003821134567260742, "StateBufferConnector_ms": 0.002696990966796875, "ViewRequirementAgentConnector_ms": 0.06573057174682617}}, "episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2397.150043742357, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2472.9140500439016, -2414.8455273836294, -2278.6086175056193, -2263.878373886552, -2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659228811503258, "mean_inference_ms": 0.3679810607829181, "mean_action_processing_ms": 0.09051123083612989, "mean_env_wait_ms": 0.9212226082414133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003821134567260742, "StateBufferConnector_ms": 0.002696990966796875, "ViewRequirementAgentConnector_ms": 0.06573057174682617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520, "num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.06930515364121, "num_env_steps_trained_throughput_per_sec": 111.06930515364121, "timesteps_total": 230520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 230520, "timers": {"training_iteration_time_ms": 3225.737, "sample_time_ms": 3214.799, "load_time_ms": 0.302, "load_throughput": 1193258.606, "learn_time_ms": 9.855, "learn_throughput": 36529.65, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520}, "done": false, "episodes_total": 1121, "training_iteration": 237, "trial_id": "73eff_00000", "date": "2023-08-04_09-04-45", "timestamp": 1691129085, "time_this_iter_s": 12.96771788597107, "time_total_s": 2734.189565896988, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1004.3588390350342, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 20.53333333333333, "ram_util_percent": 62.400000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.75910034179685, "policy_loss": -2357911.6625, "vf_loss": 8859304.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 1552.0}}, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "sampler_results": {"episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2399.219670110577, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659375256716726, "mean_inference_ms": 0.36797839365999674, "mean_action_processing_ms": 0.09050895395566347, "mean_env_wait_ms": 0.9208336992318865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038213729858398438, "StateBufferConnector_ms": 0.002695322036743164, "ViewRequirementAgentConnector_ms": 0.06564807891845703}}, "episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2399.219670110577, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2482.784273618353, -2416.2506207817055, -2400.7884999042158, -2561.1650717065104, -2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659375256716726, "mean_inference_ms": 0.36797839365999674, "mean_action_processing_ms": 0.09050895395566347, "mean_env_wait_ms": 0.9208336992318865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038213729858398438, "StateBufferConnector_ms": 0.002695322036743164, "ViewRequirementAgentConnector_ms": 0.06564807891845703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.63027205172864, "num_env_steps_trained_throughput_per_sec": 109.63027205172864, "timesteps_total": 231960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 231960, "timers": {"training_iteration_time_ms": 3241.949, "sample_time_ms": 3231.034, "load_time_ms": 0.301, "load_throughput": 1195904.831, "learn_time_ms": 9.829, "learn_throughput": 36625.967, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "done": false, "episodes_total": 1125, "training_iteration": 238, "trial_id": "73eff_00000", "date": "2023-08-04_09-04-58", "timestamp": 1691129098, "time_this_iter_s": 13.137783765792847, "time_total_s": 2747.3273496627808, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1017.496622800827, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 17.278947368421054, "ram_util_percent": 62.48421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.76947631835935, "policy_loss": -3563223.91875, "vf_loss": 9520797.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1573.0, "diff_num_grad_updates_vs_sampler_policy": 1572.0}}, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "sampler_results": {"episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2393.6872772394345, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6593737695080675, "mean_inference_ms": 0.36797942349907425, "mean_action_processing_ms": 0.09050750667517601, "mean_env_wait_ms": 0.9204303631173621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003823995590209961, "StateBufferConnector_ms": 0.0026962757110595703, "ViewRequirementAgentConnector_ms": 0.06567978858947754}}, "episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2393.6872772394345, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2411.613474311574, -2435.856170293569, -2478.428753613164, -2226.7655387365844, -2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6593737695080675, "mean_inference_ms": 0.36797942349907425, "mean_action_processing_ms": 0.09050750667517601, "mean_env_wait_ms": 0.9204303631173621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003823995590209961, "StateBufferConnector_ms": 0.0026962757110595703, "ViewRequirementAgentConnector_ms": 0.06567978858947754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.6070741759804, "num_env_steps_trained_throughput_per_sec": 112.6070741759804, "timesteps_total": 233400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 233400, "timers": {"training_iteration_time_ms": 3247.436, "sample_time_ms": 3236.543, "load_time_ms": 0.3, "load_throughput": 1198372.571, "learn_time_ms": 9.8, "learn_throughput": 36735.033, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "done": false, "episodes_total": 1129, "training_iteration": 239, "trial_id": "73eff_00000", "date": "2023-08-04_09-05-11", "timestamp": 1691129111, "time_this_iter_s": 12.79068899154663, "time_total_s": 2760.1180386543274, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1030.2873117923737, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 23.266666666666666, "ram_util_percent": 62.54999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.87989501953126, "policy_loss": -8093983.5015625, "vf_loss": 9972217.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1593.0, "diff_num_grad_updates_vs_sampler_policy": 1592.0}}, "num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840}, "sampler_results": {"episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2394.9439598740655, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659423854943413, "mean_inference_ms": 0.3679785477061863, "mean_action_processing_ms": 0.09050606257388732, "mean_env_wait_ms": 0.9200675620909078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038313865661621094, "StateBufferConnector_ms": 0.002699136734008789, "ViewRequirementAgentConnector_ms": 0.0657353401184082}}, "episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2394.9439598740655, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2247.355029216808, -2346.3098429523134, -2408.737330770483, -2310.202317842197, -2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659423854943413, "mean_inference_ms": 0.3679785477061863, "mean_action_processing_ms": 0.09050606257388732, "mean_env_wait_ms": 0.9200675620909078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038313865661621094, "StateBufferConnector_ms": 0.002699136734008789, "ViewRequirementAgentConnector_ms": 0.0657353401184082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840, "num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.65710504896101, "num_env_steps_trained_throughput_per_sec": 108.65710504896101, "timesteps_total": 234840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 234840, "timers": {"training_iteration_time_ms": 3259.589, "sample_time_ms": 3248.76, "load_time_ms": 0.3, "load_throughput": 1199514.967, "learn_time_ms": 9.743, "learn_throughput": 36948.071, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840}, "done": false, "episodes_total": 1133, "training_iteration": 240, "trial_id": "73eff_00000", "date": "2023-08-04_09-05-24", "timestamp": 1691129124, "time_this_iter_s": 13.255542039871216, "time_total_s": 2773.3735806941986, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1043.5428538322449, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 17.857894736842105, "ram_util_percent": 62.452631578947376}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.6446533203125, "policy_loss": -2415670.925, "vf_loss": 9375403.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1613.0, "diff_num_grad_updates_vs_sampler_policy": 1612.0}}, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "sampler_results": {"episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2399.676985682346, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659474929371201, "mean_inference_ms": 0.3679768696448748, "mean_action_processing_ms": 0.09050442041069622, "mean_env_wait_ms": 0.9197168497572921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038318634033203125, "StateBufferConnector_ms": 0.002707242965698242, "ViewRequirementAgentConnector_ms": 0.06571555137634277}}, "episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2399.676985682346, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2282.465293335383, -2459.0062436886747, -2445.6660547071806, -2503.8646729681523, -2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659474929371201, "mean_inference_ms": 0.3679768696448748, "mean_action_processing_ms": 0.09050442041069622, "mean_env_wait_ms": 0.9197168497572921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038318634033203125, "StateBufferConnector_ms": 0.002707242965698242, "ViewRequirementAgentConnector_ms": 0.06571555137634277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.98495340888654, "num_env_steps_trained_throughput_per_sec": 109.98495340888654, "timesteps_total": 236280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 236280, "timers": {"training_iteration_time_ms": 3286.107, "sample_time_ms": 3275.323, "load_time_ms": 0.3, "load_throughput": 1201806.304, "learn_time_ms": 9.729, "learn_throughput": 37002.942, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "done": false, "episodes_total": 1137, "training_iteration": 241, "trial_id": "73eff_00000", "date": "2023-08-04_09-05-37", "timestamp": 1691129137, "time_this_iter_s": 13.095540046691895, "time_total_s": 2786.4691207408905, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1056.6383938789368, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 18.889473684210532, "ram_util_percent": 62.5263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.47540893554685, "policy_loss": -815238.384375, "vf_loss": 8449528.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1633.0, "diff_num_grad_updates_vs_sampler_policy": 1632.0}}, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "sampler_results": {"episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2397.9290155186513, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659414096413079, "mean_inference_ms": 0.36797677156117703, "mean_action_processing_ms": 0.09050289502617705, "mean_env_wait_ms": 0.9193699084290384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003837108612060547, "StateBufferConnector_ms": 0.002711772918701172, "ViewRequirementAgentConnector_ms": 0.06573033332824707}}, "episode_reward_max": -2194.8469083592227, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2397.9290155186513, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2194.8469083592227, -2231.2523226069884, -2585.6112912669946, -2296.003200184812, -2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659414096413079, "mean_inference_ms": 0.36797677156117703, "mean_action_processing_ms": 0.09050289502617705, "mean_env_wait_ms": 0.9193699084290384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003837108612060547, "StateBufferConnector_ms": 0.002711772918701172, "ViewRequirementAgentConnector_ms": 0.06573033332824707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.02094103360906, "num_env_steps_trained_throughput_per_sec": 111.02094103360906, "timesteps_total": 237720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 237720, "timers": {"training_iteration_time_ms": 3265.558, "sample_time_ms": 3254.75, "load_time_ms": 0.299, "load_throughput": 1203051.103, "learn_time_ms": 9.755, "learn_throughput": 36904.274, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "done": false, "episodes_total": 1141, "training_iteration": 242, "trial_id": "73eff_00000", "date": "2023-08-04_09-05-50", "timestamp": 1691129150, "time_this_iter_s": 12.973363876342773, "time_total_s": 2799.4424846172333, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1069.6117577552795, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 18.988888888888887, "ram_util_percent": 62.57222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -318.21124877929685, "policy_loss": -4457494.7578125, "vf_loss": 10412202.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1653.0, "diff_num_grad_updates_vs_sampler_policy": 1652.0}}, "num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160}, "sampler_results": {"episode_reward_max": -2194.950995965839, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2398.893876863766, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659352954545033, "mean_inference_ms": 0.3679777371418973, "mean_action_processing_ms": 0.09050150813903288, "mean_env_wait_ms": 0.9190542349942915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038309097290039062, "StateBufferConnector_ms": 0.002711772918701172, "ViewRequirementAgentConnector_ms": 0.06571722030639648}}, "episode_reward_max": -2194.950995965839, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2398.893876863766, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2338.954226699778, -2284.5379124266237, -2455.6525984778928, -2373.1556620787437, -2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659352954545033, "mean_inference_ms": 0.3679777371418973, "mean_action_processing_ms": 0.09050150813903288, "mean_env_wait_ms": 0.9190542349942915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038309097290039062, "StateBufferConnector_ms": 0.002711772918701172, "ViewRequirementAgentConnector_ms": 0.06571722030639648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160, "num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.12227044426416, "num_env_steps_trained_throughput_per_sec": 110.12227044426416, "timesteps_total": 239160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 239160, "timers": {"training_iteration_time_ms": 3264.171, "sample_time_ms": 3253.382, "load_time_ms": 0.3, "load_throughput": 1199705.578, "learn_time_ms": 9.741, "learn_throughput": 36958.471, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160}, "done": false, "episodes_total": 1145, "training_iteration": 243, "trial_id": "73eff_00000", "date": "2023-08-04_09-06-03", "timestamp": 1691129163, "time_this_iter_s": 13.079162120819092, "time_total_s": 2812.5216467380524, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1082.6909198760986, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 18.568421052631578, "ram_util_percent": 62.805263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -317.20612182617185, "policy_loss": -561102.31015625, "vf_loss": 10519263.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1673.0, "diff_num_grad_updates_vs_sampler_policy": 1672.0}}, "num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600}, "sampler_results": {"episode_reward_max": -2194.950995965839, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2401.2883204667114, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659303265667643, "mean_inference_ms": 0.36797972808123625, "mean_action_processing_ms": 0.0905003081246297, "mean_env_wait_ms": 0.9187273709592231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00383758544921875, "StateBufferConnector_ms": 0.002710103988647461, "ViewRequirementAgentConnector_ms": 0.06572484970092773}}, "episode_reward_max": -2194.950995965839, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2401.2883204667114, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2258.1797113270154, -2622.287972412023, -2384.200288219086, -2402.366917708359, -2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659303265667643, "mean_inference_ms": 0.36797972808123625, "mean_action_processing_ms": 0.0905003081246297, "mean_env_wait_ms": 0.9187273709592231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00383758544921875, "StateBufferConnector_ms": 0.002710103988647461, "ViewRequirementAgentConnector_ms": 0.06572484970092773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600, "num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.57711487330003, "num_env_steps_trained_throughput_per_sec": 109.57711487330003, "timesteps_total": 240600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 240600, "timers": {"training_iteration_time_ms": 3263.98, "sample_time_ms": 3253.203, "load_time_ms": 0.3, "load_throughput": 1199610.265, "learn_time_ms": 9.734, "learn_throughput": 36983.003, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600}, "done": false, "episodes_total": 1149, "training_iteration": 244, "trial_id": "73eff_00000", "date": "2023-08-04_09-06-16", "timestamp": 1691129176, "time_this_iter_s": 13.144186973571777, "time_total_s": 2825.665833711624, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1095.8351068496704, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 18.25263157894737, "ram_util_percent": 62.67368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.53056640625, "policy_loss": -745246.865625, "vf_loss": 8805119.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1693.0, "diff_num_grad_updates_vs_sampler_policy": 1692.0}}, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "sampler_results": {"episode_reward_max": -2194.950995965839, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2399.769078974434, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659208574223507, "mean_inference_ms": 0.3679824586637826, "mean_action_processing_ms": 0.0904991656175553, "mean_env_wait_ms": 0.9184156031277487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003831148147583008, "StateBufferConnector_ms": 0.0027070045471191406, "ViewRequirementAgentConnector_ms": 0.06565594673156738}}, "episode_reward_max": -2194.950995965839, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2399.769078974434, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2360.6548888782777, -2344.2460406167597, -2390.220074988844, -2231.931484808976, -2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659208574223507, "mean_inference_ms": 0.3679824586637826, "mean_action_processing_ms": 0.0904991656175553, "mean_env_wait_ms": 0.9184156031277487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003831148147583008, "StateBufferConnector_ms": 0.0027070045471191406, "ViewRequirementAgentConnector_ms": 0.06565594673156738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.27062010057529, "num_env_steps_trained_throughput_per_sec": 110.27062010057529, "timesteps_total": 242040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 242040, "timers": {"training_iteration_time_ms": 3273.642, "sample_time_ms": 3262.819, "load_time_ms": 0.302, "load_throughput": 1193541.57, "learn_time_ms": 9.777, "learn_throughput": 36820.132, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "done": false, "episodes_total": 1153, "training_iteration": 245, "trial_id": "73eff_00000", "date": "2023-08-04_09-06-29", "timestamp": 1691129189, "time_this_iter_s": 13.06155014038086, "time_total_s": 2838.727383852005, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1108.8966569900513, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 18.133333333333333, "ram_util_percent": 62.73888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.8358154296875, "policy_loss": -730908.17734375, "vf_loss": 9366991.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1713.0, "diff_num_grad_updates_vs_sampler_policy": 1712.0}}, "num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480}, "sampler_results": {"episode_reward_max": -2194.950995965839, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2401.2439538375784, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659107282391257, "mean_inference_ms": 0.3679864183754728, "mean_action_processing_ms": 0.09049832844025275, "mean_env_wait_ms": 0.9181242447749929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003767251968383789, "StateBufferConnector_ms": 0.002712726593017578, "ViewRequirementAgentConnector_ms": 0.06567788124084473}}, "episode_reward_max": -2194.950995965839, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2401.2439538375784, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2491.4169013652204, -2420.865580177238, -2194.950995965839, -2504.4309311549127, -2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.659107282391257, "mean_inference_ms": 0.3679864183754728, "mean_action_processing_ms": 0.09049832844025275, "mean_env_wait_ms": 0.9181242447749929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003767251968383789, "StateBufferConnector_ms": 0.002712726593017578, "ViewRequirementAgentConnector_ms": 0.06567788124084473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480, "num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.39968102766692, "num_env_steps_trained_throughput_per_sec": 109.39968102766692, "timesteps_total": 243480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 243480, "timers": {"training_iteration_time_ms": 3278.204, "sample_time_ms": 3267.33, "load_time_ms": 0.301, "load_throughput": 1196663.053, "learn_time_ms": 9.833, "learn_throughput": 36611.58, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480}, "done": false, "episodes_total": 1157, "training_iteration": 246, "trial_id": "73eff_00000", "date": "2023-08-04_09-06-43", "timestamp": 1691129203, "time_this_iter_s": 13.165564775466919, "time_total_s": 2851.892948627472, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1122.0622217655182, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 19.068421052631578, "ram_util_percent": 62.36842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.43621215820315, "policy_loss": -37631.8375, "vf_loss": 8412018.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1733.0, "diff_num_grad_updates_vs_sampler_policy": 1732.0}}, "num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2400.658166396146, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65905666325701, "mean_inference_ms": 0.3679911183171345, "mean_action_processing_ms": 0.09049766605766817, "mean_env_wait_ms": 0.917822030181432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003773927688598633, "StateBufferConnector_ms": 0.0027217864990234375, "ViewRequirementAgentConnector_ms": 0.06570625305175781}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2400.658166396146, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2302.459038106274, -2281.5067176747116, -2356.3641635796685, -2398.1683985725736, -2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65905666325701, "mean_inference_ms": 0.3679911183171345, "mean_action_processing_ms": 0.09049766605766817, "mean_env_wait_ms": 0.917822030181432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003773927688598633, "StateBufferConnector_ms": 0.0027217864990234375, "ViewRequirementAgentConnector_ms": 0.06570625305175781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920, "num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.98903933449013, "num_env_steps_trained_throughput_per_sec": 109.98903933449013, "timesteps_total": 244920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 244920, "timers": {"training_iteration_time_ms": 3276.126, "sample_time_ms": 3265.28, "load_time_ms": 0.301, "load_throughput": 1195715.426, "learn_time_ms": 9.789, "learn_throughput": 36775.294, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920}, "done": false, "episodes_total": 1161, "training_iteration": 247, "trial_id": "73eff_00000", "date": "2023-08-04_09-06-56", "timestamp": 1691129216, "time_this_iter_s": 13.095051050186157, "time_total_s": 2864.987999677658, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1135.1572728157043, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 19.010526315789473, "ram_util_percent": 62.36842105263159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.97014770507815, "policy_loss": -1794735.0375, "vf_loss": 9594142.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1753.0, "diff_num_grad_updates_vs_sampler_policy": 1752.0}}, "num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2409.042604837398, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658915957214294, "mean_inference_ms": 0.3679964132531039, "mean_action_processing_ms": 0.09049726970814474, "mean_env_wait_ms": 0.917542937755093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003780841827392578, "StateBufferConnector_ms": 0.0027265548706054688, "ViewRequirementAgentConnector_ms": 0.0657966136932373}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2409.042604837398, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2402.555616528324, -2363.268870427383, -2267.1687113244384, -2458.5091101283974, -2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658915957214294, "mean_inference_ms": 0.3679964132531039, "mean_action_processing_ms": 0.09049726970814474, "mean_env_wait_ms": 0.917542937755093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003780841827392578, "StateBufferConnector_ms": 0.0027265548706054688, "ViewRequirementAgentConnector_ms": 0.0657966136932373}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360, "num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.28053882514548, "num_env_steps_trained_throughput_per_sec": 111.28053882514548, "timesteps_total": 246360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 246360, "timers": {"training_iteration_time_ms": 3269.398, "sample_time_ms": 3258.495, "load_time_ms": 0.303, "load_throughput": 1188188.102, "learn_time_ms": 9.834, "learn_throughput": 36609.184, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360}, "done": false, "episodes_total": 1165, "training_iteration": 248, "trial_id": "73eff_00000", "date": "2023-08-04_09-07-09", "timestamp": 1691129229, "time_this_iter_s": 12.943079948425293, "time_total_s": 2877.9310796260834, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1148.1003527641296, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 18.572222222222223, "ram_util_percent": 62.41111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.80091552734376, "policy_loss": -1266826.4421875, "vf_loss": 8201886.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1773.0, "diff_num_grad_updates_vs_sampler_policy": 1772.0}}, "num_env_steps_sampled": 247800, "num_env_steps_trained": 247800, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247800}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2407.6832026519023, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658702282449443, "mean_inference_ms": 0.36800144887470965, "mean_action_processing_ms": 0.09049711946257873, "mean_env_wait_ms": 0.9172841994110386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003783702850341797, "StateBufferConnector_ms": 0.0027294158935546875, "ViewRequirementAgentConnector_ms": 0.06580877304077148}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2407.6832026519023, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2258.765605322468, -2264.6292282408153, -2464.45214572751, -2516.054293272531, -2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658702282449443, "mean_inference_ms": 0.36800144887470965, "mean_action_processing_ms": 0.09049711946257873, "mean_env_wait_ms": 0.9172841994110386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003783702850341797, "StateBufferConnector_ms": 0.0027294158935546875, "ViewRequirementAgentConnector_ms": 0.06580877304077148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247800, "num_env_steps_sampled": 247800, "num_env_steps_trained": 247800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.20117884288995, "num_env_steps_trained_throughput_per_sec": 112.20117884288995, "timesteps_total": 247800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 247800, "timers": {"training_iteration_time_ms": 3233.268, "sample_time_ms": 3222.325, "load_time_ms": 0.302, "load_throughput": 1192693.081, "learn_time_ms": 9.876, "learn_throughput": 36450.286, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 247800, "num_env_steps_trained": 247800, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247800}, "done": false, "episodes_total": 1169, "training_iteration": 249, "trial_id": "73eff_00000", "date": "2023-08-04_09-07-22", "timestamp": 1691129242, "time_this_iter_s": 12.836924076080322, "time_total_s": 2890.7680037021637, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1160.93727684021, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 22.48333333333333, "ram_util_percent": 62.40555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -317.512744140625, "policy_loss": -7797653.49609375, "vf_loss": 11136331.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1793.0, "diff_num_grad_updates_vs_sampler_policy": 1792.0}}, "num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2414.259140526538, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658503211357504, "mean_inference_ms": 0.36800832373762815, "mean_action_processing_ms": 0.09049751098256965, "mean_env_wait_ms": 0.9170547967045749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037806034088134766, "StateBufferConnector_ms": 0.002740621566772461, "ViewRequirementAgentConnector_ms": 0.06588220596313477}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2414.259140526538, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2315.5745969904947, -2330.2657577650107, -2337.136347109901, -2502.054740200926, -2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658503211357504, "mean_inference_ms": 0.36800832373762815, "mean_action_processing_ms": 0.09049751098256965, "mean_env_wait_ms": 0.9170547967045749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037806034088134766, "StateBufferConnector_ms": 0.002740621566772461, "ViewRequirementAgentConnector_ms": 0.06588220596313477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240, "num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.29545910625144, "num_env_steps_trained_throughput_per_sec": 110.29545910625144, "timesteps_total": 249240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 249240, "timers": {"training_iteration_time_ms": 3235.435, "sample_time_ms": 3224.434, "load_time_ms": 0.302, "load_throughput": 1192598.878, "learn_time_ms": 9.944, "learn_throughput": 36202.96, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240}, "done": false, "episodes_total": 1173, "training_iteration": 250, "trial_id": "73eff_00000", "date": "2023-08-04_09-07-35", "timestamp": 1691129255, "time_this_iter_s": 13.058787107467651, "time_total_s": 2903.8267908096313, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1173.9960639476776, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 19.226315789473684, "ram_util_percent": 62.426315789473676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.9327392578125, "policy_loss": -6174043.878125, "vf_loss": 9820650.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1813.0, "diff_num_grad_updates_vs_sampler_policy": 1812.0}}, "num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2415.4822588344555, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658239811085622, "mean_inference_ms": 0.3680418881455854, "mean_action_processing_ms": 0.09050418643330964, "mean_env_wait_ms": 0.9168652848467618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037903785705566406, "StateBufferConnector_ms": 0.002764463424682617, "ViewRequirementAgentConnector_ms": 0.06632733345031738}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2415.4822588344555, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2436.2468600209154, -2309.183749865277, -2269.0924886477487, -2271.8488189525438, -2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.658239811085622, "mean_inference_ms": 0.3680418881455854, "mean_action_processing_ms": 0.09050418643330964, "mean_env_wait_ms": 0.9168652848467618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037903785705566406, "StateBufferConnector_ms": 0.002764463424682617, "ViewRequirementAgentConnector_ms": 0.06632733345031738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680, "num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.89006568616533, "num_env_steps_trained_throughput_per_sec": 108.89006568616533, "timesteps_total": 250680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 250680, "timers": {"training_iteration_time_ms": 3261.692, "sample_time_ms": 3250.579, "load_time_ms": 0.307, "load_throughput": 1174509.521, "learn_time_ms": 10.041, "learn_throughput": 35851.816, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680}, "done": false, "episodes_total": 1177, "training_iteration": 251, "trial_id": "73eff_00000", "date": "2023-08-04_09-07-48", "timestamp": 1691129268, "time_this_iter_s": 13.227166891098022, "time_total_s": 2917.0539577007294, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1187.2232308387756, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 26.431578947368422, "ram_util_percent": 63.01052631578946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.4427001953125, "policy_loss": -125897.915625, "vf_loss": 8402968.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1833.0, "diff_num_grad_updates_vs_sampler_policy": 1832.0}}, "num_env_steps_sampled": 252120, "num_env_steps_trained": 252120, "num_agent_steps_sampled": 252120, "num_agent_steps_trained": 252120}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2413.8834011255517, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.657918621555472, "mean_inference_ms": 0.3680916409399049, "mean_action_processing_ms": 0.09051400434801962, "mean_env_wait_ms": 0.9167046882862826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037887096405029297, "StateBufferConnector_ms": 0.0027773380279541016, "ViewRequirementAgentConnector_ms": 0.06650280952453613}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2413.8834011255517, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2685.7812723023194, -2587.5763944618816, -2619.5208684287263, -2264.78525478764, -2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.657918621555472, "mean_inference_ms": 0.3680916409399049, "mean_action_processing_ms": 0.09051400434801962, "mean_env_wait_ms": 0.9167046882862826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037887096405029297, "StateBufferConnector_ms": 0.0027773380279541016, "ViewRequirementAgentConnector_ms": 0.06650280952453613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252120, "num_agent_steps_trained": 252120, "num_env_steps_sampled": 252120, "num_env_steps_trained": 252120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.3393065556202, "num_env_steps_trained_throughput_per_sec": 110.3393065556202, "timesteps_total": 252120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 252120, "timers": {"training_iteration_time_ms": 3282.7, "sample_time_ms": 3271.469, "load_time_ms": 0.314, "load_throughput": 1145289.32, "learn_time_ms": 10.123, "learn_throughput": 35560.938, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 252120, "num_env_steps_trained": 252120, "num_agent_steps_sampled": 252120, "num_agent_steps_trained": 252120}, "done": false, "episodes_total": 1181, "training_iteration": 252, "trial_id": "73eff_00000", "date": "2023-08-04_09-08-01", "timestamp": 1691129281, "time_this_iter_s": 13.05359697341919, "time_total_s": 2930.1075546741486, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1200.2768278121948, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 30.82222222222222, "ram_util_percent": 63.27222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.97156982421876, "policy_loss": -2448861.6046875, "vf_loss": 9193685.85}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1853.0, "diff_num_grad_updates_vs_sampler_policy": 1852.0}}, "num_env_steps_sampled": 253560, "num_env_steps_trained": 253560, "num_agent_steps_sampled": 253560, "num_agent_steps_trained": 253560}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2405.9654695085424, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.657602161001148, "mean_inference_ms": 0.3681442485883815, "mean_action_processing_ms": 0.09052451170621169, "mean_env_wait_ms": 0.9165532077943503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003782987594604492, "StateBufferConnector_ms": 0.002775430679321289, "ViewRequirementAgentConnector_ms": 0.0665278434753418}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2405.9654695085424, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2277.3599954548604, -2442.5013918120917, -2739.1272319308114, -2364.742783083536, -2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.657602161001148, "mean_inference_ms": 0.3681442485883815, "mean_action_processing_ms": 0.09052451170621169, "mean_env_wait_ms": 0.9165532077943503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003782987594604492, "StateBufferConnector_ms": 0.002775430679321289, "ViewRequirementAgentConnector_ms": 0.0665278434753418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253560, "num_agent_steps_trained": 253560, "num_env_steps_sampled": 253560, "num_env_steps_trained": 253560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.64065650884582, "num_env_steps_trained_throughput_per_sec": 109.64065650884582, "timesteps_total": 253560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 253560, "timers": {"training_iteration_time_ms": 3265.034, "sample_time_ms": 3253.927, "load_time_ms": 0.309, "load_throughput": 1163647.842, "learn_time_ms": 10.01, "learn_throughput": 35962.48, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 253560, "num_env_steps_trained": 253560, "num_agent_steps_sampled": 253560, "num_agent_steps_trained": 253560}, "done": false, "episodes_total": 1185, "training_iteration": 253, "trial_id": "73eff_00000", "date": "2023-08-04_09-08-14", "timestamp": 1691129294, "time_this_iter_s": 13.136661052703857, "time_total_s": 2943.2442157268524, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1213.4134888648987, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 20.136842105263153, "ram_util_percent": 62.88421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.3050109863281, "policy_loss": 204274.3875, "vf_loss": 8162026.45}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1873.0, "diff_num_grad_updates_vs_sampler_policy": 1872.0}}, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2399.8467441848875, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65730646007857, "mean_inference_ms": 0.36819816111874815, "mean_action_processing_ms": 0.09053529267350502, "mean_env_wait_ms": 0.9163878686376198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003774881362915039, "StateBufferConnector_ms": 0.0027730464935302734, "ViewRequirementAgentConnector_ms": 0.06653642654418945}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2399.8467441848875, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2274.723059314666, -2365.38097511344, -2455.9178775524897, -2338.265746661241, -2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65730646007857, "mean_inference_ms": 0.36819816111874815, "mean_action_processing_ms": 0.09053529267350502, "mean_env_wait_ms": 0.9163878686376198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003774881362915039, "StateBufferConnector_ms": 0.0027730464935302734, "ViewRequirementAgentConnector_ms": 0.06653642654418945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.54025172541907, "num_env_steps_trained_throughput_per_sec": 110.54025172541907, "timesteps_total": 255000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 255000, "timers": {"training_iteration_time_ms": 3271.101, "sample_time_ms": 3259.868, "load_time_ms": 0.308, "load_throughput": 1168239.412, "learn_time_ms": 10.118, "learn_throughput": 35581.217, "synch_weights_time_ms": 0.757}, "counters": {"num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "done": false, "episodes_total": 1189, "training_iteration": 254, "trial_id": "73eff_00000", "date": "2023-08-04_09-08-27", "timestamp": 1691129307, "time_this_iter_s": 13.030100107192993, "time_total_s": 2956.2743158340454, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1226.4435889720917, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 20.57894736842105, "ram_util_percent": 63.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.90501708984374, "policy_loss": -4825037.1875, "vf_loss": 9190873.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1893.0, "diff_num_grad_updates_vs_sampler_policy": 1892.0}}, "num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2401.922295765988, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.656938512470127, "mean_inference_ms": 0.3682533539025155, "mean_action_processing_ms": 0.09054626640171286, "mean_env_wait_ms": 0.9162214442404831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037746429443359375, "StateBufferConnector_ms": 0.002777576446533203, "ViewRequirementAgentConnector_ms": 0.06652450561523438}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2784.348076724349, "episode_reward_mean": -2401.922295765988, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2572.4634383349817, -2358.2021623737837, -2598.363263699421, -2784.348076724349, -2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.656938512470127, "mean_inference_ms": 0.3682533539025155, "mean_action_processing_ms": 0.09054626640171286, "mean_env_wait_ms": 0.9162214442404831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037746429443359375, "StateBufferConnector_ms": 0.002777576446533203, "ViewRequirementAgentConnector_ms": 0.06652450561523438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440, "num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.0291249992486, "num_env_steps_trained_throughput_per_sec": 111.0291249992486, "timesteps_total": 256440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 256440, "timers": {"training_iteration_time_ms": 3254.366, "sample_time_ms": 3243.483, "load_time_ms": 0.3, "load_throughput": 1201997.644, "learn_time_ms": 9.813, "learn_throughput": 36687.638, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440}, "done": false, "episodes_total": 1193, "training_iteration": 255, "trial_id": "73eff_00000", "date": "2023-08-04_09-08-40", "timestamp": 1691129320, "time_this_iter_s": 12.972292184829712, "time_total_s": 2969.246608018875, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1239.4158811569214, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 20.188888888888883, "ram_util_percent": 62.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -317.68488159179685, "policy_loss": -5197161.7484375, "vf_loss": 10764894.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1913.0, "diff_num_grad_updates_vs_sampler_policy": 1912.0}}, "num_env_steps_sampled": 257880, "num_env_steps_trained": 257880, "num_agent_steps_sampled": 257880, "num_agent_steps_trained": 257880}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2397.5175604283427, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.656580617545289, "mean_inference_ms": 0.3683083410656597, "mean_action_processing_ms": 0.0905574063176915, "mean_env_wait_ms": 0.9160473303377941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037822723388671875, "StateBufferConnector_ms": 0.0027878284454345703, "ViewRequirementAgentConnector_ms": 0.06667041778564453}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2397.5175604283427, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2368.0846525378224, -2334.751397527074, -2503.617303468833, -2499.1297220768915, -2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.656580617545289, "mean_inference_ms": 0.3683083410656597, "mean_action_processing_ms": 0.0905574063176915, "mean_env_wait_ms": 0.9160473303377941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037822723388671875, "StateBufferConnector_ms": 0.0027878284454345703, "ViewRequirementAgentConnector_ms": 0.06667041778564453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 257880, "num_agent_steps_trained": 257880, "num_env_steps_sampled": 257880, "num_env_steps_trained": 257880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.66042982953623, "num_env_steps_trained_throughput_per_sec": 109.66042982953623, "timesteps_total": 257880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 257880, "timers": {"training_iteration_time_ms": 3253.465, "sample_time_ms": 3242.557, "load_time_ms": 0.3, "load_throughput": 1198943.497, "learn_time_ms": 9.84, "learn_throughput": 36586.83, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 257880, "num_env_steps_trained": 257880, "num_agent_steps_sampled": 257880, "num_agent_steps_trained": 257880}, "done": false, "episodes_total": 1197, "training_iteration": 256, "trial_id": "73eff_00000", "date": "2023-08-04_09-08-53", "timestamp": 1691129333, "time_this_iter_s": 13.134116888046265, "time_total_s": 2982.3807249069214, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1252.5499980449677, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 18.65263157894737, "ram_util_percent": 62.384210526315776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.7378234863281, "policy_loss": -2410850.234375, "vf_loss": 8707255.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1933.0, "diff_num_grad_updates_vs_sampler_policy": 1932.0}}, "num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2395.3720902285186, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.656195608187067, "mean_inference_ms": 0.36836347836676686, "mean_action_processing_ms": 0.09056847995438928, "mean_env_wait_ms": 0.9158796397583123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037827491760253906, "StateBufferConnector_ms": 0.0027916431427001953, "ViewRequirementAgentConnector_ms": 0.06667256355285645}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2395.3720902285186, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2273.9205304265633, -2382.312512225509, -2615.3217441809156, -2380.76573874459, -2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.656195608187067, "mean_inference_ms": 0.36836347836676686, "mean_action_processing_ms": 0.09056847995438928, "mean_env_wait_ms": 0.9158796397583123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037827491760253906, "StateBufferConnector_ms": 0.0027916431427001953, "ViewRequirementAgentConnector_ms": 0.06667256355285645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320, "num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.84058642279072, "num_env_steps_trained_throughput_per_sec": 111.84058642279072, "timesteps_total": 259320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 259320, "timers": {"training_iteration_time_ms": 3254.916, "sample_time_ms": 3244.059, "load_time_ms": 0.299, "load_throughput": 1205740.989, "learn_time_ms": 9.798, "learn_throughput": 36743.436, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320}, "done": false, "episodes_total": 1201, "training_iteration": 257, "trial_id": "73eff_00000", "date": "2023-08-04_09-09-06", "timestamp": 1691129346, "time_this_iter_s": 12.878323793411255, "time_total_s": 2995.2590487003326, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1265.428321838379, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 19.63888888888889, "ram_util_percent": 62.400000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.930908203125, "policy_loss": -4965455.68125, "vf_loss": 9039778.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1953.0, "diff_num_grad_updates_vs_sampler_policy": 1952.0}}, "num_env_steps_sampled": 260760, "num_env_steps_trained": 260760, "num_agent_steps_sampled": 260760, "num_agent_steps_trained": 260760}, "sampler_results": {"episode_reward_max": -2195.0278976307545, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2394.690325729261, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655808018851838, "mean_inference_ms": 0.3684179870148061, "mean_action_processing_ms": 0.09057932818474694, "mean_env_wait_ms": 0.9157072016995231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00376129150390625, "StateBufferConnector_ms": 0.0027923583984375, "ViewRequirementAgentConnector_ms": 0.06665158271789551}}, "episode_reward_max": -2195.0278976307545, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2394.690325729261, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2429.609353147146, -2431.9110507153355, -2195.557035627935, -2656.2808003024775, -2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655808018851838, "mean_inference_ms": 0.3684179870148061, "mean_action_processing_ms": 0.09057932818474694, "mean_env_wait_ms": 0.9157072016995231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00376129150390625, "StateBufferConnector_ms": 0.0027923583984375, "ViewRequirementAgentConnector_ms": 0.06665158271789551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260760, "num_agent_steps_trained": 260760, "num_env_steps_sampled": 260760, "num_env_steps_trained": 260760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.369133704677, "num_env_steps_trained_throughput_per_sec": 110.369133704677, "timesteps_total": 260760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 260760, "timers": {"training_iteration_time_ms": 3249.419, "sample_time_ms": 3238.471, "load_time_ms": 0.3, "load_throughput": 1201806.304, "learn_time_ms": 9.876, "learn_throughput": 36450.55, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 260760, "num_env_steps_trained": 260760, "num_agent_steps_sampled": 260760, "num_agent_steps_trained": 260760}, "done": false, "episodes_total": 1205, "training_iteration": 258, "trial_id": "73eff_00000", "date": "2023-08-04_09-09-19", "timestamp": 1691129359, "time_this_iter_s": 13.050005197525024, "time_total_s": 3008.3090538978577, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1278.478327035904, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 19.83157894736842, "ram_util_percent": 62.73684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -318.45371704101564, "policy_loss": -6031835.4140625, "vf_loss": 11021843.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1973.0, "diff_num_grad_updates_vs_sampler_policy": 1972.0}}, "num_env_steps_sampled": 262200, "num_env_steps_trained": 262200, "num_agent_steps_sampled": 262200, "num_agent_steps_trained": 262200}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2392.254408372046, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655379537150225, "mean_inference_ms": 0.3684706285831977, "mean_action_processing_ms": 0.09058988147989334, "mean_env_wait_ms": 0.9155348760189446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037539005279541016, "StateBufferConnector_ms": 0.002780437469482422, "ViewRequirementAgentConnector_ms": 0.06656837463378906}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2392.254408372046, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2332.05614423405, -2537.353161076499, -2293.351220298871, -2339.054882074668, -2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655379537150225, "mean_inference_ms": 0.3684706285831977, "mean_action_processing_ms": 0.09058988147989334, "mean_env_wait_ms": 0.9155348760189446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037539005279541016, "StateBufferConnector_ms": 0.002780437469482422, "ViewRequirementAgentConnector_ms": 0.06656837463378906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262200, "num_agent_steps_trained": 262200, "num_env_steps_sampled": 262200, "num_env_steps_trained": 262200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.7004212854617, "num_env_steps_trained_throughput_per_sec": 113.7004212854617, "timesteps_total": 262200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 262200, "timers": {"training_iteration_time_ms": 3222.544, "sample_time_ms": 3211.473, "load_time_ms": 0.301, "load_throughput": 1196378.607, "learn_time_ms": 9.991, "learn_throughput": 36032.594, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 262200, "num_env_steps_trained": 262200, "num_agent_steps_sampled": 262200, "num_agent_steps_trained": 262200}, "done": false, "episodes_total": 1209, "training_iteration": 259, "trial_id": "73eff_00000", "date": "2023-08-04_09-09-32", "timestamp": 1691129372, "time_this_iter_s": 12.667616128921509, "time_total_s": 3020.976670026779, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1291.1459431648254, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 24.716666666666665, "ram_util_percent": 62.78888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -317.04172973632814, "policy_loss": -3996201.1625, "vf_loss": 9468318.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1993.0, "diff_num_grad_updates_vs_sampler_policy": 1992.0}}, "num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2390.8725904457283, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654974814767069, "mean_inference_ms": 0.3685185592573815, "mean_action_processing_ms": 0.09059952706133814, "mean_env_wait_ms": 0.9153677940423367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003749847412109375, "StateBufferConnector_ms": 0.0027713775634765625, "ViewRequirementAgentConnector_ms": 0.06656050682067871}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2390.8725904457283, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2358.7488262548395, -2482.806075686104, -2365.3533236511207, -2508.5934072526957, -2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654974814767069, "mean_inference_ms": 0.3685185592573815, "mean_action_processing_ms": 0.09059952706133814, "mean_env_wait_ms": 0.9153677940423367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003749847412109375, "StateBufferConnector_ms": 0.0027713775634765625, "ViewRequirementAgentConnector_ms": 0.06656050682067871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640, "num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.63585681906883, "num_env_steps_trained_throughput_per_sec": 112.63585681906883, "timesteps_total": 263640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 263640, "timers": {"training_iteration_time_ms": 3192.645, "sample_time_ms": 3181.595, "load_time_ms": 0.303, "load_throughput": 1188562.217, "learn_time_ms": 9.962, "learn_throughput": 36138.841, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640}, "done": false, "episodes_total": 1213, "training_iteration": 260, "trial_id": "73eff_00000", "date": "2023-08-04_09-09-45", "timestamp": 1691129385, "time_this_iter_s": 12.787951231002808, "time_total_s": 3033.764621257782, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1303.9338943958282, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 21.227777777777774, "ram_util_percent": 62.544444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -317.32379150390625, "policy_loss": -7822240.140625, "vf_loss": 10503155.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2013.0, "diff_num_grad_updates_vs_sampler_policy": 2012.0}}, "num_env_steps_sampled": 265080, "num_env_steps_trained": 265080, "num_agent_steps_sampled": 265080, "num_agent_steps_trained": 265080}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2392.0467643028164, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654535055673193, "mean_inference_ms": 0.3685636398631128, "mean_action_processing_ms": 0.09060867537875407, "mean_env_wait_ms": 0.9152201854070735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003767728805541992, "StateBufferConnector_ms": 0.002777576446533203, "ViewRequirementAgentConnector_ms": 0.06679368019104004}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2392.0467643028164, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2492.189851917016, -2195.0278976307545, -2436.3535837145373, -2255.2174419790917, -2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654535055673193, "mean_inference_ms": 0.3685636398631128, "mean_action_processing_ms": 0.09060867537875407, "mean_env_wait_ms": 0.9152201854070735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003767728805541992, "StateBufferConnector_ms": 0.002777576446533203, "ViewRequirementAgentConnector_ms": 0.06679368019104004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265080, "num_agent_steps_trained": 265080, "num_env_steps_sampled": 265080, "num_env_steps_trained": 265080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.23755452762994, "num_env_steps_trained_throughput_per_sec": 113.23755452762994, "timesteps_total": 265080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 265080, "timers": {"training_iteration_time_ms": 3192.472, "sample_time_ms": 3181.67, "load_time_ms": 0.302, "load_throughput": 1191093.666, "learn_time_ms": 9.733, "learn_throughput": 36986.264, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 265080, "num_env_steps_trained": 265080, "num_agent_steps_sampled": 265080, "num_agent_steps_trained": 265080}, "done": false, "episodes_total": 1217, "training_iteration": 261, "trial_id": "73eff_00000", "date": "2023-08-04_09-09-58", "timestamp": 1691129398, "time_this_iter_s": 12.719504117965698, "time_total_s": 3046.4841253757477, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1316.653398513794, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 24.422222222222224, "ram_util_percent": 62.81111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -317.0002685546875, "policy_loss": -6875595.5875, "vf_loss": 9118458.45}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2033.0, "diff_num_grad_updates_vs_sampler_policy": 2032.0}}, "num_env_steps_sampled": 266520, "num_env_steps_trained": 266520, "num_agent_steps_sampled": 266520, "num_agent_steps_trained": 266520}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2396.5271042159598, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654065701683683, "mean_inference_ms": 0.36864010206964026, "mean_action_processing_ms": 0.0906240067602635, "mean_env_wait_ms": 0.9151259050875297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003797292709350586, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.06715893745422363}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2396.5271042159598, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2355.878842930064, -2434.8160859392337, -2513.8282863189565, -2332.685990453536, -2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654065701683683, "mean_inference_ms": 0.36864010206964026, "mean_action_processing_ms": 0.0906240067602635, "mean_env_wait_ms": 0.9151259050875297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003797292709350586, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.06715893745422363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266520, "num_agent_steps_trained": 266520, "num_env_steps_sampled": 266520, "num_env_steps_trained": 266520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.63168293281397, "num_env_steps_trained_throughput_per_sec": 109.63168293281397, "timesteps_total": 266520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 266520, "timers": {"training_iteration_time_ms": 3219.964, "sample_time_ms": 3209.124, "load_time_ms": 0.307, "load_throughput": 1172776.264, "learn_time_ms": 9.754, "learn_throughput": 36908.063, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 266520, "num_env_steps_trained": 266520, "num_agent_steps_sampled": 266520, "num_agent_steps_trained": 266520}, "done": false, "episodes_total": 1221, "training_iteration": 262, "trial_id": "73eff_00000", "date": "2023-08-04_09-10-11", "timestamp": 1691129411, "time_this_iter_s": 13.137732028961182, "time_total_s": 3059.621857404709, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1329.7911305427551, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 25.463157894736838, "ram_util_percent": 62.92631578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.7690856933594, "policy_loss": -2212336.39296875, "vf_loss": 8984630.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2053.0, "diff_num_grad_updates_vs_sampler_policy": 2052.0}}, "num_env_steps_sampled": 267960, "num_env_steps_trained": 267960, "num_agent_steps_sampled": 267960, "num_agent_steps_trained": 267960}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2394.992358298481, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653450198602441, "mean_inference_ms": 0.3687383760826131, "mean_action_processing_ms": 0.09064332397759385, "mean_env_wait_ms": 0.9150582572833028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003807544708251953, "StateBufferConnector_ms": 0.0027947425842285156, "ViewRequirementAgentConnector_ms": 0.0674288272857666}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2394.992358298481, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2227.5768582312726, -2315.1822694775665, -2388.5211737340437, -2376.468877453582, -2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653450198602441, "mean_inference_ms": 0.3687383760826131, "mean_action_processing_ms": 0.09064332397759385, "mean_env_wait_ms": 0.9150582572833028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003807544708251953, "StateBufferConnector_ms": 0.0027947425842285156, "ViewRequirementAgentConnector_ms": 0.0674288272857666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267960, "num_agent_steps_trained": 267960, "num_env_steps_sampled": 267960, "num_env_steps_trained": 267960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.55956021134548, "num_env_steps_trained_throughput_per_sec": 112.55956021134548, "timesteps_total": 267960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 267960, "timers": {"training_iteration_time_ms": 3227.819, "sample_time_ms": 3216.754, "load_time_ms": 0.312, "load_throughput": 1154219.11, "learn_time_ms": 9.925, "learn_throughput": 36272.709, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 267960, "num_env_steps_trained": 267960, "num_agent_steps_sampled": 267960, "num_agent_steps_trained": 267960}, "done": false, "episodes_total": 1225, "training_iteration": 263, "trial_id": "73eff_00000", "date": "2023-08-04_09-10-24", "timestamp": 1691129424, "time_this_iter_s": 12.796483993530273, "time_total_s": 3072.418341398239, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1342.5876145362854, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 28.650000000000002, "ram_util_percent": 62.955555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -317.0085021972656, "policy_loss": -3907155.285546875, "vf_loss": 9702634.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2073.0, "diff_num_grad_updates_vs_sampler_policy": 2072.0}}, "num_env_steps_sampled": 269400, "num_env_steps_trained": 269400, "num_agent_steps_sampled": 269400, "num_agent_steps_trained": 269400}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2396.7367210798175, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652783703618727, "mean_inference_ms": 0.36884192375475783, "mean_action_processing_ms": 0.0906633663721133, "mean_env_wait_ms": 0.915016676313168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038139820098876953, "StateBufferConnector_ms": 0.002796649932861328, "ViewRequirementAgentConnector_ms": 0.0675046443939209}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2396.7367210798175, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2619.386802882567, -2456.725433049615, -2195.041363291051, -2407.1786011947415, -2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652783703618727, "mean_inference_ms": 0.36884192375475783, "mean_action_processing_ms": 0.0906633663721133, "mean_env_wait_ms": 0.915016676313168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038139820098876953, "StateBufferConnector_ms": 0.002796649932861328, "ViewRequirementAgentConnector_ms": 0.0675046443939209}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269400, "num_agent_steps_trained": 269400, "num_env_steps_sampled": 269400, "num_env_steps_trained": 269400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.25802854109783, "num_env_steps_trained_throughput_per_sec": 114.25802854109783, "timesteps_total": 269400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 269400, "timers": {"training_iteration_time_ms": 3212.576, "sample_time_ms": 3201.42, "load_time_ms": 0.311, "load_throughput": 1157315.429, "learn_time_ms": 9.984, "learn_throughput": 36058.064, "synch_weights_time_ms": 0.815}, "counters": {"num_env_steps_sampled": 269400, "num_env_steps_trained": 269400, "num_agent_steps_sampled": 269400, "num_agent_steps_trained": 269400}, "done": false, "episodes_total": 1229, "training_iteration": 264, "trial_id": "73eff_00000", "date": "2023-08-04_09-10-36", "timestamp": 1691129436, "time_this_iter_s": 12.605785131454468, "time_total_s": 3085.0241265296936, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1355.1933996677399, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 25.711111111111112, "ram_util_percent": 62.916666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.76878051757814, "policy_loss": -458404.30625, "vf_loss": 8803655.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2093.0, "diff_num_grad_updates_vs_sampler_policy": 2092.0}}, "num_env_steps_sampled": 270840, "num_env_steps_trained": 270840, "num_agent_steps_sampled": 270840, "num_agent_steps_trained": 270840}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2394.526021939107, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652058767000787, "mean_inference_ms": 0.36894375182247985, "mean_action_processing_ms": 0.09068309773394972, "mean_env_wait_ms": 0.9149659284932347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038115978240966797, "StateBufferConnector_ms": 0.0027854442596435547, "ViewRequirementAgentConnector_ms": 0.06745219230651855}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2394.526021939107, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2419.0037713237784, -2432.0446097333843, -2575.372364312248, -2359.4863562405144, -2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652058767000787, "mean_inference_ms": 0.36894375182247985, "mean_action_processing_ms": 0.09068309773394972, "mean_env_wait_ms": 0.9149659284932347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038115978240966797, "StateBufferConnector_ms": 0.0027854442596435547, "ViewRequirementAgentConnector_ms": 0.06745219230651855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270840, "num_agent_steps_trained": 270840, "num_env_steps_sampled": 270840, "num_env_steps_trained": 270840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.56883547804087, "num_env_steps_trained_throughput_per_sec": 110.56883547804087, "timesteps_total": 270840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 270840, "timers": {"training_iteration_time_ms": 3200.059, "sample_time_ms": 3189.139, "load_time_ms": 0.304, "load_throughput": 1182604.511, "learn_time_ms": 9.807, "learn_throughput": 36709.133, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 270840, "num_env_steps_trained": 270840, "num_agent_steps_sampled": 270840, "num_agent_steps_trained": 270840}, "done": false, "episodes_total": 1233, "training_iteration": 265, "trial_id": "73eff_00000", "date": "2023-08-04_09-10-49", "timestamp": 1691129449, "time_this_iter_s": 13.026360988616943, "time_total_s": 3098.0504875183105, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1368.2197606563568, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 19.47368421052631, "ram_util_percent": 62.56842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.57958984375, "policy_loss": -1038041.003125, "vf_loss": 8780752.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2113.0, "diff_num_grad_updates_vs_sampler_policy": 2112.0}}, "num_env_steps_sampled": 272280, "num_env_steps_trained": 272280, "num_agent_steps_sampled": 272280, "num_agent_steps_trained": 272280}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2392.0933812549424, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307, -2317.7042914618496, -2365.688373272492, -2549.377022700192, -2309.8733457589324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651308728761376, "mean_inference_ms": 0.3690432573241034, "mean_action_processing_ms": 0.09070238979428248, "mean_env_wait_ms": 0.9149237534177707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038089752197265625, "StateBufferConnector_ms": 0.0027723312377929688, "ViewRequirementAgentConnector_ms": 0.06744933128356934}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2392.0933812549424, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2303.5996744279987, -2526.1582147966897, -2422.7035476602614, -2263.7438114449233, -2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307, -2317.7042914618496, -2365.688373272492, -2549.377022700192, -2309.8733457589324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651308728761376, "mean_inference_ms": 0.3690432573241034, "mean_action_processing_ms": 0.09070238979428248, "mean_env_wait_ms": 0.9149237534177707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038089752197265625, "StateBufferConnector_ms": 0.0027723312377929688, "ViewRequirementAgentConnector_ms": 0.06744933128356934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272280, "num_agent_steps_trained": 272280, "num_env_steps_sampled": 272280, "num_env_steps_trained": 272280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.77894623317879, "num_env_steps_trained_throughput_per_sec": 110.77894623317879, "timesteps_total": 272280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 272280, "timers": {"training_iteration_time_ms": 3239.721, "sample_time_ms": 3228.907, "load_time_ms": 0.303, "load_throughput": 1188936.567, "learn_time_ms": 9.763, "learn_throughput": 36873.993, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 272280, "num_env_steps_trained": 272280, "num_agent_steps_sampled": 272280, "num_agent_steps_trained": 272280}, "done": false, "episodes_total": 1237, "training_iteration": 266, "trial_id": "73eff_00000", "date": "2023-08-04_09-11-02", "timestamp": 1691129462, "time_this_iter_s": 13.001651048660278, "time_total_s": 3111.052138566971, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1381.221411705017, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 19.833333333333336, "ram_util_percent": 62.483333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.54931640625, "policy_loss": -1762218.6984375, "vf_loss": 8613748.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2133.0, "diff_num_grad_updates_vs_sampler_policy": 2132.0}}, "num_env_steps_sampled": 273720, "num_env_steps_trained": 273720, "num_agent_steps_sampled": 273720, "num_agent_steps_trained": 273720}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2395.0860670560314, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307, -2317.7042914618496, -2365.688373272492, -2549.377022700192, -2309.8733457589324, -2516.910057992273, -2696.307177708244, -2324.9853050245597, -2277.271287713669], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65058877883595, "mean_inference_ms": 0.3691402183290883, "mean_action_processing_ms": 0.09072110325888955, "mean_env_wait_ms": 0.9148931462791299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003802776336669922, "StateBufferConnector_ms": 0.002767801284790039, "ViewRequirementAgentConnector_ms": 0.06741547584533691}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2395.0860670560314, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2267.102489669402, -2355.557106604092, -2331.5190149409445, -2450.0212457150487, -2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307, -2317.7042914618496, -2365.688373272492, -2549.377022700192, -2309.8733457589324, -2516.910057992273, -2696.307177708244, -2324.9853050245597, -2277.271287713669], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65058877883595, "mean_inference_ms": 0.3691402183290883, "mean_action_processing_ms": 0.09072110325888955, "mean_env_wait_ms": 0.9148931462791299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003802776336669922, "StateBufferConnector_ms": 0.002767801284790039, "ViewRequirementAgentConnector_ms": 0.06741547584533691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273720, "num_agent_steps_trained": 273720, "num_env_steps_sampled": 273720, "num_env_steps_trained": 273720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.25877542284653, "num_env_steps_trained_throughput_per_sec": 110.25877542284653, "timesteps_total": 273720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 273720, "timers": {"training_iteration_time_ms": 3256.52, "sample_time_ms": 3245.732, "load_time_ms": 0.302, "load_throughput": 1192222.219, "learn_time_ms": 9.739, "learn_throughput": 36966.434, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 273720, "num_env_steps_trained": 273720, "num_agent_steps_sampled": 273720, "num_agent_steps_trained": 273720}, "done": false, "episodes_total": 1241, "training_iteration": 267, "trial_id": "73eff_00000", "date": "2023-08-04_09-11-15", "timestamp": 1691129475, "time_this_iter_s": 13.063153743743896, "time_total_s": 3124.1152923107147, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1394.284565448761, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 19.52631578947368, "ram_util_percent": 62.57894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -316.4128662109375, "policy_loss": -662700.14375, "vf_loss": 8231221.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2153.0, "diff_num_grad_updates_vs_sampler_policy": 2152.0}}, "num_env_steps_sampled": 275160, "num_env_steps_trained": 275160, "num_agent_steps_sampled": 275160, "num_agent_steps_trained": 275160}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2390.58561737002, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307, -2317.7042914618496, -2365.688373272492, -2549.377022700192, -2309.8733457589324, -2516.910057992273, -2696.307177708244, -2324.9853050245597, -2277.271287713669, -2266.693844497868, -2228.081829785138, -2228.0052627561377, -2231.3739512892075], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.649822602963145, "mean_inference_ms": 0.3692370811638392, "mean_action_processing_ms": 0.09073954823492478, "mean_env_wait_ms": 0.9148571741199057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038039684295654297, "StateBufferConnector_ms": 0.002774477005004883, "ViewRequirementAgentConnector_ms": 0.06742167472839355}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2390.58561737002, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2347.0452981900326, -2324.645791049812, -2465.286039045837, -2554.7676316919215, -2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307, -2317.7042914618496, -2365.688373272492, -2549.377022700192, -2309.8733457589324, -2516.910057992273, -2696.307177708244, -2324.9853050245597, -2277.271287713669, -2266.693844497868, -2228.081829785138, -2228.0052627561377, -2231.3739512892075], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.649822602963145, "mean_inference_ms": 0.3692370811638392, "mean_action_processing_ms": 0.09073954823492478, "mean_env_wait_ms": 0.9148571741199057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038039684295654297, "StateBufferConnector_ms": 0.002774477005004883, "ViewRequirementAgentConnector_ms": 0.06742167472839355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275160, "num_agent_steps_trained": 275160, "num_env_steps_sampled": 275160, "num_env_steps_trained": 275160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.04941173480466, "num_env_steps_trained_throughput_per_sec": 112.04941173480466, "timesteps_total": 275160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 275160, "timers": {"training_iteration_time_ms": 3240.395, "sample_time_ms": 3229.523, "load_time_ms": 0.301, "load_throughput": 1196947.634, "learn_time_ms": 9.818, "learn_throughput": 36665.811, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 275160, "num_env_steps_trained": 275160, "num_agent_steps_sampled": 275160, "num_agent_steps_trained": 275160}, "done": false, "episodes_total": 1245, "training_iteration": 268, "trial_id": "73eff_00000", "date": "2023-08-04_09-11-28", "timestamp": 1691129488, "time_this_iter_s": 12.854416131973267, "time_total_s": 3136.969708442688, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1407.1389815807343, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 20.077777777777776, "ram_util_percent": 62.588888888888896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -318.1953430175781, "policy_loss": -2575771.06875, "vf_loss": 10274488.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2173.0, "diff_num_grad_updates_vs_sampler_policy": 2172.0}}, "num_env_steps_sampled": 276600, "num_env_steps_trained": 276600, "num_agent_steps_sampled": 276600, "num_agent_steps_trained": 276600}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2387.8657681702352, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307, -2317.7042914618496, -2365.688373272492, -2549.377022700192, -2309.8733457589324, -2516.910057992273, -2696.307177708244, -2324.9853050245597, -2277.271287713669, -2266.693844497868, -2228.081829785138, -2228.0052627561377, -2231.3739512892075, -2195.1654934428893, -2350.6148219151382, -2408.9409093122936, -2465.038615328848], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648998071468511, "mean_inference_ms": 0.3693322879296656, "mean_action_processing_ms": 0.09075754203014558, "mean_env_wait_ms": 0.9148282043615368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003804922103881836, "StateBufferConnector_ms": 0.002775907516479492, "ViewRequirementAgentConnector_ms": 0.06745266914367676}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2771.3925500806677, "episode_reward_mean": -2387.8657681702352, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2436.4980720900035, -2274.9543127033094, -2464.471119804891, -2339.187235840493, -2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307, -2317.7042914618496, -2365.688373272492, -2549.377022700192, -2309.8733457589324, -2516.910057992273, -2696.307177708244, -2324.9853050245597, -2277.271287713669, -2266.693844497868, -2228.081829785138, -2228.0052627561377, -2231.3739512892075, -2195.1654934428893, -2350.6148219151382, -2408.9409093122936, -2465.038615328848], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648998071468511, "mean_inference_ms": 0.3693322879296656, "mean_action_processing_ms": 0.09075754203014558, "mean_env_wait_ms": 0.9148282043615368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003804922103881836, "StateBufferConnector_ms": 0.002775907516479492, "ViewRequirementAgentConnector_ms": 0.06745266914367676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276600, "num_agent_steps_trained": 276600, "num_env_steps_sampled": 276600, "num_env_steps_trained": 276600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.41001977428054, "num_env_steps_trained_throughput_per_sec": 111.41001977428054, "timesteps_total": 276600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 276600, "timers": {"training_iteration_time_ms": 3229.251, "sample_time_ms": 3218.376, "load_time_ms": 0.301, "load_throughput": 1194674.769, "learn_time_ms": 9.802, "learn_throughput": 36727.259, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 276600, "num_env_steps_trained": 276600, "num_agent_steps_sampled": 276600, "num_agent_steps_trained": 276600}, "done": false, "episodes_total": 1249, "training_iteration": 269, "trial_id": "73eff_00000", "date": "2023-08-04_09-11-41", "timestamp": 1691129501, "time_this_iter_s": 12.928177118301392, "time_total_s": 3149.8978855609894, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1420.0671586990356, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 18.555555555555557, "ram_util_percent": 62.59444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -322.19264526367186, "policy_loss": -11947987.509375, "vf_loss": 14359167.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2193.0, "diff_num_grad_updates_vs_sampler_policy": 2192.0}}, "num_env_steps_sampled": 278040, "num_env_steps_trained": 278040, "num_agent_steps_sampled": 278040, "num_agent_steps_trained": 278040}, "sampler_results": {"episode_reward_max": -2194.89763232045, "episode_reward_min": -2907.462750108906, "episode_reward_mean": -2396.133346802595, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307, -2317.7042914618496, -2365.688373272492, -2549.377022700192, -2309.8733457589324, -2516.910057992273, -2696.307177708244, -2324.9853050245597, -2277.271287713669, -2266.693844497868, -2228.081829785138, -2228.0052627561377, -2231.3739512892075, -2195.1654934428893, -2350.6148219151382, -2408.9409093122936, -2465.038615328848, -2560.626168058645, -2532.3223209688904, -2341.457364538196, -2907.462750108906], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648138521194067, "mean_inference_ms": 0.36942809306027796, "mean_action_processing_ms": 0.09077560948459158, "mean_env_wait_ms": 0.9148000343482607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003810882568359375, "StateBufferConnector_ms": 0.002781391143798828, "ViewRequirementAgentConnector_ms": 0.06749963760375977}}, "episode_reward_max": -2194.89763232045, "episode_reward_min": -2907.462750108906, "episode_reward_mean": -2396.133346802595, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2227.303378441254, -2413.465459052926, -2468.046920834079, -2365.7242172790334, -2265.084105598945, -2372.655210935445, -2666.853770620397, -2248.4925773652103, -2771.3925500806677, -2340.7703795062575, -2625.29361219692, -2439.485620274604, -2408.665657594906, -2381.2163050791564, -2335.3597222643757, -2230.320404920529, -2312.163985584676, -2603.546066654287, -2681.272527198514, -2564.5124805893456, -2314.833013777883, -2416.8661511896794, -2464.6314784749707, -2411.0126294155775, -2195.0905067122744, -2369.870590088613, -2302.523617958756, -2259.001431836493, -2338.246596170608, -2401.7815802212313, -2229.782187090009, -2396.060264797741, -2303.9530884748556, -2440.39093502762, -2234.286701317839, -2233.22814509553, -2374.2291691163723, -2331.38478581183, -2557.520654304027, -2378.7082075196645, -2352.394528633401, -2494.6807967244968, -2451.6993188071833, -2574.1287632029002, -2195.1103077459143, -2663.313349505165, -2327.9421928190714, -2304.6702055580613, -2443.690772561707, -2394.186031799248, -2370.981012073776, -2375.2862592171277, -2404.7915110903614, -2194.89763232045, -2294.656108099814, -2575.421252560736, -2363.174567070493, -2326.3919904389686, -2275.877508768658, -2398.1895487741876, -2337.6118027392527, -2562.71519022079, -2430.473800483682, -2502.118225109876, -2403.95638014564, -2522.0791340481496, -2479.57071249794, -2421.216539863975, -2409.102765719685, -2314.475064837061, -2426.8979460866362, -2333.258837250583, -2288.300704972117, -2331.1113149220473, -2470.1600713697426, -2392.613365766193, -2396.540303812744, -2326.3913025884635, -2408.1101539794145, -2326.220525966307, -2317.7042914618496, -2365.688373272492, -2549.377022700192, -2309.8733457589324, -2516.910057992273, -2696.307177708244, -2324.9853050245597, -2277.271287713669, -2266.693844497868, -2228.081829785138, -2228.0052627561377, -2231.3739512892075, -2195.1654934428893, -2350.6148219151382, -2408.9409093122936, -2465.038615328848, -2560.626168058645, -2532.3223209688904, -2341.457364538196, -2907.462750108906], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648138521194067, "mean_inference_ms": 0.36942809306027796, "mean_action_processing_ms": 0.09077560948459158, "mean_env_wait_ms": 0.9148000343482607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003810882568359375, "StateBufferConnector_ms": 0.002781391143798828, "ViewRequirementAgentConnector_ms": 0.06749963760375977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278040, "num_agent_steps_trained": 278040, "num_env_steps_sampled": 278040, "num_env_steps_trained": 278040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.68647771899433, "num_env_steps_trained_throughput_per_sec": 111.68647771899433, "timesteps_total": 278040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 278040, "timers": {"training_iteration_time_ms": 3223.261, "sample_time_ms": 3212.442, "load_time_ms": 0.304, "load_throughput": 1184831.638, "learn_time_ms": 9.749, "learn_throughput": 36927.65, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 278040, "num_env_steps_trained": 278040, "num_agent_steps_sampled": 278040, "num_agent_steps_trained": 278040}, "done": false, "episodes_total": 1253, "training_iteration": 270, "trial_id": "73eff_00000", "date": "2023-08-04_09-11-54", "timestamp": 1691129514, "time_this_iter_s": 12.896040916442871, "time_total_s": 3162.7939264774323, "pid": 35730, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14d737b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1432.9631996154785, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 24.105263157894733, "ram_util_percent": 63.01052631578946}}
