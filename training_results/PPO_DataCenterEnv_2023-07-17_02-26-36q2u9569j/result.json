{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.394817727776438, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.039647453833968, "policy_loss": 0.002665608324833079, "vf_loss": 10.0, "vf_explained_var": 1.8456811679082708e-09, "kl": 0.01082230534190841, "entropy": 3.309005664553485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24705.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 12859776, "num_env_steps_trained": 12859776, "num_agent_steps_sampled": 12859776, "num_agent_steps_trained": 12859776}, "sampler_results": {"episode_reward_max": -88902622.07765014, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -88902622.07765014, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014], "episode_lengths": [105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2915970686021271, "mean_inference_ms": 0.4483515132697085, "mean_action_processing_ms": 0.08954315045131679, "mean_env_wait_ms": 1.5916001957426336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006127357482910156, "StateBufferConnector_ms": 0.0026226043701171875, "ViewRequirementAgentConnector_ms": 0.06670951843261719}}, "episode_reward_max": -88902622.07765014, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -88902622.07765014, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014], "episode_lengths": [105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2915970686021271, "mean_inference_ms": 0.4483515132697085, "mean_action_processing_ms": 0.08954315045131679, "mean_env_wait_ms": 1.5916001957426336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006127357482910156, "StateBufferConnector_ms": 0.0026226043701171875, "ViewRequirementAgentConnector_ms": 0.06670951843261719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12859776, "num_agent_steps_trained": 12859776, "num_env_steps_sampled": 12859776, "num_env_steps_trained": 12859776, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 260.3990588242057, "num_env_steps_trained_throughput_per_sec": 260.3990588242057, "timesteps_total": 12859776, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 12859776, "timers": {"training_iteration_time_ms": 404794.067, "sample_time_ms": 257345.75, "load_time_ms": 1.495, "load_throughput": 70501227.242, "learn_time_ms": 147424.127, "learn_throughput": 714.998, "synch_weights_time_ms": 1.192}, "counters": {"num_env_steps_sampled": 12859776, "num_env_steps_trained": 12859776, "num_agent_steps_sampled": 12859776, "num_agent_steps_trained": 12859776}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "default", "date": "2023-07-17_02-33-23", "timestamp": 1689550403, "time_this_iter_s": 404.79706597328186, "time_total_s": 404.79706597328186, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 404.79706597328186, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.795121951219514, "ram_util_percent": 72.30226480836237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.644796859552155, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.040792946362869, "policy_loss": 0.0026999979554916784, "vf_loss": 10.0, "vf_explained_var": 1.605380717811978e-07, "kl": 0.01114745568654401, "entropy": 3.26457889412994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 74115.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 12965184, "num_env_steps_trained": 12965184, "num_agent_steps_sampled": 12965184, "num_agent_steps_trained": 12965184}, "sampler_results": {"episode_reward_max": -88191174.47704168, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -88546898.27734591, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168], "episode_lengths": [105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2921280539928317, "mean_inference_ms": 0.44879633644969863, "mean_action_processing_ms": 0.08964611939064182, "mean_env_wait_ms": 1.5719442570763897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00457763671875, "StateBufferConnector_ms": 0.002753734588623047, "ViewRequirementAgentConnector_ms": 0.06628036499023438}}, "episode_reward_max": -88191174.47704168, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -88546898.27734591, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168], "episode_lengths": [105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2921280539928317, "mean_inference_ms": 0.44879633644969863, "mean_action_processing_ms": 0.08964611939064182, "mean_env_wait_ms": 1.5719442570763897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00457763671875, "StateBufferConnector_ms": 0.002753734588623047, "ViewRequirementAgentConnector_ms": 0.06628036499023438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12965184, "num_agent_steps_trained": 12965184, "num_env_steps_sampled": 12965184, "num_env_steps_trained": 12965184, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 266.7399013860706, "num_env_steps_trained_throughput_per_sec": 266.7399013860706, "timesteps_total": 12965184, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 12965184, "timers": {"training_iteration_time_ms": 399982.761, "sample_time_ms": 253455.593, "load_time_ms": 42.431, "load_throughput": 2484214.644, "learn_time_ms": 146463.11, "learn_throughput": 719.69, "synch_weights_time_ms": 1.138}, "counters": {"num_env_steps_sampled": 12965184, "num_env_steps_trained": 12965184, "num_agent_steps_sampled": 12965184, "num_agent_steps_trained": 12965184}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "default", "date": "2023-07-17_02-39-58", "timestamp": 1689550798, "time_this_iter_s": 395.17424392700195, "time_total_s": 799.9713099002838, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 799.9713099002838, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.27745974955277, "ram_util_percent": 73.17620751341681}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.601644702455674, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.041092960522306, "policy_loss": 0.002913794866739023, "vf_loss": 10.0, "vf_explained_var": 1.8561762176865727e-07, "kl": 0.011172686743810258, "entropy": 3.257293754491553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123525.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 13070592, "num_env_steps_trained": 13070592, "num_agent_steps_sampled": 13070592, "num_agent_steps_trained": 13070592}, "sampler_results": {"episode_reward_max": -88062533.1875328, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -88385443.24740821, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328], "episode_lengths": [105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29252585883121535, "mean_inference_ms": 0.44893536942978135, "mean_action_processing_ms": 0.0896973717966018, "mean_env_wait_ms": 1.5604122452250764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003981590270996094, "StateBufferConnector_ms": 0.0028292338053385415, "ViewRequirementAgentConnector_ms": 0.0665903091430664}}, "episode_reward_max": -88062533.1875328, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -88385443.24740821, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328], "episode_lengths": [105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29252585883121535, "mean_inference_ms": 0.44893536942978135, "mean_action_processing_ms": 0.0896973717966018, "mean_env_wait_ms": 1.5604122452250764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003981590270996094, "StateBufferConnector_ms": 0.0028292338053385415, "ViewRequirementAgentConnector_ms": 0.0665903091430664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13070592, "num_agent_steps_trained": 13070592, "num_env_steps_sampled": 13070592, "num_env_steps_trained": 13070592, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 267.2697599965736, "num_env_steps_trained_throughput_per_sec": 267.2697599965736, "timesteps_total": 13070592, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 13070592, "timers": {"training_iteration_time_ms": 398117.852, "sample_time_ms": 251943.403, "load_time_ms": 55.496, "load_throughput": 1899364.589, "learn_time_ms": 146097.672, "learn_throughput": 721.49, "synch_weights_time_ms": 1.107}, "counters": {"num_env_steps_sampled": 13070592, "num_env_steps_trained": 13070592, "num_agent_steps_sampled": 13070592, "num_agent_steps_trained": 13070592}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "default", "date": "2023-07-17_02-46-33", "timestamp": 1689551193, "time_this_iter_s": 394.3910949230194, "time_total_s": 1194.3624048233032, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1194.3624048233032, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.244444444444444, "ram_util_percent": 73.14354838709676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.276757873196372, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.04022372682918, "policy_loss": 0.0025592504424339444, "vf_loss": 10.0, "vf_explained_var": 9.336975320006546e-08, "kl": 0.01102206869491435, "entropy": 3.247262796769859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 13176000, "num_env_steps_trained": 13176000, "num_agent_steps_sampled": 13176000, "num_agent_steps_trained": 13176000}, "sampler_results": {"episode_reward_max": -87019103.05182835, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -88043858.19851324, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835], "episode_lengths": [105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29264036678758665, "mean_inference_ms": 0.4489837869303387, "mean_action_processing_ms": 0.08972464329679132, "mean_env_wait_ms": 1.5531835119391286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037610530853271484, "StateBufferConnector_ms": 0.0028192996978759766, "ViewRequirementAgentConnector_ms": 0.06682276725769043}}, "episode_reward_max": -87019103.05182835, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -88043858.19851324, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835], "episode_lengths": [105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29264036678758665, "mean_inference_ms": 0.4489837869303387, "mean_action_processing_ms": 0.08972464329679132, "mean_env_wait_ms": 1.5531835119391286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037610530853271484, "StateBufferConnector_ms": 0.0028192996978759766, "ViewRequirementAgentConnector_ms": 0.06682276725769043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13176000, "num_agent_steps_trained": 13176000, "num_env_steps_sampled": 13176000, "num_env_steps_trained": 13176000, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 266.69917216827935, "num_env_steps_trained_throughput_per_sec": 266.69917216827935, "timesteps_total": 13176000, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 13176000, "timers": {"training_iteration_time_ms": 397396.339, "sample_time_ms": 251276.448, "load_time_ms": 59.285, "load_throughput": 1777986.347, "learn_time_ms": 146039.393, "learn_throughput": 721.778, "synch_weights_time_ms": 1.096}, "counters": {"num_env_steps_sampled": 13176000, "num_env_steps_trained": 13176000, "num_agent_steps_sampled": 13176000, "num_agent_steps_trained": 13176000}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "default", "date": "2023-07-17_02-53-08", "timestamp": 1689551588, "time_this_iter_s": 395.2344870567322, "time_total_s": 1589.5968918800354, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1589.5968918800354, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.489605734767025, "ram_util_percent": 73.115770609319}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.112963589252043, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.041126611077866, "policy_loss": 0.0028884550571242605, "vf_loss": 10.0, "vf_explained_var": 1.0277910817371546e-07, "kl": 0.011189950490176018, "entropy": 3.1929473357170703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 222345.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 13281408, "num_env_steps_trained": 13281408, "num_agent_steps_sampled": 13281408, "num_agent_steps_trained": 13281408}, "sampler_results": {"episode_reward_max": -87019103.05182835, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -87991970.15544222, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816], "episode_lengths": [105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2924907898427837, "mean_inference_ms": 0.5709728368478175, "mean_action_processing_ms": 0.08979020082779055, "mean_env_wait_ms": 1.6832512494527492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036668777465820312, "StateBufferConnector_ms": 0.0028085708618164062, "ViewRequirementAgentConnector_ms": 0.06737709045410156}}, "episode_reward_max": -87019103.05182835, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -87991970.15544222, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816], "episode_lengths": [105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2924907898427837, "mean_inference_ms": 0.5709728368478175, "mean_action_processing_ms": 0.08979020082779055, "mean_env_wait_ms": 1.6832512494527492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036668777465820312, "StateBufferConnector_ms": 0.0028085708618164062, "ViewRequirementAgentConnector_ms": 0.06737709045410156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13281408, "num_agent_steps_trained": 13281408, "num_env_steps_sampled": 13281408, "num_env_steps_trained": 13281408, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 98.13050743048414, "num_env_steps_trained_throughput_per_sec": 98.13050743048414, "timesteps_total": 13281408, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 13281408, "timers": {"training_iteration_time_ms": 532749.341, "sample_time_ms": 386350.315, "load_time_ms": 65.792, "load_throughput": 1602148.489, "learn_time_ms": 146312.037, "learn_throughput": 720.433, "synch_weights_time_ms": 1.142}, "counters": {"num_env_steps_sampled": 13281408, "num_env_steps_trained": 13281408, "num_agent_steps_sampled": 13281408, "num_agent_steps_trained": 13281408}, "done": false, "episodes_total": 5, "training_iteration": 5, "trial_id": "default", "date": "2023-07-17_03-11-02", "timestamp": 1689552662, "time_this_iter_s": 1074.168375968933, "time_total_s": 2663.7652678489685, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2663.7652678489685, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.26934046345811, "ram_util_percent": 73.94670231729054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.541516016194802, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.04181593786763, "policy_loss": 0.002635423763004086, "vf_loss": 10.0, "vf_explained_var": -7.831478524222545e-08, "kl": 0.011465719288587283, "entropy": 3.2207357506548386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 271755.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 13386816, "num_env_steps_trained": 13386816, "num_agent_steps_sampled": 13386816, "num_agent_steps_trained": 13386816}, "sampler_results": {"episode_reward_max": -87019103.05182835, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -87984387.57432835, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2923522343418571, "mean_inference_ms": 0.6352726005682996, "mean_action_processing_ms": 0.08981474895359713, "mean_env_wait_ms": 1.7506025566317913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035802523295084634, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.06714661916097005}}, "episode_reward_max": -87019103.05182835, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -87984387.57432835, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2923522343418571, "mean_inference_ms": 0.6352726005682996, "mean_action_processing_ms": 0.08981474895359713, "mean_env_wait_ms": 1.7506025566317913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035802523295084634, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.06714661916097005}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13386816, "num_agent_steps_trained": 13386816, "num_env_steps_sampled": 13386816, "num_env_steps_trained": 13386816, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 265.5881963743835, "num_env_steps_trained_throughput_per_sec": 265.5881963743835, "timesteps_total": 13386816, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 13386816, "timers": {"training_iteration_time_ms": 510105.299, "sample_time_ms": 363296.699, "load_time_ms": 67.112, "load_throughput": 1570638.229, "learn_time_ms": 146720.343, "learn_throughput": 718.428, "synch_weights_time_ms": 1.126}, "counters": {"num_env_steps_sampled": 13386816, "num_env_steps_trained": 13386816, "num_agent_steps_sampled": 13386816, "num_agent_steps_trained": 13386816}, "done": false, "episodes_total": 6, "training_iteration": 6, "trial_id": "default", "date": "2023-07-17_03-17-39", "timestamp": 1689553059, "time_this_iter_s": 396.88781809806824, "time_total_s": 3060.6530859470367, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3060.6530859470367, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.566370106761564, "ram_util_percent": 73.70480427046263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.6630483511343, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.041608949291653, "policy_loss": 0.0027335549039141636, "vf_loss": 10.0, "vf_explained_var": 1.1066849042085278e-07, "kl": 0.011376431087785962, "entropy": 3.2599970529736164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 321165.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 13492224, "num_env_steps_trained": 13492224, "num_agent_steps_sampled": 13492224, "num_agent_steps_trained": 13492224}, "sampler_results": {"episode_reward_max": -87019103.05182835, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -88009349.26955006, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29224005973772815, "mean_inference_ms": 0.6707582357731805, "mean_action_processing_ms": 0.08981616987851193, "mean_env_wait_ms": 1.7871814122480385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035115650721958707, "StateBufferConnector_ms": 0.0028371810913085938, "ViewRequirementAgentConnector_ms": 0.06710120609828404}}, "episode_reward_max": -87019103.05182835, "episode_reward_min": -88902622.07765014, "episode_reward_mean": -88009349.26955006, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29224005973772815, "mean_inference_ms": 0.6707582357731805, "mean_action_processing_ms": 0.08981616987851193, "mean_env_wait_ms": 1.7871814122480385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035115650721958707, "StateBufferConnector_ms": 0.0028371810913085938, "ViewRequirementAgentConnector_ms": 0.06710120609828404}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13492224, "num_agent_steps_trained": 13492224, "num_env_steps_sampled": 13492224, "num_env_steps_trained": 13492224, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 266.70700884320655, "num_env_steps_trained_throughput_per_sec": 266.70700884320655, "timesteps_total": 13492224, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 13492224, "timers": {"training_iteration_time_ms": 493693.141, "sample_time_ms": 347055.788, "load_time_ms": 71.476, "load_throughput": 1474740.865, "learn_time_ms": 146544.737, "learn_throughput": 719.289, "synch_weights_time_ms": 1.12}, "counters": {"num_env_steps_sampled": 13492224, "num_env_steps_trained": 13492224, "num_agent_steps_sampled": 13492224, "num_agent_steps_trained": 13492224}, "done": false, "episodes_total": 7, "training_iteration": 7, "trial_id": "default", "date": "2023-07-17_03-24-14", "timestamp": 1689553454, "time_this_iter_s": 395.2235321998596, "time_total_s": 3455.8766181468964, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3455.8766181468964, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.544982078853042, "ram_util_percent": 73.19103942652329}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.6623531003588, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.040839983702334, "policy_loss": 0.0026583773493924173, "vf_loss": 10.0, "vf_explained_var": 6.774735581028005e-08, "kl": 0.011173400666019594, "entropy": 3.348776656856085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 370575.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 13597632, "num_env_steps_trained": 13597632, "num_agent_steps_sampled": 13597632, "num_agent_steps_trained": 13597632}, "sampler_results": {"episode_reward_max": -87019103.05182835, "episode_reward_min": -89695536.36616285, "episode_reward_mean": -88220122.65662664, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920986114973795, "mean_inference_ms": 0.6905566583080984, "mean_action_processing_ms": 0.08980737773735775, "mean_env_wait_ms": 1.8064690676517468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035375356674194336, "StateBufferConnector_ms": 0.0028878450393676758, "ViewRequirementAgentConnector_ms": 0.0689774751663208}}, "episode_reward_max": -87019103.05182835, "episode_reward_min": -89695536.36616285, "episode_reward_mean": -88220122.65662664, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920986114973795, "mean_inference_ms": 0.6905566583080984, "mean_action_processing_ms": 0.08980737773735775, "mean_env_wait_ms": 1.8064690676517468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035375356674194336, "StateBufferConnector_ms": 0.0028878450393676758, "ViewRequirementAgentConnector_ms": 0.0689774751663208}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13597632, "num_agent_steps_trained": 13597632, "num_env_steps_sampled": 13597632, "num_env_steps_trained": 13597632, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 266.5695528076137, "num_env_steps_trained_throughput_per_sec": 266.5695528076137, "timesteps_total": 13597632, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 13597632, "timers": {"training_iteration_time_ms": 481409.496, "sample_time_ms": 334493.479, "load_time_ms": 75.191, "load_throughput": 1401866.736, "learn_time_ms": 146819.607, "learn_throughput": 717.942, "synch_weights_time_ms": 1.122}, "counters": {"num_env_steps_sampled": 13597632, "num_env_steps_trained": 13597632, "num_agent_steps_sampled": 13597632, "num_agent_steps_trained": 13597632}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "default", "date": "2023-07-17_03-30-50", "timestamp": 1689553850, "time_this_iter_s": 395.43079829216003, "time_total_s": 3851.3074164390564, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3851.3074164390564, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.53482142857143, "ram_util_percent": 74.62464285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.22666761555717, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.04020312294934, "policy_loss": 0.002623036320455937, "vf_loss": 10.0, "vf_explained_var": 7.47319923868741e-08, "kl": 0.010997373419859525, "entropy": 3.3377936004265387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 419985.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 13703040, "num_env_steps_trained": 13703040, "num_agent_steps_sampled": 13703040, "num_agent_steps_trained": 13703040}, "sampler_results": {"episode_reward_max": -87019103.05182835, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88406495.34147061, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29203877781617416, "mean_inference_ms": 0.7013037420181962, "mean_action_processing_ms": 0.08981383382063123, "mean_env_wait_ms": 1.8160087297296705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034835603502061632, "StateBufferConnector_ms": 0.0028954611884223092, "ViewRequirementAgentConnector_ms": 0.06895065307617188}}, "episode_reward_max": -87019103.05182835, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88406495.34147061, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29203877781617416, "mean_inference_ms": 0.7013037420181962, "mean_action_processing_ms": 0.08981383382063123, "mean_env_wait_ms": 1.8160087297296705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034835603502061632, "StateBufferConnector_ms": 0.0028954611884223092, "ViewRequirementAgentConnector_ms": 0.06895065307617188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13703040, "num_agent_steps_trained": 13703040, "num_env_steps_sampled": 13703040, "num_env_steps_trained": 13703040, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 266.684270258044, "num_env_steps_trained_throughput_per_sec": 266.684270258044, "timesteps_total": 13703040, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 13703040, "timers": {"training_iteration_time_ms": 471836.651, "sample_time_ms": 324964.022, "load_time_ms": 76.858, "load_throughput": 1371463.479, "learn_time_ms": 146774.596, "learn_throughput": 718.162, "synch_weights_time_ms": 1.125}, "counters": {"num_env_steps_sampled": 13703040, "num_env_steps_trained": 13703040, "num_agent_steps_sampled": 13703040, "num_agent_steps_trained": 13703040}, "done": false, "episodes_total": 9, "training_iteration": 9, "trial_id": "default", "date": "2023-07-17_03-37-25", "timestamp": 1689554245, "time_this_iter_s": 395.2574999332428, "time_total_s": 4246.564916372299, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4246.564916372299, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.511051693404635, "ram_util_percent": 75.56969696969696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.732406719899616, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.03934515704271, "policy_loss": 0.0026176101256166076, "vf_loss": 10.0, "vf_explained_var": 1.0397337245883259e-07, "kl": 0.010747886669091386, "entropy": 3.349964527518275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 469395.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 13808448, "num_env_steps_trained": 13808448, "num_agent_steps_sampled": 13808448, "num_agent_steps_trained": 13808448}, "sampler_results": {"episode_reward_max": -87019103.05182835, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88345168.2117157, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920225603071399, "mean_inference_ms": 0.7065460450300102, "mean_action_processing_ms": 0.08982653870214971, "mean_env_wait_ms": 1.8197425280816326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.002911090850830078, "ViewRequirementAgentConnector_ms": 0.06874322891235352}}, "episode_reward_max": -87019103.05182835, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88345168.2117157, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920225603071399, "mean_inference_ms": 0.7065460450300102, "mean_action_processing_ms": 0.08982653870214971, "mean_env_wait_ms": 1.8197425280816326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.002911090850830078, "ViewRequirementAgentConnector_ms": 0.06874322891235352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13808448, "num_agent_steps_trained": 13808448, "num_env_steps_sampled": 13808448, "num_env_steps_trained": 13808448, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 266.43147106499754, "num_env_steps_trained_throughput_per_sec": 266.43147106499754, "timesteps_total": 13808448, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 13808448, "timers": {"training_iteration_time_ms": 464215.878, "sample_time_ms": 317360.392, "load_time_ms": 78.377, "load_throughput": 1344876.832, "learn_time_ms": 146755.964, "learn_throughput": 718.254, "synch_weights_time_ms": 1.117}, "counters": {"num_env_steps_sampled": 13808448, "num_env_steps_trained": 13808448, "num_agent_steps_sampled": 13808448, "num_agent_steps_trained": 13808448}, "done": false, "episodes_total": 10, "training_iteration": 10, "trial_id": "default", "date": "2023-07-17_03-44-01", "timestamp": 1689554641, "time_this_iter_s": 395.6318681240082, "time_total_s": 4642.196784496307, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4642.196784496307, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.00338078291815, "ram_util_percent": 74.81868327402135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.160085215317144, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.038838909251853, "policy_loss": 0.0024889912541470917, "vf_loss": 10.0, "vf_explained_var": 1.0107818631309412e-07, "kl": 0.01063737816418561, "entropy": 3.4204663426112223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 518805.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 13913856, "num_env_steps_trained": 13913856, "num_agent_steps_sampled": 13913856, "num_agent_steps_trained": 13913856}, "sampler_results": {"episode_reward_max": -87019103.05182835, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88284471.1693647, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144, -87677500.74585482], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29201236815424175, "mean_inference_ms": 0.7083208210631732, "mean_action_processing_ms": 0.08983738947183886, "mean_env_wait_ms": 1.819947797012568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034223903309215198, "StateBufferConnector_ms": 0.0029043717817826705, "ViewRequirementAgentConnector_ms": 0.06853450428355824}}, "episode_reward_max": -87019103.05182835, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88284471.1693647, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144, -87677500.74585482], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29201236815424175, "mean_inference_ms": 0.7083208210631732, "mean_action_processing_ms": 0.08983738947183886, "mean_env_wait_ms": 1.819947797012568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034223903309215198, "StateBufferConnector_ms": 0.0029043717817826705, "ViewRequirementAgentConnector_ms": 0.06853450428355824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13913856, "num_agent_steps_trained": 13913856, "num_env_steps_sampled": 13913856, "num_env_steps_trained": 13913856, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 267.11993992471207, "num_env_steps_trained_throughput_per_sec": 267.11993992471207, "timesteps_total": 13913856, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 13913856, "timers": {"training_iteration_time_ms": 463197.393, "sample_time_ms": 316520.544, "load_time_ms": 85.95, "load_throughput": 1226390.254, "learn_time_ms": 146569.956, "learn_throughput": 719.165, "synch_weights_time_ms": 1.114}, "counters": {"num_env_steps_sampled": 13913856, "num_env_steps_trained": 13913856, "num_agent_steps_sampled": 13913856, "num_agent_steps_trained": 13913856}, "done": false, "episodes_total": 11, "training_iteration": 11, "trial_id": "default", "date": "2023-07-17_03-50-35", "timestamp": 1689555035, "time_this_iter_s": 394.61170196533203, "time_total_s": 5036.808486461639, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5036.808486461639, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.4, "ram_util_percent": 74.95589285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.268766582721497, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.038751815244076, "policy_loss": 0.0025308729332847797, "vf_loss": 10.0, "vf_explained_var": 3.365291996152747e-07, "kl": 0.010599635997925069, "entropy": 3.403450934014999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 568215.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 14019264, "num_env_steps_trained": 14019264, "num_agent_steps_sampled": 14019264, "num_agent_steps_trained": 14019264}, "sampler_results": {"episode_reward_max": -86732401.4044001, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88155132.02228433, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144, -87677500.74585482, -86732401.4044001], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920054179824221, "mean_inference_ms": 0.7078837851260592, "mean_action_processing_ms": 0.08984717962281658, "mean_env_wait_ms": 1.8177072776647298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003645817438761393, "StateBufferConnector_ms": 0.0029027462005615234, "ViewRequirementAgentConnector_ms": 0.06838639577229817}}, "episode_reward_max": -86732401.4044001, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88155132.02228433, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144, -87677500.74585482, -86732401.4044001], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920054179824221, "mean_inference_ms": 0.7078837851260592, "mean_action_processing_ms": 0.08984717962281658, "mean_env_wait_ms": 1.8177072776647298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003645817438761393, "StateBufferConnector_ms": 0.0029027462005615234, "ViewRequirementAgentConnector_ms": 0.06838639577229817}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14019264, "num_agent_steps_trained": 14019264, "num_env_steps_sampled": 14019264, "num_env_steps_trained": 14019264, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 268.5887218244002, "num_env_steps_trained_throughput_per_sec": 268.5887218244002, "timesteps_total": 14019264, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 14019264, "timers": {"training_iteration_time_ms": 462925.379, "sample_time_ms": 316103.152, "load_time_ms": 87.574, "load_throughput": 1203643.864, "learn_time_ms": 146713.656, "learn_throughput": 718.461, "synch_weights_time_ms": 1.119}, "counters": {"num_env_steps_sampled": 14019264, "num_env_steps_trained": 14019264, "num_agent_steps_sampled": 14019264, "num_agent_steps_trained": 14019264}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "default", "date": "2023-07-17_03-57-08", "timestamp": 1689555428, "time_this_iter_s": 392.45475578308105, "time_total_s": 5429.2632422447205, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5429.2632422447205, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.391187050359715, "ram_util_percent": 74.93741007194244}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.369043185100022, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.040283424276206, "policy_loss": 0.002519162085235358, "vf_loss": 10.0, "vf_explained_var": -2.1424377478464632e-07, "kl": 0.011051271266600509, "entropy": 3.478680761066484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 617625.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 14124672, "num_env_steps_trained": 14124672, "num_agent_steps_sampled": 14124672, "num_agent_steps_trained": 14124672}, "sampler_results": {"episode_reward_max": -86732401.4044001, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88082998.99116468, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144, -87677500.74585482, -86732401.4044001, -87217402.61772895], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920064223618505, "mean_inference_ms": 0.7060168785727643, "mean_action_processing_ms": 0.0898550968585741, "mean_env_wait_ms": 1.8142022368103183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036001205444335938, "StateBufferConnector_ms": 0.0028885327852689303, "ViewRequirementAgentConnector_ms": 0.06825006925142728}}, "episode_reward_max": -86732401.4044001, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88082998.99116468, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144, -87677500.74585482, -86732401.4044001, -87217402.61772895], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920064223618505, "mean_inference_ms": 0.7060168785727643, "mean_action_processing_ms": 0.0898550968585741, "mean_env_wait_ms": 1.8142022368103183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036001205444335938, "StateBufferConnector_ms": 0.0028885327852689303, "ViewRequirementAgentConnector_ms": 0.06825006925142728}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14124672, "num_agent_steps_trained": 14124672, "num_env_steps_sampled": 14124672, "num_env_steps_trained": 14124672, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 266.62861794977994, "num_env_steps_trained_throughput_per_sec": 266.62861794977994, "timesteps_total": 14124672, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 14124672, "timers": {"training_iteration_time_ms": 463020.214, "sample_time_ms": 316240.995, "load_time_ms": 89.168, "load_throughput": 1182132.54, "learn_time_ms": 146669.009, "learn_throughput": 718.679, "synch_weights_time_ms": 1.113}, "counters": {"num_env_steps_sampled": 14124672, "num_env_steps_trained": 14124672, "num_agent_steps_sampled": 14124672, "num_agent_steps_trained": 14124672}, "done": false, "episodes_total": 13, "training_iteration": 13, "trial_id": "default", "date": "2023-07-17_04-03-43", "timestamp": 1689555823, "time_this_iter_s": 395.33945775032043, "time_total_s": 5824.602699995041, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5824.602699995041, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.159212880143112, "ram_util_percent": 74.87996422182468}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.112583942168204, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.039743390480918, "policy_loss": 0.002376588618192108, "vf_loss": 10.0, "vf_explained_var": -2.6961420982189446e-08, "kl": 0.010934958077134379, "entropy": 3.4851473271038533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 667035.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 14230080, "num_env_steps_trained": 14230080, "num_agent_steps_sampled": 14230080, "num_agent_steps_trained": 14230080}, "sampler_results": {"episode_reward_max": -86732401.4044001, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88025329.85978158, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144, -87677500.74585482, -86732401.4044001, -87217402.61772895, -87275631.15180103], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920337824306, "mean_inference_ms": 0.7032285429200934, "mean_action_processing_ms": 0.08986214980090457, "mean_env_wait_ms": 1.8099614892391422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035694667271205355, "StateBufferConnector_ms": 0.002876349857875279, "ViewRequirementAgentConnector_ms": 0.06815024784633092}}, "episode_reward_max": -86732401.4044001, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -88025329.85978158, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144, -87677500.74585482, -86732401.4044001, -87217402.61772895, -87275631.15180103], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920337824306, "mean_inference_ms": 0.7032285429200934, "mean_action_processing_ms": 0.08986214980090457, "mean_env_wait_ms": 1.8099614892391422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035694667271205355, "StateBufferConnector_ms": 0.002876349857875279, "ViewRequirementAgentConnector_ms": 0.06815024784633092}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14230080, "num_agent_steps_trained": 14230080, "num_env_steps_sampled": 14230080, "num_env_steps_trained": 14230080, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 265.1936623329721, "num_env_steps_trained_throughput_per_sec": 265.1936623329721, "timesteps_total": 14230080, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 14230080, "timers": {"training_iteration_time_ms": 463244.588, "sample_time_ms": 316493.299, "load_time_ms": 91.267, "load_throughput": 1154943.541, "learn_time_ms": 146639.03, "learn_throughput": 718.826, "synch_weights_time_ms": 1.107}, "counters": {"num_env_steps_sampled": 14230080, "num_env_steps_trained": 14230080, "num_agent_steps_sampled": 14230080, "num_agent_steps_trained": 14230080}, "done": false, "episodes_total": 14, "training_iteration": 14, "trial_id": "default", "date": "2023-07-17_04-10-21", "timestamp": 1689556221, "time_this_iter_s": 397.47801399230957, "time_total_s": 6222.0807139873505, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6222.0807139873505, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.271174377224195, "ram_util_percent": 74.88362989323844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.608710708073628, "cur_kl_coeff": 3.417187499999998, "cur_lr": 0.0010000000000000007, "total_loss": 10.043162333675783, "policy_loss": 0.0030165954432652153, "vf_loss": 10.0, "vf_explained_var": -3.213656621769695e-08, "kl": 0.011748182854721212, "entropy": 3.5390055310506616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 716445.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 14335488, "num_env_steps_trained": 14335488, "num_agent_steps_sampled": 14335488, "num_agent_steps_trained": 14335488}, "sampler_results": {"episode_reward_max": -86732401.4044001, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -87996156.30755463, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144, -87677500.74585482, -86732401.4044001, -87217402.61772895, -87275631.15180103, -87587726.57637742], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920687691711101, "mean_inference_ms": 0.699846285168, "mean_action_processing_ms": 0.08986771775633848, "mean_env_wait_ms": 1.8052248874186967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035429000854492188, "StateBufferConnector_ms": 0.0028626124064127603, "ViewRequirementAgentConnector_ms": 0.06802082061767578}}, "episode_reward_max": -86732401.4044001, "episode_reward_min": -89897476.8202224, "episode_reward_mean": -87996156.30755463, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88902622.07765014, -88191174.47704168, -88062533.1875328, -87019103.05182835, -87784417.98315816, -87946474.6687589, -88159119.44088036, -89695536.36616285, -89897476.8202224, -87793224.04392144, -87677500.74585482, -86732401.4044001, -87217402.61772895, -87275631.15180103, -87587726.57637742], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2920687691711101, "mean_inference_ms": 0.699846285168, "mean_action_processing_ms": 0.08986771775633848, "mean_env_wait_ms": 1.8052248874186967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035429000854492188, "StateBufferConnector_ms": 0.0028626124064127603, "ViewRequirementAgentConnector_ms": 0.06802082061767578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14335488, "num_agent_steps_trained": 14335488, "num_env_steps_sampled": 14335488, "num_env_steps_trained": 14335488, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 266.627830042992, "num_env_steps_trained_throughput_per_sec": 266.627830042992, "timesteps_total": 14335488, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 14335488, "timers": {"training_iteration_time_ms": 395362.208, "sample_time_ms": 248830.839, "load_time_ms": 90.373, "load_throughput": 1166364.939, "learn_time_ms": 146419.894, "learn_throughput": 719.902, "synch_weights_time_ms": 1.101}, "counters": {"num_env_steps_sampled": 14335488, "num_env_steps_trained": 14335488, "num_agent_steps_sampled": 14335488, "num_agent_steps_trained": 14335488}, "done": false, "episodes_total": 15, "training_iteration": 15, "trial_id": "default", "date": "2023-07-17_04-16-56", "timestamp": 1689556616, "time_this_iter_s": 395.3410859107971, "time_total_s": 6617.421799898148, "pid": 67363, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x151db6c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6617.421799898148, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.35813953488372, "ram_util_percent": 74.85813953488372}}
