{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.6947110790553, "policy_loss": 6861.964590089314, "vf_loss": 338459.480915748}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.5, "diff_num_grad_updates_vs_sampler_policy": 342.5}}, "num_env_steps_sampled": 3802200, "num_env_steps_trained": 3802200, "num_agent_steps_sampled": 3802200, "num_agent_steps_trained": 3802200}, "sampler_results": {"episode_reward_max": 89881.18135309684, "episode_reward_min": 89881.18135309684, "episode_reward_mean": 89881.18135309684, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22745427205717245, "mean_inference_ms": 0.39465743708661016, "mean_action_processing_ms": 0.09376068334105464, "mean_env_wait_ms": 1.6835115529190188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030755996704101562, "StateBufferConnector_ms": 0.0029087066650390625, "ViewRequirementAgentConnector_ms": 0.06496906280517578}}, "episode_reward_max": 89881.18135309684, "episode_reward_min": 89881.18135309684, "episode_reward_mean": 89881.18135309684, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22745427205717245, "mean_inference_ms": 0.39465743708661016, "mean_action_processing_ms": 0.09376068334105464, "mean_env_wait_ms": 1.6835115529190188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030755996704101562, "StateBufferConnector_ms": 0.0029087066650390625, "ViewRequirementAgentConnector_ms": 0.06496906280517578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3802200, "num_agent_steps_trained": 3802200, "num_env_steps_sampled": 3802200, "num_env_steps_trained": 3802200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 408.88843047892493, "num_env_steps_trained_throughput_per_sec": 408.88843047892493, "timesteps_total": 3802200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3802200, "timers": {"training_iteration_time_ms": 107413.103, "sample_time_ms": 106269.601, "load_time_ms": 1.763, "load_throughput": 24910592.519, "learn_time_ms": 1139.804, "learn_throughput": 38532.937, "synch_weights_time_ms": 1.504}, "counters": {"num_env_steps_sampled": 3802200, "num_env_steps_trained": 3802200, "num_agent_steps_sampled": 3802200, "num_agent_steps_trained": 3802200}, "done": false, "episodes_total": 1160, "training_iteration": 541, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-26-52", "timestamp": 1690237612, "time_this_iter_s": 107.41623020172119, "time_total_s": 7059.965759277344, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 107.41623020172119, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 24.949019607843137, "ram_util_percent": 79.86993464052289}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.123861566484518e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 69.53818642085217, "policy_loss": 6966.512977622341, "vf_loss": 303135.28782044345}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1029.5, "diff_num_grad_updates_vs_sampler_policy": 1028.5}}, "num_env_steps_sampled": 3846120, "num_env_steps_trained": 3846120, "num_agent_steps_sampled": 3846120, "num_agent_steps_trained": 3846120}, "sampler_results": {"episode_reward_max": 90238.15012589388, "episode_reward_min": 89881.18135309684, "episode_reward_mean": 90059.66573949537, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22503198018622264, "mean_inference_ms": 0.3892408537975872, "mean_action_processing_ms": 0.09289739244212952, "mean_env_wait_ms": 1.6695040904452219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031948089599609375, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.0653982162475586}}, "episode_reward_max": 90238.15012589388, "episode_reward_min": 89881.18135309684, "episode_reward_mean": 90059.66573949537, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22503198018622264, "mean_inference_ms": 0.3892408537975872, "mean_action_processing_ms": 0.09289739244212952, "mean_env_wait_ms": 1.6695040904452219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031948089599609375, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.0653982162475586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3846120, "num_agent_steps_trained": 3846120, "num_env_steps_sampled": 3846120, "num_env_steps_trained": 3846120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 424.4622912546294, "num_env_steps_trained_throughput_per_sec": 424.4622912546294, "timesteps_total": 3846120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3846120, "timers": {"training_iteration_time_ms": 105442.576, "sample_time_ms": 104273.632, "load_time_ms": 36.75, "load_throughput": 1195103.374, "learn_time_ms": 1130.59, "learn_throughput": 38846.983, "synch_weights_time_ms": 1.292}, "counters": {"num_env_steps_sampled": 3846120, "num_env_steps_trained": 3846120, "num_agent_steps_sampled": 3846120, "num_agent_steps_trained": 3846120}, "done": false, "episodes_total": 1161, "training_iteration": 542, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-28-35", "timestamp": 1690237715, "time_this_iter_s": 103.47504830360413, "time_total_s": 7163.440807580948, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 210.89127850532532, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 21.19047619047619, "ram_util_percent": 79.64693877551022}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.923861566484518e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.66852044642145, "policy_loss": 5340.6917502066835, "vf_loss": 197911.0440689843}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1715.5, "diff_num_grad_updates_vs_sampler_policy": 1714.5}}, "num_env_steps_sampled": 3890040, "num_env_steps_trained": 3890040, "num_agent_steps_sampled": 3890040, "num_agent_steps_trained": 3890040}, "sampler_results": {"episode_reward_max": 90238.15012589388, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 88783.20221736107, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22413757662709324, "mean_inference_ms": 0.3866066205374558, "mean_action_processing_ms": 0.09245594656426544, "mean_env_wait_ms": 1.6607093471417045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003258387247721354, "StateBufferConnector_ms": 0.0028371810913085938, "ViewRequirementAgentConnector_ms": 0.06817181905110677}}, "episode_reward_max": 90238.15012589388, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 88783.20221736107, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22413757662709324, "mean_inference_ms": 0.3866066205374558, "mean_action_processing_ms": 0.09245594656426544, "mean_env_wait_ms": 1.6607093471417045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003258387247721354, "StateBufferConnector_ms": 0.0028371810913085938, "ViewRequirementAgentConnector_ms": 0.06817181905110677}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3890040, "num_agent_steps_trained": 3890040, "num_env_steps_sampled": 3890040, "num_env_steps_trained": 3890040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 424.6599078902519, "num_env_steps_trained_throughput_per_sec": 424.6599078902519, "timesteps_total": 3890040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3890040, "timers": {"training_iteration_time_ms": 104769.68, "sample_time_ms": 103603.266, "load_time_ms": 36.806, "load_throughput": 1193282.825, "learn_time_ms": 1127.968, "learn_throughput": 38937.281, "synch_weights_time_ms": 1.367}, "counters": {"num_env_steps_sampled": 3890040, "num_env_steps_trained": 3890040, "num_agent_steps_sampled": 3890040, "num_agent_steps_trained": 3890040}, "done": false, "episodes_total": 1162, "training_iteration": 543, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-30-19", "timestamp": 1690237819, "time_this_iter_s": 103.42693877220154, "time_total_s": 7266.867746353149, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 314.31821727752686, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.49727891156462, "ram_util_percent": 80.54489795918367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.723861566484515e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 71.28678231197613, "policy_loss": 5640.212994811834, "vf_loss": 187352.14424867326}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2401.5, "diff_num_grad_updates_vs_sampler_policy": 2400.5}}, "num_env_steps_sampled": 3933960, "num_env_steps_trained": 3933960, "num_agent_steps_sampled": 3933960, "num_agent_steps_trained": 3933960}, "sampler_results": {"episode_reward_max": 91630.42196402462, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 89495.00715402696, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2233715515936573, "mean_inference_ms": 0.3850695286275755, "mean_action_processing_ms": 0.0921915632323916, "mean_env_wait_ms": 1.655678631424579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031888484954833984, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.0675499439239502}}, "episode_reward_max": 91630.42196402462, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 89495.00715402696, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2233715515936573, "mean_inference_ms": 0.3850695286275755, "mean_action_processing_ms": 0.0921915632323916, "mean_env_wait_ms": 1.655678631424579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031888484954833984, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.0675499439239502}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3933960, "num_agent_steps_trained": 3933960, "num_env_steps_sampled": 3933960, "num_env_steps_trained": 3933960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 422.8079219524333, "num_env_steps_trained_throughput_per_sec": 422.8079219524333, "timesteps_total": 3933960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3933960, "timers": {"training_iteration_time_ms": 104546.493, "sample_time_ms": 103384.715, "load_time_ms": 34.207, "load_throughput": 1283954.951, "learn_time_ms": 1126.082, "learn_throughput": 39002.476, "synch_weights_time_ms": 1.246}, "counters": {"num_env_steps_sampled": 3933960, "num_env_steps_trained": 3933960, "num_agent_steps_sampled": 3933960, "num_agent_steps_trained": 3933960}, "done": false, "episodes_total": 1163, "training_iteration": 544, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-32-03", "timestamp": 1690237923, "time_this_iter_s": 103.8794298171997, "time_total_s": 7370.747176170349, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 418.19764709472656, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.781756756756756, "ram_util_percent": 80.58716216216214}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.523861566484518e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 70.14277159576861, "policy_loss": 4312.667641820435, "vf_loss": 118924.36163370116}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3087.5, "diff_num_grad_updates_vs_sampler_policy": 3086.5}}, "num_env_steps_sampled": 3977880, "num_env_steps_trained": 3977880, "num_agent_steps_sampled": 3977880, "num_agent_steps_trained": 3977880}, "sampler_results": {"episode_reward_max": 91630.42196402462, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 89477.08638186744, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22290370266094434, "mean_inference_ms": 0.38399579747627616, "mean_action_processing_ms": 0.09200129364421834, "mean_env_wait_ms": 1.6532234907968726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003795623779296875, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06733894348144531}}, "episode_reward_max": 91630.42196402462, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 89477.08638186744, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22290370266094434, "mean_inference_ms": 0.38399579747627616, "mean_action_processing_ms": 0.09200129364421834, "mean_env_wait_ms": 1.6532234907968726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003795623779296875, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06733894348144531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3977880, "num_agent_steps_trained": 3977880, "num_env_steps_sampled": 3977880, "num_env_steps_trained": 3977880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 418.2605988149741, "num_env_steps_trained_throughput_per_sec": 418.2605988149741, "timesteps_total": 3977880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3977880, "timers": {"training_iteration_time_ms": 104638.447, "sample_time_ms": 103466.342, "load_time_ms": 44.63, "load_throughput": 984090.301, "learn_time_ms": 1125.95, "learn_throughput": 39007.056, "synch_weights_time_ms": 1.252}, "counters": {"num_env_steps_sampled": 3977880, "num_env_steps_trained": 3977880, "num_agent_steps_sampled": 3977880, "num_agent_steps_trained": 3977880}, "done": false, "episodes_total": 1164, "training_iteration": 545, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-33-48", "timestamp": 1690238028, "time_this_iter_s": 105.00915884971619, "time_total_s": 7475.756335020065, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 523.2068059444427, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.591946308724832, "ram_util_percent": 80.50268456375838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.059653916211295e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.11305737842972, "policy_loss": 4030.858840986869, "vf_loss": 99042.61111672627}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.5, "diff_num_grad_updates_vs_sampler_policy": 3772.5}}, "num_env_steps_sampled": 4021800, "num_env_steps_trained": 4021800, "num_agent_steps_sampled": 4021800, "num_agent_steps_trained": 4021800}, "sampler_results": {"episode_reward_max": 93415.63006899075, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90133.51032972132, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22251707404847312, "mean_inference_ms": 0.38320691354309916, "mean_action_processing_ms": 0.09186052678819319, "mean_env_wait_ms": 1.6526080941292276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036954879760742188, "StateBufferConnector_ms": 0.002674261728922526, "ViewRequirementAgentConnector_ms": 0.06699164708455403}}, "episode_reward_max": 93415.63006899075, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90133.51032972132, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22251707404847312, "mean_inference_ms": 0.38320691354309916, "mean_action_processing_ms": 0.09186052678819319, "mean_env_wait_ms": 1.6526080941292276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036954879760742188, "StateBufferConnector_ms": 0.002674261728922526, "ViewRequirementAgentConnector_ms": 0.06699164708455403}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4021800, "num_agent_steps_trained": 4021800, "num_env_steps_sampled": 4021800, "num_env_steps_trained": 4021800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 414.29769677492067, "num_env_steps_trained_throughput_per_sec": 414.29769677492067, "timesteps_total": 4021800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4021800, "timers": {"training_iteration_time_ms": 104867.157, "sample_time_ms": 103696.171, "load_time_ms": 46.187, "load_throughput": 950922.58, "learn_time_ms": 1123.359, "learn_throughput": 39097.042, "synch_weights_time_ms": 1.186}, "counters": {"num_env_steps_sampled": 4021800, "num_env_steps_trained": 4021800, "num_agent_steps_sampled": 4021800, "num_agent_steps_trained": 4021800}, "done": false, "episodes_total": 1165, "training_iteration": 546, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-35-34", "timestamp": 1690238134, "time_this_iter_s": 106.01345682144165, "time_total_s": 7581.769791841507, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 629.2202627658844, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.934666666666665, "ram_util_percent": 80.43466666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.559653916211295e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 73.90656697576317, "policy_loss": 2924.0392682461975, "vf_loss": 49961.081224625035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4459.5, "diff_num_grad_updates_vs_sampler_policy": 4458.5}}, "num_env_steps_sampled": 4065720, "num_env_steps_trained": 4065720, "num_agent_steps_sampled": 4065720, "num_agent_steps_trained": 4065720}, "sampler_results": {"episode_reward_max": 93415.63006899075, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90113.36406609278, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2222266190535971, "mean_inference_ms": 0.38253715742356553, "mean_action_processing_ms": 0.09174457378261631, "mean_env_wait_ms": 1.6531072913722624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036205564226422992, "StateBufferConnector_ms": 0.002636228288922991, "ViewRequirementAgentConnector_ms": 0.06678785596575056}}, "episode_reward_max": 93415.63006899075, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90113.36406609278, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2222266190535971, "mean_inference_ms": 0.38253715742356553, "mean_action_processing_ms": 0.09174457378261631, "mean_env_wait_ms": 1.6531072913722624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036205564226422992, "StateBufferConnector_ms": 0.002636228288922991, "ViewRequirementAgentConnector_ms": 0.06678785596575056}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4065720, "num_agent_steps_trained": 4065720, "num_env_steps_sampled": 4065720, "num_env_steps_trained": 4065720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 411.9128461260987, "num_env_steps_trained_throughput_per_sec": 411.9128461260987, "timesteps_total": 4065720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4065720, "timers": {"training_iteration_time_ms": 105118.199, "sample_time_ms": 103944.957, "load_time_ms": 48.316, "load_throughput": 909020.097, "learn_time_ms": 1123.459, "learn_throughput": 39093.565, "synch_weights_time_ms": 1.188}, "counters": {"num_env_steps_sampled": 4065720, "num_env_steps_trained": 4065720, "num_agent_steps_sampled": 4065720, "num_agent_steps_trained": 4065720}, "done": false, "episodes_total": 1166, "training_iteration": 547, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-37-21", "timestamp": 1690238241, "time_this_iter_s": 106.62743282318115, "time_total_s": 7688.397224664688, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 735.8476955890656, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 20.39602649006622, "ram_util_percent": 80.34039735099338}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.059653916211296e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 76.21860263924557, "policy_loss": 2315.7833527225794, "vf_loss": 35070.952836551056}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5145.5, "diff_num_grad_updates_vs_sampler_policy": 5144.5}}, "num_env_steps_sampled": 4109640, "num_env_steps_trained": 4109640, "num_agent_steps_sampled": 4109640, "num_agent_steps_trained": 4109640}, "sampler_results": {"episode_reward_max": 93415.63006899075, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90145.62455675282, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22194312899543286, "mean_inference_ms": 0.3819961703290594, "mean_action_processing_ms": 0.09165336019192129, "mean_env_wait_ms": 1.654178861273503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.0026285648345947266, "ViewRequirementAgentConnector_ms": 0.06660521030426025}}, "episode_reward_max": 93415.63006899075, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90145.62455675282, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22194312899543286, "mean_inference_ms": 0.3819961703290594, "mean_action_processing_ms": 0.09165336019192129, "mean_env_wait_ms": 1.654178861273503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.0026285648345947266, "ViewRequirementAgentConnector_ms": 0.06660521030426025}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4109640, "num_agent_steps_trained": 4109640, "num_env_steps_sampled": 4109640, "num_env_steps_trained": 4109640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 411.5108511820693, "num_env_steps_trained_throughput_per_sec": 411.5108511820693, "timesteps_total": 4109640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4109640, "timers": {"training_iteration_time_ms": 105319.504, "sample_time_ms": 104149.891, "load_time_ms": 45.957, "load_throughput": 955672.879, "learn_time_ms": 1122.241, "learn_throughput": 39135.975, "synch_weights_time_ms": 1.148}, "counters": {"num_env_steps_sampled": 4109640, "num_env_steps_trained": 4109640, "num_agent_steps_sampled": 4109640, "num_agent_steps_trained": 4109640}, "done": false, "episodes_total": 1167, "training_iteration": 548, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-39-07", "timestamp": 1690238347, "time_this_iter_s": 106.7311041355133, "time_total_s": 7795.128328800201, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 842.5787997245789, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.012582781456953, "ram_util_percent": 80.29271523178808}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.559653916211293e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 74.26506419501568, "policy_loss": 1529.7773600403143, "vf_loss": 20841.440721250485}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5831.5, "diff_num_grad_updates_vs_sampler_policy": 5830.5}}, "num_env_steps_sampled": 4153560, "num_env_steps_trained": 4153560, "num_agent_steps_sampled": 4153560, "num_agent_steps_trained": 4153560}, "sampler_results": {"episode_reward_max": 93415.63006899075, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90073.29386361822, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22173237299464324, "mean_inference_ms": 0.38156423242038584, "mean_action_processing_ms": 0.09158977633980382, "mean_env_wait_ms": 1.6554367301520128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035259458753797743, "StateBufferConnector_ms": 0.002590815226236979, "ViewRequirementAgentConnector_ms": 0.06666448381212023}}, "episode_reward_max": 93415.63006899075, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90073.29386361822, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22173237299464324, "mean_inference_ms": 0.38156423242038584, "mean_action_processing_ms": 0.09158977633980382, "mean_env_wait_ms": 1.6554367301520128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035259458753797743, "StateBufferConnector_ms": 0.002590815226236979, "ViewRequirementAgentConnector_ms": 0.06666448381212023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4153560, "num_agent_steps_trained": 4153560, "num_env_steps_sampled": 4153560, "num_env_steps_trained": 4153560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 410.5361300683875, "num_env_steps_trained_throughput_per_sec": 410.5361300683875, "timesteps_total": 4153560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4153560, "timers": {"training_iteration_time_ms": 105504.225, "sample_time_ms": 104332.305, "load_time_ms": 48.17, "load_throughput": 911776.133, "learn_time_ms": 1122.259, "learn_throughput": 39135.348, "synch_weights_time_ms": 1.193}, "counters": {"num_env_steps_sampled": 4153560, "num_env_steps_trained": 4153560, "num_agent_steps_sampled": 4153560, "num_agent_steps_trained": 4153560}, "done": false, "episodes_total": 1168, "training_iteration": 549, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-40-54", "timestamp": 1690238454, "time_this_iter_s": 106.98528099060059, "time_total_s": 7902.113609790802, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 949.5640807151794, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.71523178807947, "ram_util_percent": 79.57880794701988}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.059653916211293e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.83731541202646, "policy_loss": 1293.5633807140607, "vf_loss": 16713.99691318701}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6517.5, "diff_num_grad_updates_vs_sampler_policy": 6516.5}}, "num_env_steps_sampled": 4197480, "num_env_steps_trained": 4197480, "num_agent_steps_sampled": 4197480, "num_agent_steps_trained": 4197480}, "sampler_results": {"episode_reward_max": 93415.63006899075, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90194.23668125807, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22157534006347945, "mean_inference_ms": 0.3812126938060102, "mean_action_processing_ms": 0.09153840731854972, "mean_env_wait_ms": 1.6569893465631522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038003921508789062, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.06649017333984375}}, "episode_reward_max": 93415.63006899075, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90194.23668125807, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22157534006347945, "mean_inference_ms": 0.3812126938060102, "mean_action_processing_ms": 0.09153840731854972, "mean_env_wait_ms": 1.6569893465631522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038003921508789062, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.06649017333984375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4197480, "num_agent_steps_trained": 4197480, "num_env_steps_sampled": 4197480, "num_env_steps_trained": 4197480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 407.12663720606866, "num_env_steps_trained_throughput_per_sec": 407.12663720606866, "timesteps_total": 4197480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4197480, "timers": {"training_iteration_time_ms": 105741.599, "sample_time_ms": 104572.013, "load_time_ms": 47.478, "load_throughput": 925053.363, "learn_time_ms": 1120.655, "learn_throughput": 39191.37, "synch_weights_time_ms": 1.166}, "counters": {"num_env_steps_sampled": 4197480, "num_env_steps_trained": 4197480, "num_agent_steps_sampled": 4197480, "num_agent_steps_trained": 4197480}, "done": false, "episodes_total": 1169, "training_iteration": 550, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-42-42", "timestamp": 1690238562, "time_this_iter_s": 107.88131523132324, "time_total_s": 8009.994925022125, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1057.4453959465027, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.7718954248366, "ram_util_percent": 79.72287581699347}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.559653916211293e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 70.6895104399923, "policy_loss": 1354.222050509717, "vf_loss": 15633.939590187185}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7203.5, "diff_num_grad_updates_vs_sampler_policy": 7202.5}}, "num_env_steps_sampled": 4241400, "num_env_steps_trained": 4241400, "num_agent_steps_sampled": 4241400, "num_agent_steps_trained": 4241400}, "sampler_results": {"episode_reward_max": 94106.06704172709, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90549.85762311889, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22143819920457955, "mean_inference_ms": 0.38091897587831214, "mean_action_processing_ms": 0.09149732680826922, "mean_env_wait_ms": 1.6584543745220808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037475065751509233, "StateBufferConnector_ms": 0.0025814229791814632, "ViewRequirementAgentConnector_ms": 0.0664255835793235}}, "episode_reward_max": 94106.06704172709, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90549.85762311889, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22143819920457955, "mean_inference_ms": 0.38091897587831214, "mean_action_processing_ms": 0.09149732680826922, "mean_env_wait_ms": 1.6584543745220808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037475065751509233, "StateBufferConnector_ms": 0.0025814229791814632, "ViewRequirementAgentConnector_ms": 0.0664255835793235}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4241400, "num_agent_steps_trained": 4241400, "num_env_steps_sampled": 4241400, "num_env_steps_trained": 4241400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 411.5411431671434, "num_env_steps_trained_throughput_per_sec": 411.5411431671434, "timesteps_total": 4241400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4241400, "timers": {"training_iteration_time_ms": 105672.362, "sample_time_ms": 104503.439, "load_time_ms": 51.273, "load_throughput": 856592.18, "learn_time_ms": 1116.182, "learn_throughput": 39348.423, "synch_weights_time_ms": 1.18}, "counters": {"num_env_steps_sampled": 4241400, "num_env_steps_trained": 4241400, "num_agent_steps_sampled": 4241400, "num_agent_steps_trained": 4241400}, "done": false, "episodes_total": 1170, "training_iteration": 551, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-44-29", "timestamp": 1690238669, "time_this_iter_s": 106.72392892837524, "time_total_s": 8116.7188539505005, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1164.169324874878, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 20.6, "ram_util_percent": 78.94900662251655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.059653916211293e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 68.4331287851139, "policy_loss": 787.2501637692354, "vf_loss": 10744.717122247546}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7889.5, "diff_num_grad_updates_vs_sampler_policy": 7888.5}}, "num_env_steps_sampled": 4285320, "num_env_steps_trained": 4285320, "num_agent_steps_sampled": 4285320, "num_agent_steps_trained": 4285320}, "sampler_results": {"episode_reward_max": 94106.06704172709, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90778.70316405506, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22130031213020562, "mean_inference_ms": 0.3806589808536635, "mean_action_processing_ms": 0.09146226482530628, "mean_env_wait_ms": 1.6598622390481488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0025828679402669272, "ViewRequirementAgentConnector_ms": 0.0665128231048584}}, "episode_reward_max": 94106.06704172709, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 90778.70316405506, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22130031213020562, "mean_inference_ms": 0.3806589808536635, "mean_action_processing_ms": 0.09146226482530628, "mean_env_wait_ms": 1.6598622390481488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0025828679402669272, "ViewRequirementAgentConnector_ms": 0.0665128231048584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4285320, "num_agent_steps_trained": 4285320, "num_env_steps_sampled": 4285320, "num_env_steps_trained": 4285320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 411.36983475353276, "num_env_steps_trained_throughput_per_sec": 411.36983475353276, "timesteps_total": 4285320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4285320, "timers": {"training_iteration_time_ms": 106001.677, "sample_time_ms": 104834.722, "load_time_ms": 50.882, "load_throughput": 863174.734, "learn_time_ms": 1114.607, "learn_throughput": 39404.032, "synch_weights_time_ms": 1.174}, "counters": {"num_env_steps_sampled": 4285320, "num_env_steps_trained": 4285320, "num_agent_steps_sampled": 4285320, "num_agent_steps_trained": 4285320}, "done": false, "episodes_total": 1171, "training_iteration": 552, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-46-16", "timestamp": 1690238776, "time_this_iter_s": 106.76852512359619, "time_total_s": 8223.487379074097, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1270.9378499984741, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 21.729139072847683, "ram_util_percent": 79.75894039735098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.559653916211295e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 67.26975992608696, "policy_loss": 1142.0438016983233, "vf_loss": 12881.594969568725}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8575.5, "diff_num_grad_updates_vs_sampler_policy": 8574.5}}, "num_env_steps_sampled": 4329240, "num_env_steps_trained": 4329240, "num_agent_steps_sampled": 4329240, "num_agent_steps_trained": 4329240}, "sampler_results": {"episode_reward_max": 97421.73431122795, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 91289.70555999143, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22119354785110945, "mean_inference_ms": 0.38042806521094275, "mean_action_processing_ms": 0.09143158417272326, "mean_env_wait_ms": 1.661129421083513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037138278667743388, "StateBufferConnector_ms": 0.0026024304903470553, "ViewRequirementAgentConnector_ms": 0.06714784182035007}}, "episode_reward_max": 97421.73431122795, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 91289.70555999143, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22119354785110945, "mean_inference_ms": 0.38042806521094275, "mean_action_processing_ms": 0.09143158417272326, "mean_env_wait_ms": 1.661129421083513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037138278667743388, "StateBufferConnector_ms": 0.0026024304903470553, "ViewRequirementAgentConnector_ms": 0.06714784182035007}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4329240, "num_agent_steps_trained": 4329240, "num_env_steps_sampled": 4329240, "num_env_steps_trained": 4329240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 412.42193526278515, "num_env_steps_trained_throughput_per_sec": 412.42193526278515, "timesteps_total": 4329240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4329240, "timers": {"training_iteration_time_ms": 106308.575, "sample_time_ms": 105139.396, "load_time_ms": 55.34, "load_throughput": 793640.631, "learn_time_ms": 1112.44, "learn_throughput": 39480.794, "synch_weights_time_ms": 1.11}, "counters": {"num_env_steps_sampled": 4329240, "num_env_steps_trained": 4329240, "num_agent_steps_sampled": 4329240, "num_agent_steps_trained": 4329240}, "done": false, "episodes_total": 1172, "training_iteration": 553, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-48-02", "timestamp": 1690238882, "time_this_iter_s": 106.49545884132385, "time_total_s": 8329.98283791542, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1377.433308839798, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 20.49139072847682, "ram_util_percent": 80.86490066225166}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.0596539162112935e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 66.49061135717453, "policy_loss": 928.4053526452957, "vf_loss": 11034.89485479861}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9261.5, "diff_num_grad_updates_vs_sampler_policy": 9260.5}}, "num_env_steps_sampled": 4373160, "num_env_steps_trained": 4373160, "num_agent_steps_sampled": 4373160, "num_agent_steps_trained": 4373160}, "sampler_results": {"episode_reward_max": 98120.10221838586, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 91777.59103559102, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22109518595485697, "mean_inference_ms": 0.380219009238118, "mean_action_processing_ms": 0.09140483001274605, "mean_env_wait_ms": 1.6621654667003458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036886760166713168, "StateBufferConnector_ms": 0.002602168491908482, "ViewRequirementAgentConnector_ms": 0.06710461207798549}}, "episode_reward_max": 98120.10221838586, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 91777.59103559102, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22109518595485697, "mean_inference_ms": 0.380219009238118, "mean_action_processing_ms": 0.09140483001274605, "mean_env_wait_ms": 1.6621654667003458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036886760166713168, "StateBufferConnector_ms": 0.002602168491908482, "ViewRequirementAgentConnector_ms": 0.06710461207798549}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4373160, "num_agent_steps_trained": 4373160, "num_env_steps_sampled": 4373160, "num_env_steps_trained": 4373160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 417.0163396941502, "num_env_steps_trained_throughput_per_sec": 417.0163396941502, "timesteps_total": 4373160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4373160, "timers": {"training_iteration_time_ms": 106452.841, "sample_time_ms": 105284.048, "load_time_ms": 55.578, "load_throughput": 790243.888, "learn_time_ms": 1111.805, "learn_throughput": 39503.336, "synch_weights_time_ms": 1.119}, "counters": {"num_env_steps_sampled": 4373160, "num_env_steps_trained": 4373160, "num_agent_steps_sampled": 4373160, "num_agent_steps_trained": 4373160}, "done": false, "episodes_total": 1173, "training_iteration": 554, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-49-48", "timestamp": 1690238988, "time_this_iter_s": 105.32223629951477, "time_total_s": 8435.305074214935, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1482.7555451393127, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 20.7255033557047, "ram_util_percent": 80.67181208053691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5596539162112932e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 63.573389887462206, "policy_loss": 890.1613247328528, "vf_loss": 10328.853341550242}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9947.5, "diff_num_grad_updates_vs_sampler_policy": 9946.5}}, "num_env_steps_sampled": 4417080, "num_env_steps_trained": 4417080, "num_agent_steps_sampled": 4417080, "num_agent_steps_trained": 4417080}, "sampler_results": {"episode_reward_max": 99787.9911840913, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 92311.6177121577, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22099893397518547, "mean_inference_ms": 0.3800251727112801, "mean_action_processing_ms": 0.09137941285169691, "mean_env_wait_ms": 1.6629930108740476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036573410034179688, "StateBufferConnector_ms": 0.0025955835978190103, "ViewRequirementAgentConnector_ms": 0.0670305887858073}}, "episode_reward_max": 99787.9911840913, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 92311.6177121577, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22099893397518547, "mean_inference_ms": 0.3800251727112801, "mean_action_processing_ms": 0.09137941285169691, "mean_env_wait_ms": 1.6629930108740476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036573410034179688, "StateBufferConnector_ms": 0.0025955835978190103, "ViewRequirementAgentConnector_ms": 0.0670305887858073}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4417080, "num_agent_steps_trained": 4417080, "num_env_steps_sampled": 4417080, "num_env_steps_trained": 4417080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 418.45681524855536, "num_env_steps_trained_throughput_per_sec": 418.45681524855536, "timesteps_total": 4417080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4417080, "timers": {"training_iteration_time_ms": 106447.916, "sample_time_ms": 105287.444, "load_time_ms": 49.621, "load_throughput": 885114.906, "learn_time_ms": 1109.4, "learn_throughput": 39588.956, "synch_weights_time_ms": 1.156}, "counters": {"num_env_steps_sampled": 4417080, "num_env_steps_trained": 4417080, "num_agent_steps_sampled": 4417080, "num_agent_steps_trained": 4417080}, "done": false, "episodes_total": 1174, "training_iteration": 555, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-51-33", "timestamp": 1690239093, "time_this_iter_s": 104.96028518676758, "time_total_s": 8540.265359401703, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1587.7158303260803, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 20.594630872483226, "ram_util_percent": 80.644966442953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2357923497267755e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 60.13735386929081, "policy_loss": 874.9467371531895, "vf_loss": 9991.201679663478}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10633.5, "diff_num_grad_updates_vs_sampler_policy": 10632.5}}, "num_env_steps_sampled": 4461000, "num_env_steps_trained": 4461000, "num_agent_steps_sampled": 4461000, "num_agent_steps_trained": 4461000}, "sampler_results": {"episode_reward_max": 101423.66655517199, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 92881.1207648461, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2209034267746826, "mean_inference_ms": 0.3798417807532475, "mean_action_processing_ms": 0.09135543099613647, "mean_env_wait_ms": 1.663677603165823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036284327507019043, "StateBufferConnector_ms": 0.0025764107704162598, "ViewRequirementAgentConnector_ms": 0.0668749213218689}}, "episode_reward_max": 101423.66655517199, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 92881.1207648461, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2209034267746826, "mean_inference_ms": 0.3798417807532475, "mean_action_processing_ms": 0.09135543099613647, "mean_env_wait_ms": 1.663677603165823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036284327507019043, "StateBufferConnector_ms": 0.0025764107704162598, "ViewRequirementAgentConnector_ms": 0.0668749213218689}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4461000, "num_agent_steps_trained": 4461000, "num_env_steps_sampled": 4461000, "num_env_steps_trained": 4461000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 418.1729941765815, "num_env_steps_trained_throughput_per_sec": 418.1729941765815, "timesteps_total": 4461000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4461000, "timers": {"training_iteration_time_ms": 106349.673, "sample_time_ms": 105192.473, "load_time_ms": 47.681, "load_throughput": 921128.111, "learn_time_ms": 1108.067, "learn_throughput": 39636.604, "synch_weights_time_ms": 1.158}, "counters": {"num_env_steps_sampled": 4461000, "num_env_steps_trained": 4461000, "num_agent_steps_sampled": 4461000, "num_agent_steps_trained": 4461000}, "done": false, "episodes_total": 1175, "training_iteration": 556, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-53-18", "timestamp": 1690239198, "time_this_iter_s": 105.030935049057, "time_total_s": 8645.29629445076, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1692.7467653751373, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 20.29054054054054, "ram_util_percent": 80.54054054054055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9357923497267764e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 56.016114354481154, "policy_loss": 872.3603852163599, "vf_loss": 10457.44428346595}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11319.5, "diff_num_grad_updates_vs_sampler_policy": 11318.5}}, "num_env_steps_sampled": 4504920, "num_env_steps_trained": 4504920, "num_agent_steps_sampled": 4504920, "num_agent_steps_trained": 4504920}, "sampler_results": {"episode_reward_max": 103267.07847425103, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 93492.05945363463, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22082648081205775, "mean_inference_ms": 0.37967473776118127, "mean_action_processing_ms": 0.0913350562327289, "mean_env_wait_ms": 1.6640264351004759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035973156199735753, "StateBufferConnector_ms": 0.0025833354276769303, "ViewRequirementAgentConnector_ms": 0.06683574003331802}}, "episode_reward_max": 103267.07847425103, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 93492.05945363463, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22082648081205775, "mean_inference_ms": 0.37967473776118127, "mean_action_processing_ms": 0.0913350562327289, "mean_env_wait_ms": 1.6640264351004759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035973156199735753, "StateBufferConnector_ms": 0.0025833354276769303, "ViewRequirementAgentConnector_ms": 0.06683574003331802}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4504920, "num_agent_steps_trained": 4504920, "num_env_steps_sampled": 4504920, "num_env_steps_trained": 4504920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 428.0556024598578, "num_env_steps_trained_throughput_per_sec": 428.0556024598578, "timesteps_total": 4504920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4504920, "timers": {"training_iteration_time_ms": 105947.575, "sample_time_ms": 104796.045, "load_time_ms": 46.05, "load_throughput": 953738.024, "learn_time_ms": 1104.078, "learn_throughput": 39779.813, "synch_weights_time_ms": 1.134}, "counters": {"num_env_steps_sampled": 4504920, "num_env_steps_trained": 4504920, "num_agent_steps_sampled": 4504920, "num_agent_steps_trained": 4504920}, "done": false, "episodes_total": 1176, "training_iteration": 557, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-55-00", "timestamp": 1690239300, "time_this_iter_s": 102.6060140132904, "time_total_s": 8747.90230846405, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1795.3527793884277, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 24.255862068965516, "ram_util_percent": 81.72206896551725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6357923497267755e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 53.267733721274325, "policy_loss": 759.1148870832371, "vf_loss": 9411.184123103194}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12005.5, "diff_num_grad_updates_vs_sampler_policy": 12004.5}}, "num_env_steps_sampled": 4548840, "num_env_steps_trained": 4548840, "num_agent_steps_sampled": 4548840, "num_agent_steps_trained": 4548840}, "sampler_results": {"episode_reward_max": 103951.20762889825, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 94073.12324114928, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2207454230373866, "mean_inference_ms": 0.3795218001535756, "mean_action_processing_ms": 0.09131701500288775, "mean_env_wait_ms": 1.6641477991277003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003612041473388672, "StateBufferConnector_ms": 0.0025802188449435765, "ViewRequirementAgentConnector_ms": 0.067240662044949}}, "episode_reward_max": 103951.20762889825, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 94073.12324114928, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2207454230373866, "mean_inference_ms": 0.3795218001535756, "mean_action_processing_ms": 0.09131701500288775, "mean_env_wait_ms": 1.6641477991277003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003612041473388672, "StateBufferConnector_ms": 0.0025802188449435765, "ViewRequirementAgentConnector_ms": 0.067240662044949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4548840, "num_agent_steps_trained": 4548840, "num_env_steps_sampled": 4548840, "num_env_steps_trained": 4548840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 427.7763735391645, "num_env_steps_trained_throughput_per_sec": 427.7763735391645, "timesteps_total": 4548840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4548840, "timers": {"training_iteration_time_ms": 105541.756, "sample_time_ms": 104388.168, "load_time_ms": 48.66, "load_throughput": 902583.791, "learn_time_ms": 1103.475, "learn_throughput": 39801.523, "synch_weights_time_ms": 1.178}, "counters": {"num_env_steps_sampled": 4548840, "num_env_steps_trained": 4548840, "num_agent_steps_sampled": 4548840, "num_agent_steps_trained": 4548840}, "done": false, "episodes_total": 1177, "training_iteration": 558, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-56-43", "timestamp": 1690239403, "time_this_iter_s": 102.6740038394928, "time_total_s": 8850.576312303543, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1898.0267832279205, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 20.42945205479452, "ram_util_percent": 81.30205479452054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3357923497267755e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 51.64583528146104, "policy_loss": 607.4874216411969, "vf_loss": 7359.583882290142}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12691.5, "diff_num_grad_updates_vs_sampler_policy": 12690.5}}, "num_env_steps_sampled": 4592760, "num_env_steps_trained": 4592760, "num_agent_steps_sampled": 4592760, "num_agent_steps_trained": 4592760}, "sampler_results": {"episode_reward_max": 103951.20762889825, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 94590.38139104306, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22067449972219308, "mean_inference_ms": 0.37938155620553704, "mean_action_processing_ms": 0.09130134125170372, "mean_env_wait_ms": 1.6640671928275554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035875721981650905, "StateBufferConnector_ms": 0.0025874690005653783, "ViewRequirementAgentConnector_ms": 0.06714996538664166}}, "episode_reward_max": 103951.20762889825, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 94590.38139104306, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22067449972219308, "mean_inference_ms": 0.37938155620553704, "mean_action_processing_ms": 0.09130134125170372, "mean_env_wait_ms": 1.6640671928275554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035875721981650905, "StateBufferConnector_ms": 0.0025874690005653783, "ViewRequirementAgentConnector_ms": 0.06714996538664166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4592760, "num_agent_steps_trained": 4592760, "num_env_steps_sampled": 4592760, "num_env_steps_trained": 4592760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 429.06323199559404, "num_env_steps_trained_throughput_per_sec": 429.06323199559404, "timesteps_total": 4592760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4592760, "timers": {"training_iteration_time_ms": 105079.805, "sample_time_ms": 103932.845, "load_time_ms": 46.067, "load_throughput": 953398.422, "learn_time_ms": 1099.492, "learn_throughput": 39945.725, "synch_weights_time_ms": 1.129}, "counters": {"num_env_steps_sampled": 4592760, "num_env_steps_trained": 4592760, "num_agent_steps_sampled": 4592760, "num_agent_steps_trained": 4592760}, "done": false, "episodes_total": 1178, "training_iteration": 559, "trial_id": "ec4cd_00000", "date": "2023-07-25_01-58-25", "timestamp": 1690239505, "time_this_iter_s": 102.36606311798096, "time_total_s": 8952.942375421524, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2000.3928463459015, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.16758620689655, "ram_util_percent": 81.12896551724137}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.035792349726776e-05, "entropy_coeff": 0.09999999999999999, "policy_entropy": 46.81309279616998, "policy_loss": 575.0609863589873, "vf_loss": 7490.850388930074}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13377.5, "diff_num_grad_updates_vs_sampler_policy": 13376.5}}, "num_env_steps_sampled": 4636680, "num_env_steps_trained": 4636680, "num_agent_steps_sampled": 4636680, "num_agent_steps_trained": 4636680}, "sampler_results": {"episode_reward_max": 104890.34487360984, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 95105.3795651714, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2206131197169078, "mean_inference_ms": 0.37925300026163755, "mean_action_processing_ms": 0.09128700416415639, "mean_env_wait_ms": 1.6638427682023569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560781478881836, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.06716251373291016}}, "episode_reward_max": 104890.34487360984, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 95105.3795651714, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2206131197169078, "mean_inference_ms": 0.37925300026163755, "mean_action_processing_ms": 0.09128700416415639, "mean_env_wait_ms": 1.6638427682023569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560781478881836, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.06716251373291016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4636680, "num_agent_steps_trained": 4636680, "num_env_steps_sampled": 4636680, "num_env_steps_trained": 4636680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 427.9974829503903, "num_env_steps_trained_throughput_per_sec": 427.9974829503903, "timesteps_total": 4636680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4636680, "timers": {"training_iteration_time_ms": 104553.749, "sample_time_ms": 103406.35, "load_time_ms": 47.189, "load_throughput": 930721.203, "learn_time_ms": 1098.811, "learn_throughput": 39970.46, "synch_weights_time_ms": 1.129}, "counters": {"num_env_steps_sampled": 4636680, "num_env_steps_trained": 4636680, "num_agent_steps_sampled": 4636680, "num_agent_steps_trained": 4636680}, "done": false, "episodes_total": 1179, "training_iteration": 560, "trial_id": "ec4cd_00000", "date": "2023-07-25_02-00-08", "timestamp": 1690239608, "time_this_iter_s": 102.62017297744751, "time_total_s": 9055.562548398972, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2103.013019323349, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 20.621379310344828, "ram_util_percent": 80.36275862068966}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.559653916211293e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": 45.1642594462581, "policy_loss": 592.7867253653857, "vf_loss": 7739.361303001381}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14063.5, "diff_num_grad_updates_vs_sampler_policy": 14062.5}}, "num_env_steps_sampled": 4680600, "num_env_steps_trained": 4680600, "num_agent_steps_sampled": 4680600, "num_agent_steps_trained": 4680600}, "sampler_results": {"episode_reward_max": 106041.04280079636, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 95626.1254335345, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22055605057039157, "mean_inference_ms": 0.3791368351653947, "mean_action_processing_ms": 0.09127381408091122, "mean_env_wait_ms": 1.663457408645055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003533136276971726, "StateBufferConnector_ms": 0.0025942212059384302, "ViewRequirementAgentConnector_ms": 0.06714207785470146}}, "episode_reward_max": 106041.04280079636, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 95626.1254335345, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22055605057039157, "mean_inference_ms": 0.3791368351653947, "mean_action_processing_ms": 0.09127381408091122, "mean_env_wait_ms": 1.663457408645055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003533136276971726, "StateBufferConnector_ms": 0.0025942212059384302, "ViewRequirementAgentConnector_ms": 0.06714207785470146}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4680600, "num_agent_steps_trained": 4680600, "num_env_steps_sampled": 4680600, "num_env_steps_trained": 4680600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 432.62650424795, "num_env_steps_trained_throughput_per_sec": 432.62650424795, "timesteps_total": 4680600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4680600, "timers": {"training_iteration_time_ms": 104033.616, "sample_time_ms": 102888.9, "load_time_ms": 46.324, "load_throughput": 948112.65, "learn_time_ms": 1097.011, "learn_throughput": 40036.066, "synch_weights_time_ms": 1.116}, "counters": {"num_env_steps_sampled": 4680600, "num_env_steps_trained": 4680600, "num_agent_steps_sampled": 4680600, "num_agent_steps_trained": 4680600}, "done": false, "episodes_total": 1180, "training_iteration": 561, "trial_id": "ec4cd_00000", "date": "2023-07-25_02-01-50", "timestamp": 1690239710, "time_this_iter_s": 101.52260208129883, "time_total_s": 9157.08515048027, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2204.535621404648, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 21.147222222222226, "ram_util_percent": 80.63263888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.059653916211296e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": 43.65146270507279, "policy_loss": 546.1245631108131, "vf_loss": 7159.446758704004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14749.5, "diff_num_grad_updates_vs_sampler_policy": 14748.5}}, "num_env_steps_sampled": 4724520, "num_env_steps_trained": 4724520, "num_agent_steps_sampled": 4724520, "num_agent_steps_trained": 4724520}, "sampler_results": {"episode_reward_max": 106485.08614726027, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 96119.71455688566, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205028004588078, "mean_inference_ms": 0.3790288959793765, "mean_action_processing_ms": 0.09126155041533236, "mean_env_wait_ms": 1.6629623321036284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035264275290749288, "StateBufferConnector_ms": 0.002582506699995561, "ViewRequirementAgentConnector_ms": 0.06706823002208363}}, "episode_reward_max": 106485.08614726027, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 96119.71455688566, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205028004588078, "mean_inference_ms": 0.3790288959793765, "mean_action_processing_ms": 0.09126155041533236, "mean_env_wait_ms": 1.6629623321036284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035264275290749288, "StateBufferConnector_ms": 0.002582506699995561, "ViewRequirementAgentConnector_ms": 0.06706823002208363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4724520, "num_agent_steps_trained": 4724520, "num_env_steps_sampled": 4724520, "num_env_steps_trained": 4724520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 431.24893313407944, "num_env_steps_trained_throughput_per_sec": 431.24893313407944, "timesteps_total": 4724520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4724520, "timers": {"training_iteration_time_ms": 103541.466, "sample_time_ms": 102401.684, "load_time_ms": 42.428, "load_throughput": 1035154.58, "learn_time_ms": 1095.994, "learn_throughput": 40073.213, "synch_weights_time_ms": 1.103}, "counters": {"num_env_steps_sampled": 4724520, "num_env_steps_trained": 4724520, "num_agent_steps_sampled": 4724520, "num_agent_steps_trained": 4724520}, "done": false, "episodes_total": 1181, "training_iteration": 562, "trial_id": "ec4cd_00000", "date": "2023-07-25_02-03-32", "timestamp": 1690239812, "time_this_iter_s": 101.84633111953735, "time_total_s": 9258.931481599808, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2306.381952524185, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 20.540277777777778, "ram_util_percent": 80.34375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.559653916211295e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": 42.20700706059314, "policy_loss": 519.3341596029243, "vf_loss": 6603.787353298754}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 15434.5}}, "num_env_steps_sampled": 4768440, "num_env_steps_trained": 4768440, "num_agent_steps_sampled": 4768440, "num_agent_steps_trained": 4768440}, "sampler_results": {"episode_reward_max": 106929.58594964325, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 96589.70896526643, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22045467235832736, "mean_inference_ms": 0.3789263084564587, "mean_action_processing_ms": 0.09125018427760542, "mean_env_wait_ms": 1.6623827406413867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035006067027216372, "StateBufferConnector_ms": 0.002599799114724864, "ViewRequirementAgentConnector_ms": 0.06704848745594853}}, "episode_reward_max": 106929.58594964325, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 96589.70896526643, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22045467235832736, "mean_inference_ms": 0.3789263084564587, "mean_action_processing_ms": 0.09125018427760542, "mean_env_wait_ms": 1.6623827406413867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035006067027216372, "StateBufferConnector_ms": 0.002599799114724864, "ViewRequirementAgentConnector_ms": 0.06704848745594853}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4768440, "num_agent_steps_trained": 4768440, "num_env_steps_sampled": 4768440, "num_env_steps_trained": 4768440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 431.7054085757704, "num_env_steps_trained_throughput_per_sec": 431.7054085757704, "timesteps_total": 4768440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4768440, "timers": {"training_iteration_time_ms": 103065.779, "sample_time_ms": 101932.288, "load_time_ms": 38.827, "load_throughput": 1131163.56, "learn_time_ms": 1093.202, "learn_throughput": 40175.57, "synch_weights_time_ms": 1.173}, "counters": {"num_env_steps_sampled": 4768440, "num_env_steps_trained": 4768440, "num_agent_steps_sampled": 4768440, "num_agent_steps_trained": 4768440}, "done": false, "episodes_total": 1182, "training_iteration": 563, "trial_id": "ec4cd_00000", "date": "2023-07-25_02-05-13", "timestamp": 1690239913, "time_this_iter_s": 101.73933625221252, "time_total_s": 9360.67081785202, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2408.1212887763977, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 20.43263888888889, "ram_util_percent": 80.85902777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.059653916211293e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": 41.62684446729654, "policy_loss": 472.26913978198525, "vf_loss": 5969.176789508964}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16121.5, "diff_num_grad_updates_vs_sampler_policy": 16120.5}}, "num_env_steps_sampled": 4812360, "num_env_steps_trained": 4812360, "num_agent_steps_sampled": 4812360, "num_agent_steps_trained": 4812360}, "sampler_results": {"episode_reward_max": 107182.29557388673, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 97031.06674062561, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22040711552713152, "mean_inference_ms": 0.3788312593945742, "mean_action_processing_ms": 0.0912401203409038, "mean_env_wait_ms": 1.6617389047199993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035991271336873374, "StateBufferConnector_ms": 0.002603729565938314, "ViewRequirementAgentConnector_ms": 0.06702740987141927}}, "episode_reward_max": 107182.29557388673, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 97031.06674062561, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22040711552713152, "mean_inference_ms": 0.3788312593945742, "mean_action_processing_ms": 0.0912401203409038, "mean_env_wait_ms": 1.6617389047199993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035991271336873374, "StateBufferConnector_ms": 0.002603729565938314, "ViewRequirementAgentConnector_ms": 0.06702740987141927}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4812360, "num_agent_steps_trained": 4812360, "num_env_steps_sampled": 4812360, "num_env_steps_trained": 4812360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 431.6814487480181, "num_env_steps_trained_throughput_per_sec": 431.6814487480181, "timesteps_total": 4812360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4812360, "timers": {"training_iteration_time_ms": 102707.985, "sample_time_ms": 101576.243, "load_time_ms": 40.372, "load_throughput": 1087879.743, "learn_time_ms": 1089.892, "learn_throughput": 40297.561, "synch_weights_time_ms": 1.186}, "counters": {"num_env_steps_sampled": 4812360, "num_env_steps_trained": 4812360, "num_agent_steps_sampled": 4812360, "num_agent_steps_trained": 4812360}, "done": false, "episodes_total": 1183, "training_iteration": 564, "trial_id": "ec4cd_00000", "date": "2023-07-25_02-06-55", "timestamp": 1690240015, "time_this_iter_s": 101.74482321739197, "time_total_s": 9462.415641069412, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2509.8661119937897, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 21.561805555555555, "ram_util_percent": 80.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.559653916211295e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": 40.88133676267574, "policy_loss": 425.8657992080766, "vf_loss": 5420.596964065952}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16807.5, "diff_num_grad_updates_vs_sampler_policy": 16806.5}}, "num_env_steps_sampled": 4856280, "num_env_steps_trained": 4856280, "num_agent_steps_sampled": 4856280, "num_agent_steps_trained": 4856280}, "sampler_results": {"episode_reward_max": 107331.96018032906, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 97443.10247821375, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22035916589037774, "mean_inference_ms": 0.3787392588448151, "mean_action_processing_ms": 0.0912303850550672, "mean_env_wait_ms": 1.6610198990649305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035791397094726562, "StateBufferConnector_ms": 0.00261688232421875, "ViewRequirementAgentConnector_ms": 0.06711864471435547}}, "episode_reward_max": 107331.96018032906, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 97443.10247821375, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22035916589037774, "mean_inference_ms": 0.3787392588448151, "mean_action_processing_ms": 0.0912303850550672, "mean_env_wait_ms": 1.6610198990649305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035791397094726562, "StateBufferConnector_ms": 0.00261688232421875, "ViewRequirementAgentConnector_ms": 0.06711864471435547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4856280, "num_agent_steps_trained": 4856280, "num_env_steps_sampled": 4856280, "num_env_steps_trained": 4856280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 435.77760359915624, "num_env_steps_trained_throughput_per_sec": 435.77760359915624, "timesteps_total": 4856280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4856280, "timers": {"training_iteration_time_ms": 102290.814, "sample_time_ms": 101159.616, "load_time_ms": 40.64, "load_throughput": 1080718.264, "learn_time_ms": 1089.109, "learn_throughput": 40326.557, "synch_weights_time_ms": 1.178}, "counters": {"num_env_steps_sampled": 4856280, "num_env_steps_trained": 4856280, "num_agent_steps_sampled": 4856280, "num_agent_steps_trained": 4856280}, "done": false, "episodes_total": 1184, "training_iteration": 565, "trial_id": "ec4cd_00000", "date": "2023-07-25_02-08-36", "timestamp": 1690240116, "time_this_iter_s": 100.7886381149292, "time_total_s": 9563.204279184341, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2610.654750108719, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 22.484615384615385, "ram_util_percent": 80.98181818181817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.059653916211294e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": 41.13303383029237, "policy_loss": 366.77614810862974, "vf_loss": 4425.619085417545}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17493.5, "diff_num_grad_updates_vs_sampler_policy": 17492.5}}, "num_env_steps_sampled": 4900200, "num_env_steps_trained": 4900200, "num_agent_steps_sampled": 4900200, "num_agent_steps_trained": 4900200}, "sampler_results": {"episode_reward_max": 107331.96018032906, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 97817.87913348831, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906, 107187.29551535251], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22031056827481457, "mean_inference_ms": 0.37865439479283414, "mean_action_processing_ms": 0.09122153702468626, "mean_env_wait_ms": 1.660233236074347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035854486318734977, "StateBufferConnector_ms": 0.0026060984684870793, "ViewRequirementAgentConnector_ms": 0.06720744646512546}}, "episode_reward_max": 107331.96018032906, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 97817.87913348831, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906, 107187.29551535251], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22031056827481457, "mean_inference_ms": 0.37865439479283414, "mean_action_processing_ms": 0.09122153702468626, "mean_env_wait_ms": 1.660233236074347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035854486318734977, "StateBufferConnector_ms": 0.0026060984684870793, "ViewRequirementAgentConnector_ms": 0.06720744646512546}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4900200, "num_agent_steps_trained": 4900200, "num_env_steps_sampled": 4900200, "num_env_steps_trained": 4900200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 436.1039456718919, "num_env_steps_trained_throughput_per_sec": 436.1039456718919, "timesteps_total": 4900200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4900200, "timers": {"training_iteration_time_ms": 101858.977, "sample_time_ms": 100722.72, "load_time_ms": 46.834, "load_throughput": 937787.566, "learn_time_ms": 1087.969, "learn_throughput": 40368.798, "synch_weights_time_ms": 1.182}, "counters": {"num_env_steps_sampled": 4900200, "num_env_steps_trained": 4900200, "num_agent_steps_sampled": 4900200, "num_agent_steps_trained": 4900200}, "done": false, "episodes_total": 1185, "training_iteration": 566, "trial_id": "ec4cd_00000", "date": "2023-07-25_02-10-17", "timestamp": 1690240217, "time_this_iter_s": 100.71267199516296, "time_total_s": 9663.916951179504, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2711.367422103882, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 22.64014084507042, "ram_util_percent": 80.66549295774648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.559653916211293e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": 39.92396261810214, "policy_loss": 358.42598724782295, "vf_loss": 4305.1169963091525}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18179.5, "diff_num_grad_updates_vs_sampler_policy": 18178.5}}, "num_env_steps_sampled": 4944120, "num_env_steps_trained": 4944120, "num_agent_steps_sampled": 4944120, "num_agent_steps_trained": 4944120}, "sampler_results": {"episode_reward_max": 107668.45334969128, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 98182.71521556992, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906, 107187.29551535251, 107668.45334969128], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22026818589450411, "mean_inference_ms": 0.3785793189429895, "mean_action_processing_ms": 0.09121430555113313, "mean_env_wait_ms": 1.659429479941471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035727465594256364, "StateBufferConnector_ms": 0.0026022946393048324, "ViewRequirementAgentConnector_ms": 0.06721284654405382}}, "episode_reward_max": 107668.45334969128, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 98182.71521556992, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906, 107187.29551535251, 107668.45334969128], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22026818589450411, "mean_inference_ms": 0.3785793189429895, "mean_action_processing_ms": 0.09121430555113313, "mean_env_wait_ms": 1.659429479941471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035727465594256364, "StateBufferConnector_ms": 0.0026022946393048324, "ViewRequirementAgentConnector_ms": 0.06721284654405382}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4944120, "num_agent_steps_trained": 4944120, "num_env_steps_sampled": 4944120, "num_env_steps_trained": 4944120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 429.8547465828664, "num_env_steps_trained_throughput_per_sec": 429.8547465828664, "timesteps_total": 4944120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4944120, "timers": {"training_iteration_time_ms": 101816.029, "sample_time_ms": 100676.622, "load_time_ms": 49.768, "load_throughput": 882502.899, "learn_time_ms": 1088.099, "learn_throughput": 40363.983, "synch_weights_time_ms": 1.243}, "counters": {"num_env_steps_sampled": 4944120, "num_env_steps_trained": 4944120, "num_agent_steps_sampled": 4944120, "num_agent_steps_trained": 4944120}, "done": false, "episodes_total": 1186, "training_iteration": 567, "trial_id": "ec4cd_00000", "date": "2023-07-25_02-11-59", "timestamp": 1690240319, "time_this_iter_s": 102.17779994010925, "time_total_s": 9766.094751119614, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2813.545222043991, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 21.845517241379312, "ram_util_percent": 81.08000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.059653916211293e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": 39.71346751176929, "policy_loss": 341.468912126024, "vf_loss": 4075.8387799999805}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18865.5, "diff_num_grad_updates_vs_sampler_policy": 18864.5}}, "num_env_steps_sampled": 4988040, "num_env_steps_trained": 4988040, "num_agent_steps_sampled": 4988040, "num_agent_steps_trained": 4988040}, "sampler_results": {"episode_reward_max": 107968.53950289222, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 98532.20894011714, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906, 107187.29551535251, 107668.45334969128, 107968.53950289222], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22022940126240728, "mean_inference_ms": 0.37850835494083296, "mean_action_processing_ms": 0.09120716660807485, "mean_env_wait_ms": 1.6586043630132732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035660607474190848, "StateBufferConnector_ms": 0.002599614007132394, "ViewRequirementAgentConnector_ms": 0.0671522957938058}}, "episode_reward_max": 107968.53950289222, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 98532.20894011714, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906, 107187.29551535251, 107668.45334969128, 107968.53950289222], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22022940126240728, "mean_inference_ms": 0.37850835494083296, "mean_action_processing_ms": 0.09120716660807485, "mean_env_wait_ms": 1.6586043630132732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035660607474190848, "StateBufferConnector_ms": 0.002599614007132394, "ViewRequirementAgentConnector_ms": 0.0671522957938058}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4988040, "num_agent_steps_trained": 4988040, "num_env_steps_sampled": 4988040, "num_env_steps_trained": 4988040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 432.9582657924888, "num_env_steps_trained_throughput_per_sec": 432.9582657924888, "timesteps_total": 4988040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4988040, "timers": {"training_iteration_time_ms": 101693.147, "sample_time_ms": 100553.359, "load_time_ms": 52.91, "load_throughput": 830081.815, "learn_time_ms": 1085.388, "learn_throughput": 40464.804, "synch_weights_time_ms": 1.201}, "counters": {"num_env_steps_sampled": 4988040, "num_env_steps_trained": 4988040, "num_agent_steps_sampled": 4988040, "num_agent_steps_trained": 4988040}, "done": false, "episodes_total": 1187, "training_iteration": 568, "trial_id": "ec4cd_00000", "date": "2023-07-25_02-13-40", "timestamp": 1690240420, "time_this_iter_s": 101.44435286521912, "time_total_s": 9867.539103984833, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2914.98957490921, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.335664335664337, "ram_util_percent": 79.83776223776223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.559653916211292e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": 39.147833788012626, "policy_loss": 300.37810898730777, "vf_loss": 3593.5307207691426}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19551.5, "diff_num_grad_updates_vs_sampler_policy": 19550.5}}, "num_env_steps_sampled": 5031960, "num_env_steps_trained": 5031960, "num_agent_steps_sampled": 5031960, "num_agent_steps_trained": 5031960}, "sampler_results": {"episode_reward_max": 108038.55241894946, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 98860.01388766308, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906, 107187.29551535251, 107668.45334969128, 107968.53950289222, 108038.55241894946], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22019535255419087, "mean_inference_ms": 0.37844316155063695, "mean_action_processing_ms": 0.09120120182977427, "mean_env_wait_ms": 1.6577540030151787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038558039171942347, "StateBufferConnector_ms": 0.0026513790262156518, "ViewRequirementAgentConnector_ms": 0.06882651098843279}}, "episode_reward_max": 108038.55241894946, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 98860.01388766308, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906, 107187.29551535251, 107668.45334969128, 107968.53950289222, 108038.55241894946], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22019535255419087, "mean_inference_ms": 0.37844316155063695, "mean_action_processing_ms": 0.09120120182977427, "mean_env_wait_ms": 1.6577540030151787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038558039171942347, "StateBufferConnector_ms": 0.0026513790262156518, "ViewRequirementAgentConnector_ms": 0.06882651098843279}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5031960, "num_agent_steps_trained": 5031960, "num_env_steps_sampled": 5031960, "num_env_steps_trained": 5031960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 433.6971552768205, "num_env_steps_trained_throughput_per_sec": 433.6971552768205, "timesteps_total": 5031960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5031960, "timers": {"training_iteration_time_ms": 101583.779, "sample_time_ms": 100443.656, "load_time_ms": 53.598, "load_throughput": 819435.769, "learn_time_ms": 1085.085, "learn_throughput": 40476.085, "synch_weights_time_ms": 1.187}, "counters": {"num_env_steps_sampled": 5031960, "num_env_steps_trained": 5031960, "num_agent_steps_sampled": 5031960, "num_agent_steps_trained": 5031960}, "done": false, "episodes_total": 1188, "training_iteration": 569, "trial_id": "ec4cd_00000", "date": "2023-07-25_02-15-22", "timestamp": 1690240522, "time_this_iter_s": 101.2717080116272, "time_total_s": 9968.81081199646, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3016.2612829208374, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 22.65944055944056, "ram_util_percent": 80.50419580419579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.059653916211293e-06, "entropy_coeff": 0.09999999999999999, "policy_entropy": 39.328107817179955, "policy_loss": 268.7043675278088, "vf_loss": 3331.08978034595}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20237.5, "diff_num_grad_updates_vs_sampler_policy": 20236.5}}, "num_env_steps_sampled": 5075880, "num_env_steps_trained": 5075880, "num_agent_steps_sampled": 5075880, "num_agent_steps_trained": 5075880}, "sampler_results": {"episode_reward_max": 108038.55241894946, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 99165.4079845531, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906, 107187.29551535251, 107668.45334969128, 107968.53950289222, 108038.55241894946, 108021.83679436338], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22016243186427445, "mean_inference_ms": 0.37838048265674173, "mean_action_processing_ms": 0.09119557082479238, "mean_env_wait_ms": 1.6568714132909146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038226445515950522, "StateBufferConnector_ms": 0.002654393513997396, "ViewRequirementAgentConnector_ms": 0.06869713465372722}}, "episode_reward_max": 108038.55241894946, "episode_reward_min": 86230.27517309246, "episode_reward_mean": 99165.4079845531, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89881.18135309684, 90238.15012589388, 86230.27517309246, 91630.42196402462, 89405.40329322935, 93415.63006899075, 89992.48648432153, 90371.44799137308, 89494.64831854153, 91282.72204001664, 94106.06704172709, 93296.00411435272, 97421.73431122795, 98120.10221838586, 99787.9911840913, 101423.66655517199, 103267.07847425103, 103951.20762889825, 103901.02808913121, 104890.34487360984, 106041.04280079636, 106485.08614726027, 106929.58594964325, 107182.29557388673, 107331.96018032906, 107187.29551535251, 107668.45334969128, 107968.53950289222, 108038.55241894946, 108021.83679436338], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22016243186427445, "mean_inference_ms": 0.37838048265674173, "mean_action_processing_ms": 0.09119557082479238, "mean_env_wait_ms": 1.6568714132909146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038226445515950522, "StateBufferConnector_ms": 0.002654393513997396, "ViewRequirementAgentConnector_ms": 0.06869713465372722}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5075880, "num_agent_steps_trained": 5075880, "num_env_steps_sampled": 5075880, "num_env_steps_trained": 5075880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 437.88639322923865, "num_env_steps_trained_throughput_per_sec": 437.88639322923865, "timesteps_total": 5075880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5075880, "timers": {"training_iteration_time_ms": 101352.034, "sample_time_ms": 100216.821, "load_time_ms": 51.129, "load_throughput": 858996.363, "learn_time_ms": 1082.628, "learn_throughput": 40567.944, "synch_weights_time_ms": 1.196}, "counters": {"num_env_steps_sampled": 5075880, "num_env_steps_trained": 5075880, "num_agent_steps_sampled": 5075880, "num_agent_steps_trained": 5075880}, "done": true, "episodes_total": 1189, "training_iteration": 570, "trial_id": "ec4cd_00000", "date": "2023-07-25_02-17-02", "timestamp": 1690240622, "time_this_iter_s": 100.30300688743591, "time_total_s": 10069.113818883896, "pid": 53853, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[3500000, 0.0001], [3719600, 8.5e-05], [3939200, 7.5e-05], [4158800, 5e-05], [4378400, 2.5e-05], [4598000, 1e-05], [4817600, 7.5e-06], [5037200, 5e-06], [5256800, 2.5e-06], [5476400, 1e-06], [5696000, 7.5e-07], [5915600, 5e-07], [6135200, 2.5e-07], [6354800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1579b64c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3116.5642898082733, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 20.788732394366196, "ram_util_percent": 80.66901408450704}}
