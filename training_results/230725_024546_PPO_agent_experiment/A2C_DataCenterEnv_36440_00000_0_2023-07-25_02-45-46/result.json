{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.800000000000002e-05, "entropy_coeff": 0.1, "policy_entropy": 39.87340087890625, "policy_loss": -28017.619921875, "vf_loss": 14243079.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 5076960, "num_env_steps_trained": 5076960, "num_agent_steps_sampled": 5076960, "num_agent_steps_trained": 5076960}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -1906.1132171976321, "episode_reward_mean": -1903.0394207657134, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.457084285231457, "mean_inference_ms": 0.4030270889663343, "mean_action_processing_ms": 0.09731668548160521, "mean_env_wait_ms": 4.218142083350648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003894170125325521, "StateBufferConnector_ms": 0.0028212865193684897, "ViewRequirementAgentConnector_ms": 0.07102489471435547}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -1906.1132171976321, "episode_reward_mean": -1903.0394207657134, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.457084285231457, "mean_inference_ms": 0.4030270889663343, "mean_action_processing_ms": 0.09731668548160521, "mean_env_wait_ms": 4.218142083350648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003894170125325521, "StateBufferConnector_ms": 0.0028212865193684897, "ViewRequirementAgentConnector_ms": 0.07102489471435547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5076960, "num_agent_steps_trained": 5076960, "num_env_steps_sampled": 5076960, "num_env_steps_trained": 5076960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 81.54846016589781, "num_env_steps_trained_throughput_per_sec": 81.54846016589781, "timesteps_total": 5076960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5076960, "timers": {"training_iteration_time_ms": 4414.538, "sample_time_ms": 4398.087, "load_time_ms": 0.383, "load_throughput": 939997.576, "learn_time_ms": 15.261, "learn_throughput": 23589.52, "synch_weights_time_ms": 0.763}, "counters": {"num_env_steps_sampled": 5076960, "num_env_steps_trained": 5076960, "num_agent_steps_sampled": 5076960, "num_agent_steps_trained": 5076960}, "done": false, "episodes_total": 1192, "training_iteration": 571, "trial_id": "36440_00000", "date": "2023-07-25_02-46-06", "timestamp": 1690242366, "time_this_iter_s": 13.246028900146484, "time_total_s": 10082.359847784042, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13.246028900146484, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.594736842105267, "ram_util_percent": 78.53157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.5e-05, "entropy_coeff": 0.1, "policy_entropy": 42.76924514770508, "policy_loss": -29179.50703125, "vf_loss": 14516007.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 5078040, "num_env_steps_trained": 5078040, "num_agent_steps_sampled": 5078040, "num_agent_steps_trained": 5078040}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -1926.2073349150705, "episode_reward_mean": -1911.8349221298547, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705], "episode_lengths": [360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.453985465866729, "mean_inference_ms": 0.40229834112778134, "mean_action_processing_ms": 0.0969386566483394, "mean_env_wait_ms": 3.572355417220432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044027964274088545, "StateBufferConnector_ms": 0.0029166539510091147, "ViewRequirementAgentConnector_ms": 0.0710924466451009}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -1926.2073349150705, "episode_reward_mean": -1911.8349221298547, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705], "episode_lengths": [360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.453985465866729, "mean_inference_ms": 0.40229834112778134, "mean_action_processing_ms": 0.0969386566483394, "mean_env_wait_ms": 3.572355417220432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044027964274088545, "StateBufferConnector_ms": 0.0029166539510091147, "ViewRequirementAgentConnector_ms": 0.0710924466451009}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5078040, "num_agent_steps_trained": 5078040, "num_env_steps_sampled": 5078040, "num_env_steps_trained": 5078040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 103.81488045694378, "num_env_steps_trained_throughput_per_sec": 103.81488045694378, "timesteps_total": 5078040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5078040, "timers": {"training_iteration_time_ms": 3941.118, "sample_time_ms": 3927.599, "load_time_ms": 0.335, "load_throughput": 1075717.958, "learn_time_ms": 12.415, "learn_throughput": 28996.04, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 5078040, "num_env_steps_trained": 5078040, "num_agent_steps_sampled": 5078040, "num_agent_steps_trained": 5078040}, "done": false, "episodes_total": 1195, "training_iteration": 572, "trial_id": "36440_00000", "date": "2023-07-25_02-46-17", "timestamp": 1690242377, "time_this_iter_s": 10.405591011047363, "time_total_s": 10092.76543879509, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 23.651619911193848, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.626666666666665, "ram_util_percent": 77.55333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.2e-05, "entropy_coeff": 0.1, "policy_entropy": 42.340363311767575, "policy_loss": -25897.651953125, "vf_loss": 14814142.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 5079120, "num_env_steps_trained": 5079120, "num_agent_steps_sampled": 5079120, "num_agent_steps_trained": 5079120}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -1957.7725775234064, "episode_reward_mean": -1922.2440312346635, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4486322931941675, "mean_inference_ms": 0.40177055513226334, "mean_action_processing_ms": 0.09668028223849005, "mean_env_wait_ms": 3.2317830446426554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044027964274088545, "StateBufferConnector_ms": 0.0030464596218532985, "ViewRequirementAgentConnector_ms": 0.07585419548882379}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -1957.7725775234064, "episode_reward_mean": -1922.2440312346635, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4486322931941675, "mean_inference_ms": 0.40177055513226334, "mean_action_processing_ms": 0.09668028223849005, "mean_env_wait_ms": 3.2317830446426554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044027964274088545, "StateBufferConnector_ms": 0.0030464596218532985, "ViewRequirementAgentConnector_ms": 0.07585419548882379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5079120, "num_agent_steps_trained": 5079120, "num_env_steps_sampled": 5079120, "num_env_steps_trained": 5079120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 102.43160234259196, "num_env_steps_trained_throughput_per_sec": 102.43160234259196, "timesteps_total": 5079120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5079120, "timers": {"training_iteration_time_ms": 3798.921, "sample_time_ms": 3786.427, "load_time_ms": 0.317, "load_throughput": 1136819.89, "learn_time_ms": 11.43, "learn_throughput": 31497.308, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 5079120, "num_env_steps_trained": 5079120, "num_agent_steps_sampled": 5079120, "num_agent_steps_trained": 5079120}, "done": false, "episodes_total": 1198, "training_iteration": 573, "trial_id": "36440_00000", "date": "2023-07-25_02-46-27", "timestamp": 1690242387, "time_this_iter_s": 10.54599928855896, "time_total_s": 10103.311438083649, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 34.19761919975281, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.27333333333333, "ram_util_percent": 78.07333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.900000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 43.97120895385742, "policy_loss": -31635.07421875, "vf_loss": 16294695.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 5080200, "num_env_steps_trained": 5080200, "num_agent_steps_sampled": 5080200, "num_agent_steps_trained": 5080200}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -2104.4324550133842, "episode_reward_mean": -1951.9104009109476, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4496142076875715, "mean_inference_ms": 0.40159281928730217, "mean_action_processing_ms": 0.09655294041457789, "mean_env_wait_ms": 3.018908206940939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044405460357666016, "StateBufferConnector_ms": 0.0029802322387695312, "ViewRequirementAgentConnector_ms": 0.07419983545939128}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -2104.4324550133842, "episode_reward_mean": -1951.9104009109476, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4496142076875715, "mean_inference_ms": 0.40159281928730217, "mean_action_processing_ms": 0.09655294041457789, "mean_env_wait_ms": 3.018908206940939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044405460357666016, "StateBufferConnector_ms": 0.0029802322387695312, "ViewRequirementAgentConnector_ms": 0.07419983545939128}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5080200, "num_agent_steps_trained": 5080200, "num_env_steps_sampled": 5080200, "num_env_steps_trained": 5080200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 100.78368322943626, "num_env_steps_trained_throughput_per_sec": 100.78368322943626, "timesteps_total": 5080200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5080200, "timers": {"training_iteration_time_ms": 3518.426, "sample_time_ms": 3507.925, "load_time_ms": 0.285, "load_throughput": 1262182.931, "learn_time_ms": 9.47, "learn_throughput": 38016.563, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 5080200, "num_env_steps_trained": 5080200, "num_agent_steps_sampled": 5080200, "num_agent_steps_trained": 5080200}, "done": false, "episodes_total": 1201, "training_iteration": 574, "trial_id": "36440_00000", "date": "2023-07-25_02-46-38", "timestamp": 1690242398, "time_this_iter_s": 10.718470811843872, "time_total_s": 10114.029908895493, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 44.91609001159668, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.880000000000003, "ram_util_percent": 78.22666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.6e-05, "entropy_coeff": 0.1, "policy_entropy": 42.406776428222656, "policy_loss": -41110.16015625, "vf_loss": 20482633.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 5081280, "num_env_steps_trained": 5081280, "num_agent_steps_sampled": 5081280, "num_agent_steps_trained": 5081280}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -2491.2810202745804, "episode_reward_mean": -2022.2209309461512, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.452601472295516, "mean_inference_ms": 0.4013511235785579, "mean_action_processing_ms": 0.09645532301939576, "mean_env_wait_ms": 2.8723061759169033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004464785257975261, "StateBufferConnector_ms": 0.0030533472696940103, "ViewRequirementAgentConnector_ms": 0.07549126942952473}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -2491.2810202745804, "episode_reward_mean": -2022.2209309461512, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.452601472295516, "mean_inference_ms": 0.4013511235785579, "mean_action_processing_ms": 0.09645532301939576, "mean_env_wait_ms": 2.8723061759169033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004464785257975261, "StateBufferConnector_ms": 0.0030533472696940103, "ViewRequirementAgentConnector_ms": 0.07549126942952473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5081280, "num_agent_steps_trained": 5081280, "num_env_steps_sampled": 5081280, "num_env_steps_trained": 5081280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 100.27753722784335, "num_env_steps_trained_throughput_per_sec": 100.27753722784335, "timesteps_total": 5081280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5081280, "timers": {"training_iteration_time_ms": 3561.57, "sample_time_ms": 3551.077, "load_time_ms": 0.287, "load_throughput": 1253798.422, "learn_time_ms": 9.46, "learn_throughput": 38056.614, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 5081280, "num_env_steps_trained": 5081280, "num_agent_steps_sampled": 5081280, "num_agent_steps_trained": 5081280}, "done": false, "episodes_total": 1204, "training_iteration": 575, "trial_id": "36440_00000", "date": "2023-07-25_02-46-49", "timestamp": 1690242409, "time_this_iter_s": 10.772568702697754, "time_total_s": 10124.80247759819, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 55.688658714294434, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.875, "ram_util_percent": 78.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.366666666666668e-05, "entropy_coeff": 0.1, "policy_entropy": 30.466687393188476, "policy_loss": -34354.7828125, "vf_loss": 24983429.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}}, "num_env_steps_sampled": 5082360, "num_env_steps_trained": 5082360, "num_agent_steps_sampled": 5082360, "num_agent_steps_trained": 5082360}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -2849.2379812251766, "episode_reward_mean": -2144.581777238043, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.455389607132613, "mean_inference_ms": 0.4010989853802028, "mean_action_processing_ms": 0.096376987742658, "mean_env_wait_ms": 2.759495774944731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004340542687310113, "StateBufferConnector_ms": 0.0030729505750868055, "ViewRequirementAgentConnector_ms": 0.07462501525878906}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -2849.2379812251766, "episode_reward_mean": -2144.581777238043, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.455389607132613, "mean_inference_ms": 0.4010989853802028, "mean_action_processing_ms": 0.096376987742658, "mean_env_wait_ms": 2.759495774944731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004340542687310113, "StateBufferConnector_ms": 0.0030729505750868055, "ViewRequirementAgentConnector_ms": 0.07462501525878906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5082360, "num_agent_steps_trained": 5082360, "num_env_steps_sampled": 5082360, "num_env_steps_trained": 5082360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 102.16762574380184, "num_env_steps_trained_throughput_per_sec": 102.16762574380184, "timesteps_total": 5082360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5082360, "timers": {"training_iteration_time_ms": 3566.607, "sample_time_ms": 3556.06, "load_time_ms": 0.293, "load_throughput": 1230602.641, "learn_time_ms": 9.495, "learn_throughput": 37916.612, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 5082360, "num_env_steps_trained": 5082360, "num_agent_steps_sampled": 5082360, "num_agent_steps_trained": 5082360}, "done": false, "episodes_total": 1207, "training_iteration": 576, "trial_id": "36440_00000", "date": "2023-07-25_02-46-59", "timestamp": 1690242419, "time_this_iter_s": 10.573258876800537, "time_total_s": 10135.37573647499, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 66.26191759109497, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.326666666666664, "ram_util_percent": 78.22666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.166666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 18.974880981445313, "policy_loss": -26342.4748046875, "vf_loss": 26464242.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 5083440, "num_env_steps_trained": 5083440, "num_agent_steps_sampled": 5083440, "num_agent_steps_trained": 5083440}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -2979.5257021258353, "episode_reward_mean": -2255.483737006528, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.457032393090845, "mean_inference_ms": 0.4013260013526813, "mean_action_processing_ms": 0.09642674096402368, "mean_env_wait_ms": 2.6683961504443237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004267692565917969, "StateBufferConnector_ms": 0.0030256453014555432, "ViewRequirementAgentConnector_ms": 0.07422424498058501}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -2979.5257021258353, "episode_reward_mean": -2255.483737006528, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.457032393090845, "mean_inference_ms": 0.4013260013526813, "mean_action_processing_ms": 0.09642674096402368, "mean_env_wait_ms": 2.6683961504443237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004267692565917969, "StateBufferConnector_ms": 0.0030256453014555432, "ViewRequirementAgentConnector_ms": 0.07422424498058501}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5083440, "num_agent_steps_trained": 5083440, "num_env_steps_sampled": 5083440, "num_env_steps_trained": 5083440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 102.96837814782371, "num_env_steps_trained_throughput_per_sec": 102.96837814782371, "timesteps_total": 5083440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5083440, "timers": {"training_iteration_time_ms": 3544.746, "sample_time_ms": 3534.165, "load_time_ms": 0.299, "load_throughput": 1203146.964, "learn_time_ms": 9.528, "learn_throughput": 37782.74, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 5083440, "num_env_steps_trained": 5083440, "num_agent_steps_sampled": 5083440, "num_agent_steps_trained": 5083440}, "done": false, "episodes_total": 1210, "training_iteration": 577, "trial_id": "36440_00000", "date": "2023-07-25_02-47-10", "timestamp": 1690242430, "time_this_iter_s": 10.491524934768677, "time_total_s": 10145.86726140976, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 76.75344252586365, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.026666666666664, "ram_util_percent": 78.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.966666666666666e-05, "entropy_coeff": 0.1, "policy_entropy": 17.202759170532225, "policy_loss": -15173.54609375, "vf_loss": 28705006.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 118.0, "diff_num_grad_updates_vs_sampler_policy": 117.0}}, "num_env_steps_sampled": 5084520, "num_env_steps_trained": 5084520, "num_agent_steps_sampled": 5084520, "num_agent_steps_trained": 5084520}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3150.053969977487, "episode_reward_mean": -2362.2790459662624, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4598843407482525, "mean_inference_ms": 0.4014365310745238, "mean_action_processing_ms": 0.096443704498568, "mean_env_wait_ms": 2.592654437516061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00434120496114095, "StateBufferConnector_ms": 0.003023942311604818, "ViewRequirementAgentConnector_ms": 0.07396340370178223}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3150.053969977487, "episode_reward_mean": -2362.2790459662624, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4598843407482525, "mean_inference_ms": 0.4014365310745238, "mean_action_processing_ms": 0.096443704498568, "mean_env_wait_ms": 2.592654437516061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00434120496114095, "StateBufferConnector_ms": 0.003023942311604818, "ViewRequirementAgentConnector_ms": 0.07396340370178223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5084520, "num_agent_steps_trained": 5084520, "num_env_steps_sampled": 5084520, "num_env_steps_trained": 5084520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 102.34302014966575, "num_env_steps_trained_throughput_per_sec": 102.34302014966575, "timesteps_total": 5084520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5084520, "timers": {"training_iteration_time_ms": 3510.577, "sample_time_ms": 3499.923, "load_time_ms": 0.301, "load_throughput": 1196947.634, "learn_time_ms": 9.602, "learn_throughput": 37492.382, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 5084520, "num_env_steps_trained": 5084520, "num_agent_steps_sampled": 5084520, "num_agent_steps_trained": 5084520}, "done": false, "episodes_total": 1213, "training_iteration": 578, "trial_id": "36440_00000", "date": "2023-07-25_02-47-21", "timestamp": 1690242441, "time_this_iter_s": 10.55533218383789, "time_total_s": 10156.422593593597, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 87.30877470970154, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.680000000000003, "ram_util_percent": 78.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.766666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 18.757863998413086, "policy_loss": -20105.1912109375, "vf_loss": 27330129.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 133.0, "diff_num_grad_updates_vs_sampler_policy": 132.0}}, "num_env_steps_sampled": 5085600, "num_env_steps_trained": 5085600, "num_agent_steps_sampled": 5085600, "num_agent_steps_trained": 5085600}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3150.053969977487, "episode_reward_mean": -2441.0698861836427, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4626319876560725, "mean_inference_ms": 0.4015158755542877, "mean_action_processing_ms": 0.09644534859620142, "mean_env_wait_ms": 2.528716221842251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043242065994827834, "StateBufferConnector_ms": 0.003029682018138744, "ViewRequirementAgentConnector_ms": 0.07501619833487051}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3150.053969977487, "episode_reward_mean": -2441.0698861836427, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4626319876560725, "mean_inference_ms": 0.4015158755542877, "mean_action_processing_ms": 0.09644534859620142, "mean_env_wait_ms": 2.528716221842251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043242065994827834, "StateBufferConnector_ms": 0.003029682018138744, "ViewRequirementAgentConnector_ms": 0.07501619833487051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5085600, "num_agent_steps_trained": 5085600, "num_env_steps_sampled": 5085600, "num_env_steps_trained": 5085600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 102.72958051953336, "num_env_steps_trained_throughput_per_sec": 102.72958051953336, "timesteps_total": 5085600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5085600, "timers": {"training_iteration_time_ms": 3496.335, "sample_time_ms": 3485.629, "load_time_ms": 0.302, "load_throughput": 1191751.728, "learn_time_ms": 9.64, "learn_throughput": 37346.237, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 5085600, "num_env_steps_trained": 5085600, "num_agent_steps_sampled": 5085600, "num_agent_steps_trained": 5085600}, "done": false, "episodes_total": 1216, "training_iteration": 579, "trial_id": "36440_00000", "date": "2023-07-25_02-47-31", "timestamp": 1690242451, "time_this_iter_s": 10.515711069107056, "time_total_s": 10166.938304662704, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 97.8244857788086, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.44, "ram_util_percent": 77.84666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.566666666666666e-05, "entropy_coeff": 0.1, "policy_entropy": 21.900014114379882, "policy_loss": -25639.7953125, "vf_loss": 27890938.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 148.0, "diff_num_grad_updates_vs_sampler_policy": 147.0}}, "num_env_steps_sampled": 5086680, "num_env_steps_trained": 5086680, "num_agent_steps_sampled": 5086680, "num_agent_steps_trained": 5086680}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2507.9237241656606, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.46578910951064, "mean_inference_ms": 0.4015247465024288, "mean_action_processing_ms": 0.09643069709085943, "mean_env_wait_ms": 2.4736578613401585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004374980926513672, "StateBufferConnector_ms": 0.003003279368082682, "ViewRequirementAgentConnector_ms": 0.07451613744099934}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2507.9237241656606, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.46578910951064, "mean_inference_ms": 0.4015247465024288, "mean_action_processing_ms": 0.09643069709085943, "mean_env_wait_ms": 2.4736578613401585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004374980926513672, "StateBufferConnector_ms": 0.003003279368082682, "ViewRequirementAgentConnector_ms": 0.07451613744099934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5086680, "num_agent_steps_trained": 5086680, "num_env_steps_sampled": 5086680, "num_env_steps_trained": 5086680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 102.48406896282107, "num_env_steps_trained_throughput_per_sec": 102.48406896282107, "timesteps_total": 5086680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5086680, "timers": {"training_iteration_time_ms": 3490.678, "sample_time_ms": 3479.911, "load_time_ms": 0.299, "load_throughput": 1202667.814, "learn_time_ms": 9.712, "learn_throughput": 37068.074, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 5086680, "num_env_steps_trained": 5086680, "num_agent_steps_sampled": 5086680, "num_agent_steps_trained": 5086680}, "done": false, "episodes_total": 1219, "training_iteration": 580, "trial_id": "36440_00000", "date": "2023-07-25_02-47-42", "timestamp": 1690242462, "time_this_iter_s": 10.540844202041626, "time_total_s": 10177.479148864746, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 108.36532998085022, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.366666666666664, "ram_util_percent": 78.08000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.166666666666666e-05, "entropy_coeff": 0.1, "policy_entropy": 13.984784126281738, "policy_loss": -24160.5236328125, "vf_loss": 26117439.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 163.0, "diff_num_grad_updates_vs_sampler_policy": 162.0}}, "num_env_steps_sampled": 5087760, "num_env_steps_trained": 5087760, "num_agent_steps_sampled": 5087760, "num_agent_steps_trained": 5087760}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2551.900986351091, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.469736873214238, "mean_inference_ms": 0.4015320923817718, "mean_action_processing_ms": 0.09641466848876341, "mean_env_wait_ms": 2.4261272287149875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043710072835286455, "StateBufferConnector_ms": 0.0030257485129616475, "ViewRequirementAgentConnector_ms": 0.07475289431485263}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2551.900986351091, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.469736873214238, "mean_inference_ms": 0.4015320923817718, "mean_action_processing_ms": 0.09641466848876341, "mean_env_wait_ms": 2.4261272287149875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043710072835286455, "StateBufferConnector_ms": 0.0030257485129616475, "ViewRequirementAgentConnector_ms": 0.07475289431485263}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5087760, "num_agent_steps_trained": 5087760, "num_env_steps_sampled": 5087760, "num_env_steps_trained": 5087760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 101.08538363522352, "num_env_steps_trained_throughput_per_sec": 101.08538363522352, "timesteps_total": 5087760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5087760, "timers": {"training_iteration_time_ms": 3512.322, "sample_time_ms": 3501.552, "load_time_ms": 0.298, "load_throughput": 1206415.34, "learn_time_ms": 9.722, "learn_throughput": 37028.531, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 5087760, "num_env_steps_trained": 5087760, "num_agent_steps_sampled": 5087760, "num_agent_steps_trained": 5087760}, "done": false, "episodes_total": 1222, "training_iteration": 581, "trial_id": "36440_00000", "date": "2023-07-25_02-47-52", "timestamp": 1690242472, "time_this_iter_s": 10.686668872833252, "time_total_s": 10188.16581773758, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 119.05199885368347, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.60666666666667, "ram_util_percent": 77.97999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 0.8118712425231933, "policy_loss": -15859.7373046875, "vf_loss": 23929192.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 178.0, "diff_num_grad_updates_vs_sampler_policy": 177.0}}, "num_env_steps_sampled": 5088840, "num_env_steps_trained": 5088840, "num_agent_steps_sampled": 5088840, "num_agent_steps_trained": 5088840}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2579.381600594277, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.472581747342588, "mean_inference_ms": 0.40152439582546773, "mean_action_processing_ms": 0.09639793160421811, "mean_env_wait_ms": 2.385110217792641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004370345009697808, "StateBufferConnector_ms": 0.0030385123358832467, "ViewRequirementAgentConnector_ms": 0.07502900229560004}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2579.381600594277, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.472581747342588, "mean_inference_ms": 0.40152439582546773, "mean_action_processing_ms": 0.09639793160421811, "mean_env_wait_ms": 2.385110217792641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004370345009697808, "StateBufferConnector_ms": 0.0030385123358832467, "ViewRequirementAgentConnector_ms": 0.07502900229560004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5088840, "num_agent_steps_trained": 5088840, "num_env_steps_sampled": 5088840, "num_env_steps_trained": 5088840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 102.59835106018902, "num_env_steps_trained_throughput_per_sec": 102.59835106018902, "timesteps_total": 5088840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5088840, "timers": {"training_iteration_time_ms": 3513.318, "sample_time_ms": 3502.649, "load_time_ms": 0.299, "load_throughput": 1202284.768, "learn_time_ms": 9.606, "learn_throughput": 37476.376, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 5088840, "num_env_steps_trained": 5088840, "num_agent_steps_sampled": 5088840, "num_agent_steps_trained": 5088840}, "done": false, "episodes_total": 1225, "training_iteration": 582, "trial_id": "36440_00000", "date": "2023-07-25_02-48-03", "timestamp": 1690242483, "time_this_iter_s": 10.529372930526733, "time_total_s": 10198.695190668106, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 129.5813717842102, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 25.959999999999997, "ram_util_percent": 77.99333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -8.464593505859375, "policy_loss": -2419.19365234375, "vf_loss": 22430487.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 192.0}}, "num_env_steps_sampled": 5089920, "num_env_steps_trained": 5089920, "num_agent_steps_sampled": 5089920, "num_agent_steps_trained": 5089920}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2592.6110341808144, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.475217031139459, "mean_inference_ms": 0.4015062256794273, "mean_action_processing_ms": 0.0963783228596636, "mean_env_wait_ms": 2.349237797086139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004343497447478466, "StateBufferConnector_ms": 0.0030120213826497397, "ViewRequirementAgentConnector_ms": 0.07497469584147136}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2592.6110341808144, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.475217031139459, "mean_inference_ms": 0.4015062256794273, "mean_action_processing_ms": 0.0963783228596636, "mean_env_wait_ms": 2.349237797086139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004343497447478466, "StateBufferConnector_ms": 0.0030120213826497397, "ViewRequirementAgentConnector_ms": 0.07497469584147136}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5089920, "num_agent_steps_trained": 5089920, "num_env_steps_sampled": 5089920, "num_env_steps_trained": 5089920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 101.7026245005291, "num_env_steps_trained_throughput_per_sec": 101.7026245005291, "timesteps_total": 5089920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5089920, "timers": {"training_iteration_time_ms": 3533.474, "sample_time_ms": 3522.856, "load_time_ms": 0.299, "load_throughput": 1204298.485, "learn_time_ms": 9.562, "learn_throughput": 37649.999, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 5089920, "num_env_steps_trained": 5089920, "num_agent_steps_sampled": 5089920, "num_agent_steps_trained": 5089920}, "done": false, "episodes_total": 1228, "training_iteration": 583, "trial_id": "36440_00000", "date": "2023-07-25_02-48-14", "timestamp": 1690242494, "time_this_iter_s": 10.621807098388672, "time_total_s": 10209.316997766495, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 140.20317888259888, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.90666666666667, "ram_util_percent": 77.78666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -13.717075729370118, "policy_loss": 10247.952880859375, "vf_loss": 20893719.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 208.0, "diff_num_grad_updates_vs_sampler_policy": 207.0}}, "num_env_steps_sampled": 5091000, "num_env_steps_trained": 5091000, "num_agent_steps_sampled": 5091000, "num_agent_steps_trained": 5091000}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2597.808687052114, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.477968003761806, "mean_inference_ms": 0.4014772843515226, "mean_action_processing_ms": 0.0963567082407738, "mean_env_wait_ms": 2.3176738787791065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004514626094273159, "StateBufferConnector_ms": 0.0030154273623511905, "ViewRequirementAgentConnector_ms": 0.07501499993460518}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2597.808687052114, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.477968003761806, "mean_inference_ms": 0.4014772843515226, "mean_action_processing_ms": 0.0963567082407738, "mean_env_wait_ms": 2.3176738787791065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004514626094273159, "StateBufferConnector_ms": 0.0030154273623511905, "ViewRequirementAgentConnector_ms": 0.07501499993460518}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5091000, "num_agent_steps_trained": 5091000, "num_env_steps_sampled": 5091000, "num_env_steps_trained": 5091000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 100.85904772244406, "num_env_steps_trained_throughput_per_sec": 100.85904772244406, "timesteps_total": 5091000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5091000, "timers": {"training_iteration_time_ms": 3534.354, "sample_time_ms": 3523.712, "load_time_ms": 0.305, "load_throughput": 1179648.0, "learn_time_ms": 9.579, "learn_throughput": 37583.65, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 5091000, "num_env_steps_trained": 5091000, "num_agent_steps_sampled": 5091000, "num_agent_steps_trained": 5091000}, "done": false, "episodes_total": 1231, "training_iteration": 584, "trial_id": "36440_00000", "date": "2023-07-25_02-48-24", "timestamp": 1690242504, "time_this_iter_s": 10.710494041442871, "time_total_s": 10220.027491807938, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 150.91367292404175, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 22.21333333333333, "ram_util_percent": 77.56}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.166666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -13.343851852416993, "policy_loss": 6881.79853515625, "vf_loss": 19354745.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 223.0, "diff_num_grad_updates_vs_sampler_policy": 222.0}}, "num_env_steps_sampled": 5092080, "num_env_steps_trained": 5092080, "num_agent_steps_sampled": 5092080, "num_agent_steps_trained": 5092080}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2595.281420013652, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.480470244738177, "mean_inference_ms": 0.40143296384868876, "mean_action_processing_ms": 0.09633149605756773, "mean_env_wait_ms": 2.289664847004196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004455248514811198, "StateBufferConnector_ms": 0.002997716267903646, "ViewRequirementAgentConnector_ms": 0.07474422454833984}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2595.281420013652, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.480470244738177, "mean_inference_ms": 0.40143296384868876, "mean_action_processing_ms": 0.09633149605756773, "mean_env_wait_ms": 2.289664847004196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004455248514811198, "StateBufferConnector_ms": 0.002997716267903646, "ViewRequirementAgentConnector_ms": 0.07474422454833984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5092080, "num_agent_steps_trained": 5092080, "num_env_steps_sampled": 5092080, "num_env_steps_trained": 5092080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 101.52161386850507, "num_env_steps_trained_throughput_per_sec": 101.52161386850507, "timesteps_total": 5092080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5092080, "timers": {"training_iteration_time_ms": 3547.689, "sample_time_ms": 3537.034, "load_time_ms": 0.306, "load_throughput": 1178267.218, "learn_time_ms": 9.592, "learn_throughput": 37532.175, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 5092080, "num_env_steps_trained": 5092080, "num_agent_steps_sampled": 5092080, "num_agent_steps_trained": 5092080}, "done": false, "episodes_total": 1234, "training_iteration": 585, "trial_id": "36440_00000", "date": "2023-07-25_02-48-35", "timestamp": 1690242515, "time_this_iter_s": 10.640926122665405, "time_total_s": 10230.668417930603, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 161.55459904670715, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.118750000000002, "ram_util_percent": 77.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -2.3326205253601073, "policy_loss": -13988.282470703125, "vf_loss": 18485328.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 238.0, "diff_num_grad_updates_vs_sampler_policy": 237.0}}, "num_env_steps_sampled": 5093160, "num_env_steps_trained": 5093160, "num_agent_steps_sampled": 5093160, "num_agent_steps_trained": 5093160}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2590.6248511129756, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.483058615066864, "mean_inference_ms": 0.40139366196317017, "mean_action_processing_ms": 0.09630720969748403, "mean_env_wait_ms": 2.2647869924201807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004475315411885579, "StateBufferConnector_ms": 0.0030001004536946616, "ViewRequirementAgentConnector_ms": 0.07464935382207234}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2590.6248511129756, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.483058615066864, "mean_inference_ms": 0.40139366196317017, "mean_action_processing_ms": 0.09630720969748403, "mean_env_wait_ms": 2.2647869924201807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004475315411885579, "StateBufferConnector_ms": 0.0030001004536946616, "ViewRequirementAgentConnector_ms": 0.07464935382207234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5093160, "num_agent_steps_trained": 5093160, "num_env_steps_sampled": 5093160, "num_env_steps_trained": 5093160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 100.24442799908675, "num_env_steps_trained_throughput_per_sec": 100.24442799908675, "timesteps_total": 5093160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5093160, "timers": {"training_iteration_time_ms": 3572.535, "sample_time_ms": 3561.821, "load_time_ms": 0.307, "load_throughput": 1171048.115, "learn_time_ms": 9.654, "learn_throughput": 37291.91, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 5093160, "num_env_steps_trained": 5093160, "num_agent_steps_sampled": 5093160, "num_agent_steps_trained": 5093160}, "done": false, "episodes_total": 1237, "training_iteration": 586, "trial_id": "36440_00000", "date": "2023-07-25_02-48-46", "timestamp": 1690242526, "time_this_iter_s": 10.776254892349243, "time_total_s": 10241.444672822952, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 172.3308539390564, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.80666666666667, "ram_util_percent": 78.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.166666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 11.100798034667969, "policy_loss": -12110.984350585937, "vf_loss": 17654361.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 253.0, "diff_num_grad_updates_vs_sampler_policy": 252.0}}, "num_env_steps_sampled": 5094240, "num_env_steps_trained": 5094240, "num_agent_steps_sampled": 5094240, "num_agent_steps_trained": 5094240}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2585.846854814171, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4857284173182554, "mean_inference_ms": 0.4013667596370849, "mean_action_processing_ms": 0.09628518183132012, "mean_env_wait_ms": 2.242891171269708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044345855712890625, "StateBufferConnector_ms": 0.003001269172219669, "ViewRequirementAgentConnector_ms": 0.07456424189548866}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2585.846854814171, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4857284173182554, "mean_inference_ms": 0.4013667596370849, "mean_action_processing_ms": 0.09628518183132012, "mean_env_wait_ms": 2.242891171269708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044345855712890625, "StateBufferConnector_ms": 0.003001269172219669, "ViewRequirementAgentConnector_ms": 0.07456424189548866}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5094240, "num_agent_steps_trained": 5094240, "num_env_steps_sampled": 5094240, "num_env_steps_trained": 5094240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 99.01733740153018, "num_env_steps_trained_throughput_per_sec": 99.01733740153018, "timesteps_total": 5094240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5094240, "timers": {"training_iteration_time_ms": 3607.903, "sample_time_ms": 3597.128, "load_time_ms": 0.307, "load_throughput": 1172412.02, "learn_time_ms": 9.698, "learn_throughput": 37122.115, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 5094240, "num_env_steps_trained": 5094240, "num_agent_steps_sampled": 5094240, "num_agent_steps_trained": 5094240}, "done": false, "episodes_total": 1240, "training_iteration": 587, "trial_id": "36440_00000", "date": "2023-07-25_02-48-57", "timestamp": 1690242537, "time_this_iter_s": 10.909811019897461, "time_total_s": 10252.35448384285, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 183.24066495895386, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 24.12, "ram_util_percent": 77.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 27.335464859008788, "policy_loss": -23287.137890625, "vf_loss": 16883861.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 268.0, "diff_num_grad_updates_vs_sampler_policy": 267.0}}, "num_env_steps_sampled": 5095320, "num_env_steps_trained": 5095320, "num_agent_steps_sampled": 5095320, "num_agent_steps_trained": 5095320}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2581.14759530785, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.488073767561497, "mean_inference_ms": 0.40135558249643233, "mean_action_processing_ms": 0.09626655961220465, "mean_env_wait_ms": 2.223498146187121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004402354911521629, "StateBufferConnector_ms": 0.003010255319100839, "ViewRequirementAgentConnector_ms": 0.0745340629860207}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2581.14759530785, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.488073767561497, "mean_inference_ms": 0.40135558249643233, "mean_action_processing_ms": 0.09626655961220465, "mean_env_wait_ms": 2.223498146187121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004402354911521629, "StateBufferConnector_ms": 0.003010255319100839, "ViewRequirementAgentConnector_ms": 0.0745340629860207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5095320, "num_agent_steps_trained": 5095320, "num_env_steps_sampled": 5095320, "num_env_steps_trained": 5095320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 100.0467987331575, "num_env_steps_trained_throughput_per_sec": 100.0467987331575, "timesteps_total": 5095320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5095320, "timers": {"training_iteration_time_ms": 3600.503, "sample_time_ms": 3589.661, "load_time_ms": 0.308, "load_throughput": 1166975.377, "learn_time_ms": 9.753, "learn_throughput": 36913.115, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 5095320, "num_env_steps_trained": 5095320, "num_agent_steps_sampled": 5095320, "num_agent_steps_trained": 5095320}, "done": false, "episodes_total": 1243, "training_iteration": 588, "trial_id": "36440_00000", "date": "2023-07-25_02-49-07", "timestamp": 1690242547, "time_this_iter_s": 10.797744750976562, "time_total_s": 10263.152228593826, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 194.03840970993042, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 25.30625, "ram_util_percent": 77.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.166666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 41.82008819580078, "policy_loss": -32088.901953125, "vf_loss": 16615114.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 283.0, "diff_num_grad_updates_vs_sampler_policy": 282.0}}, "num_env_steps_sampled": 5096400, "num_env_steps_trained": 5096400, "num_agent_steps_sampled": 5096400, "num_agent_steps_trained": 5096400}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2578.1204661903903, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.48984193026145, "mean_inference_ms": 0.4013528811145994, "mean_action_processing_ms": 0.09624929294800501, "mean_env_wait_ms": 2.206777041835076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00435092992949904, "StateBufferConnector_ms": 0.0030078386005602383, "ViewRequirementAgentConnector_ms": 0.07416909201103344}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2578.1204661903903, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.48984193026145, "mean_inference_ms": 0.4013528811145994, "mean_action_processing_ms": 0.09624929294800501, "mean_env_wait_ms": 2.206777041835076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00435092992949904, "StateBufferConnector_ms": 0.0030078386005602383, "ViewRequirementAgentConnector_ms": 0.07416909201103344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5096400, "num_agent_steps_trained": 5096400, "num_env_steps_sampled": 5096400, "num_env_steps_trained": 5096400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 99.119433726812, "num_env_steps_trained_throughput_per_sec": 99.119433726812, "timesteps_total": 5096400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5096400, "timers": {"training_iteration_time_ms": 3628.855, "sample_time_ms": 3618.066, "load_time_ms": 0.305, "load_throughput": 1180939.653, "learn_time_ms": 9.703, "learn_throughput": 37103.415, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 5096400, "num_env_steps_trained": 5096400, "num_agent_steps_sampled": 5096400, "num_agent_steps_trained": 5096400}, "done": false, "episodes_total": 1246, "training_iteration": 589, "trial_id": "36440_00000", "date": "2023-07-25_02-49-18", "timestamp": 1690242558, "time_this_iter_s": 10.898623943328857, "time_total_s": 10274.050852537155, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 204.93703365325928, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.733333333333334, "ram_util_percent": 77.79333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.6666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 49.59286804199219, "policy_loss": -34037.641015625, "vf_loss": 16468334.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 298.0, "diff_num_grad_updates_vs_sampler_policy": 297.0}}, "num_env_steps_sampled": 5097480, "num_env_steps_trained": 5097480, "num_agent_steps_sampled": 5097480, "num_agent_steps_trained": 5097480}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2576.6863216170627, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.491316236775885, "mean_inference_ms": 0.4013683417990459, "mean_action_processing_ms": 0.09623551903063206, "mean_env_wait_ms": 2.1922160085104596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004312197367350261, "StateBufferConnector_ms": 0.002990563710530599, "ViewRequirementAgentConnector_ms": 0.0738680362701416}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2576.6863216170627, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.491316236775885, "mean_inference_ms": 0.4013683417990459, "mean_action_processing_ms": 0.09623551903063206, "mean_env_wait_ms": 2.1922160085104596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004312197367350261, "StateBufferConnector_ms": 0.002990563710530599, "ViewRequirementAgentConnector_ms": 0.0738680362701416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5097480, "num_agent_steps_trained": 5097480, "num_env_steps_sampled": 5097480, "num_env_steps_trained": 5097480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 98.62037278617063, "num_env_steps_trained_throughput_per_sec": 98.62037278617063, "timesteps_total": 5097480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5097480, "timers": {"training_iteration_time_ms": 3632.789, "sample_time_ms": 3621.947, "load_time_ms": 0.304, "load_throughput": 1184274.071, "learn_time_ms": 9.749, "learn_throughput": 36928.733, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 5097480, "num_env_steps_trained": 5097480, "num_agent_steps_sampled": 5097480, "num_agent_steps_trained": 5097480}, "done": false, "episodes_total": 1249, "training_iteration": 590, "trial_id": "36440_00000", "date": "2023-07-25_02-49-29", "timestamp": 1690242569, "time_this_iter_s": 10.953757047653198, "time_total_s": 10285.004609584808, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 215.89079070091248, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.48125, "ram_util_percent": 77.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3e-05, "entropy_coeff": 0.1, "policy_entropy": 62.388371276855466, "policy_loss": -42052.26796875, "vf_loss": 15764463.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 313.0, "diff_num_grad_updates_vs_sampler_policy": 312.0}}, "num_env_steps_sampled": 5098560, "num_env_steps_trained": 5098560, "num_agent_steps_sampled": 5098560, "num_agent_steps_trained": 5098560}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2576.088797566668, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.492475983039489, "mean_inference_ms": 0.40139160177987393, "mean_action_processing_ms": 0.09622315511391304, "mean_env_wait_ms": 2.1795097210500742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00427072010343037, "StateBufferConnector_ms": 0.0029741771637447297, "ViewRequirementAgentConnector_ms": 0.07352185627770802}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2576.088797566668, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.492475983039489, "mean_inference_ms": 0.40139160177987393, "mean_action_processing_ms": 0.09622315511391304, "mean_env_wait_ms": 2.1795097210500742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00427072010343037, "StateBufferConnector_ms": 0.0029741771637447297, "ViewRequirementAgentConnector_ms": 0.07352185627770802}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5098560, "num_agent_steps_trained": 5098560, "num_env_steps_sampled": 5098560, "num_env_steps_trained": 5098560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 98.7559843661208, "num_env_steps_trained_throughput_per_sec": 98.7559843661208, "timesteps_total": 5098560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5098560, "timers": {"training_iteration_time_ms": 3651.103, "sample_time_ms": 3640.293, "load_time_ms": 0.302, "load_throughput": 1192316.361, "learn_time_ms": 9.731, "learn_throughput": 36994.42, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 5098560, "num_env_steps_trained": 5098560, "num_agent_steps_sampled": 5098560, "num_agent_steps_trained": 5098560}, "done": false, "episodes_total": 1252, "training_iteration": 591, "trial_id": "36440_00000", "date": "2023-07-25_02-49-40", "timestamp": 1690242580, "time_this_iter_s": 10.93860125541687, "time_total_s": 10295.943210840225, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 226.82939195632935, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.8875, "ram_util_percent": 77.20625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2e-05, "entropy_coeff": 0.1, "policy_entropy": 68.47653503417969, "policy_loss": -47791.2765625, "vf_loss": 15919349.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 328.0, "diff_num_grad_updates_vs_sampler_policy": 327.0}}, "num_env_steps_sampled": 5099640, "num_env_steps_trained": 5099640, "num_agent_steps_sampled": 5099640, "num_agent_steps_trained": 5099640}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2576.3358334587506, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.493369625991637, "mean_inference_ms": 0.401418844551705, "mean_action_processing_ms": 0.09621228637383505, "mean_env_wait_ms": 2.1684622199936454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004292256904370857, "StateBufferConnector_ms": 0.0029748136346990414, "ViewRequirementAgentConnector_ms": 0.07337982004339044}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2576.3358334587506, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.493369625991637, "mean_inference_ms": 0.401418844551705, "mean_action_processing_ms": 0.09621228637383505, "mean_env_wait_ms": 2.1684622199936454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004292256904370857, "StateBufferConnector_ms": 0.0029748136346990414, "ViewRequirementAgentConnector_ms": 0.07337982004339044}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5099640, "num_agent_steps_trained": 5099640, "num_env_steps_sampled": 5099640, "num_env_steps_trained": 5099640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 98.36236636683091, "num_env_steps_trained_throughput_per_sec": 98.36236636683091, "timesteps_total": 5099640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5099640, "timers": {"training_iteration_time_ms": 3657.393, "sample_time_ms": 3646.662, "load_time_ms": 0.3, "load_throughput": 1200182.37, "learn_time_ms": 9.675, "learn_throughput": 37207.919, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 5099640, "num_env_steps_trained": 5099640, "num_agent_steps_sampled": 5099640, "num_agent_steps_trained": 5099640}, "done": false, "episodes_total": 1255, "training_iteration": 592, "trial_id": "36440_00000", "date": "2023-07-25_02-49-51", "timestamp": 1690242591, "time_this_iter_s": 10.982572078704834, "time_total_s": 10306.92578291893, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 237.81196403503418, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.5, "ram_util_percent": 77.07333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7e-05, "entropy_coeff": 0.1, "policy_entropy": 75.6876708984375, "policy_loss": -53226.9625, "vf_loss": 16172319.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.0, "diff_num_grad_updates_vs_sampler_policy": 342.0}}, "num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2578.8511990828033, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.494388068192614, "mean_inference_ms": 0.4014565126530277, "mean_action_processing_ms": 0.09620395257080096, "mean_env_wait_ms": 2.158828977398923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043019004490064535, "StateBufferConnector_ms": 0.0029674474743829255, "ViewRequirementAgentConnector_ms": 0.07310259169426517}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2578.8511990828033, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.494388068192614, "mean_inference_ms": 0.4014565126530277, "mean_action_processing_ms": 0.09620395257080096, "mean_env_wait_ms": 2.158828977398923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043019004490064535, "StateBufferConnector_ms": 0.0029674474743829255, "ViewRequirementAgentConnector_ms": 0.07310259169426517}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720, "num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.51445897860718, "num_env_steps_trained_throughput_per_sec": 96.51445897860718, "timesteps_total": 5100720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5100720, "timers": {"training_iteration_time_ms": 3682.722, "sample_time_ms": 3671.907, "load_time_ms": 0.302, "load_throughput": 1192693.081, "learn_time_ms": 9.736, "learn_throughput": 36975.033, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720}, "done": false, "episodes_total": 1258, "training_iteration": 593, "trial_id": "36440_00000", "date": "2023-07-25_02-50-03", "timestamp": 1690242603, "time_this_iter_s": 11.192753076553345, "time_total_s": 10318.118535995483, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 249.00471711158752, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 23.9375, "ram_util_percent": 77.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4000000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 78.67983856201172, "policy_loss": -56317.175, "vf_loss": 16749679.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 358.0, "diff_num_grad_updates_vs_sampler_policy": 357.0}}, "num_env_steps_sampled": 5101800, "num_env_steps_trained": 5101800, "num_agent_steps_sampled": 5101800, "num_agent_steps_trained": 5101800}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2582.2807840191663, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.495530626777357, "mean_inference_ms": 0.4014858909310492, "mean_action_processing_ms": 0.09619553342566887, "mean_env_wait_ms": 2.1503986689255594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004280606905619304, "StateBufferConnector_ms": 0.0029593706130981445, "ViewRequirementAgentConnector_ms": 0.07299747731950548}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2582.2807840191663, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.495530626777357, "mean_inference_ms": 0.4014858909310492, "mean_action_processing_ms": 0.09619553342566887, "mean_env_wait_ms": 2.1503986689255594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004280606905619304, "StateBufferConnector_ms": 0.0029593706130981445, "ViewRequirementAgentConnector_ms": 0.07299747731950548}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5101800, "num_agent_steps_trained": 5101800, "num_env_steps_sampled": 5101800, "num_env_steps_trained": 5101800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.44538154548871, "num_env_steps_trained_throughput_per_sec": 96.44538154548871, "timesteps_total": 5101800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5101800, "timers": {"training_iteration_time_ms": 3691.242, "sample_time_ms": 3680.521, "load_time_ms": 0.298, "load_throughput": 1206415.34, "learn_time_ms": 9.675, "learn_throughput": 37210.211, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 5101800, "num_env_steps_trained": 5101800, "num_agent_steps_sampled": 5101800, "num_agent_steps_trained": 5101800}, "done": false, "episodes_total": 1261, "training_iteration": 594, "trial_id": "36440_00000", "date": "2023-07-25_02-50-14", "timestamp": 1690242614, "time_this_iter_s": 11.200845718383789, "time_total_s": 10329.319381713867, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 260.2055628299713, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.2375, "ram_util_percent": 78.09375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1000000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 81.0276123046875, "policy_loss": -61646.41953125, "vf_loss": 16451604.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 373.0, "diff_num_grad_updates_vs_sampler_policy": 372.0}}, "num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2586.1488869435043, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4965481776122855, "mean_inference_ms": 0.401525985563958, "mean_action_processing_ms": 0.09618969861714943, "mean_env_wait_ms": 2.143160773093703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042591094970703125, "StateBufferConnector_ms": 0.0029592514038085938, "ViewRequirementAgentConnector_ms": 0.07291253407796223}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2586.1488869435043, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4965481776122855, "mean_inference_ms": 0.401525985563958, "mean_action_processing_ms": 0.09618969861714943, "mean_env_wait_ms": 2.143160773093703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042591094970703125, "StateBufferConnector_ms": 0.0029592514038085938, "ViewRequirementAgentConnector_ms": 0.07291253407796223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880, "num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.64117409005608, "num_env_steps_trained_throughput_per_sec": 96.64117409005608, "timesteps_total": 5102880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5102880, "timers": {"training_iteration_time_ms": 3706.274, "sample_time_ms": 3695.533, "load_time_ms": 0.299, "load_throughput": 1203818.417, "learn_time_ms": 9.692, "learn_throughput": 37145.676, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880}, "done": false, "episodes_total": 1264, "training_iteration": 595, "trial_id": "36440_00000", "date": "2023-07-25_02-50-25", "timestamp": 1690242625, "time_this_iter_s": 11.178040981292725, "time_total_s": 10340.49742269516, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 271.38360381126404, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 23.674999999999997, "ram_util_percent": 78.09375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 84.53116302490234, "policy_loss": -56652.72578125, "vf_loss": 16365552.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 388.0, "diff_num_grad_updates_vs_sampler_policy": 387.0}}, "num_env_steps_sampled": 5103960, "num_env_steps_trained": 5103960, "num_agent_steps_sampled": 5103960, "num_agent_steps_trained": 5103960}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2589.6681810820423, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.497557274184264, "mean_inference_ms": 0.40157895539136285, "mean_action_processing_ms": 0.09618631493292525, "mean_env_wait_ms": 2.1366993966425865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004242933713472807, "StateBufferConnector_ms": 0.002956390380859375, "ViewRequirementAgentConnector_ms": 0.07302608245458359}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2589.6681810820423, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.497557274184264, "mean_inference_ms": 0.40157895539136285, "mean_action_processing_ms": 0.09618631493292525, "mean_env_wait_ms": 2.1366993966425865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004242933713472807, "StateBufferConnector_ms": 0.002956390380859375, "ViewRequirementAgentConnector_ms": 0.07302608245458359}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5103960, "num_agent_steps_trained": 5103960, "num_env_steps_sampled": 5103960, "num_env_steps_trained": 5103960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.51040538671543, "num_env_steps_trained_throughput_per_sec": 97.51040538671543, "timesteps_total": 5103960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5103960, "timers": {"training_iteration_time_ms": 3711.624, "sample_time_ms": 3700.905, "load_time_ms": 0.298, "load_throughput": 1206897.482, "learn_time_ms": 9.671, "learn_throughput": 37223.604, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 5103960, "num_env_steps_trained": 5103960, "num_agent_steps_sampled": 5103960, "num_agent_steps_trained": 5103960}, "done": false, "episodes_total": 1267, "training_iteration": 596, "trial_id": "36440_00000", "date": "2023-07-25_02-50-36", "timestamp": 1690242636, "time_this_iter_s": 11.078640937805176, "time_total_s": 10351.576063632965, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 282.4622447490692, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.0, "ram_util_percent": 78.29375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.166666666666668e-06, "entropy_coeff": 0.1, "policy_entropy": 87.10679626464844, "policy_loss": -53746.51328125, "vf_loss": 15973801.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 403.0, "diff_num_grad_updates_vs_sampler_policy": 402.0}}, "num_env_steps_sampled": 5105040, "num_env_steps_trained": 5105040, "num_agent_steps_sampled": 5105040, "num_agent_steps_trained": 5105040}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2591.3334336738567, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.498650743733412, "mean_inference_ms": 0.40161895942646, "mean_action_processing_ms": 0.09618142944660683, "mean_env_wait_ms": 2.1310042687791197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248265866880064, "StateBufferConnector_ms": 0.00296316029113016, "ViewRequirementAgentConnector_ms": 0.07329693547001591}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2591.3334336738567, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.498650743733412, "mean_inference_ms": 0.40161895942646, "mean_action_processing_ms": 0.09618142944660683, "mean_env_wait_ms": 2.1310042687791197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248265866880064, "StateBufferConnector_ms": 0.00296316029113016, "ViewRequirementAgentConnector_ms": 0.07329693547001591}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5105040, "num_agent_steps_trained": 5105040, "num_env_steps_sampled": 5105040, "num_env_steps_trained": 5105040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.40418892567789, "num_env_steps_trained_throughput_per_sec": 96.40418892567789, "timesteps_total": 5105040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5105040, "timers": {"training_iteration_time_ms": 3719.567, "sample_time_ms": 3708.945, "load_time_ms": 0.296, "load_throughput": 1215251.058, "learn_time_ms": 9.596, "learn_throughput": 37515.95, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 5105040, "num_env_steps_trained": 5105040, "num_agent_steps_sampled": 5105040, "num_agent_steps_trained": 5105040}, "done": false, "episodes_total": 1270, "training_iteration": 597, "trial_id": "36440_00000", "date": "2023-07-25_02-50-47", "timestamp": 1690242647, "time_this_iter_s": 11.205518245697021, "time_total_s": 10362.781581878662, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 293.66776299476624, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 23.09375, "ram_util_percent": 78.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666668e-06, "entropy_coeff": 0.1, "policy_entropy": 88.40599975585937, "policy_loss": -60389.82890625, "vf_loss": 16371305.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 418.0, "diff_num_grad_updates_vs_sampler_policy": 417.0}}, "num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2594.8230703588565, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.499674559064728, "mean_inference_ms": 0.4016556272251123, "mean_action_processing_ms": 0.09617602205856783, "mean_env_wait_ms": 2.126017255490397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00430969964890253, "StateBufferConnector_ms": 0.0029654729933965775, "ViewRequirementAgentConnector_ms": 0.07339034761701312}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2594.8230703588565, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.499674559064728, "mean_inference_ms": 0.4016556272251123, "mean_action_processing_ms": 0.09617602205856783, "mean_env_wait_ms": 2.126017255490397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00430969964890253, "StateBufferConnector_ms": 0.0029654729933965775, "ViewRequirementAgentConnector_ms": 0.07339034761701312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120, "num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.00336756431977, "num_env_steps_trained_throughput_per_sec": 97.00336756431977, "timesteps_total": 5106120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5106120, "timers": {"training_iteration_time_ms": 3722.85, "sample_time_ms": 3712.22, "load_time_ms": 0.295, "load_throughput": 1219569.857, "learn_time_ms": 9.603, "learn_throughput": 37488.193, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120}, "done": false, "episodes_total": 1273, "training_iteration": 598, "trial_id": "36440_00000", "date": "2023-07-25_02-50-58", "timestamp": 1690242658, "time_this_iter_s": 11.136653900146484, "time_total_s": 10373.918235778809, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 304.8044168949127, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 22.793333333333337, "ram_util_percent": 78.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.166666666666668e-06, "entropy_coeff": 0.1, "policy_entropy": 90.24380493164062, "policy_loss": -62842.0875, "vf_loss": 16051975.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 433.0, "diff_num_grad_updates_vs_sampler_policy": 432.0}}, "num_env_steps_sampled": 5107200, "num_env_steps_trained": 5107200, "num_agent_steps_sampled": 5107200, "num_agent_steps_trained": 5107200}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2597.397812465324, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.50032465502506, "mean_inference_ms": 0.401703923992227, "mean_action_processing_ms": 0.09617332990613821, "mean_env_wait_ms": 2.121632986197807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004334833430147719, "StateBufferConnector_ms": 0.002976395617956403, "ViewRequirementAgentConnector_ms": 0.07343593685106299}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2597.397812465324, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.50032465502506, "mean_inference_ms": 0.401703923992227, "mean_action_processing_ms": 0.09617332990613821, "mean_env_wait_ms": 2.121632986197807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004334833430147719, "StateBufferConnector_ms": 0.002976395617956403, "ViewRequirementAgentConnector_ms": 0.07343593685106299}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5107200, "num_agent_steps_trained": 5107200, "num_env_steps_sampled": 5107200, "num_env_steps_trained": 5107200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 99.46708712717093, "num_env_steps_trained_throughput_per_sec": 99.46708712717093, "timesteps_total": 5107200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5107200, "timers": {"training_iteration_time_ms": 3694.716, "sample_time_ms": 3684.089, "load_time_ms": 0.297, "load_throughput": 1213590.612, "learn_time_ms": 9.596, "learn_throughput": 37517.348, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 5107200, "num_env_steps_trained": 5107200, "num_agent_steps_sampled": 5107200, "num_agent_steps_trained": 5107200}, "done": false, "episodes_total": 1276, "training_iteration": 599, "trial_id": "36440_00000", "date": "2023-07-25_02-51-09", "timestamp": 1690242669, "time_this_iter_s": 10.86058497428894, "time_total_s": 10384.778820753098, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 315.66500186920166, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 27.68125, "ram_util_percent": 77.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 91.98697509765626, "policy_loss": -61816.4796875, "vf_loss": 16117500.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 448.0, "diff_num_grad_updates_vs_sampler_policy": 447.0}}, "num_env_steps_sampled": 5108280, "num_env_steps_trained": 5108280, "num_agent_steps_sampled": 5108280, "num_agent_steps_trained": 5108280}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2600.9304291677786, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.500921689510161, "mean_inference_ms": 0.40175458386856, "mean_action_processing_ms": 0.09617149097875262, "mean_env_wait_ms": 2.1178196523600215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004323853386773003, "StateBufferConnector_ms": 0.002968311309814453, "ViewRequirementAgentConnector_ms": 0.07335265477498372}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2600.9304291677786, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.500921689510161, "mean_inference_ms": 0.40175458386856, "mean_action_processing_ms": 0.09617149097875262, "mean_env_wait_ms": 2.1178196523600215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004323853386773003, "StateBufferConnector_ms": 0.002968311309814453, "ViewRequirementAgentConnector_ms": 0.07335265477498372}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5108280, "num_agent_steps_trained": 5108280, "num_env_steps_sampled": 5108280, "num_env_steps_trained": 5108280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.86844869094588, "num_env_steps_trained_throughput_per_sec": 96.86844869094588, "timesteps_total": 5108280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5108280, "timers": {"training_iteration_time_ms": 3694.376, "sample_time_ms": 3683.73, "load_time_ms": 0.296, "load_throughput": 1214566.795, "learn_time_ms": 9.61, "learn_throughput": 37462.243, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 5108280, "num_env_steps_trained": 5108280, "num_agent_steps_sampled": 5108280, "num_agent_steps_trained": 5108280}, "done": false, "episodes_total": 1279, "training_iteration": 600, "trial_id": "36440_00000", "date": "2023-07-25_02-51-21", "timestamp": 1690242681, "time_this_iter_s": 11.151734113693237, "time_total_s": 10395.93055486679, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 326.8167359828949, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.61875, "ram_util_percent": 78.10625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.166666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 92.77862396240235, "policy_loss": -60375.88359375, "vf_loss": 16206787.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 463.0, "diff_num_grad_updates_vs_sampler_policy": 462.0}}, "num_env_steps_sampled": 5109360, "num_env_steps_trained": 5109360, "num_agent_steps_sampled": 5109360, "num_agent_steps_trained": 5109360}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2603.8798013876713, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.501469120912614, "mean_inference_ms": 0.40181093858454914, "mean_action_processing_ms": 0.09617085039909185, "mean_env_wait_ms": 2.1144805011896093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004329219941169985, "StateBufferConnector_ms": 0.0029779249621975806, "ViewRequirementAgentConnector_ms": 0.07373697014265163}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2603.8798013876713, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.501469120912614, "mean_inference_ms": 0.40181093858454914, "mean_action_processing_ms": 0.09617085039909185, "mean_env_wait_ms": 2.1144805011896093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004329219941169985, "StateBufferConnector_ms": 0.0029779249621975806, "ViewRequirementAgentConnector_ms": 0.07373697014265163}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5109360, "num_agent_steps_trained": 5109360, "num_env_steps_sampled": 5109360, "num_env_steps_trained": 5109360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.06512836071673, "num_env_steps_trained_throughput_per_sec": 97.06512836071673, "timesteps_total": 5109360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5109360, "timers": {"training_iteration_time_ms": 3695.029, "sample_time_ms": 3684.358, "load_time_ms": 0.299, "load_throughput": 1206029.904, "learn_time_ms": 9.619, "learn_throughput": 37426.679, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 5109360, "num_env_steps_trained": 5109360, "num_agent_steps_sampled": 5109360, "num_agent_steps_trained": 5109360}, "done": false, "episodes_total": 1282, "training_iteration": 601, "trial_id": "36440_00000", "date": "2023-07-25_02-51-32", "timestamp": 1690242692, "time_this_iter_s": 11.129317998886108, "time_total_s": 10407.059872865677, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 337.946053981781, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 25.5125, "ram_util_percent": 77.75625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 93.49692077636719, "policy_loss": -59836.88828125, "vf_loss": 16527654.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 478.0, "diff_num_grad_updates_vs_sampler_policy": 477.0}}, "num_env_steps_sampled": 5110440, "num_env_steps_trained": 5110440, "num_agent_steps_sampled": 5110440, "num_agent_steps_trained": 5110440}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2608.496453500746, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.502036009425855, "mean_inference_ms": 0.4018732311208418, "mean_action_processing_ms": 0.09617153527790423, "mean_env_wait_ms": 2.1115794560165515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004309415817260742, "StateBufferConnector_ms": 0.0029765069484710693, "ViewRequirementAgentConnector_ms": 0.0736271341641744}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2608.496453500746, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.502036009425855, "mean_inference_ms": 0.4018732311208418, "mean_action_processing_ms": 0.09617153527790423, "mean_env_wait_ms": 2.1115794560165515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004309415817260742, "StateBufferConnector_ms": 0.0029765069484710693, "ViewRequirementAgentConnector_ms": 0.0736271341641744}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5110440, "num_agent_steps_trained": 5110440, "num_env_steps_sampled": 5110440, "num_env_steps_trained": 5110440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.22651996948774, "num_env_steps_trained_throughput_per_sec": 96.22651996948774, "timesteps_total": 5110440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5110440, "timers": {"training_iteration_time_ms": 3727.649, "sample_time_ms": 3716.977, "load_time_ms": 0.297, "load_throughput": 1212129.277, "learn_time_ms": 9.623, "learn_throughput": 37409.525, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 5110440, "num_env_steps_trained": 5110440, "num_agent_steps_sampled": 5110440, "num_agent_steps_trained": 5110440}, "done": false, "episodes_total": 1285, "training_iteration": 602, "trial_id": "36440_00000", "date": "2023-07-25_02-51-43", "timestamp": 1690242703, "time_this_iter_s": 11.226228952407837, "time_total_s": 10418.286101818085, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 349.17228293418884, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 24.040000000000006, "ram_util_percent": 77.98666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 94.95726928710937, "policy_loss": -67048.26328125, "vf_loss": 16656523.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 493.0, "diff_num_grad_updates_vs_sampler_policy": 492.0}}, "num_env_steps_sampled": 5111520, "num_env_steps_trained": 5111520, "num_agent_steps_sampled": 5111520, "num_agent_steps_trained": 5111520}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2611.0562518170814, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.502581792711585, "mean_inference_ms": 0.40192856108811126, "mean_action_processing_ms": 0.09617160910497215, "mean_env_wait_ms": 2.1090717181466534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004294665172846631, "StateBufferConnector_ms": 0.0029763790092082938, "ViewRequirementAgentConnector_ms": 0.0735311797170928}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2611.0562518170814, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.1132171976321, -1905.9747162115448, -1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.502581792711585, "mean_inference_ms": 0.40192856108811126, "mean_action_processing_ms": 0.09617160910497215, "mean_env_wait_ms": 2.1090717181466534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004294665172846631, "StateBufferConnector_ms": 0.0029763790092082938, "ViewRequirementAgentConnector_ms": 0.0735311797170928}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5111520, "num_agent_steps_trained": 5111520, "num_env_steps_sampled": 5111520, "num_env_steps_trained": 5111520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.64370601297378, "num_env_steps_trained_throughput_per_sec": 96.64370601297378, "timesteps_total": 5111520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5111520, "timers": {"training_iteration_time_ms": 3716.464, "sample_time_ms": 3705.758, "load_time_ms": 0.297, "load_throughput": 1212323.918, "learn_time_ms": 9.645, "learn_throughput": 37326.203, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 5111520, "num_env_steps_trained": 5111520, "num_agent_steps_sampled": 5111520, "num_agent_steps_trained": 5111520}, "done": false, "episodes_total": 1288, "training_iteration": 603, "trial_id": "36440_00000", "date": "2023-07-25_02-51-54", "timestamp": 1690242714, "time_this_iter_s": 11.177988052368164, "time_total_s": 10429.464089870453, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 360.350270986557, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.35, "ram_util_percent": 77.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 96.33528900146484, "policy_loss": -70276.48125, "vf_loss": 16177617.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 508.0, "diff_num_grad_updates_vs_sampler_policy": 507.0}}, "num_env_steps_sampled": 5112600, "num_env_steps_trained": 5112600, "num_agent_steps_sampled": 5112600, "num_agent_steps_trained": 5112600}, "sampler_results": {"episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2627.7857495407457, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.503979862759512, "mean_inference_ms": 0.4019601413141678, "mean_action_processing_ms": 0.09614874407186635, "mean_env_wait_ms": 2.064666650393252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004282712936401367, "StateBufferConnector_ms": 0.002972841262817383, "ViewRequirementAgentConnector_ms": 0.07348346710205078}}, "episode_reward_max": -1897.030328887963, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2627.7857495407457, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1897.030328887963, -1916.6128411005811, -1919.0710944663363, -1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.503979862759512, "mean_inference_ms": 0.4019601413141678, "mean_action_processing_ms": 0.09614874407186635, "mean_env_wait_ms": 2.064666650393252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004282712936401367, "StateBufferConnector_ms": 0.002972841262817383, "ViewRequirementAgentConnector_ms": 0.07348346710205078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5112600, "num_agent_steps_trained": 5112600, "num_env_steps_sampled": 5112600, "num_env_steps_trained": 5112600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.31223458971573, "num_env_steps_trained_throughput_per_sec": 97.31223458971573, "timesteps_total": 5112600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5112600, "timers": {"training_iteration_time_ms": 3705.731, "sample_time_ms": 3695.05, "load_time_ms": 0.295, "load_throughput": 1220457.032, "learn_time_ms": 9.612, "learn_throughput": 37451.744, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 5112600, "num_env_steps_trained": 5112600, "num_agent_steps_sampled": 5112600, "num_agent_steps_trained": 5112600}, "done": false, "episodes_total": 1291, "training_iteration": 604, "trial_id": "36440_00000", "date": "2023-07-25_02-52-05", "timestamp": 1690242725, "time_this_iter_s": 11.101107835769653, "time_total_s": 10440.565197706223, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 371.45137882232666, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 24.699999999999996, "ram_util_percent": 78.05625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.1666666666666675e-06, "entropy_coeff": 0.1, "policy_entropy": 95.54620056152343, "policy_loss": -75831.096875, "vf_loss": 16987466.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 523.0, "diff_num_grad_updates_vs_sampler_policy": 522.0}}, "num_env_steps_sampled": 5113680, "num_env_steps_trained": 5113680, "num_agent_steps_sampled": 5113680, "num_agent_steps_trained": 5113680}, "sampler_results": {"episode_reward_max": -1926.2073349150705, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2652.2689175184987, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.50603214876106, "mean_inference_ms": 0.4020159985519558, "mean_action_processing_ms": 0.0961304148436021, "mean_env_wait_ms": 2.025223750690917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004288673400878906, "StateBufferConnector_ms": 0.002975940704345703, "ViewRequirementAgentConnector_ms": 0.07349014282226562}}, "episode_reward_max": -1926.2073349150705, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2652.2689175184987, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1926.2073349150705, -1929.026655552237, -1942.3875152571998, -1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.50603214876106, "mean_inference_ms": 0.4020159985519558, "mean_action_processing_ms": 0.0961304148436021, "mean_env_wait_ms": 2.025223750690917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004288673400878906, "StateBufferConnector_ms": 0.002975940704345703, "ViewRequirementAgentConnector_ms": 0.07349014282226562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5113680, "num_agent_steps_trained": 5113680, "num_env_steps_sampled": 5113680, "num_env_steps_trained": 5113680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.53482724858394, "num_env_steps_trained_throughput_per_sec": 95.53482724858394, "timesteps_total": 5113680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5113680, "timers": {"training_iteration_time_ms": 3718.459, "sample_time_ms": 3707.726, "load_time_ms": 0.294, "load_throughput": 1225210.516, "learn_time_ms": 9.671, "learn_throughput": 37226.541, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 5113680, "num_env_steps_trained": 5113680, "num_agent_steps_sampled": 5113680, "num_agent_steps_trained": 5113680}, "done": false, "episodes_total": 1294, "training_iteration": 605, "trial_id": "36440_00000", "date": "2023-07-25_02-52-17", "timestamp": 1690242737, "time_this_iter_s": 11.307674884796143, "time_total_s": 10451.872872591019, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 382.7590537071228, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 23.09375, "ram_util_percent": 78.06250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 95.35550079345703, "policy_loss": -70346.20390625, "vf_loss": 17274730.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 538.0, "diff_num_grad_updates_vs_sampler_policy": 537.0}}, "num_env_steps_sampled": 5114760, "num_env_steps_trained": 5114760, "num_agent_steps_sampled": 5114760, "num_agent_steps_trained": 5114760}, "sampler_results": {"episode_reward_max": -1957.7725775234064, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2676.9857429677013, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5084791271121185, "mean_inference_ms": 0.4021054956923861, "mean_action_processing_ms": 0.09612791994679147, "mean_env_wait_ms": 2.0063805652051245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004260540008544922, "StateBufferConnector_ms": 0.002960205078125, "ViewRequirementAgentConnector_ms": 0.07291698455810547}}, "episode_reward_max": -1957.7725775234064, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2676.9857429677013, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1957.7725775234064, -1989.987260714352, -2028.3088140916668, -2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5084791271121185, "mean_inference_ms": 0.4021054956923861, "mean_action_processing_ms": 0.09612791994679147, "mean_env_wait_ms": 2.0063805652051245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004260540008544922, "StateBufferConnector_ms": 0.002960205078125, "ViewRequirementAgentConnector_ms": 0.07291698455810547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5114760, "num_agent_steps_trained": 5114760, "num_env_steps_sampled": 5114760, "num_env_steps_trained": 5114760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.03928609000543, "num_env_steps_trained_throughput_per_sec": 96.03928609000543, "timesteps_total": 5114760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5114760, "timers": {"training_iteration_time_ms": 3736.673, "sample_time_ms": 3725.857, "load_time_ms": 0.296, "load_throughput": 1217014.137, "learn_time_ms": 9.759, "learn_throughput": 36889.668, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 5114760, "num_env_steps_trained": 5114760, "num_agent_steps_sampled": 5114760, "num_agent_steps_trained": 5114760}, "done": false, "episodes_total": 1297, "training_iteration": 606, "trial_id": "36440_00000", "date": "2023-07-25_02-52-28", "timestamp": 1690242748, "time_this_iter_s": 11.24828290939331, "time_total_s": 10463.121155500412, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 394.0073366165161, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 24.06875, "ram_util_percent": 78.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.166666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 96.79602661132813, "policy_loss": -65504.58671875, "vf_loss": 17183293.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 553.0, "diff_num_grad_updates_vs_sampler_policy": 552.0}}, "num_env_steps_sampled": 5115840, "num_env_steps_trained": 5115840, "num_agent_steps_sampled": 5115840, "num_agent_steps_trained": 5115840}, "sampler_results": {"episode_reward_max": -2104.4324550133842, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2699.323710961211, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.510783924502444, "mean_inference_ms": 0.4021962344869212, "mean_action_processing_ms": 0.09612940979386721, "mean_env_wait_ms": 1.9949066085897882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042726993560791016, "StateBufferConnector_ms": 0.0029659271240234375, "ViewRequirementAgentConnector_ms": 0.07304739952087402}}, "episode_reward_max": -2104.4324550133842, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2699.323710961211, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2104.4324550133842, -2154.3378211287154, -2264.770311857599, -2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.510783924502444, "mean_inference_ms": 0.4021962344869212, "mean_action_processing_ms": 0.09612940979386721, "mean_env_wait_ms": 1.9949066085897882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042726993560791016, "StateBufferConnector_ms": 0.0029659271240234375, "ViewRequirementAgentConnector_ms": 0.07304739952087402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5115840, "num_agent_steps_trained": 5115840, "num_env_steps_sampled": 5115840, "num_env_steps_trained": 5115840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.08728224630656, "num_env_steps_trained_throughput_per_sec": 96.08728224630656, "timesteps_total": 5115840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5115840, "timers": {"training_iteration_time_ms": 3750.922, "sample_time_ms": 3740.076, "load_time_ms": 0.297, "load_throughput": 1212518.622, "learn_time_ms": 9.771, "learn_throughput": 36843.222, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 5115840, "num_env_steps_trained": 5115840, "num_agent_steps_sampled": 5115840, "num_agent_steps_trained": 5115840}, "done": false, "episodes_total": 1300, "training_iteration": 607, "trial_id": "36440_00000", "date": "2023-07-25_02-52-39", "timestamp": 1690242759, "time_this_iter_s": 11.242754936218262, "time_total_s": 10474.36391043663, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 405.2500915527344, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 24.09375, "ram_util_percent": 78.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.6666666666666674e-06, "entropy_coeff": 0.1, "policy_entropy": 98.49120025634765, "policy_loss": -60301.484375, "vf_loss": 15613147.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 568.0, "diff_num_grad_updates_vs_sampler_policy": 567.0}}, "num_env_steps_sampled": 5116920, "num_env_steps_trained": 5116920, "num_agent_steps_sampled": 5116920, "num_agent_steps_trained": 5116920}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2715.12354169852, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.512740964776314, "mean_inference_ms": 0.40230044549370647, "mean_action_processing_ms": 0.09613358814369216, "mean_env_wait_ms": 1.9872186884407832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004304170608520508, "StateBufferConnector_ms": 0.002970457077026367, "ViewRequirementAgentConnector_ms": 0.07345128059387207}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2715.12354169852, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2491.2810202745804, -2669.748479778752, -2750.1715650885744, -2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.512740964776314, "mean_inference_ms": 0.40230044549370647, "mean_action_processing_ms": 0.09613358814369216, "mean_env_wait_ms": 1.9872186884407832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004304170608520508, "StateBufferConnector_ms": 0.002970457077026367, "ViewRequirementAgentConnector_ms": 0.07345128059387207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5116920, "num_agent_steps_trained": 5116920, "num_env_steps_sampled": 5116920, "num_env_steps_trained": 5116920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.78566231776036, "num_env_steps_trained_throughput_per_sec": 95.78566231776036, "timesteps_total": 5116920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5116920, "timers": {"training_iteration_time_ms": 3763.504, "sample_time_ms": 3752.619, "load_time_ms": 0.298, "load_throughput": 1208346.223, "learn_time_ms": 9.819, "learn_throughput": 36665.099, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 5116920, "num_env_steps_trained": 5116920, "num_agent_steps_sampled": 5116920, "num_agent_steps_trained": 5116920}, "done": false, "episodes_total": 1303, "training_iteration": 608, "trial_id": "36440_00000", "date": "2023-07-25_02-52-50", "timestamp": 1690242770, "time_this_iter_s": 11.278247117996216, "time_total_s": 10485.642157554626, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 416.5283386707306, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 23.212500000000002, "ram_util_percent": 78.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.166666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 98.91156158447265, "policy_loss": -64541.590625, "vf_loss": 15056079.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 583.0, "diff_num_grad_updates_vs_sampler_policy": 582.0}}, "num_env_steps_sampled": 5118000, "num_env_steps_trained": 5118000, "num_agent_steps_sampled": 5118000, "num_agent_steps_trained": 5118000}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2716.101768003009, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5144560256864805, "mean_inference_ms": 0.4024242080141062, "mean_action_processing_ms": 0.09614060282677707, "mean_env_wait_ms": 1.9824002688052758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004315614700317383, "StateBufferConnector_ms": 0.0029664039611816406, "ViewRequirementAgentConnector_ms": 0.07339310646057129}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2716.101768003009, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2849.2379812251766, -2864.2877182554657, -2918.8730664710174, -2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5144560256864805, "mean_inference_ms": 0.4024242080141062, "mean_action_processing_ms": 0.09614060282677707, "mean_env_wait_ms": 1.9824002688052758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004315614700317383, "StateBufferConnector_ms": 0.0029664039611816406, "ViewRequirementAgentConnector_ms": 0.07339310646057129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5118000, "num_agent_steps_trained": 5118000, "num_env_steps_sampled": 5118000, "num_env_steps_trained": 5118000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.40393312189737, "num_env_steps_trained_throughput_per_sec": 97.40393312189737, "timesteps_total": 5118000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5118000, "timers": {"training_iteration_time_ms": 3745.761, "sample_time_ms": 3734.89, "load_time_ms": 0.297, "load_throughput": 1212421.262, "learn_time_ms": 9.802, "learn_throughput": 36725.562, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 5118000, "num_env_steps_trained": 5118000, "num_agent_steps_sampled": 5118000, "num_agent_steps_trained": 5118000}, "done": false, "episodes_total": 1306, "training_iteration": 609, "trial_id": "36440_00000", "date": "2023-07-25_02-53-02", "timestamp": 1690242782, "time_this_iter_s": 11.09066104888916, "time_total_s": 10496.732818603516, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 427.61899971961975, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 23.643749999999997, "ram_util_percent": 78.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 99.57652130126954, "policy_loss": -61234.2875, "vf_loss": 15473249.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 598.0, "diff_num_grad_updates_vs_sampler_policy": 597.0}}, "num_env_steps_sampled": 5119080, "num_env_steps_trained": 5119080, "num_agent_steps_sampled": 5119080, "num_agent_steps_trained": 5119080}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2710.4609338492837, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.516170628324505, "mean_inference_ms": 0.4024975369661588, "mean_action_processing_ms": 0.09613381475082403, "mean_env_wait_ms": 1.98006545063859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043277740478515625, "StateBufferConnector_ms": 0.0029630661010742188, "ViewRequirementAgentConnector_ms": 0.07370471954345703}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2710.4609338492837, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2979.5257021258353, -3033.6491306241305, -3150.053969977487, -3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.516170628324505, "mean_inference_ms": 0.4024975369661588, "mean_action_processing_ms": 0.09613381475082403, "mean_env_wait_ms": 1.98006545063859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043277740478515625, "StateBufferConnector_ms": 0.0029630661010742188, "ViewRequirementAgentConnector_ms": 0.07370471954345703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5119080, "num_agent_steps_trained": 5119080, "num_env_steps_sampled": 5119080, "num_env_steps_trained": 5119080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.17343099339885, "num_env_steps_trained_throughput_per_sec": 97.17343099339885, "timesteps_total": 5119080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5119080, "timers": {"training_iteration_time_ms": 3732.817, "sample_time_ms": 3721.957, "load_time_ms": 0.296, "load_throughput": 1214957.708, "learn_time_ms": 9.801, "learn_throughput": 36729.314, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 5119080, "num_env_steps_trained": 5119080, "num_agent_steps_sampled": 5119080, "num_agent_steps_trained": 5119080}, "done": false, "episodes_total": 1309, "training_iteration": 610, "trial_id": "36440_00000", "date": "2023-07-25_02-53-13", "timestamp": 1690242793, "time_this_iter_s": 11.116966962814331, "time_total_s": 10507.84978556633, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 438.7359666824341, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 25.2125, "ram_util_percent": 78.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3e-06, "entropy_coeff": 0.1, "policy_entropy": 99.65363006591797, "policy_loss": -73944.87421875, "vf_loss": 16624921.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 613.0, "diff_num_grad_updates_vs_sampler_policy": 612.0}}, "num_env_steps_sampled": 5120160, "num_env_steps_trained": 5120160, "num_agent_steps_sampled": 5120160, "num_agent_steps_trained": 5120160}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2700.827850952694, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.517748028956907, "mean_inference_ms": 0.40254882337920245, "mean_action_processing_ms": 0.0961222591860396, "mean_env_wait_ms": 1.9797819924216693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004317522048950195, "StateBufferConnector_ms": 0.002959728240966797, "ViewRequirementAgentConnector_ms": 0.07359814643859863}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2700.827850952694, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3145.8355254515823, -3123.1101000479002, -3050.503140732688, -3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.517748028956907, "mean_inference_ms": 0.40254882337920245, "mean_action_processing_ms": 0.0961222591860396, "mean_env_wait_ms": 1.9797819924216693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004317522048950195, "StateBufferConnector_ms": 0.002959728240966797, "ViewRequirementAgentConnector_ms": 0.07359814643859863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120160, "num_agent_steps_trained": 5120160, "num_env_steps_sampled": 5120160, "num_env_steps_trained": 5120160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.6446026534686, "num_env_steps_trained_throughput_per_sec": 95.6446026534686, "timesteps_total": 5120160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5120160, "timers": {"training_iteration_time_ms": 3724.127, "sample_time_ms": 3713.433, "load_time_ms": 0.297, "load_throughput": 1213200.578, "learn_time_ms": 9.63, "learn_throughput": 37384.98, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 5120160, "num_env_steps_trained": 5120160, "num_agent_steps_sampled": 5120160, "num_agent_steps_trained": 5120160}, "done": false, "episodes_total": 1312, "training_iteration": 611, "trial_id": "36440_00000", "date": "2023-07-25_02-53-24", "timestamp": 1690242804, "time_this_iter_s": 11.294839143753052, "time_total_s": 10519.144624710083, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 450.03080582618713, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 23.81875, "ram_util_percent": 78.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0000000000000003e-06, "entropy_coeff": 0.1, "policy_entropy": 98.14331665039063, "policy_loss": -68179.28046875, "vf_loss": 16235177.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 628.0, "diff_num_grad_updates_vs_sampler_policy": 627.0}}, "num_env_steps_sampled": 5121240, "num_env_steps_trained": 5121240, "num_agent_steps_sampled": 5121240, "num_agent_steps_trained": 5121240}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2689.5240060280707, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.519213974274168, "mean_inference_ms": 0.40260640725683317, "mean_action_processing_ms": 0.09611440339581677, "mean_env_wait_ms": 1.9810784754053514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043146610260009766, "StateBufferConnector_ms": 0.0029621124267578125, "ViewRequirementAgentConnector_ms": 0.0735616683959961}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -3160.555260529904, "episode_reward_mean": -2689.5240060280707, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3040.5765829874617, -3109.971914910421, -3160.555260529904, -3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.519213974274168, "mean_inference_ms": 0.40260640725683317, "mean_action_processing_ms": 0.09611440339581677, "mean_env_wait_ms": 1.9810784754053514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043146610260009766, "StateBufferConnector_ms": 0.0029621124267578125, "ViewRequirementAgentConnector_ms": 0.0735616683959961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5121240, "num_agent_steps_trained": 5121240, "num_env_steps_sampled": 5121240, "num_env_steps_trained": 5121240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.84256208568523, "num_env_steps_trained_throughput_per_sec": 95.84256208568523, "timesteps_total": 5121240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5121240, "timers": {"training_iteration_time_ms": 3730.755, "sample_time_ms": 3720.087, "load_time_ms": 0.3, "load_throughput": 1201710.657, "learn_time_ms": 9.588, "learn_throughput": 37546.454, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 5121240, "num_env_steps_trained": 5121240, "num_agent_steps_sampled": 5121240, "num_agent_steps_trained": 5121240}, "done": false, "episodes_total": 1315, "training_iteration": 612, "trial_id": "36440_00000", "date": "2023-07-25_02-53-35", "timestamp": 1690242815, "time_this_iter_s": 11.271409749984741, "time_total_s": 10530.416034460068, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 461.3022155761719, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 26.95, "ram_util_percent": 78.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7000000000000002e-06, "entropy_coeff": 0.1, "policy_entropy": 98.88971252441407, "policy_loss": -72672.68671875, "vf_loss": 16266325.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 643.0, "diff_num_grad_updates_vs_sampler_policy": 642.0}}, "num_env_steps_sampled": 5122320, "num_env_steps_trained": 5122320, "num_agent_steps_sampled": 5122320, "num_agent_steps_trained": 5122320}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -3058.297622571147, "episode_reward_mean": -2679.4566662940692, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.520443604795471, "mean_inference_ms": 0.4026765099619414, "mean_action_processing_ms": 0.09611083863476809, "mean_env_wait_ms": 1.9837823691295298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004302501678466797, "StateBufferConnector_ms": 0.0029582977294921875, "ViewRequirementAgentConnector_ms": 0.07325196266174316}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -3058.297622571147, "episode_reward_mean": -2679.4566662940692, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3058.297622571147, -2984.1437113963702, -3021.042533812161, -2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.520443604795471, "mean_inference_ms": 0.4026765099619414, "mean_action_processing_ms": 0.09611083863476809, "mean_env_wait_ms": 1.9837823691295298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004302501678466797, "StateBufferConnector_ms": 0.0029582977294921875, "ViewRequirementAgentConnector_ms": 0.07325196266174316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5122320, "num_agent_steps_trained": 5122320, "num_env_steps_sampled": 5122320, "num_env_steps_trained": 5122320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.95874169770214, "num_env_steps_trained_throughput_per_sec": 95.95874169770214, "timesteps_total": 5122320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5122320, "timers": {"training_iteration_time_ms": 3738.132, "sample_time_ms": 3727.46, "load_time_ms": 0.3, "load_throughput": 1201806.304, "learn_time_ms": 9.604, "learn_throughput": 37486.332, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 5122320, "num_env_steps_trained": 5122320, "num_agent_steps_sampled": 5122320, "num_agent_steps_trained": 5122320}, "done": false, "episodes_total": 1318, "training_iteration": 613, "trial_id": "36440_00000", "date": "2023-07-25_02-53-47", "timestamp": 1690242827, "time_this_iter_s": 11.25766897201538, "time_total_s": 10541.673703432083, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 472.55988454818726, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 21.8375, "ram_util_percent": 78.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4000000000000001e-06, "entropy_coeff": 0.1, "policy_entropy": 99.7914794921875, "policy_loss": -69410.0671875, "vf_loss": 16183129.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 658.0, "diff_num_grad_updates_vs_sampler_policy": 657.0}}, "num_env_steps_sampled": 5123400, "num_env_steps_trained": 5123400, "num_agent_steps_sampled": 5123400, "num_agent_steps_trained": 5123400}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -2969.834579407656, "episode_reward_mean": -2670.9989785527523, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.521366407127215, "mean_inference_ms": 0.4027593884097205, "mean_action_processing_ms": 0.09611068117762311, "mean_env_wait_ms": 1.9875517809050331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004292964935302734, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.07320117950439453}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -2969.834579407656, "episode_reward_mean": -2670.9989785527523, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2969.834579407656, -2931.2421311337325, -2909.9354697865424, -2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.521366407127215, "mean_inference_ms": 0.4027593884097205, "mean_action_processing_ms": 0.09611068117762311, "mean_env_wait_ms": 1.9875517809050331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004292964935302734, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.07320117950439453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5123400, "num_agent_steps_trained": 5123400, "num_env_steps_sampled": 5123400, "num_env_steps_trained": 5123400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.19260651883985, "num_env_steps_trained_throughput_per_sec": 95.19260651883985, "timesteps_total": 5123400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5123400, "timers": {"training_iteration_time_ms": 3753.107, "sample_time_ms": 3742.332, "load_time_ms": 0.298, "load_throughput": 1208442.929, "learn_time_ms": 9.691, "learn_throughput": 37147.778, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 5123400, "num_env_steps_trained": 5123400, "num_agent_steps_sampled": 5123400, "num_agent_steps_trained": 5123400}, "done": false, "episodes_total": 1321, "training_iteration": 614, "trial_id": "36440_00000", "date": "2023-07-25_02-53-58", "timestamp": 1690242838, "time_this_iter_s": 11.348243236541748, "time_total_s": 10553.021946668625, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 483.908127784729, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.15625, "ram_util_percent": 78.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0999999999999998e-06, "entropy_coeff": 0.1, "policy_entropy": 98.29297485351563, "policy_loss": -68730.759375, "vf_loss": 16764082.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 673.0, "diff_num_grad_updates_vs_sampler_policy": 672.0}}, "num_env_steps_sampled": 5124480, "num_env_steps_trained": 5124480, "num_agent_steps_sampled": 5124480, "num_agent_steps_trained": 5124480}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -2803.827470887684, "episode_reward_mean": -2665.3728456238036, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.522299581914411, "mean_inference_ms": 0.40284664007889176, "mean_action_processing_ms": 0.09611203586437111, "mean_env_wait_ms": 1.9920181174752105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004297733306884766, "StateBufferConnector_ms": 0.0029642581939697266, "ViewRequirementAgentConnector_ms": 0.07355284690856934}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -2803.827470887684, "episode_reward_mean": -2665.3728456238036, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2803.827470887684, -2777.4971876703207, -2739.2654825740988, -2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.522299581914411, "mean_inference_ms": 0.40284664007889176, "mean_action_processing_ms": 0.09611203586437111, "mean_env_wait_ms": 1.9920181174752105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004297733306884766, "StateBufferConnector_ms": 0.0029642581939697266, "ViewRequirementAgentConnector_ms": 0.07355284690856934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5124480, "num_agent_steps_trained": 5124480, "num_env_steps_sampled": 5124480, "num_env_steps_trained": 5124480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.22851098132597, "num_env_steps_trained_throughput_per_sec": 96.22851098132597, "timesteps_total": 5124480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5124480, "timers": {"training_iteration_time_ms": 3764.683, "sample_time_ms": 3753.888, "load_time_ms": 0.297, "load_throughput": 1211448.524, "learn_time_ms": 9.743, "learn_throughput": 36948.071, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 5124480, "num_env_steps_trained": 5124480, "num_agent_steps_sampled": 5124480, "num_agent_steps_trained": 5124480}, "done": false, "episodes_total": 1324, "training_iteration": 615, "trial_id": "36440_00000", "date": "2023-07-25_02-54-09", "timestamp": 1690242849, "time_this_iter_s": 11.225963115692139, "time_total_s": 10564.247909784317, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 495.13409090042114, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 24.418750000000003, "ram_util_percent": 77.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 100.00276336669921, "policy_loss": -68022.4921875, "vf_loss": 16026101.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 688.0, "diff_num_grad_updates_vs_sampler_policy": 687.0}}, "num_env_steps_sampled": 5125560, "num_env_steps_trained": 5125560, "num_agent_steps_sampled": 5125560, "num_agent_steps_trained": 5125560}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2663.1571064533014, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5231870039940425, "mean_inference_ms": 0.4029419614644638, "mean_action_processing_ms": 0.09611605913060398, "mean_env_wait_ms": 1.9970879806103239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004277706146240234, "StateBufferConnector_ms": 0.0029616355895996094, "ViewRequirementAgentConnector_ms": 0.07331466674804688}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2663.1571064533014, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2737.330041413368, -2697.7501497725143, -2676.0653226387367, -2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5231870039940425, "mean_inference_ms": 0.4029419614644638, "mean_action_processing_ms": 0.09611605913060398, "mean_env_wait_ms": 1.9970879806103239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004277706146240234, "StateBufferConnector_ms": 0.0029616355895996094, "ViewRequirementAgentConnector_ms": 0.07331466674804688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5125560, "num_agent_steps_trained": 5125560, "num_env_steps_sampled": 5125560, "num_env_steps_trained": 5125560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.78133017509397, "num_env_steps_trained_throughput_per_sec": 96.78133017509397, "timesteps_total": 5125560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5125560, "timers": {"training_iteration_time_ms": 3752.396, "sample_time_ms": 3741.542, "load_time_ms": 0.296, "load_throughput": 1214762.22, "learn_time_ms": 9.797, "learn_throughput": 36747.102, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 5125560, "num_env_steps_trained": 5125560, "num_agent_steps_sampled": 5125560, "num_agent_steps_trained": 5125560}, "done": false, "episodes_total": 1327, "training_iteration": 616, "trial_id": "36440_00000", "date": "2023-07-25_02-54-20", "timestamp": 1690242860, "time_this_iter_s": 11.162529230117798, "time_total_s": 10575.410439014435, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 506.29662013053894, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 24.026666666666674, "ram_util_percent": 78.17333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.166666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 99.25747375488281, "policy_loss": -76556.87109375, "vf_loss": 16361609.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 703.0, "diff_num_grad_updates_vs_sampler_policy": 702.0}}, "num_env_steps_sampled": 5126640, "num_env_steps_trained": 5126640, "num_agent_steps_sampled": 5126640, "num_agent_steps_trained": 5126640}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2664.2452512965856, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.523951561457214, "mean_inference_ms": 0.4030478591111717, "mean_action_processing_ms": 0.09612287472296205, "mean_env_wait_ms": 2.0026549883661797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248380661010742, "StateBufferConnector_ms": 0.0029599666595458984, "ViewRequirementAgentConnector_ms": 0.07307744026184082}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2664.2452512965856, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2622.319050725787, -2599.9285668641523, -2545.425351491869, -2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.523951561457214, "mean_inference_ms": 0.4030478591111717, "mean_action_processing_ms": 0.09612287472296205, "mean_env_wait_ms": 2.0026549883661797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248380661010742, "StateBufferConnector_ms": 0.0029599666595458984, "ViewRequirementAgentConnector_ms": 0.07307744026184082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5126640, "num_agent_steps_trained": 5126640, "num_env_steps_sampled": 5126640, "num_env_steps_trained": 5126640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.67980081713286, "num_env_steps_trained_throughput_per_sec": 95.67980081713286, "timesteps_total": 5126640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5126640, "timers": {"training_iteration_time_ms": 3752.805, "sample_time_ms": 3741.9, "load_time_ms": 0.299, "load_throughput": 1204971.223, "learn_time_ms": 9.842, "learn_throughput": 36578.41, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 5126640, "num_env_steps_trained": 5126640, "num_agent_steps_sampled": 5126640, "num_agent_steps_trained": 5126640}, "done": false, "episodes_total": 1330, "training_iteration": 617, "trial_id": "36440_00000", "date": "2023-07-25_02-54-32", "timestamp": 1690242872, "time_this_iter_s": 11.29043984413147, "time_total_s": 10586.700878858566, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 517.5870599746704, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.3375, "ram_util_percent": 78.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 99.27351226806641, "policy_loss": -66791.85546875, "vf_loss": 16347437.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 718.0, "diff_num_grad_updates_vs_sampler_policy": 717.0}}, "num_env_steps_sampled": 5127720, "num_env_steps_trained": 5127720, "num_agent_steps_sampled": 5127720, "num_agent_steps_trained": 5127720}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2668.8423592734225, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.524538667828743, "mean_inference_ms": 0.4031658502737412, "mean_action_processing_ms": 0.09613273416364615, "mean_env_wait_ms": 2.008641049519083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042803287506103516, "StateBufferConnector_ms": 0.002969026565551758, "ViewRequirementAgentConnector_ms": 0.07320141792297363}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2668.8423592734225, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2534.345126069563, -2527.2491856120305, -2513.9867059941535, -2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.524538667828743, "mean_inference_ms": 0.4031658502737412, "mean_action_processing_ms": 0.09613273416364615, "mean_env_wait_ms": 2.008641049519083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042803287506103516, "StateBufferConnector_ms": 0.002969026565551758, "ViewRequirementAgentConnector_ms": 0.07320141792297363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5127720, "num_agent_steps_trained": 5127720, "num_env_steps_sampled": 5127720, "num_env_steps_trained": 5127720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.4740784507119, "num_env_steps_trained_throughput_per_sec": 97.4740784507119, "timesteps_total": 5127720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5127720, "timers": {"training_iteration_time_ms": 3737.043, "sample_time_ms": 3726.161, "load_time_ms": 0.301, "load_throughput": 1196189.052, "learn_time_ms": 9.827, "learn_throughput": 36633.076, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 5127720, "num_env_steps_trained": 5127720, "num_agent_steps_sampled": 5127720, "num_agent_steps_trained": 5127720}, "done": false, "episodes_total": 1333, "training_iteration": 618, "trial_id": "36440_00000", "date": "2023-07-25_02-54-43", "timestamp": 1690242883, "time_this_iter_s": 11.082698822021484, "time_total_s": 10597.783577680588, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 528.6697587966919, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 25.4125, "ram_util_percent": 78.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.166666666666665e-07, "entropy_coeff": 0.1, "policy_entropy": 100.22224273681641, "policy_loss": -74620.85390625, "vf_loss": 15934558.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 733.0, "diff_num_grad_updates_vs_sampler_policy": 732.0}}, "num_env_steps_sampled": 5128800, "num_env_steps_trained": 5128800, "num_agent_steps_sampled": 5128800, "num_agent_steps_trained": 5128800}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2674.5148188593635, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.524939662578189, "mean_inference_ms": 0.40328741103581756, "mean_action_processing_ms": 0.09614437998083047, "mean_env_wait_ms": 2.0149452930965532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004281282424926758, "StateBufferConnector_ms": 0.0029647350311279297, "ViewRequirementAgentConnector_ms": 0.07304930686950684}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2674.5148188593635, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2521.093061202266, -2504.3643622789377, -2509.1922576003135, -2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.524939662578189, "mean_inference_ms": 0.40328741103581756, "mean_action_processing_ms": 0.09614437998083047, "mean_env_wait_ms": 2.0149452930965532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004281282424926758, "StateBufferConnector_ms": 0.0029647350311279297, "ViewRequirementAgentConnector_ms": 0.07304930686950684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5128800, "num_agent_steps_trained": 5128800, "num_env_steps_sampled": 5128800, "num_env_steps_trained": 5128800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.1238128869605, "num_env_steps_trained_throughput_per_sec": 97.1238128869605, "timesteps_total": 5128800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5128800, "timers": {"training_iteration_time_ms": 3725.494, "sample_time_ms": 3714.651, "load_time_ms": 0.302, "load_throughput": 1193919.064, "learn_time_ms": 9.778, "learn_throughput": 36816.631, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 5128800, "num_env_steps_trained": 5128800, "num_agent_steps_sampled": 5128800, "num_agent_steps_trained": 5128800}, "done": false, "episodes_total": 1336, "training_iteration": 619, "trial_id": "36440_00000", "date": "2023-07-25_02-54-54", "timestamp": 1690242894, "time_this_iter_s": 11.12276291847229, "time_total_s": 10608.90634059906, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 539.7925217151642, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 23.5, "ram_util_percent": 78.20625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.666666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 99.84481048583984, "policy_loss": -71759.49140625, "vf_loss": 15982082.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 748.0, "diff_num_grad_updates_vs_sampler_policy": 747.0}}, "num_env_steps_sampled": 5129880, "num_env_steps_trained": 5129880, "num_agent_steps_sampled": 5129880, "num_agent_steps_trained": 5129880}, "sampler_results": {"episode_reward_max": -2489.6890853970804, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2680.206142746937, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525202844482175, "mean_inference_ms": 0.40341197304891496, "mean_action_processing_ms": 0.09615789621397836, "mean_env_wait_ms": 2.0213881136972827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004286050796508789, "StateBufferConnector_ms": 0.0029659271240234375, "ViewRequirementAgentConnector_ms": 0.07305717468261719}}, "episode_reward_max": -2489.6890853970804, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2680.206142746937, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2514.640122220619, -2489.6890853970804, -2507.777200973254, -2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525202844482175, "mean_inference_ms": 0.40341197304891496, "mean_action_processing_ms": 0.09615789621397836, "mean_env_wait_ms": 2.0213881136972827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004286050796508789, "StateBufferConnector_ms": 0.0029659271240234375, "ViewRequirementAgentConnector_ms": 0.07305717468261719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5129880, "num_agent_steps_trained": 5129880, "num_env_steps_sampled": 5129880, "num_env_steps_trained": 5129880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.50946115089002, "num_env_steps_trained_throughput_per_sec": 95.50946115089002, "timesteps_total": 5129880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5129880, "timers": {"training_iteration_time_ms": 3720.353, "sample_time_ms": 3709.422, "load_time_ms": 0.301, "load_throughput": 1197517.202, "learn_time_ms": 9.846, "learn_throughput": 36564.769, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 5129880, "num_env_steps_trained": 5129880, "num_agent_steps_sampled": 5129880, "num_agent_steps_trained": 5129880}, "done": false, "episodes_total": 1339, "training_iteration": 620, "trial_id": "36440_00000", "date": "2023-07-25_02-55-05", "timestamp": 1690242905, "time_this_iter_s": 11.310518026351929, "time_total_s": 10620.216858625412, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 551.1030397415161, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 23.46875, "ram_util_percent": 78.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.166666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 99.91363983154297, "policy_loss": -67644.4859375, "vf_loss": 15682958.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 763.0, "diff_num_grad_updates_vs_sampler_policy": 762.0}}, "num_env_steps_sampled": 5130960, "num_env_steps_trained": 5130960, "num_agent_steps_sampled": 5130960, "num_agent_steps_trained": 5130960}, "sampler_results": {"episode_reward_max": -2500.5872147103973, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2686.354111973314, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525388920166323, "mean_inference_ms": 0.40353536371533205, "mean_action_processing_ms": 0.09617176768580597, "mean_env_wait_ms": 2.0278894574703377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043027400970458984, "StateBufferConnector_ms": 0.002969503402709961, "ViewRequirementAgentConnector_ms": 0.07335042953491211}}, "episode_reward_max": -2500.5872147103973, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2686.354111973314, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2506.314264730869, -2500.5872147103973, -2526.1717972762613, -2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525388920166323, "mean_inference_ms": 0.40353536371533205, "mean_action_processing_ms": 0.09617176768580597, "mean_env_wait_ms": 2.0278894574703377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043027400970458984, "StateBufferConnector_ms": 0.002969503402709961, "ViewRequirementAgentConnector_ms": 0.07335042953491211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5130960, "num_agent_steps_trained": 5130960, "num_env_steps_sampled": 5130960, "num_env_steps_trained": 5130960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.77467865778554, "num_env_steps_trained_throughput_per_sec": 96.77467865778554, "timesteps_total": 5130960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5130960, "timers": {"training_iteration_time_ms": 3715.388, "sample_time_ms": 3704.473, "load_time_ms": 0.303, "load_throughput": 1188936.567, "learn_time_ms": 9.847, "learn_throughput": 36560.431, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 5130960, "num_env_steps_trained": 5130960, "num_agent_steps_sampled": 5130960, "num_agent_steps_trained": 5130960}, "done": false, "episodes_total": 1342, "training_iteration": 621, "trial_id": "36440_00000", "date": "2023-07-25_02-55-17", "timestamp": 1690242917, "time_this_iter_s": 11.162949800491333, "time_total_s": 10631.379808425903, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 562.2659895420074, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 24.84375, "ram_util_percent": 78.05625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.666666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 100.0654800415039, "policy_loss": -70901.0078125, "vf_loss": 15854501.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 778.0, "diff_num_grad_updates_vs_sampler_policy": 777.0}}, "num_env_steps_sampled": 5132040, "num_env_steps_trained": 5132040, "num_agent_steps_sampled": 5132040, "num_agent_steps_trained": 5132040}, "sampler_results": {"episode_reward_max": -2527.0234819182674, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2691.7905583319935, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52573238830291, "mean_inference_ms": 0.40365819954649784, "mean_action_processing_ms": 0.09618640390648886, "mean_env_wait_ms": 2.034257597435223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004330873489379883, "StateBufferConnector_ms": 0.0029726028442382812, "ViewRequirementAgentConnector_ms": 0.07374358177185059}}, "episode_reward_max": -2527.0234819182674, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2691.7905583319935, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2544.1374142417094, -2527.0234819182674, -2562.6942625228667, -2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52573238830291, "mean_inference_ms": 0.40365819954649784, "mean_action_processing_ms": 0.09618640390648886, "mean_env_wait_ms": 2.034257597435223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004330873489379883, "StateBufferConnector_ms": 0.0029726028442382812, "ViewRequirementAgentConnector_ms": 0.07374358177185059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5132040, "num_agent_steps_trained": 5132040, "num_env_steps_sampled": 5132040, "num_env_steps_trained": 5132040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.53812967957421, "num_env_steps_trained_throughput_per_sec": 95.53812967957421, "timesteps_total": 5132040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5132040, "timers": {"training_iteration_time_ms": 3734.765, "sample_time_ms": 3723.905, "load_time_ms": 0.304, "load_throughput": 1184366.962, "learn_time_ms": 9.795, "learn_throughput": 36752.737, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 5132040, "num_env_steps_trained": 5132040, "num_agent_steps_sampled": 5132040, "num_agent_steps_trained": 5132040}, "done": false, "episodes_total": 1345, "training_iteration": 622, "trial_id": "36440_00000", "date": "2023-07-25_02-55-28", "timestamp": 1690242928, "time_this_iter_s": 11.307240962982178, "time_total_s": 10642.687049388885, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 573.5732305049896, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 25.05625, "ram_util_percent": 77.91874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 100.13218994140625, "policy_loss": -70674.240625, "vf_loss": 15625901.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 793.0, "diff_num_grad_updates_vs_sampler_policy": 792.0}}, "num_env_steps_sampled": 5133120, "num_env_steps_trained": 5133120, "num_agent_steps_sampled": 5133120, "num_agent_steps_trained": 5133120}, "sampler_results": {"episode_reward_max": -2544.679872840953, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2696.298947369969, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526235232752291, "mean_inference_ms": 0.40376893945616166, "mean_action_processing_ms": 0.09619967559091186, "mean_env_wait_ms": 2.040384249321749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043489933013916016, "StateBufferConnector_ms": 0.002992868423461914, "ViewRequirementAgentConnector_ms": 0.07404375076293945}}, "episode_reward_max": -2544.679872840953, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2696.298947369969, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2558.5949797303933, -2544.679872840953, -2599.5801360458054, -2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526235232752291, "mean_inference_ms": 0.40376893945616166, "mean_action_processing_ms": 0.09619967559091186, "mean_env_wait_ms": 2.040384249321749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043489933013916016, "StateBufferConnector_ms": 0.002992868423461914, "ViewRequirementAgentConnector_ms": 0.07404375076293945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5133120, "num_agent_steps_trained": 5133120, "num_env_steps_sampled": 5133120, "num_env_steps_trained": 5133120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.96470414393916, "num_env_steps_trained_throughput_per_sec": 95.96470414393916, "timesteps_total": 5133120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5133120, "timers": {"training_iteration_time_ms": 3751.194, "sample_time_ms": 3740.453, "load_time_ms": 0.301, "load_throughput": 1197232.35, "learn_time_ms": 9.697, "learn_throughput": 37124.579, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 5133120, "num_env_steps_trained": 5133120, "num_agent_steps_sampled": 5133120, "num_agent_steps_trained": 5133120}, "done": false, "episodes_total": 1348, "training_iteration": 623, "trial_id": "36440_00000", "date": "2023-07-25_02-55-39", "timestamp": 1690242939, "time_this_iter_s": 11.256978988647461, "time_total_s": 10653.944028377533, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 584.8302094936371, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 24.1375, "ram_util_percent": 78.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 100.96452026367187, "policy_loss": -68368.090625, "vf_loss": 15433402.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 808.0, "diff_num_grad_updates_vs_sampler_policy": 807.0}}, "num_env_steps_sampled": 5134200, "num_env_steps_trained": 5134200, "num_agent_steps_sampled": 5134200, "num_agent_steps_trained": 5134200}, "sampler_results": {"episode_reward_max": -2548.154940789523, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2699.17531500006, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526878269482239, "mean_inference_ms": 0.40386981507347786, "mean_action_processing_ms": 0.09621223916740072, "mean_env_wait_ms": 2.04632419656892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004363536834716797, "StateBufferConnector_ms": 0.003003358840942383, "ViewRequirementAgentConnector_ms": 0.07425165176391602}}, "episode_reward_max": -2548.154940789523, "episode_reward_min": -2802.832354834694, "episode_reward_mean": -2699.17531500006, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2548.154940789523, -2595.8483017971243, -2580.9166037374407, -2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526878269482239, "mean_inference_ms": 0.40386981507347786, "mean_action_processing_ms": 0.09621223916740072, "mean_env_wait_ms": 2.04632419656892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004363536834716797, "StateBufferConnector_ms": 0.003003358840942383, "ViewRequirementAgentConnector_ms": 0.07425165176391602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5134200, "num_agent_steps_trained": 5134200, "num_env_steps_sampled": 5134200, "num_env_steps_trained": 5134200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.40660412726362, "num_env_steps_trained_throughput_per_sec": 95.40660412726362, "timesteps_total": 5134200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5134200, "timers": {"training_iteration_time_ms": 3765.863, "sample_time_ms": 3755.082, "load_time_ms": 0.297, "load_throughput": 1212615.997, "learn_time_ms": 9.7, "learn_throughput": 37115.18, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 5134200, "num_env_steps_trained": 5134200, "num_agent_steps_sampled": 5134200, "num_agent_steps_trained": 5134200}, "done": false, "episodes_total": 1351, "training_iteration": 624, "trial_id": "36440_00000", "date": "2023-07-25_02-55-51", "timestamp": 1690242951, "time_this_iter_s": 11.323277235031128, "time_total_s": 10665.267305612564, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 596.1534867286682, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 23.1375, "ram_util_percent": 77.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.166666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 97.8519302368164, "policy_loss": -69788.55625, "vf_loss": 17724517.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 823.0, "diff_num_grad_updates_vs_sampler_policy": 822.0}}, "num_env_steps_sampled": 5135280, "num_env_steps_trained": 5135280, "num_agent_steps_sampled": 5135280, "num_agent_steps_trained": 5135280}, "sampler_results": {"episode_reward_max": -2567.8058560429063, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2704.5692267010418, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527652393768039, "mean_inference_ms": 0.40396696339326027, "mean_action_processing_ms": 0.09622465178330146, "mean_env_wait_ms": 2.0520232582379303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043888092041015625, "StateBufferConnector_ms": 0.0030145645141601562, "ViewRequirementAgentConnector_ms": 0.07451009750366211}}, "episode_reward_max": -2567.8058560429063, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2704.5692267010418, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2567.8058560429063, -2644.6203990956506, -2629.300796506749, -2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527652393768039, "mean_inference_ms": 0.40396696339326027, "mean_action_processing_ms": 0.09622465178330146, "mean_env_wait_ms": 2.0520232582379303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043888092041015625, "StateBufferConnector_ms": 0.0030145645141601562, "ViewRequirementAgentConnector_ms": 0.07451009750366211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5135280, "num_agent_steps_trained": 5135280, "num_env_steps_sampled": 5135280, "num_env_steps_trained": 5135280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.06229829555389, "num_env_steps_trained_throughput_per_sec": 96.06229829555389, "timesteps_total": 5135280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5135280, "timers": {"training_iteration_time_ms": 3765.625, "sample_time_ms": 3754.743, "load_time_ms": 0.296, "load_throughput": 1217112.236, "learn_time_ms": 9.782, "learn_throughput": 36803.798, "synch_weights_time_ms": 0.76}, "counters": {"num_env_steps_sampled": 5135280, "num_env_steps_trained": 5135280, "num_agent_steps_sampled": 5135280, "num_agent_steps_trained": 5135280}, "done": false, "episodes_total": 1354, "training_iteration": 625, "trial_id": "36440_00000", "date": "2023-07-25_02-56-02", "timestamp": 1690242962, "time_this_iter_s": 11.245370149612427, "time_total_s": 10676.512675762177, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 607.3988568782806, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 23.4625, "ram_util_percent": 77.50625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 98.76954193115235, "policy_loss": -79363.1671875, "vf_loss": 17306848.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 838.0, "diff_num_grad_updates_vs_sampler_policy": 837.0}}, "num_env_steps_sampled": 5136360, "num_env_steps_trained": 5136360, "num_agent_steps_sampled": 5136360, "num_agent_steps_trained": 5136360}, "sampler_results": {"episode_reward_max": -2607.2065605132098, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2707.9401840807345, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5283330988946515, "mean_inference_ms": 0.40405885536355884, "mean_action_processing_ms": 0.0962364460672872, "mean_env_wait_ms": 2.057473836608642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00439453125, "StateBufferConnector_ms": 0.0030236244201660156, "ViewRequirementAgentConnector_ms": 0.07461738586425781}}, "episode_reward_max": -2607.2065605132098, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2707.9401840807345, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2628.646532833497, -2625.2874249059482, -2671.3973609233612, -2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5283330988946515, "mean_inference_ms": 0.40405885536355884, "mean_action_processing_ms": 0.0962364460672872, "mean_env_wait_ms": 2.057473836608642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00439453125, "StateBufferConnector_ms": 0.0030236244201660156, "ViewRequirementAgentConnector_ms": 0.07461738586425781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5136360, "num_agent_steps_trained": 5136360, "num_env_steps_sampled": 5136360, "num_env_steps_trained": 5136360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.15660537009188, "num_env_steps_trained_throughput_per_sec": 97.15660537009188, "timesteps_total": 5136360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5136360, "timers": {"training_iteration_time_ms": 3751.541, "sample_time_ms": 3740.7, "load_time_ms": 0.299, "load_throughput": 1205548.455, "learn_time_ms": 9.747, "learn_throughput": 36933.702, "synch_weights_time_ms": 0.751}, "counters": {"num_env_steps_sampled": 5136360, "num_env_steps_trained": 5136360, "num_agent_steps_sampled": 5136360, "num_agent_steps_trained": 5136360}, "done": false, "episodes_total": 1357, "training_iteration": 626, "trial_id": "36440_00000", "date": "2023-07-25_02-56-13", "timestamp": 1690242973, "time_this_iter_s": 11.11876893043518, "time_total_s": 10687.631444692612, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 618.5176258087158, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 26.199999999999996, "ram_util_percent": 77.72500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.1666666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 101.234130859375, "policy_loss": -76271.45859375, "vf_loss": 15917646.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 853.0, "diff_num_grad_updates_vs_sampler_policy": 852.0}}, "num_env_steps_sampled": 5137440, "num_env_steps_trained": 5137440, "num_agent_steps_sampled": 5137440, "num_agent_steps_trained": 5137440}, "sampler_results": {"episode_reward_max": -2607.2065605132098, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2709.524610481084, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528837554505864, "mean_inference_ms": 0.40415153419573174, "mean_action_processing_ms": 0.09624834120572341, "mean_env_wait_ms": 2.062756693591737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004408597946166992, "StateBufferConnector_ms": 0.003031015396118164, "ViewRequirementAgentConnector_ms": 0.07473993301391602}}, "episode_reward_max": -2607.2065605132098, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2709.524610481084, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2686.798926837255, -2690.939544929146, -2673.656359987808, -2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528837554505864, "mean_inference_ms": 0.40415153419573174, "mean_action_processing_ms": 0.09624834120572341, "mean_env_wait_ms": 2.062756693591737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004408597946166992, "StateBufferConnector_ms": 0.003031015396118164, "ViewRequirementAgentConnector_ms": 0.07473993301391602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5137440, "num_agent_steps_trained": 5137440, "num_env_steps_sampled": 5137440, "num_env_steps_trained": 5137440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.01571302066263, "num_env_steps_trained_throughput_per_sec": 96.01571302066263, "timesteps_total": 5137440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5137440, "timers": {"training_iteration_time_ms": 3744.788, "sample_time_ms": 3734.061, "load_time_ms": 0.297, "load_throughput": 1210089.309, "learn_time_ms": 9.667, "learn_throughput": 37239.394, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 5137440, "num_env_steps_trained": 5137440, "num_agent_steps_sampled": 5137440, "num_agent_steps_trained": 5137440}, "done": false, "episodes_total": 1360, "training_iteration": 627, "trial_id": "36440_00000", "date": "2023-07-25_02-56-24", "timestamp": 1690242984, "time_this_iter_s": 11.251281261444092, "time_total_s": 10698.882725954056, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 629.7689070701599, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 23.699999999999996, "ram_util_percent": 77.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 101.11771850585937, "policy_loss": -65556.146875, "vf_loss": 15713920.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 868.0, "diff_num_grad_updates_vs_sampler_policy": 867.0}}, "num_env_steps_sampled": 5138520, "num_env_steps_trained": 5138520, "num_agent_steps_sampled": 5138520, "num_agent_steps_trained": 5138520}, "sampler_results": {"episode_reward_max": -2607.2065605132098, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2710.9955692435706, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529296869002894, "mean_inference_ms": 0.40423846264101493, "mean_action_processing_ms": 0.09625929975023954, "mean_env_wait_ms": 2.0677537665155743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004408121109008789, "StateBufferConnector_ms": 0.003029346466064453, "ViewRequirementAgentConnector_ms": 0.07474613189697266}}, "episode_reward_max": -2607.2065605132098, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2710.9955692435706, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2672.354166465894, -2674.7591982013078, -2690.0178353914603, -2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529296869002894, "mean_inference_ms": 0.40423846264101493, "mean_action_processing_ms": 0.09625929975023954, "mean_env_wait_ms": 2.0677537665155743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004408121109008789, "StateBufferConnector_ms": 0.003029346466064453, "ViewRequirementAgentConnector_ms": 0.07474613189697266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5138520, "num_agent_steps_trained": 5138520, "num_env_steps_sampled": 5138520, "num_env_steps_trained": 5138520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.74294302271338, "num_env_steps_trained_throughput_per_sec": 96.74294302271338, "timesteps_total": 5138520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5138520, "timers": {"training_iteration_time_ms": 3724.597, "sample_time_ms": 3713.969, "load_time_ms": 0.297, "load_throughput": 1211059.865, "learn_time_ms": 9.58, "learn_throughput": 37579.254, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 5138520, "num_env_steps_trained": 5138520, "num_agent_steps_sampled": 5138520, "num_agent_steps_trained": 5138520}, "done": false, "episodes_total": 1363, "training_iteration": 628, "trial_id": "36440_00000", "date": "2023-07-25_02-56-35", "timestamp": 1690242995, "time_this_iter_s": 11.166484832763672, "time_total_s": 10710.04921078682, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 640.9353919029236, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 26.381249999999998, "ram_util_percent": 77.60625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1666666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 99.88552856445312, "policy_loss": -64869.75546875, "vf_loss": 15590567.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 883.0, "diff_num_grad_updates_vs_sampler_policy": 882.0}}, "num_env_steps_sampled": 5139600, "num_env_steps_trained": 5139600, "num_agent_steps_sampled": 5139600, "num_agent_steps_trained": 5139600}, "sampler_results": {"episode_reward_max": -2607.2065605132098, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2712.080772689616, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529790481684871, "mean_inference_ms": 0.4043131346295632, "mean_action_processing_ms": 0.09626862075953699, "mean_env_wait_ms": 2.072585660813526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044171810150146484, "StateBufferConnector_ms": 0.0030355453491210938, "ViewRequirementAgentConnector_ms": 0.07473087310791016}}, "episode_reward_max": -2607.2065605132098, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2712.080772689616, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2668.1745700437345, -2607.2065605132098, -2646.8028627788053, -2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529790481684871, "mean_inference_ms": 0.4043131346295632, "mean_action_processing_ms": 0.09626862075953699, "mean_env_wait_ms": 2.072585660813526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044171810150146484, "StateBufferConnector_ms": 0.0030355453491210938, "ViewRequirementAgentConnector_ms": 0.07473087310791016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5139600, "num_agent_steps_trained": 5139600, "num_env_steps_sampled": 5139600, "num_env_steps_trained": 5139600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.19246448871203, "num_env_steps_trained_throughput_per_sec": 95.19246448871203, "timesteps_total": 5139600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5139600, "timers": {"training_iteration_time_ms": 3733.513, "sample_time_ms": 3722.829, "load_time_ms": 0.301, "load_throughput": 1196283.822, "learn_time_ms": 9.615, "learn_throughput": 37443.107, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 5139600, "num_env_steps_trained": 5139600, "num_agent_steps_sampled": 5139600, "num_agent_steps_trained": 5139600}, "done": false, "episodes_total": 1366, "training_iteration": 629, "trial_id": "36440_00000", "date": "2023-07-25_02-56-47", "timestamp": 1690243007, "time_this_iter_s": 11.348623991012573, "time_total_s": 10721.397834777832, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 652.2840158939362, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 23.950000000000003, "ram_util_percent": 77.85625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 99.96728515625, "policy_loss": -69461.45546875, "vf_loss": 15939431.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 898.0, "diff_num_grad_updates_vs_sampler_policy": 897.0}}, "num_env_steps_sampled": 5140680, "num_env_steps_trained": 5140680, "num_agent_steps_sampled": 5140680, "num_agent_steps_trained": 5140680}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2713.7802883361755, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.530162847157861, "mean_inference_ms": 0.4043885531619374, "mean_action_processing_ms": 0.09627840038058187, "mean_env_wait_ms": 2.077308184337054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004407405853271484, "StateBufferConnector_ms": 0.0030303001403808594, "ViewRequirementAgentConnector_ms": 0.07456493377685547}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2713.7802883361755, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2649.8805798910557, -2686.1399675229745, -2674.722759831362, -2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.530162847157861, "mean_inference_ms": 0.4043885531619374, "mean_action_processing_ms": 0.09627840038058187, "mean_env_wait_ms": 2.077308184337054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004407405853271484, "StateBufferConnector_ms": 0.0030303001403808594, "ViewRequirementAgentConnector_ms": 0.07456493377685547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5140680, "num_agent_steps_trained": 5140680, "num_env_steps_sampled": 5140680, "num_env_steps_trained": 5140680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.10590283126014, "num_env_steps_trained_throughput_per_sec": 96.10590283126014, "timesteps_total": 5140680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5140680, "timers": {"training_iteration_time_ms": 3733.662, "sample_time_ms": 3722.99, "load_time_ms": 0.301, "load_throughput": 1197232.35, "learn_time_ms": 9.601, "learn_throughput": 37494.616, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 5140680, "num_env_steps_trained": 5140680, "num_agent_steps_sampled": 5140680, "num_agent_steps_trained": 5140680}, "done": false, "episodes_total": 1369, "training_iteration": 630, "trial_id": "36440_00000", "date": "2023-07-25_02-56-58", "timestamp": 1690243018, "time_this_iter_s": 11.240587949752808, "time_total_s": 10732.638422727585, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 663.524603843689, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 21.381249999999998, "ram_util_percent": 77.73125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3e-07, "entropy_coeff": 0.1, "policy_entropy": 99.26576232910156, "policy_loss": -69586.53125, "vf_loss": 16858169.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 913.0, "diff_num_grad_updates_vs_sampler_policy": 912.0}}, "num_env_steps_sampled": 5141760, "num_env_steps_trained": 5141760, "num_agent_steps_sampled": 5141760, "num_agent_steps_trained": 5141760}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2715.7979741934773, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.530477164203147, "mean_inference_ms": 0.40447260846031113, "mean_action_processing_ms": 0.09629004217519861, "mean_env_wait_ms": 2.081823800840394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004354953765869141, "StateBufferConnector_ms": 0.0030257701873779297, "ViewRequirementAgentConnector_ms": 0.07425904273986816}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2715.7979741934773, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2706.26705520723, -2678.572532039676, -2658.3491492938174, -2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.530477164203147, "mean_inference_ms": 0.40447260846031113, "mean_action_processing_ms": 0.09629004217519861, "mean_env_wait_ms": 2.081823800840394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004354953765869141, "StateBufferConnector_ms": 0.0030257701873779297, "ViewRequirementAgentConnector_ms": 0.07425904273986816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5141760, "num_agent_steps_trained": 5141760, "num_env_steps_sampled": 5141760, "num_env_steps_trained": 5141760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.99264387868456, "num_env_steps_trained_throughput_per_sec": 96.99264387868456, "timesteps_total": 5141760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5141760, "timers": {"training_iteration_time_ms": 3732.893, "sample_time_ms": 3722.22, "load_time_ms": 0.305, "load_throughput": 1182141.58, "learn_time_ms": 9.596, "learn_throughput": 37515.67, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 5141760, "num_env_steps_trained": 5141760, "num_agent_steps_sampled": 5141760, "num_agent_steps_trained": 5141760}, "done": false, "episodes_total": 1372, "training_iteration": 631, "trial_id": "36440_00000", "date": "2023-07-25_02-57-09", "timestamp": 1690243029, "time_this_iter_s": 11.1376051902771, "time_total_s": 10743.776027917862, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 674.6622090339661, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 27.299999999999997, "ram_util_percent": 77.78125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2e-07, "entropy_coeff": 0.1, "policy_entropy": 100.24065246582032, "policy_loss": -60056.9953125, "vf_loss": 15474881.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 928.0, "diff_num_grad_updates_vs_sampler_policy": 927.0}}, "num_env_steps_sampled": 5142840, "num_env_steps_trained": 5142840, "num_agent_steps_sampled": 5142840, "num_agent_steps_trained": 5142840}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2715.639983468287, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531001486044584, "mean_inference_ms": 0.40454687863895344, "mean_action_processing_ms": 0.0963003642780346, "mean_env_wait_ms": 2.086151629495461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004370212554931641, "StateBufferConnector_ms": 0.003018617630004883, "ViewRequirementAgentConnector_ms": 0.07441020011901855}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2715.639983468287, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2671.550093005769, -2688.21073466952, -2734.835333885911, -2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531001486044584, "mean_inference_ms": 0.40454687863895344, "mean_action_processing_ms": 0.0963003642780346, "mean_env_wait_ms": 2.086151629495461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004370212554931641, "StateBufferConnector_ms": 0.003018617630004883, "ViewRequirementAgentConnector_ms": 0.07441020011901855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5142840, "num_agent_steps_trained": 5142840, "num_env_steps_sampled": 5142840, "num_env_steps_trained": 5142840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.10049979449079, "num_env_steps_trained_throughput_per_sec": 96.10049979449079, "timesteps_total": 5142840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5142840, "timers": {"training_iteration_time_ms": 3739.124, "sample_time_ms": 3728.449, "load_time_ms": 0.303, "load_throughput": 1187533.968, "learn_time_ms": 9.614, "learn_throughput": 37443.757, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 5142840, "num_env_steps_trained": 5142840, "num_agent_steps_sampled": 5142840, "num_agent_steps_trained": 5142840}, "done": false, "episodes_total": 1375, "training_iteration": 632, "trial_id": "36440_00000", "date": "2023-07-25_02-57-20", "timestamp": 1690243040, "time_this_iter_s": 11.240952014923096, "time_total_s": 10755.016979932785, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 685.9031610488892, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 23.0, "ram_util_percent": 77.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7e-07, "entropy_coeff": 0.1, "policy_entropy": 101.21119842529296, "policy_loss": -71457.1921875, "vf_loss": 15682918.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 943.0, "diff_num_grad_updates_vs_sampler_policy": 942.0}}, "num_env_steps_sampled": 5143920, "num_env_steps_trained": 5143920, "num_agent_steps_sampled": 5143920, "num_agent_steps_trained": 5143920}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2716.2415667755504, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531591939634591, "mean_inference_ms": 0.40461719837568444, "mean_action_processing_ms": 0.09630988930062168, "mean_env_wait_ms": 2.090324346268061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00438380241394043, "StateBufferConnector_ms": 0.0030503273010253906, "ViewRequirementAgentConnector_ms": 0.07475972175598145}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2825.5090631487997, "episode_reward_mean": -2716.2415667755504, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2687.082872061448, -2655.0851204409705, -2737.2131369992494, -2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531591939634591, "mean_inference_ms": 0.40461719837568444, "mean_action_processing_ms": 0.09630988930062168, "mean_env_wait_ms": 2.090324346268061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00438380241394043, "StateBufferConnector_ms": 0.0030503273010253906, "ViewRequirementAgentConnector_ms": 0.07475972175598145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5143920, "num_agent_steps_trained": 5143920, "num_env_steps_sampled": 5143920, "num_env_steps_trained": 5143920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.36519419406855, "num_env_steps_trained_throughput_per_sec": 96.36519419406855, "timesteps_total": 5143920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5143920, "timers": {"training_iteration_time_ms": 3740.746, "sample_time_ms": 3729.811, "load_time_ms": 0.307, "load_throughput": 1172048.001, "learn_time_ms": 9.855, "learn_throughput": 36529.562, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 5143920, "num_env_steps_trained": 5143920, "num_agent_steps_sampled": 5143920, "num_agent_steps_trained": 5143920}, "done": false, "episodes_total": 1378, "training_iteration": 633, "trial_id": "36440_00000", "date": "2023-07-25_02-57-32", "timestamp": 1690243052, "time_this_iter_s": 11.210774898529053, "time_total_s": 10766.227754831314, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 697.1139359474182, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 26.49375, "ram_util_percent": 77.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3999999999999998e-07, "entropy_coeff": 0.1, "policy_entropy": 99.65252990722657, "policy_loss": -70195.51171875, "vf_loss": 16010635.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 958.0, "diff_num_grad_updates_vs_sampler_policy": 957.0}}, "num_env_steps_sampled": 5145000, "num_env_steps_trained": 5145000, "num_agent_steps_sampled": 5145000, "num_agent_steps_trained": 5145000}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2717.9781297637924, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532152914025312, "mean_inference_ms": 0.40468460656543115, "mean_action_processing_ms": 0.09631917623543361, "mean_env_wait_ms": 2.094338437797824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043523311614990234, "StateBufferConnector_ms": 0.0030400753021240234, "ViewRequirementAgentConnector_ms": 0.07428622245788574}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2717.9781297637924, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2684.7846465131233, -2744.7027080300845, -2765.6330017204336, -2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532152914025312, "mean_inference_ms": 0.40468460656543115, "mean_action_processing_ms": 0.09631917623543361, "mean_env_wait_ms": 2.094338437797824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043523311614990234, "StateBufferConnector_ms": 0.0030400753021240234, "ViewRequirementAgentConnector_ms": 0.07428622245788574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5145000, "num_agent_steps_trained": 5145000, "num_env_steps_sampled": 5145000, "num_env_steps_trained": 5145000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.9742511041145, "num_env_steps_trained_throughput_per_sec": 96.9742511041145, "timesteps_total": 5145000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5145000, "timers": {"training_iteration_time_ms": 3741.581, "sample_time_ms": 3730.604, "load_time_ms": 0.309, "load_throughput": 1166704.868, "learn_time_ms": 9.902, "learn_throughput": 36358.041, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 5145000, "num_env_steps_trained": 5145000, "num_agent_steps_sampled": 5145000, "num_agent_steps_trained": 5145000}, "done": false, "episodes_total": 1381, "training_iteration": 634, "trial_id": "36440_00000", "date": "2023-07-25_02-57-43", "timestamp": 1690243063, "time_this_iter_s": 11.139768123626709, "time_total_s": 10777.36752295494, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 708.2537040710449, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 26.04375, "ram_util_percent": 77.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.49174652099609, "policy_loss": -69773.09453125, "vf_loss": 16107359.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 973.0, "diff_num_grad_updates_vs_sampler_policy": 972.0}}, "num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2716.552946836031, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532660563961164, "mean_inference_ms": 0.40474143881667274, "mean_action_processing_ms": 0.09632698484173974, "mean_env_wait_ms": 2.0981867177400977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00434422492980957, "StateBufferConnector_ms": 0.003038167953491211, "ViewRequirementAgentConnector_ms": 0.07427191734313965}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2716.552946836031, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2744.5022972676543, -2687.374197255063, -2672.925640817903, -2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532660563961164, "mean_inference_ms": 0.40474143881667274, "mean_action_processing_ms": 0.09632698484173974, "mean_env_wait_ms": 2.0981867177400977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00434422492980957, "StateBufferConnector_ms": 0.003038167953491211, "ViewRequirementAgentConnector_ms": 0.07427191734313965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080, "num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.05918020642929, "num_env_steps_trained_throughput_per_sec": 97.05918020642929, "timesteps_total": 5146080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5146080, "timers": {"training_iteration_time_ms": 3727.967, "sample_time_ms": 3716.985, "load_time_ms": 0.31, "load_throughput": 1162751.763, "learn_time_ms": 9.903, "learn_throughput": 36351.914, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080}, "done": false, "episodes_total": 1384, "training_iteration": 635, "trial_id": "36440_00000", "date": "2023-07-25_02-57-54", "timestamp": 1690243074, "time_this_iter_s": 11.130015850067139, "time_total_s": 10788.497538805008, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 719.3837199211121, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 24.2125, "ram_util_percent": 77.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.76931457519531, "policy_loss": -69635.12265625, "vf_loss": 16547580.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 988.0, "diff_num_grad_updates_vs_sampler_policy": 987.0}}, "num_env_steps_sampled": 5147160, "num_env_steps_trained": 5147160, "num_agent_steps_sampled": 5147160, "num_agent_steps_trained": 5147160}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2716.413979311182, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533130830513549, "mean_inference_ms": 0.4048011563372155, "mean_action_processing_ms": 0.09633501733943099, "mean_env_wait_ms": 2.1018681895686875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004332542419433594, "StateBufferConnector_ms": 0.0030498504638671875, "ViewRequirementAgentConnector_ms": 0.0741722583770752}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2716.413979311182, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2718.609555746436, -2701.81873234794, -2684.4661035712443, -2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533130830513549, "mean_inference_ms": 0.4048011563372155, "mean_action_processing_ms": 0.09633501733943099, "mean_env_wait_ms": 2.1018681895686875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004332542419433594, "StateBufferConnector_ms": 0.0030498504638671875, "ViewRequirementAgentConnector_ms": 0.0741722583770752}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5147160, "num_agent_steps_trained": 5147160, "num_env_steps_sampled": 5147160, "num_env_steps_trained": 5147160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.71696031602268, "num_env_steps_trained_throughput_per_sec": 96.71696031602268, "timesteps_total": 5147160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5147160, "timers": {"training_iteration_time_ms": 3721.195, "sample_time_ms": 3710.407, "load_time_ms": 0.303, "load_throughput": 1187814.223, "learn_time_ms": 9.721, "learn_throughput": 37033.98, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 5147160, "num_env_steps_trained": 5147160, "num_agent_steps_sampled": 5147160, "num_agent_steps_trained": 5147160}, "done": false, "episodes_total": 1387, "training_iteration": 636, "trial_id": "36440_00000", "date": "2023-07-25_02-58-05", "timestamp": 1690243085, "time_this_iter_s": 11.169470071792603, "time_total_s": 10799.6670088768, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 730.5531899929047, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 27.69333333333333, "ram_util_percent": 77.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.54800567626953, "policy_loss": -67233.8015625, "vf_loss": 16599261.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1003.0, "diff_num_grad_updates_vs_sampler_policy": 1002.0}}, "num_env_steps_sampled": 5148240, "num_env_steps_trained": 5148240, "num_agent_steps_sampled": 5148240, "num_agent_steps_trained": 5148240}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2716.8680841166615, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53367033170835, "mean_inference_ms": 0.40486216408298, "mean_action_processing_ms": 0.09634321417486834, "mean_env_wait_ms": 2.105399115593078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004325389862060547, "StateBufferConnector_ms": 0.0030488967895507812, "ViewRequirementAgentConnector_ms": 0.0741891860961914}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2716.8680841166615, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2709.8091216735465, -2688.7885667893383, -2726.579384779416, -2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53367033170835, "mean_inference_ms": 0.40486216408298, "mean_action_processing_ms": 0.09634321417486834, "mean_env_wait_ms": 2.105399115593078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004325389862060547, "StateBufferConnector_ms": 0.0030488967895507812, "ViewRequirementAgentConnector_ms": 0.0741891860961914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5148240, "num_agent_steps_trained": 5148240, "num_env_steps_sampled": 5148240, "num_env_steps_trained": 5148240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.63992579106684, "num_env_steps_trained_throughput_per_sec": 95.63992579106684, "timesteps_total": 5148240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5148240, "timers": {"training_iteration_time_ms": 3723.586, "sample_time_ms": 3712.864, "load_time_ms": 0.3, "load_throughput": 1200182.37, "learn_time_ms": 9.67, "learn_throughput": 37230.029, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 5148240, "num_env_steps_trained": 5148240, "num_agent_steps_sampled": 5148240, "num_agent_steps_trained": 5148240}, "done": false, "episodes_total": 1390, "training_iteration": 637, "trial_id": "36440_00000", "date": "2023-07-25_02-58-17", "timestamp": 1690243097, "time_this_iter_s": 11.295180082321167, "time_total_s": 10810.962188959122, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 741.8483700752258, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 23.043750000000003, "ram_util_percent": 77.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.35528411865235, "policy_loss": -72432.5390625, "vf_loss": 16237374.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1018.0, "diff_num_grad_updates_vs_sampler_policy": 1017.0}}, "num_env_steps_sampled": 5149320, "num_env_steps_trained": 5149320, "num_agent_steps_sampled": 5149320, "num_agent_steps_trained": 5149320}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2715.865015259827, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534184234148702, "mean_inference_ms": 0.4049201583079173, "mean_action_processing_ms": 0.09635101949547475, "mean_env_wait_ms": 2.1087734428467817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00433039665222168, "StateBufferConnector_ms": 0.0030531883239746094, "ViewRequirementAgentConnector_ms": 0.07445573806762695}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2715.865015259827, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2765.6631106613963, -2735.5013390559984, -2730.9703567540787, -2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534184234148702, "mean_inference_ms": 0.4049201583079173, "mean_action_processing_ms": 0.09635101949547475, "mean_env_wait_ms": 2.1087734428467817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00433039665222168, "StateBufferConnector_ms": 0.0030531883239746094, "ViewRequirementAgentConnector_ms": 0.07445573806762695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5149320, "num_agent_steps_trained": 5149320, "num_env_steps_sampled": 5149320, "num_env_steps_trained": 5149320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.1652334524237, "num_env_steps_trained_throughput_per_sec": 96.1652334524237, "timesteps_total": 5149320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5149320, "timers": {"training_iteration_time_ms": 3726.044, "sample_time_ms": 3715.348, "load_time_ms": 0.3, "load_throughput": 1201806.304, "learn_time_ms": 9.652, "learn_throughput": 37299.095, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 5149320, "num_env_steps_trained": 5149320, "num_agent_steps_sampled": 5149320, "num_agent_steps_trained": 5149320}, "done": false, "episodes_total": 1393, "training_iteration": 638, "trial_id": "36440_00000", "date": "2023-07-25_02-58-28", "timestamp": 1690243108, "time_this_iter_s": 11.233496904373169, "time_total_s": 10822.195685863495, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 753.081866979599, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 23.56875, "ram_util_percent": 77.46249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.1090301513672, "policy_loss": -68003.7140625, "vf_loss": 16311986.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1033.0, "diff_num_grad_updates_vs_sampler_policy": 1032.0}}, "num_env_steps_sampled": 5150400, "num_env_steps_trained": 5150400, "num_agent_steps_sampled": 5150400, "num_agent_steps_trained": 5150400}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2714.1623173164658, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534637928691556, "mean_inference_ms": 0.404976696250814, "mean_action_processing_ms": 0.09635850034274665, "mean_env_wait_ms": 2.1120376102498755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004354238510131836, "StateBufferConnector_ms": 0.003068208694458008, "ViewRequirementAgentConnector_ms": 0.07505583763122559}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2714.1623173164658, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2802.832354834694, -2686.1150172672355, -2748.8315049158778, -2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534637928691556, "mean_inference_ms": 0.404976696250814, "mean_action_processing_ms": 0.09635850034274665, "mean_env_wait_ms": 2.1120376102498755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004354238510131836, "StateBufferConnector_ms": 0.003068208694458008, "ViewRequirementAgentConnector_ms": 0.07505583763122559}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5150400, "num_agent_steps_trained": 5150400, "num_env_steps_sampled": 5150400, "num_env_steps_trained": 5150400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.59956950473375, "num_env_steps_trained_throughput_per_sec": 95.59956950473375, "timesteps_total": 5150400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5150400, "timers": {"training_iteration_time_ms": 3740.746, "sample_time_ms": 3729.981, "load_time_ms": 0.299, "load_throughput": 1203338.731, "learn_time_ms": 9.717, "learn_throughput": 37047.065, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 5150400, "num_env_steps_trained": 5150400, "num_agent_steps_sampled": 5150400, "num_agent_steps_trained": 5150400}, "done": false, "episodes_total": 1396, "training_iteration": 639, "trial_id": "36440_00000", "date": "2023-07-25_02-58-39", "timestamp": 1690243119, "time_this_iter_s": 11.299995183944702, "time_total_s": 10833.49568104744, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 764.3818621635437, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 24.43125, "ram_util_percent": 77.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.49645233154297, "policy_loss": -69526.59375, "vf_loss": 15944521.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1048.0, "diff_num_grad_updates_vs_sampler_policy": 1047.0}}, "num_env_steps_sampled": 5151480, "num_env_steps_trained": 5151480, "num_agent_steps_sampled": 5151480, "num_agent_steps_trained": 5151480}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2712.1591300422397, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535116876782512, "mean_inference_ms": 0.4050310647097384, "mean_action_processing_ms": 0.09636563598531822, "mean_env_wait_ms": 2.115155700917037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043489933013916016, "StateBufferConnector_ms": 0.003064393997192383, "ViewRequirementAgentConnector_ms": 0.07503938674926758}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2712.1591300422397, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2774.918929497237, -2699.219237133457, -2756.906255654785, -2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535116876782512, "mean_inference_ms": 0.4050310647097384, "mean_action_processing_ms": 0.09636563598531822, "mean_env_wait_ms": 2.115155700917037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043489933013916016, "StateBufferConnector_ms": 0.003064393997192383, "ViewRequirementAgentConnector_ms": 0.07503938674926758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5151480, "num_agent_steps_trained": 5151480, "num_env_steps_sampled": 5151480, "num_env_steps_trained": 5151480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.22455005576708, "num_env_steps_trained_throughput_per_sec": 95.22455005576708, "timesteps_total": 5151480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5151480, "timers": {"training_iteration_time_ms": 3761.242, "sample_time_ms": 3750.435, "load_time_ms": 0.3, "load_throughput": 1200659.542, "learn_time_ms": 9.767, "learn_throughput": 36857.701, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 5151480, "num_env_steps_trained": 5151480, "num_agent_steps_sampled": 5151480, "num_agent_steps_trained": 5151480}, "done": false, "episodes_total": 1399, "training_iteration": 640, "trial_id": "36440_00000", "date": "2023-07-25_02-58-51", "timestamp": 1690243131, "time_this_iter_s": 11.344499349594116, "time_total_s": 10844.840180397034, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 775.7263615131378, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 22.93125, "ram_util_percent": 77.38749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.89510498046874, "policy_loss": -70627.65390625, "vf_loss": 16430961.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1063.0, "diff_num_grad_updates_vs_sampler_policy": 1062.0}}, "num_env_steps_sampled": 5152560, "num_env_steps_trained": 5152560, "num_agent_steps_sampled": 5152560, "num_agent_steps_trained": 5152560}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2710.517595771124, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535556319802517, "mean_inference_ms": 0.4050828077943056, "mean_action_processing_ms": 0.09637210519751578, "mean_env_wait_ms": 2.118099425991966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004340410232543945, "StateBufferConnector_ms": 0.0030531883239746094, "ViewRequirementAgentConnector_ms": 0.07480740547180176}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2710.517595771124, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2647.3981689424227, -2683.340219933983, -2710.2932657705023, -2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535556319802517, "mean_inference_ms": 0.4050828077943056, "mean_action_processing_ms": 0.09637210519751578, "mean_env_wait_ms": 2.118099425991966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004340410232543945, "StateBufferConnector_ms": 0.0030531883239746094, "ViewRequirementAgentConnector_ms": 0.07480740547180176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5152560, "num_agent_steps_trained": 5152560, "num_env_steps_sampled": 5152560, "num_env_steps_trained": 5152560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.14555610894872, "num_env_steps_trained_throughput_per_sec": 97.14555610894872, "timesteps_total": 5152560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5152560, "timers": {"training_iteration_time_ms": 3752.798, "sample_time_ms": 3742.022, "load_time_ms": 0.301, "load_throughput": 1194863.844, "learn_time_ms": 9.722, "learn_throughput": 37028.713, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 5152560, "num_env_steps_trained": 5152560, "num_agent_steps_sampled": 5152560, "num_agent_steps_trained": 5152560}, "done": false, "episodes_total": 1402, "training_iteration": 641, "trial_id": "36440_00000", "date": "2023-07-25_02-59-02", "timestamp": 1690243142, "time_this_iter_s": 11.120137929916382, "time_total_s": 10855.96031832695, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 786.8464994430542, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 24.2, "ram_util_percent": 77.30625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.82646942138672, "policy_loss": -71574.40625, "vf_loss": 16398873.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1078.0, "diff_num_grad_updates_vs_sampler_policy": 1077.0}}, "num_env_steps_sampled": 5153640, "num_env_steps_trained": 5153640, "num_agent_steps_sampled": 5153640, "num_agent_steps_trained": 5153640}, "sampler_results": {"episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2711.162062530216, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535967459707231, "mean_inference_ms": 0.4051330602521365, "mean_action_processing_ms": 0.09637833838237658, "mean_env_wait_ms": 2.1209677778521625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004298210144042969, "StateBufferConnector_ms": 0.003047943115234375, "ViewRequirementAgentConnector_ms": 0.07453346252441406}}, "episode_reward_max": -2615.390209886323, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2711.162062530216, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2615.390209886323, -2687.97504544797, -2725.15509873797, -2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535967459707231, "mean_inference_ms": 0.4051330602521365, "mean_action_processing_ms": 0.09637833838237658, "mean_env_wait_ms": 2.1209677778521625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004298210144042969, "StateBufferConnector_ms": 0.003047943115234375, "ViewRequirementAgentConnector_ms": 0.07453346252441406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5153640, "num_agent_steps_trained": 5153640, "num_env_steps_sampled": 5153640, "num_env_steps_trained": 5153640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.6853037920883, "num_env_steps_trained_throughput_per_sec": 96.6853037920883, "timesteps_total": 5153640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5153640, "timers": {"training_iteration_time_ms": 3749.677, "sample_time_ms": 3738.964, "load_time_ms": 0.301, "load_throughput": 1196378.607, "learn_time_ms": 9.67, "learn_throughput": 37228.652, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 5153640, "num_env_steps_trained": 5153640, "num_agent_steps_sampled": 5153640, "num_agent_steps_trained": 5153640}, "done": false, "episodes_total": 1405, "training_iteration": 642, "trial_id": "36440_00000", "date": "2023-07-25_02-59-13", "timestamp": 1690243153, "time_this_iter_s": 11.172932147979736, "time_total_s": 10867.13325047493, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 798.0194315910339, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 24.33125, "ram_util_percent": 77.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.33945770263672, "policy_loss": -67790.1046875, "vf_loss": 15919985.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1093.0, "diff_num_grad_updates_vs_sampler_policy": 1092.0}}, "num_env_steps_sampled": 5154720, "num_env_steps_trained": 5154720, "num_agent_steps_sampled": 5154720, "num_agent_steps_trained": 5154720}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2712.4421533309096, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5364086206003105, "mean_inference_ms": 0.4051783537722579, "mean_action_processing_ms": 0.0963836848646747, "mean_env_wait_ms": 2.123768002479773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004303693771362305, "StateBufferConnector_ms": 0.0030498504638671875, "ViewRequirementAgentConnector_ms": 0.07443356513977051}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2712.4421533309096, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2655.185206393156, -2763.608661191928, -2682.6382918865797, -2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5364086206003105, "mean_inference_ms": 0.4051783537722579, "mean_action_processing_ms": 0.0963836848646747, "mean_env_wait_ms": 2.123768002479773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004303693771362305, "StateBufferConnector_ms": 0.0030498504638671875, "ViewRequirementAgentConnector_ms": 0.07443356513977051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5154720, "num_agent_steps_trained": 5154720, "num_env_steps_sampled": 5154720, "num_env_steps_trained": 5154720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.1677588724787, "num_env_steps_trained_throughput_per_sec": 96.1677588724787, "timesteps_total": 5154720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5154720, "timers": {"training_iteration_time_ms": 3735.067, "sample_time_ms": 3724.495, "load_time_ms": 0.298, "load_throughput": 1207186.952, "learn_time_ms": 9.532, "learn_throughput": 37765.919, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 5154720, "num_env_steps_trained": 5154720, "num_agent_steps_sampled": 5154720, "num_agent_steps_trained": 5154720}, "done": false, "episodes_total": 1408, "training_iteration": 643, "trial_id": "36440_00000", "date": "2023-07-25_02-59-24", "timestamp": 1690243164, "time_this_iter_s": 11.233092069625854, "time_total_s": 10878.366342544556, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 809.2525236606598, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 23.71875, "ram_util_percent": 77.35624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.6883560180664, "policy_loss": -70120.2953125, "vf_loss": 16236196.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1108.0, "diff_num_grad_updates_vs_sampler_policy": 1107.0}}, "num_env_steps_sampled": 5155800, "num_env_steps_trained": 5155800, "num_agent_steps_sampled": 5155800, "num_agent_steps_trained": 5155800}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2712.64067555558, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.536778531429167, "mean_inference_ms": 0.4052267623971001, "mean_action_processing_ms": 0.09638957989470652, "mean_env_wait_ms": 2.126477899924802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004311323165893555, "StateBufferConnector_ms": 0.003058910369873047, "ViewRequirementAgentConnector_ms": 0.07444596290588379}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2712.64067555558, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2753.6735599899657, -2742.625919707654, -2737.0693429471135, -2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.536778531429167, "mean_inference_ms": 0.4052267623971001, "mean_action_processing_ms": 0.09638957989470652, "mean_env_wait_ms": 2.126477899924802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004311323165893555, "StateBufferConnector_ms": 0.003058910369873047, "ViewRequirementAgentConnector_ms": 0.07444596290588379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5155800, "num_agent_steps_trained": 5155800, "num_env_steps_sampled": 5155800, "num_env_steps_trained": 5155800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.85197700105451, "num_env_steps_trained_throughput_per_sec": 96.85197700105451, "timesteps_total": 5155800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5155800, "timers": {"training_iteration_time_ms": 3737.18, "sample_time_ms": 3726.523, "load_time_ms": 0.3, "load_throughput": 1199324.416, "learn_time_ms": 9.602, "learn_throughput": 37492.382, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 5155800, "num_env_steps_trained": 5155800, "num_agent_steps_sampled": 5155800, "num_agent_steps_trained": 5155800}, "done": false, "episodes_total": 1411, "training_iteration": 644, "trial_id": "36440_00000", "date": "2023-07-25_02-59-35", "timestamp": 1690243175, "time_this_iter_s": 11.153955221176147, "time_total_s": 10889.520297765732, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 820.4064788818359, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 27.831249999999997, "ram_util_percent": 77.39375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.74687194824219, "policy_loss": -68845.54296875, "vf_loss": 16052419.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1123.0, "diff_num_grad_updates_vs_sampler_policy": 1122.0}}, "num_env_steps_sampled": 5156880, "num_env_steps_trained": 5156880, "num_agent_steps_sampled": 5156880, "num_agent_steps_trained": 5156880}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2712.1476800961514, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537061618788011, "mean_inference_ms": 0.40527701038397723, "mean_action_processing_ms": 0.09639572417102305, "mean_env_wait_ms": 2.1291335919312586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00432276725769043, "StateBufferConnector_ms": 0.0030548572540283203, "ViewRequirementAgentConnector_ms": 0.0747983455657959}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2712.1476800961514, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2709.369011115104, -2776.084025142537, -2780.9316988887917, -2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537061618788011, "mean_inference_ms": 0.40527701038397723, "mean_action_processing_ms": 0.09639572417102305, "mean_env_wait_ms": 2.1291335919312586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00432276725769043, "StateBufferConnector_ms": 0.0030548572540283203, "ViewRequirementAgentConnector_ms": 0.0747983455657959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5156880, "num_agent_steps_trained": 5156880, "num_env_steps_sampled": 5156880, "num_env_steps_trained": 5156880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.92141448040044, "num_env_steps_trained_throughput_per_sec": 95.92141448040044, "timesteps_total": 5156880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5156880, "timers": {"training_iteration_time_ms": 3739.087, "sample_time_ms": 3728.406, "load_time_ms": 0.3, "load_throughput": 1200564.077, "learn_time_ms": 9.63, "learn_throughput": 37382.944, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 5156880, "num_env_steps_trained": 5156880, "num_agent_steps_sampled": 5156880, "num_agent_steps_trained": 5156880}, "done": false, "episodes_total": 1414, "training_iteration": 645, "trial_id": "36440_00000", "date": "2023-07-25_02-59-47", "timestamp": 1690243187, "time_this_iter_s": 11.26193881034851, "time_total_s": 10900.78223657608, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 831.6684176921844, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 24.387500000000003, "ram_util_percent": 77.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.29046936035157, "policy_loss": -75311.8625, "vf_loss": 17014710.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1138.0, "diff_num_grad_updates_vs_sampler_policy": 1137.0}}, "num_env_steps_sampled": 5157960, "num_env_steps_trained": 5157960, "num_agent_steps_sampled": 5157960, "num_agent_steps_trained": 5157960}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2711.4763762963976, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537328907863168, "mean_inference_ms": 0.4053280724993402, "mean_action_processing_ms": 0.09640212763833846, "mean_env_wait_ms": 2.1316612823656573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004320621490478516, "StateBufferConnector_ms": 0.0030524730682373047, "ViewRequirementAgentConnector_ms": 0.07474875450134277}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2711.4763762963976, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2747.354060996323, -2751.589346818161, -2748.9254226906855, -2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537328907863168, "mean_inference_ms": 0.4053280724993402, "mean_action_processing_ms": 0.09640212763833846, "mean_env_wait_ms": 2.1316612823656573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004320621490478516, "StateBufferConnector_ms": 0.0030524730682373047, "ViewRequirementAgentConnector_ms": 0.07474875450134277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5157960, "num_agent_steps_trained": 5157960, "num_env_steps_sampled": 5157960, "num_env_steps_trained": 5157960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.45224663967645, "num_env_steps_trained_throughput_per_sec": 96.45224663967645, "timesteps_total": 5157960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5157960, "timers": {"training_iteration_time_ms": 3726.928, "sample_time_ms": 3716.177, "load_time_ms": 0.303, "load_throughput": 1189311.153, "learn_time_ms": 9.694, "learn_throughput": 37135.809, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 5157960, "num_env_steps_trained": 5157960, "num_agent_steps_sampled": 5157960, "num_agent_steps_trained": 5157960}, "done": false, "episodes_total": 1417, "training_iteration": 646, "trial_id": "36440_00000", "date": "2023-07-25_02-59-58", "timestamp": 1690243198, "time_this_iter_s": 11.200011968612671, "time_total_s": 10911.982248544693, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 842.8684296607971, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 24.575000000000003, "ram_util_percent": 77.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.17567749023438, "policy_loss": -64411.30625, "vf_loss": 15860607.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1153.0, "diff_num_grad_updates_vs_sampler_policy": 1152.0}}, "num_env_steps_sampled": 5159040, "num_env_steps_trained": 5159040, "num_agent_steps_sampled": 5159040, "num_agent_steps_trained": 5159040}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2709.6208851815936, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53749241116368, "mean_inference_ms": 0.40537473453904016, "mean_action_processing_ms": 0.09640796887262847, "mean_env_wait_ms": 2.1340835467489314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004325151443481445, "StateBufferConnector_ms": 0.003057241439819336, "ViewRequirementAgentConnector_ms": 0.07477450370788574}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2709.6208851815936, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2717.2003241391576, -2802.81508311339, -2695.293649471126, -2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53749241116368, "mean_inference_ms": 0.40537473453904016, "mean_action_processing_ms": 0.09640796887262847, "mean_env_wait_ms": 2.1340835467489314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004325151443481445, "StateBufferConnector_ms": 0.003057241439819336, "ViewRequirementAgentConnector_ms": 0.07477450370788574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5159040, "num_agent_steps_trained": 5159040, "num_env_steps_sampled": 5159040, "num_env_steps_trained": 5159040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.51521449738567, "num_env_steps_trained_throughput_per_sec": 97.51521449738567, "timesteps_total": 5159040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5159040, "timers": {"training_iteration_time_ms": 3711.656, "sample_time_ms": 3700.917, "load_time_ms": 0.305, "load_throughput": 1181863.995, "learn_time_ms": 9.675, "learn_throughput": 37210.853, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 5159040, "num_env_steps_trained": 5159040, "num_agent_steps_sampled": 5159040, "num_agent_steps_trained": 5159040}, "done": false, "episodes_total": 1420, "training_iteration": 647, "trial_id": "36440_00000", "date": "2023-07-25_03-00-09", "timestamp": 1690243209, "time_this_iter_s": 11.078053951263428, "time_total_s": 10923.060302495956, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 853.9464836120605, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 27.91875, "ram_util_percent": 77.48750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.45594940185546, "policy_loss": -67274.59921875, "vf_loss": 16288655.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1168.0, "diff_num_grad_updates_vs_sampler_policy": 1167.0}}, "num_env_steps_sampled": 5160120, "num_env_steps_trained": 5160120, "num_agent_steps_sampled": 5160120, "num_agent_steps_trained": 5160120}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2708.8578003253824, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5375968132996345, "mean_inference_ms": 0.40541922724738255, "mean_action_processing_ms": 0.09641351354327142, "mean_env_wait_ms": 2.136436005882472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004298210144042969, "StateBufferConnector_ms": 0.0030388832092285156, "ViewRequirementAgentConnector_ms": 0.0743098258972168}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2708.8578003253824, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2750.290154848498, -2695.6175705198716, -2725.7308963342043, -2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5375968132996345, "mean_inference_ms": 0.40541922724738255, "mean_action_processing_ms": 0.09641351354327142, "mean_env_wait_ms": 2.136436005882472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004298210144042969, "StateBufferConnector_ms": 0.0030388832092285156, "ViewRequirementAgentConnector_ms": 0.0743098258972168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160120, "num_agent_steps_trained": 5160120, "num_env_steps_sampled": 5160120, "num_env_steps_trained": 5160120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.49379072552425, "num_env_steps_trained_throughput_per_sec": 96.49379072552425, "timesteps_total": 5160120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5160120, "timers": {"training_iteration_time_ms": 3712.14, "sample_time_ms": 3701.493, "load_time_ms": 0.305, "load_throughput": 1182234.137, "learn_time_ms": 9.589, "learn_throughput": 37542.72, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 5160120, "num_env_steps_trained": 5160120, "num_agent_steps_sampled": 5160120, "num_agent_steps_trained": 5160120}, "done": false, "episodes_total": 1423, "training_iteration": 648, "trial_id": "36440_00000", "date": "2023-07-25_03-00-20", "timestamp": 1690243220, "time_this_iter_s": 11.195219993591309, "time_total_s": 10934.255522489548, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 865.1417036056519, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 23.8125, "ram_util_percent": 77.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.52396850585937, "policy_loss": -75953.9671875, "vf_loss": 16141850.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1183.0, "diff_num_grad_updates_vs_sampler_policy": 1182.0}}, "num_env_steps_sampled": 5161200, "num_env_steps_trained": 5161200, "num_agent_steps_sampled": 5161200, "num_agent_steps_trained": 5161200}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2708.242503074289, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537728778638215, "mean_inference_ms": 0.4054577427022216, "mean_action_processing_ms": 0.09641805796985467, "mean_env_wait_ms": 2.13870658707154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004305601119995117, "StateBufferConnector_ms": 0.0030426979064941406, "ViewRequirementAgentConnector_ms": 0.07437467575073242}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2708.242503074289, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2677.6677572277626, -2718.544746880399, -2748.109542817497, -2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537728778638215, "mean_inference_ms": 0.4054577427022216, "mean_action_processing_ms": 0.09641805796985467, "mean_env_wait_ms": 2.13870658707154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004305601119995117, "StateBufferConnector_ms": 0.0030426979064941406, "ViewRequirementAgentConnector_ms": 0.07437467575073242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5161200, "num_agent_steps_trained": 5161200, "num_env_steps_sampled": 5161200, "num_env_steps_trained": 5161200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.18737265098005, "num_env_steps_trained_throughput_per_sec": 96.18737265098005, "timesteps_total": 5161200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5161200, "timers": {"training_iteration_time_ms": 3723.87, "sample_time_ms": 3713.343, "load_time_ms": 0.303, "load_throughput": 1187627.371, "learn_time_ms": 9.463, "learn_throughput": 38043.861, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 5161200, "num_env_steps_trained": 5161200, "num_agent_steps_sampled": 5161200, "num_agent_steps_trained": 5161200}, "done": false, "episodes_total": 1426, "training_iteration": 649, "trial_id": "36440_00000", "date": "2023-07-25_03-00-31", "timestamp": 1690243231, "time_this_iter_s": 11.231017827987671, "time_total_s": 10945.486540317535, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 876.3727214336395, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 23.9875, "ram_util_percent": 77.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.9561553955078, "policy_loss": -65546.51640625, "vf_loss": 15453468.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1198.0, "diff_num_grad_updates_vs_sampler_policy": 1197.0}}, "num_env_steps_sampled": 5162280, "num_env_steps_trained": 5162280, "num_agent_steps_sampled": 5162280, "num_agent_steps_trained": 5162280}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2707.502663076123, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537821625619314, "mean_inference_ms": 0.4054933978367255, "mean_action_processing_ms": 0.0964218743635024, "mean_env_wait_ms": 2.140912748898171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043141841888427734, "StateBufferConnector_ms": 0.0030426979064941406, "ViewRequirementAgentConnector_ms": 0.0745537281036377}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2831.9051500925702, "episode_reward_mean": -2707.502663076123, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2753.3057084552124, -2745.6469727251224, -2731.636088909193, -2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537821625619314, "mean_inference_ms": 0.4054933978367255, "mean_action_processing_ms": 0.0964218743635024, "mean_env_wait_ms": 2.140912748898171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043141841888427734, "StateBufferConnector_ms": 0.0030426979064941406, "ViewRequirementAgentConnector_ms": 0.0745537281036377}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5162280, "num_agent_steps_trained": 5162280, "num_env_steps_sampled": 5162280, "num_env_steps_trained": 5162280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.46352287552527, "num_env_steps_trained_throughput_per_sec": 96.46352287552527, "timesteps_total": 5162280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5162280, "timers": {"training_iteration_time_ms": 3740.619, "sample_time_ms": 3730.116, "load_time_ms": 0.3, "load_throughput": 1200468.628, "learn_time_ms": 9.45, "learn_throughput": 38095.693, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 5162280, "num_env_steps_trained": 5162280, "num_agent_steps_sampled": 5162280, "num_agent_steps_trained": 5162280}, "done": false, "episodes_total": 1429, "training_iteration": 650, "trial_id": "36440_00000", "date": "2023-07-25_03-00-43", "timestamp": 1690243243, "time_this_iter_s": 11.198715925216675, "time_total_s": 10956.685256242752, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 887.5714373588562, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 24.0875, "ram_util_percent": 77.35625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.43536071777343, "policy_loss": -71709.75546875, "vf_loss": 16025770.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1213.0, "diff_num_grad_updates_vs_sampler_policy": 1212.0}}, "num_env_steps_sampled": 5163360, "num_env_steps_trained": 5163360, "num_agent_steps_sampled": 5163360, "num_agent_steps_trained": 5163360}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.9029462462995, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537922866523749, "mean_inference_ms": 0.40552699829212413, "mean_action_processing_ms": 0.09642548956619605, "mean_env_wait_ms": 2.1430535651525524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004305601119995117, "StateBufferConnector_ms": 0.003049612045288086, "ViewRequirementAgentConnector_ms": 0.07452654838562012}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.9029462462995, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2750.1007051311713, -2687.991213160637, -2759.2487551726754, -2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537922866523749, "mean_inference_ms": 0.40552699829212413, "mean_action_processing_ms": 0.09642548956619605, "mean_env_wait_ms": 2.1430535651525524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004305601119995117, "StateBufferConnector_ms": 0.003049612045288086, "ViewRequirementAgentConnector_ms": 0.07452654838562012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5163360, "num_agent_steps_trained": 5163360, "num_env_steps_sampled": 5163360, "num_env_steps_trained": 5163360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.76952058795626, "num_env_steps_trained_throughput_per_sec": 96.76952058795626, "timesteps_total": 5163360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5163360, "timers": {"training_iteration_time_ms": 3739.828, "sample_time_ms": 3729.312, "load_time_ms": 0.3, "load_throughput": 1199896.249, "learn_time_ms": 9.454, "learn_throughput": 38080.705, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 5163360, "num_env_steps_trained": 5163360, "num_agent_steps_sampled": 5163360, "num_agent_steps_trained": 5163360}, "done": false, "episodes_total": 1432, "training_iteration": 651, "trial_id": "36440_00000", "date": "2023-07-25_03-00-54", "timestamp": 1690243254, "time_this_iter_s": 11.163408756256104, "time_total_s": 10967.848664999008, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 898.7348461151123, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 23.706666666666663, "ram_util_percent": 77.41333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.51792755126954, "policy_loss": -68993.93203125, "vf_loss": 15893518.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1228.0, "diff_num_grad_updates_vs_sampler_policy": 1227.0}}, "num_env_steps_sampled": 5164440, "num_env_steps_trained": 5164440, "num_agent_steps_sampled": 5164440, "num_agent_steps_trained": 5164440}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.3373496699023, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538066224492736, "mean_inference_ms": 0.4055573147832419, "mean_action_processing_ms": 0.09642849579325981, "mean_env_wait_ms": 2.1451128263237655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004298686981201172, "StateBufferConnector_ms": 0.003040790557861328, "ViewRequirementAgentConnector_ms": 0.07445526123046875}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.3373496699023, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2695.5870079365586, -2673.1314911813834, -2728.204650879824, -2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538066224492736, "mean_inference_ms": 0.4055573147832419, "mean_action_processing_ms": 0.09642849579325981, "mean_env_wait_ms": 2.1451128263237655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004298686981201172, "StateBufferConnector_ms": 0.003040790557861328, "ViewRequirementAgentConnector_ms": 0.07445526123046875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5164440, "num_agent_steps_trained": 5164440, "num_env_steps_sampled": 5164440, "num_env_steps_trained": 5164440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.07863504154591, "num_env_steps_trained_throughput_per_sec": 97.07863504154591, "timesteps_total": 5164440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5164440, "timers": {"training_iteration_time_ms": 3731.449, "sample_time_ms": 3720.9, "load_time_ms": 0.3, "load_throughput": 1201519.408, "learn_time_ms": 9.474, "learn_throughput": 37997.716, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 5164440, "num_env_steps_trained": 5164440, "num_agent_steps_sampled": 5164440, "num_agent_steps_trained": 5164440}, "done": false, "episodes_total": 1435, "training_iteration": 652, "trial_id": "36440_00000", "date": "2023-07-25_03-01-05", "timestamp": 1690243265, "time_this_iter_s": 11.127709865570068, "time_total_s": 10978.976374864578, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 909.8625559806824, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 24.5, "ram_util_percent": 77.48124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.89912567138671, "policy_loss": -70843.31015625, "vf_loss": 16007144.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1243.0, "diff_num_grad_updates_vs_sampler_policy": 1242.0}}, "num_env_steps_sampled": 5165520, "num_env_steps_trained": 5165520, "num_agent_steps_sampled": 5165520, "num_agent_steps_trained": 5165520}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.768406370979, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538206658349118, "mean_inference_ms": 0.40558702812596503, "mean_action_processing_ms": 0.09643096053222416, "mean_env_wait_ms": 2.147114154668208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004312038421630859, "StateBufferConnector_ms": 0.003042936325073242, "ViewRequirementAgentConnector_ms": 0.07478046417236328}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.768406370979, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2702.445927777646, -2699.6689339336626, -2748.407351775219, -2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538206658349118, "mean_inference_ms": 0.40558702812596503, "mean_action_processing_ms": 0.09643096053222416, "mean_env_wait_ms": 2.147114154668208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004312038421630859, "StateBufferConnector_ms": 0.003042936325073242, "ViewRequirementAgentConnector_ms": 0.07478046417236328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5165520, "num_agent_steps_trained": 5165520, "num_env_steps_sampled": 5165520, "num_env_steps_trained": 5165520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.64060427123705, "num_env_steps_trained_throughput_per_sec": 95.64060427123705, "timesteps_total": 5165520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5165520, "timers": {"training_iteration_time_ms": 3740.171, "sample_time_ms": 3729.609, "load_time_ms": 0.299, "load_throughput": 1203818.417, "learn_time_ms": 9.503, "learn_throughput": 37882.081, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 5165520, "num_env_steps_trained": 5165520, "num_agent_steps_sampled": 5165520, "num_agent_steps_trained": 5165520}, "done": false, "episodes_total": 1438, "training_iteration": 653, "trial_id": "36440_00000", "date": "2023-07-25_03-01-16", "timestamp": 1690243276, "time_this_iter_s": 11.295093059539795, "time_total_s": 10990.271467924118, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 921.1576490402222, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 23.4875, "ram_util_percent": 77.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.41882934570313, "policy_loss": -68201.25234375, "vf_loss": 16159275.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1258.0, "diff_num_grad_updates_vs_sampler_policy": 1257.0}}, "num_env_steps_sampled": 5166600, "num_env_steps_trained": 5166600, "num_agent_steps_sampled": 5166600, "num_agent_steps_trained": 5166600}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.319507071355, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538366797713693, "mean_inference_ms": 0.4056118885918886, "mean_action_processing_ms": 0.09643259447402797, "mean_env_wait_ms": 2.149054361491665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00430607795715332, "StateBufferConnector_ms": 0.0030422210693359375, "ViewRequirementAgentConnector_ms": 0.07460546493530273}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.319507071355, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2678.8270455197076, -2654.8535487474082, -2733.0362194542276, -2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538366797713693, "mean_inference_ms": 0.4056118885918886, "mean_action_processing_ms": 0.09643259447402797, "mean_env_wait_ms": 2.149054361491665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00430607795715332, "StateBufferConnector_ms": 0.0030422210693359375, "ViewRequirementAgentConnector_ms": 0.07460546493530273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5166600, "num_agent_steps_trained": 5166600, "num_env_steps_sampled": 5166600, "num_env_steps_trained": 5166600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.82358933804392, "num_env_steps_trained_throughput_per_sec": 95.82358933804392, "timesteps_total": 5166600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5166600, "timers": {"training_iteration_time_ms": 3740.298, "sample_time_ms": 3729.765, "load_time_ms": 0.297, "load_throughput": 1211351.336, "learn_time_ms": 9.482, "learn_throughput": 37967.428, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 5166600, "num_env_steps_trained": 5166600, "num_agent_steps_sampled": 5166600, "num_agent_steps_trained": 5166600}, "done": false, "episodes_total": 1441, "training_iteration": 654, "trial_id": "36440_00000", "date": "2023-07-25_03-01-28", "timestamp": 1690243288, "time_this_iter_s": 11.27335500717163, "time_total_s": 11001.54482293129, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 932.4310040473938, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 24.78125, "ram_util_percent": 77.46875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.66124725341797, "policy_loss": -77167.8640625, "vf_loss": 16983728.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1273.0, "diff_num_grad_updates_vs_sampler_policy": 1272.0}}, "num_env_steps_sampled": 5167680, "num_env_steps_trained": 5167680, "num_agent_steps_sampled": 5167680, "num_agent_steps_trained": 5167680}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2709.9449591243556, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538509481658679, "mean_inference_ms": 0.40563256331508285, "mean_action_processing_ms": 0.09643361624485153, "mean_env_wait_ms": 2.150928319573963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00429224967956543, "StateBufferConnector_ms": 0.003041505813598633, "ViewRequirementAgentConnector_ms": 0.07442235946655273}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2709.9449591243556, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2688.828144383869, -2671.19781373745, -2736.864484826319, -2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538509481658679, "mean_inference_ms": 0.40563256331508285, "mean_action_processing_ms": 0.09643361624485153, "mean_env_wait_ms": 2.150928319573963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00429224967956543, "StateBufferConnector_ms": 0.003041505813598633, "ViewRequirementAgentConnector_ms": 0.07442235946655273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5167680, "num_agent_steps_trained": 5167680, "num_env_steps_sampled": 5167680, "num_env_steps_trained": 5167680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.31268507325368, "num_env_steps_trained_throughput_per_sec": 96.31268507325368, "timesteps_total": 5167680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5167680, "timers": {"training_iteration_time_ms": 3736.131, "sample_time_ms": 3725.537, "load_time_ms": 0.298, "load_throughput": 1209604.614, "learn_time_ms": 9.545, "learn_throughput": 37716.017, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 5167680, "num_env_steps_trained": 5167680, "num_agent_steps_sampled": 5167680, "num_agent_steps_trained": 5167680}, "done": false, "episodes_total": 1444, "training_iteration": 655, "trial_id": "36440_00000", "date": "2023-07-25_03-01-39", "timestamp": 1690243299, "time_this_iter_s": 11.216299057006836, "time_total_s": 11012.761121988297, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 943.6473031044006, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 24.5125, "ram_util_percent": 77.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.18177337646485, "policy_loss": -64942.66328125, "vf_loss": 16157426.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1288.0, "diff_num_grad_updates_vs_sampler_policy": 1287.0}}, "num_env_steps_sampled": 5168760, "num_env_steps_trained": 5168760, "num_agent_steps_sampled": 5168760, "num_agent_steps_trained": 5168760}, "sampler_results": {"episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2710.452987250282, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538610778573082, "mean_inference_ms": 0.4056547904163695, "mean_action_processing_ms": 0.09643499178210577, "mean_env_wait_ms": 2.1527466565164857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263877868652344, "StateBufferConnector_ms": 0.0030241012573242188, "ViewRequirementAgentConnector_ms": 0.07399964332580566}}, "episode_reward_max": -2625.0832429943043, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2710.452987250282, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2676.6317639166327, -2676.2165024299625, -2672.4427191171712, -2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538610778573082, "mean_inference_ms": 0.4056547904163695, "mean_action_processing_ms": 0.09643499178210577, "mean_env_wait_ms": 2.1527466565164857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263877868652344, "StateBufferConnector_ms": 0.0030241012573242188, "ViewRequirementAgentConnector_ms": 0.07399964332580566}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5168760, "num_agent_steps_trained": 5168760, "num_env_steps_sampled": 5168760, "num_env_steps_trained": 5168760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.37976379316133, "num_env_steps_trained_throughput_per_sec": 96.37976379316133, "timesteps_total": 5168760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5168760, "timers": {"training_iteration_time_ms": 3732.367, "sample_time_ms": 3721.77, "load_time_ms": 0.3, "load_throughput": 1201232.649, "learn_time_ms": 9.548, "learn_throughput": 37702.927, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 5168760, "num_env_steps_trained": 5168760, "num_agent_steps_sampled": 5168760, "num_agent_steps_trained": 5168760}, "done": false, "episodes_total": 1447, "training_iteration": 656, "trial_id": "36440_00000", "date": "2023-07-25_03-01-50", "timestamp": 1690243310, "time_this_iter_s": 11.208539009094238, "time_total_s": 11023.96966099739, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 954.8558421134949, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 24.25, "ram_util_percent": 77.54375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.89660034179687, "policy_loss": -71265.5375, "vf_loss": 16958339.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1303.0, "diff_num_grad_updates_vs_sampler_policy": 1302.0}}, "num_env_steps_sampled": 5169840, "num_env_steps_trained": 5169840, "num_agent_steps_sampled": 5169840, "num_agent_steps_trained": 5169840}, "sampler_results": {"episode_reward_max": -2616.916877269921, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2710.9963041823667, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538670856089536, "mean_inference_ms": 0.4056779469490091, "mean_action_processing_ms": 0.09643655866700858, "mean_env_wait_ms": 2.1544901907868432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042705535888671875, "StateBufferConnector_ms": 0.003015279769897461, "ViewRequirementAgentConnector_ms": 0.07399821281433105}}, "episode_reward_max": -2616.916877269921, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2710.9963041823667, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2641.832530079112, -2687.775902255901, -2751.026051017621, -2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538670856089536, "mean_inference_ms": 0.4056779469490091, "mean_action_processing_ms": 0.09643655866700858, "mean_env_wait_ms": 2.1544901907868432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042705535888671875, "StateBufferConnector_ms": 0.003015279769897461, "ViewRequirementAgentConnector_ms": 0.07399821281433105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5169840, "num_agent_steps_trained": 5169840, "num_env_steps_sampled": 5169840, "num_env_steps_trained": 5169840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.65317715819049, "num_env_steps_trained_throughput_per_sec": 96.65317715819049, "timesteps_total": 5169840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5169840, "timers": {"training_iteration_time_ms": 3727.055, "sample_time_ms": 3716.388, "load_time_ms": 0.3, "load_throughput": 1201997.644, "learn_time_ms": 9.606, "learn_throughput": 37478.144, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 5169840, "num_env_steps_trained": 5169840, "num_agent_steps_sampled": 5169840, "num_agent_steps_trained": 5169840}, "done": false, "episodes_total": 1450, "training_iteration": 657, "trial_id": "36440_00000", "date": "2023-07-25_03-02-01", "timestamp": 1690243321, "time_this_iter_s": 11.176767110824585, "time_total_s": 11035.146428108215, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 966.0326092243195, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 23.5625, "ram_util_percent": 77.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 98.89594268798828, "policy_loss": -70604.70234375, "vf_loss": 16985942.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1318.0, "diff_num_grad_updates_vs_sampler_policy": 1317.0}}, "num_env_steps_sampled": 5170920, "num_env_steps_trained": 5170920, "num_agent_steps_sampled": 5170920, "num_agent_steps_trained": 5170920}, "sampler_results": {"episode_reward_max": -2603.2451801561683, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2711.2782539906207, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53868066949981, "mean_inference_ms": 0.40570110672865595, "mean_action_processing_ms": 0.09643822290391281, "mean_env_wait_ms": 2.1561544969795268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004275321960449219, "StateBufferConnector_ms": 0.0030150413513183594, "ViewRequirementAgentConnector_ms": 0.07409930229187012}}, "episode_reward_max": -2603.2451801561683, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2711.2782539906207, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2825.5090631487997, -2718.7567984030557, -2670.061506926512, -2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53868066949981, "mean_inference_ms": 0.40570110672865595, "mean_action_processing_ms": 0.09643822290391281, "mean_env_wait_ms": 2.1561544969795268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004275321960449219, "StateBufferConnector_ms": 0.0030150413513183594, "ViewRequirementAgentConnector_ms": 0.07409930229187012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5170920, "num_agent_steps_trained": 5170920, "num_env_steps_sampled": 5170920, "num_env_steps_trained": 5170920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.58162911974675, "num_env_steps_trained_throughput_per_sec": 97.58162911974675, "timesteps_total": 5170920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5170920, "timers": {"training_iteration_time_ms": 3722.72, "sample_time_ms": 3711.877, "load_time_ms": 0.298, "load_throughput": 1208056.196, "learn_time_ms": 9.779, "learn_throughput": 36813.759, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 5170920, "num_env_steps_trained": 5170920, "num_agent_steps_sampled": 5170920, "num_agent_steps_trained": 5170920}, "done": false, "episodes_total": 1453, "training_iteration": 658, "trial_id": "36440_00000", "date": "2023-07-25_03-02-12", "timestamp": 1690243332, "time_this_iter_s": 11.070531129837036, "time_total_s": 11046.216959238052, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 977.1031403541565, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 23.89375, "ram_util_percent": 77.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.74798431396485, "policy_loss": -65481.63359375, "vf_loss": 16124715.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1333.0, "diff_num_grad_updates_vs_sampler_policy": 1332.0}}, "num_env_steps_sampled": 5172000, "num_env_steps_trained": 5172000, "num_agent_steps_sampled": 5172000, "num_agent_steps_trained": 5172000}, "sampler_results": {"episode_reward_max": -2603.2451801561683, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2710.466240559418, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538680691128405, "mean_inference_ms": 0.40572334011804984, "mean_action_processing_ms": 0.09643969676966152, "mean_env_wait_ms": 2.1577887068335446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004268169403076172, "StateBufferConnector_ms": 0.0030090808868408203, "ViewRequirementAgentConnector_ms": 0.07408308982849121}}, "episode_reward_max": -2603.2451801561683, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2710.466240559418, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2790.0044842850125, -2685.705136649508, -2693.68031974861, -2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538680691128405, "mean_inference_ms": 0.40572334011804984, "mean_action_processing_ms": 0.09643969676966152, "mean_env_wait_ms": 2.1577887068335446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004268169403076172, "StateBufferConnector_ms": 0.0030090808868408203, "ViewRequirementAgentConnector_ms": 0.07408308982849121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5172000, "num_agent_steps_trained": 5172000, "num_env_steps_sampled": 5172000, "num_env_steps_trained": 5172000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.77163543344783, "num_env_steps_trained_throughput_per_sec": 96.77163543344783, "timesteps_total": 5172000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5172000, "timers": {"training_iteration_time_ms": 3723.133, "sample_time_ms": 3712.298, "load_time_ms": 0.298, "load_throughput": 1207669.711, "learn_time_ms": 9.763, "learn_throughput": 36875.073, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 5172000, "num_env_steps_trained": 5172000, "num_agent_steps_sampled": 5172000, "num_agent_steps_trained": 5172000}, "done": false, "episodes_total": 1456, "training_iteration": 659, "trial_id": "36440_00000", "date": "2023-07-25_03-02-24", "timestamp": 1690243344, "time_this_iter_s": 11.16314435005188, "time_total_s": 11057.380103588104, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 988.2662847042084, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 23.2375, "ram_util_percent": 77.47500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.45298309326172, "policy_loss": -71079.2484375, "vf_loss": 16835198.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1348.0, "diff_num_grad_updates_vs_sampler_policy": 1347.0}}, "num_env_steps_sampled": 5173080, "num_env_steps_trained": 5173080, "num_agent_steps_sampled": 5173080, "num_agent_steps_trained": 5173080}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2709.0453328677036, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53866477522782, "mean_inference_ms": 0.4057423954210569, "mean_action_processing_ms": 0.09644076553007055, "mean_env_wait_ms": 2.1593339653562604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004265546798706055, "StateBufferConnector_ms": 0.00301361083984375, "ViewRequirementAgentConnector_ms": 0.07404780387878418}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2709.0453328677036, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2704.3885022996883, -2786.9185779424615, -2733.5129716252204, -2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53866477522782, "mean_inference_ms": 0.4057423954210569, "mean_action_processing_ms": 0.09644076553007055, "mean_env_wait_ms": 2.1593339653562604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004265546798706055, "StateBufferConnector_ms": 0.00301361083984375, "ViewRequirementAgentConnector_ms": 0.07404780387878418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5173080, "num_agent_steps_trained": 5173080, "num_env_steps_sampled": 5173080, "num_env_steps_trained": 5173080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 98.11518150649275, "num_env_steps_trained_throughput_per_sec": 98.11518150649275, "timesteps_total": 5173080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5173080, "timers": {"training_iteration_time_ms": 3704.269, "sample_time_ms": 3693.454, "load_time_ms": 0.299, "load_throughput": 1205355.983, "learn_time_ms": 9.75, "learn_throughput": 36922.683, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 5173080, "num_env_steps_trained": 5173080, "num_agent_steps_sampled": 5173080, "num_agent_steps_trained": 5173080}, "done": false, "episodes_total": 1459, "training_iteration": 660, "trial_id": "36440_00000", "date": "2023-07-25_03-02-35", "timestamp": 1690243355, "time_this_iter_s": 11.01018500328064, "time_total_s": 11068.390288591385, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 999.276469707489, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 25.53125, "ram_util_percent": 77.39375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.84482116699219, "policy_loss": -66932.3703125, "vf_loss": 15679058.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1363.0, "diff_num_grad_updates_vs_sampler_policy": 1362.0}}, "num_env_steps_sampled": 5174160, "num_env_steps_trained": 5174160, "num_agent_steps_sampled": 5174160, "num_agent_steps_trained": 5174160}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.5044707721013, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538667143919678, "mean_inference_ms": 0.40576078972840435, "mean_action_processing_ms": 0.0964416875546652, "mean_env_wait_ms": 2.1608128067341354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004261493682861328, "StateBufferConnector_ms": 0.0030100345611572266, "ViewRequirementAgentConnector_ms": 0.07395482063293457}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.5044707721013, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2678.0591584351287, -2704.124818767512, -2766.410002700732, -2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538667143919678, "mean_inference_ms": 0.40576078972840435, "mean_action_processing_ms": 0.0964416875546652, "mean_env_wait_ms": 2.1608128067341354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004261493682861328, "StateBufferConnector_ms": 0.0030100345611572266, "ViewRequirementAgentConnector_ms": 0.07395482063293457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5174160, "num_agent_steps_trained": 5174160, "num_env_steps_sampled": 5174160, "num_env_steps_trained": 5174160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.65775358450638, "num_env_steps_trained_throughput_per_sec": 96.65775358450638, "timesteps_total": 5174160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5174160, "timers": {"training_iteration_time_ms": 3713.012, "sample_time_ms": 3702.124, "load_time_ms": 0.299, "load_throughput": 1204490.619, "learn_time_ms": 9.82, "learn_throughput": 36660.737, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 5174160, "num_env_steps_trained": 5174160, "num_agent_steps_sampled": 5174160, "num_agent_steps_trained": 5174160}, "done": false, "episodes_total": 1462, "training_iteration": 661, "trial_id": "36440_00000", "date": "2023-07-25_03-02-46", "timestamp": 1690243366, "time_this_iter_s": 11.17613697052002, "time_total_s": 11079.566425561905, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1010.452606678009, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 24.7625, "ram_util_percent": 77.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.42432098388672, "policy_loss": -66364.30703125, "vf_loss": 16046952.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1378.0, "diff_num_grad_updates_vs_sampler_policy": 1377.0}}, "num_env_steps_sampled": 5175240, "num_env_steps_trained": 5175240, "num_agent_steps_sampled": 5175240, "num_agent_steps_trained": 5175240}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.8698665914976, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538639441985894, "mean_inference_ms": 0.4057821377503404, "mean_action_processing_ms": 0.09644322150351513, "mean_env_wait_ms": 2.162243007750519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042629241943359375, "StateBufferConnector_ms": 0.003015756607055664, "ViewRequirementAgentConnector_ms": 0.07414436340332031}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.8698665914976, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2675.116723194887, -2629.2149455687145, -2768.5630243656533, -2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538639441985894, "mean_inference_ms": 0.4057821377503404, "mean_action_processing_ms": 0.09644322150351513, "mean_env_wait_ms": 2.162243007750519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042629241943359375, "StateBufferConnector_ms": 0.003015756607055664, "ViewRequirementAgentConnector_ms": 0.07414436340332031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5175240, "num_agent_steps_trained": 5175240, "num_env_steps_sampled": 5175240, "num_env_steps_trained": 5175240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.22178806970463, "num_env_steps_trained_throughput_per_sec": 96.22178806970463, "timesteps_total": 5175240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5175240, "timers": {"training_iteration_time_ms": 3720.013, "sample_time_ms": 3709.32, "load_time_ms": 0.298, "load_throughput": 1208442.929, "learn_time_ms": 9.645, "learn_throughput": 37324.174, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 5175240, "num_env_steps_trained": 5175240, "num_agent_steps_sampled": 5175240, "num_agent_steps_trained": 5175240}, "done": false, "episodes_total": 1465, "training_iteration": 662, "trial_id": "36440_00000", "date": "2023-07-25_03-02-57", "timestamp": 1690243377, "time_this_iter_s": 11.226754903793335, "time_total_s": 11090.793180465698, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1021.6793615818024, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 22.75, "ram_util_percent": 77.61250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.51068115234375, "policy_loss": -65993.18828125, "vf_loss": 15673561.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1393.0, "diff_num_grad_updates_vs_sampler_policy": 1392.0}}, "num_env_steps_sampled": 5176320, "num_env_steps_trained": 5176320, "num_agent_steps_sampled": 5176320, "num_agent_steps_trained": 5176320}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2709.118886667, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538585002131868, "mean_inference_ms": 0.40580428618147585, "mean_action_processing_ms": 0.09644492499480993, "mean_env_wait_ms": 2.1636036726467984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042724609375, "StateBufferConnector_ms": 0.003026723861694336, "ViewRequirementAgentConnector_ms": 0.07431864738464355}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2709.118886667, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2694.357588057429, -2694.2043398454957, -2735.4755374709503, -2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538585002131868, "mean_inference_ms": 0.40580428618147585, "mean_action_processing_ms": 0.09644492499480993, "mean_env_wait_ms": 2.1636036726467984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042724609375, "StateBufferConnector_ms": 0.003026723861694336, "ViewRequirementAgentConnector_ms": 0.07431864738464355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5176320, "num_agent_steps_trained": 5176320, "num_env_steps_sampled": 5176320, "num_env_steps_trained": 5176320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.02606065886886, "num_env_steps_trained_throughput_per_sec": 97.02606065886886, "timesteps_total": 5176320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5176320, "timers": {"training_iteration_time_ms": 3715.703, "sample_time_ms": 3705.045, "load_time_ms": 0.297, "load_throughput": 1211837.432, "learn_time_ms": 9.612, "learn_throughput": 37451.465, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 5176320, "num_env_steps_trained": 5176320, "num_agent_steps_sampled": 5176320, "num_agent_steps_trained": 5176320}, "done": false, "episodes_total": 1468, "training_iteration": 663, "trial_id": "36440_00000", "date": "2023-07-25_03-03-08", "timestamp": 1690243388, "time_this_iter_s": 11.13402795791626, "time_total_s": 11101.927208423615, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1032.8133895397186, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 77.57333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.68437805175782, "policy_loss": -73185.934375, "vf_loss": 16402842.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1408.0, "diff_num_grad_updates_vs_sampler_policy": 1407.0}}, "num_env_steps_sampled": 5177400, "num_env_steps_trained": 5177400, "num_agent_steps_sampled": 5177400, "num_agent_steps_trained": 5177400}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.6356373790604, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538538921324962, "mean_inference_ms": 0.40582212848694543, "mean_action_processing_ms": 0.09644587265975359, "mean_env_wait_ms": 2.164930387250085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042819976806640625, "StateBufferConnector_ms": 0.0030307769775390625, "ViewRequirementAgentConnector_ms": 0.07441139221191406}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2708.6356373790604, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2782.832015659058, -2656.62285455113, -2714.305830553208, -2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538538921324962, "mean_inference_ms": 0.40582212848694543, "mean_action_processing_ms": 0.09644587265975359, "mean_env_wait_ms": 2.164930387250085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042819976806640625, "StateBufferConnector_ms": 0.0030307769775390625, "ViewRequirementAgentConnector_ms": 0.07441139221191406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5177400, "num_agent_steps_trained": 5177400, "num_env_steps_sampled": 5177400, "num_env_steps_trained": 5177400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.63117758951962, "num_env_steps_trained_throughput_per_sec": 96.63117758951962, "timesteps_total": 5177400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5177400, "timers": {"training_iteration_time_ms": 3712.555, "sample_time_ms": 3701.876, "load_time_ms": 0.297, "load_throughput": 1212129.277, "learn_time_ms": 9.641, "learn_throughput": 37339.68, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 5177400, "num_env_steps_trained": 5177400, "num_agent_steps_sampled": 5177400, "num_agent_steps_trained": 5177400}, "done": false, "episodes_total": 1471, "training_iteration": 664, "trial_id": "36440_00000", "date": "2023-07-25_03-03-19", "timestamp": 1690243399, "time_this_iter_s": 11.179378032684326, "time_total_s": 11113.106586456299, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1043.992767572403, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 23.4375, "ram_util_percent": 77.68125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.16185302734375, "policy_loss": -71346.5546875, "vf_loss": 16156317.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1423.0, "diff_num_grad_updates_vs_sampler_policy": 1422.0}}, "num_env_steps_sampled": 5178480, "num_env_steps_trained": 5178480, "num_agent_steps_sampled": 5178480, "num_agent_steps_trained": 5178480}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2709.878387522772, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538436534753908, "mean_inference_ms": 0.40583699905272913, "mean_action_processing_ms": 0.09644648325023629, "mean_env_wait_ms": 2.16624832199473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00428318977355957, "StateBufferConnector_ms": 0.003030538558959961, "ViewRequirementAgentConnector_ms": 0.07438802719116211}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2709.878387522772, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2656.460978917294, -2715.4567522044376, -2769.707212471083, -2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538436534753908, "mean_inference_ms": 0.40583699905272913, "mean_action_processing_ms": 0.09644648325023629, "mean_env_wait_ms": 2.16624832199473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00428318977355957, "StateBufferConnector_ms": 0.003030538558959961, "ViewRequirementAgentConnector_ms": 0.07438802719116211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5178480, "num_agent_steps_trained": 5178480, "num_env_steps_sampled": 5178480, "num_env_steps_trained": 5178480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.33582956883897, "num_env_steps_trained_throughput_per_sec": 97.33582956883897, "timesteps_total": 5178480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5178480, "timers": {"training_iteration_time_ms": 3702.169, "sample_time_ms": 3691.486, "load_time_ms": 0.299, "load_throughput": 1205933.584, "learn_time_ms": 9.635, "learn_throughput": 37363.333, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 5178480, "num_env_steps_trained": 5178480, "num_agent_steps_sampled": 5178480, "num_agent_steps_trained": 5178480}, "done": false, "episodes_total": 1474, "training_iteration": 665, "trial_id": "36440_00000", "date": "2023-07-25_03-03-31", "timestamp": 1690243411, "time_this_iter_s": 11.098217010498047, "time_total_s": 11124.204803466797, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1055.090984582901, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 30.337500000000002, "ram_util_percent": 77.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.16424102783203, "policy_loss": -73982.0390625, "vf_loss": 16670727.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1438.0, "diff_num_grad_updates_vs_sampler_policy": 1437.0}}, "num_env_steps_sampled": 5179560, "num_env_steps_trained": 5179560, "num_agent_steps_sampled": 5179560, "num_agent_steps_trained": 5179560}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2711.1856619038285, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538263039110732, "mean_inference_ms": 0.40585171742535264, "mean_action_processing_ms": 0.09644737252773218, "mean_env_wait_ms": 2.1674757389443866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004268646240234375, "StateBufferConnector_ms": 0.003007173538208008, "ViewRequirementAgentConnector_ms": 0.07402706146240234}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2711.1856619038285, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2669.590527612107, -2711.7546470013217, -2831.9051500925702, -2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538263039110732, "mean_inference_ms": 0.40585171742535264, "mean_action_processing_ms": 0.09644737252773218, "mean_env_wait_ms": 2.1674757389443866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004268646240234375, "StateBufferConnector_ms": 0.003007173538208008, "ViewRequirementAgentConnector_ms": 0.07402706146240234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5179560, "num_agent_steps_trained": 5179560, "num_env_steps_sampled": 5179560, "num_env_steps_trained": 5179560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 100.13447692650871, "num_env_steps_trained_throughput_per_sec": 100.13447692650871, "timesteps_total": 5179560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5179560, "timers": {"training_iteration_time_ms": 3677.706, "sample_time_ms": 3666.938, "load_time_ms": 0.3, "load_throughput": 1199610.265, "learn_time_ms": 9.72, "learn_throughput": 37038.25, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 5179560, "num_env_steps_trained": 5179560, "num_agent_steps_sampled": 5179560, "num_agent_steps_trained": 5179560}, "done": false, "episodes_total": 1477, "training_iteration": 666, "trial_id": "36440_00000", "date": "2023-07-25_03-03-41", "timestamp": 1690243421, "time_this_iter_s": 10.788264989852905, "time_total_s": 11134.99306845665, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1065.879249572754, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 35.61875, "ram_util_percent": 77.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.00566101074219, "policy_loss": -66800.38359375, "vf_loss": 16592512.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1453.0, "diff_num_grad_updates_vs_sampler_policy": 1452.0}}, "num_env_steps_sampled": 5180640, "num_env_steps_trained": 5180640, "num_agent_steps_sampled": 5180640, "num_agent_steps_trained": 5180640}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2710.7844790992594, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538158075282621, "mean_inference_ms": 0.4058591815709827, "mean_action_processing_ms": 0.0964473474627277, "mean_env_wait_ms": 2.1686536487553156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004265308380126953, "StateBufferConnector_ms": 0.0030062198638916016, "ViewRequirementAgentConnector_ms": 0.07397985458374023}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2710.7844790992594, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2709.3776312319874, -2673.206056730137, -2676.9223572444453, -2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538158075282621, "mean_inference_ms": 0.4058591815709827, "mean_action_processing_ms": 0.0964473474627277, "mean_env_wait_ms": 2.1686536487553156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004265308380126953, "StateBufferConnector_ms": 0.0030062198638916016, "ViewRequirementAgentConnector_ms": 0.07397985458374023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5180640, "num_agent_steps_trained": 5180640, "num_env_steps_sampled": 5180640, "num_env_steps_trained": 5180640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.6949664536717, "num_env_steps_trained_throughput_per_sec": 95.6949664536717, "timesteps_total": 5180640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5180640, "timers": {"training_iteration_time_ms": 3693.263, "sample_time_ms": 3682.562, "load_time_ms": 0.301, "load_throughput": 1195336.795, "learn_time_ms": 9.654, "learn_throughput": 37288.318, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 5180640, "num_env_steps_trained": 5180640, "num_agent_steps_sampled": 5180640, "num_agent_steps_trained": 5180640}, "done": false, "episodes_total": 1480, "training_iteration": 667, "trial_id": "36440_00000", "date": "2023-07-25_03-03-53", "timestamp": 1690243433, "time_this_iter_s": 11.288549661636353, "time_total_s": 11146.281618118286, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1077.1677992343903, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.69375, "ram_util_percent": 77.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.24625244140626, "policy_loss": -69430.4875, "vf_loss": 16057461.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1468.0, "diff_num_grad_updates_vs_sampler_policy": 1467.0}}, "num_env_steps_sampled": 5181720, "num_env_steps_trained": 5181720, "num_agent_steps_sampled": 5181720, "num_agent_steps_trained": 5181720}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2711.4668058932334, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538011512202145, "mean_inference_ms": 0.4058692607881082, "mean_action_processing_ms": 0.09644772376284419, "mean_env_wait_ms": 2.169803592333027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004281759262084961, "StateBufferConnector_ms": 0.0030052661895751953, "ViewRequirementAgentConnector_ms": 0.07417893409729004}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2711.4668058932334, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2702.473649512978, -2665.991021792171, -2687.6824087506575, -2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538011512202145, "mean_inference_ms": 0.4058692607881082, "mean_action_processing_ms": 0.09644772376284419, "mean_env_wait_ms": 2.169803592333027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004281759262084961, "StateBufferConnector_ms": 0.0030052661895751953, "ViewRequirementAgentConnector_ms": 0.07417893409729004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5181720, "num_agent_steps_trained": 5181720, "num_env_steps_sampled": 5181720, "num_env_steps_trained": 5181720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 98.45650288397013, "num_env_steps_trained_throughput_per_sec": 98.45650288397013, "timesteps_total": 5181720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5181720, "timers": {"training_iteration_time_ms": 3675.612, "sample_time_ms": 3664.884, "load_time_ms": 0.3, "load_throughput": 1198182.384, "learn_time_ms": 9.671, "learn_throughput": 37224.063, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 5181720, "num_env_steps_trained": 5181720, "num_agent_steps_sampled": 5181720, "num_agent_steps_trained": 5181720}, "done": false, "episodes_total": 1483, "training_iteration": 668, "trial_id": "36440_00000", "date": "2023-07-25_03-04-04", "timestamp": 1690243444, "time_this_iter_s": 10.97215485572815, "time_total_s": 11157.253772974014, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1088.1399540901184, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 24.813333333333336, "ram_util_percent": 77.21333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.19921569824218, "policy_loss": -67248.1296875, "vf_loss": 15664819.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1483.0, "diff_num_grad_updates_vs_sampler_policy": 1482.0}}, "num_env_steps_sampled": 5182800, "num_env_steps_trained": 5182800, "num_agent_steps_sampled": 5182800, "num_agent_steps_trained": 5182800}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2712.4189934239325, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537849793472008, "mean_inference_ms": 0.4058775084296197, "mean_action_processing_ms": 0.09644801739919341, "mean_env_wait_ms": 2.170957938644006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004277944564819336, "StateBufferConnector_ms": 0.00299072265625, "ViewRequirementAgentConnector_ms": 0.07418060302734375}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2712.4189934239325, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2737.231952312799, -2759.001028965898, -2625.0832429943043, -2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537849793472008, "mean_inference_ms": 0.4058775084296197, "mean_action_processing_ms": 0.09644801739919341, "mean_env_wait_ms": 2.170957938644006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004277944564819336, "StateBufferConnector_ms": 0.00299072265625, "ViewRequirementAgentConnector_ms": 0.07418060302734375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5182800, "num_agent_steps_trained": 5182800, "num_env_steps_sampled": 5182800, "num_env_steps_trained": 5182800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.5273459088029, "num_env_steps_trained_throughput_per_sec": 96.5273459088029, "timesteps_total": 5182800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5182800, "timers": {"training_iteration_time_ms": 3716.115, "sample_time_ms": 3705.451, "load_time_ms": 0.3, "load_throughput": 1200373.193, "learn_time_ms": 9.616, "learn_throughput": 37435.773, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 5182800, "num_env_steps_trained": 5182800, "num_agent_steps_sampled": 5182800, "num_agent_steps_trained": 5182800}, "done": false, "episodes_total": 1486, "training_iteration": 669, "trial_id": "36440_00000", "date": "2023-07-25_03-04-15", "timestamp": 1690243455, "time_this_iter_s": 11.191277980804443, "time_total_s": 11168.445050954819, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1099.3312320709229, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 21.6625, "ram_util_percent": 77.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.54774780273438, "policy_loss": -63628.28203125, "vf_loss": 15984897.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1498.0, "diff_num_grad_updates_vs_sampler_policy": 1497.0}}, "num_env_steps_sampled": 5183880, "num_env_steps_trained": 5183880, "num_agent_steps_sampled": 5183880, "num_agent_steps_trained": 5183880}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2711.8692121507734, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537671545282422, "mean_inference_ms": 0.4058824540762273, "mean_action_processing_ms": 0.0964480466662543, "mean_env_wait_ms": 2.1720788700671663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004282474517822266, "StateBufferConnector_ms": 0.0029878616333007812, "ViewRequirementAgentConnector_ms": 0.07417964935302734}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2711.8692121507734, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2766.220600253317, -2638.75788167653, -2660.1393738158326, -2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537671545282422, "mean_inference_ms": 0.4058824540762273, "mean_action_processing_ms": 0.0964480466662543, "mean_env_wait_ms": 2.1720788700671663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004282474517822266, "StateBufferConnector_ms": 0.0029878616333007812, "ViewRequirementAgentConnector_ms": 0.07417964935302734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5183880, "num_agent_steps_trained": 5183880, "num_env_steps_sampled": 5183880, "num_env_steps_trained": 5183880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.53589727622837, "num_env_steps_trained_throughput_per_sec": 96.53589727622837, "timesteps_total": 5183880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5183880, "timers": {"training_iteration_time_ms": 3720.885, "sample_time_ms": 3709.963, "load_time_ms": 0.3, "load_throughput": 1199610.265, "learn_time_ms": 9.87, "learn_throughput": 36475.028, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 5183880, "num_env_steps_trained": 5183880, "num_agent_steps_sampled": 5183880, "num_agent_steps_trained": 5183880}, "done": false, "episodes_total": 1489, "training_iteration": 670, "trial_id": "36440_00000", "date": "2023-07-25_03-04-26", "timestamp": 1690243466, "time_this_iter_s": 11.190319061279297, "time_total_s": 11179.635370016098, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1110.5215511322021, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 23.7625, "ram_util_percent": 77.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.39963989257812, "policy_loss": -69757.4484375, "vf_loss": 16458043.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1513.0, "diff_num_grad_updates_vs_sampler_policy": 1512.0}}, "num_env_steps_sampled": 5184960, "num_env_steps_trained": 5184960, "num_agent_steps_sampled": 5184960, "num_agent_steps_trained": 5184960}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2712.237142175045, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537403317131215, "mean_inference_ms": 0.40588760491500847, "mean_action_processing_ms": 0.09644819227631043, "mean_env_wait_ms": 2.173166752980087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00426936149597168, "StateBufferConnector_ms": 0.002980470657348633, "ViewRequirementAgentConnector_ms": 0.07395434379577637}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2712.237142175045, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2725.9729320664555, -2660.8398341463676, -2680.8942351191085, -2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537403317131215, "mean_inference_ms": 0.40588760491500847, "mean_action_processing_ms": 0.09644819227631043, "mean_env_wait_ms": 2.173166752980087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00426936149597168, "StateBufferConnector_ms": 0.002980470657348633, "ViewRequirementAgentConnector_ms": 0.07395434379577637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5184960, "num_agent_steps_trained": 5184960, "num_env_steps_sampled": 5184960, "num_env_steps_trained": 5184960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 98.80854326834661, "num_env_steps_trained_throughput_per_sec": 98.80854326834661, "timesteps_total": 5184960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5184960, "timers": {"training_iteration_time_ms": 3699.811, "sample_time_ms": 3688.967, "load_time_ms": 0.298, "load_throughput": 1208442.929, "learn_time_ms": 9.785, "learn_throughput": 36792.051, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 5184960, "num_env_steps_trained": 5184960, "num_agent_steps_sampled": 5184960, "num_agent_steps_trained": 5184960}, "done": false, "episodes_total": 1492, "training_iteration": 671, "trial_id": "36440_00000", "date": "2023-07-25_03-04-37", "timestamp": 1690243477, "time_this_iter_s": 10.93301510810852, "time_total_s": 11190.568385124207, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1121.4545662403107, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 26.5, "ram_util_percent": 77.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.86881713867187, "policy_loss": -75983.103125, "vf_loss": 16124254.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1528.0, "diff_num_grad_updates_vs_sampler_policy": 1527.0}}, "num_env_steps_sampled": 5186040, "num_env_steps_trained": 5186040, "num_agent_steps_sampled": 5186040, "num_agent_steps_trained": 5186040}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2713.3285370895965, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537153506111617, "mean_inference_ms": 0.40589232466759695, "mean_action_processing_ms": 0.09644852810104323, "mean_env_wait_ms": 2.1742267215475937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004239320755004883, "StateBufferConnector_ms": 0.0029647350311279297, "ViewRequirementAgentConnector_ms": 0.07322835922241211}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2713.3285370895965, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2720.130942869919, -2631.946265045655, -2696.975503577027, -2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537153506111617, "mean_inference_ms": 0.40589232466759695, "mean_action_processing_ms": 0.09644852810104323, "mean_env_wait_ms": 2.1742267215475937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004239320755004883, "StateBufferConnector_ms": 0.0029647350311279297, "ViewRequirementAgentConnector_ms": 0.07322835922241211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5186040, "num_agent_steps_trained": 5186040, "num_env_steps_sampled": 5186040, "num_env_steps_trained": 5186040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.0291148119163, "num_env_steps_trained_throughput_per_sec": 95.0291148119163, "timesteps_total": 5186040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5186040, "timers": {"training_iteration_time_ms": 3724.935, "sample_time_ms": 3714.11, "load_time_ms": 0.3, "load_throughput": 1201615.025, "learn_time_ms": 9.781, "learn_throughput": 36805.413, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 5186040, "num_env_steps_trained": 5186040, "num_agent_steps_sampled": 5186040, "num_agent_steps_trained": 5186040}, "done": false, "episodes_total": 1495, "training_iteration": 672, "trial_id": "36440_00000", "date": "2023-07-25_03-04-48", "timestamp": 1690243488, "time_this_iter_s": 11.367858171463013, "time_total_s": 11201.93624329567, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1132.8224244117737, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 23.15, "ram_util_percent": 77.38749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.75785675048829, "policy_loss": -68575.95390625, "vf_loss": 16083274.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1543.0, "diff_num_grad_updates_vs_sampler_policy": 1542.0}}, "num_env_steps_sampled": 5187120, "num_env_steps_trained": 5187120, "num_agent_steps_sampled": 5187120, "num_agent_steps_trained": 5187120}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2713.920180059761, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.536842665714613, "mean_inference_ms": 0.4058958899538242, "mean_action_processing_ms": 0.09644867075644874, "mean_env_wait_ms": 2.175249550901157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004252433776855469, "StateBufferConnector_ms": 0.002970457077026367, "ViewRequirementAgentConnector_ms": 0.07343029975891113}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2713.920180059761, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2708.5383809724913, -2704.9858144432164, -2631.000306397498, -2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.536842665714613, "mean_inference_ms": 0.4058958899538242, "mean_action_processing_ms": 0.09644867075644874, "mean_env_wait_ms": 2.175249550901157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004252433776855469, "StateBufferConnector_ms": 0.002970457077026367, "ViewRequirementAgentConnector_ms": 0.07343029975891113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5187120, "num_agent_steps_trained": 5187120, "num_env_steps_sampled": 5187120, "num_env_steps_trained": 5187120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.23936401866783, "num_env_steps_trained_throughput_per_sec": 97.23936401866783, "timesteps_total": 5187120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5187120, "timers": {"training_iteration_time_ms": 3704.483, "sample_time_ms": 3693.674, "load_time_ms": 0.298, "load_throughput": 1209313.984, "learn_time_ms": 9.763, "learn_throughput": 36873.723, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 5187120, "num_env_steps_trained": 5187120, "num_agent_steps_sampled": 5187120, "num_agent_steps_trained": 5187120}, "done": false, "episodes_total": 1498, "training_iteration": 673, "trial_id": "36440_00000", "date": "2023-07-25_03-05-00", "timestamp": 1690243500, "time_this_iter_s": 11.109292030334473, "time_total_s": 11213.045535326004, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1143.9317164421082, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 23.39375, "ram_util_percent": 77.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.17958526611328, "policy_loss": -65180.21015625, "vf_loss": 15933313.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1558.0, "diff_num_grad_updates_vs_sampler_policy": 1557.0}}, "num_env_steps_sampled": 5188200, "num_env_steps_trained": 5188200, "num_agent_steps_sampled": 5188200, "num_agent_steps_trained": 5188200}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2714.8022618832697, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.536474010866731, "mean_inference_ms": 0.4059021317273412, "mean_action_processing_ms": 0.09644934233690602, "mean_env_wait_ms": 2.1762547061953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248142242431641, "StateBufferConnector_ms": 0.0029773712158203125, "ViewRequirementAgentConnector_ms": 0.07342100143432617}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2714.8022618832697, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2730.904874333215, -2648.4190492428074, -2738.16277477911, -2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.536474010866731, "mean_inference_ms": 0.4059021317273412, "mean_action_processing_ms": 0.09644934233690602, "mean_env_wait_ms": 2.1762547061953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248142242431641, "StateBufferConnector_ms": 0.0029773712158203125, "ViewRequirementAgentConnector_ms": 0.07342100143432617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5188200, "num_agent_steps_trained": 5188200, "num_env_steps_sampled": 5188200, "num_env_steps_trained": 5188200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 98.13360573072654, "num_env_steps_trained_throughput_per_sec": 98.13360573072654, "timesteps_total": 5188200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5188200, "timers": {"training_iteration_time_ms": 3705.964, "sample_time_ms": 3695.319, "load_time_ms": 0.301, "load_throughput": 1196189.052, "learn_time_ms": 9.596, "learn_throughput": 37517.534, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 5188200, "num_env_steps_trained": 5188200, "num_agent_steps_sampled": 5188200, "num_agent_steps_trained": 5188200}, "done": false, "episodes_total": 1501, "training_iteration": 674, "trial_id": "36440_00000", "date": "2023-07-25_03-05-11", "timestamp": 1690243511, "time_this_iter_s": 11.008322954177856, "time_total_s": 11224.053858280182, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1154.940039396286, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 23.660000000000004, "ram_util_percent": 77.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.28973236083985, "policy_loss": -64160.3828125, "vf_loss": 15551068.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1573.0, "diff_num_grad_updates_vs_sampler_policy": 1572.0}}, "num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2714.1549991008137, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.536150357290027, "mean_inference_ms": 0.40590583737639996, "mean_action_processing_ms": 0.0964497325266805, "mean_env_wait_ms": 2.1772424952241467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042438507080078125, "StateBufferConnector_ms": 0.0029828548431396484, "ViewRequirementAgentConnector_ms": 0.07333707809448242}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2714.1549991008137, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2718.8965065341954, -2758.720006659068, -2704.6413336254373, -2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.536150357290027, "mean_inference_ms": 0.40590583737639996, "mean_action_processing_ms": 0.0964497325266805, "mean_env_wait_ms": 2.1772424952241467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042438507080078125, "StateBufferConnector_ms": 0.0029828548431396484, "ViewRequirementAgentConnector_ms": 0.07333707809448242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280, "num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.54787509597293, "num_env_steps_trained_throughput_per_sec": 95.54787509597293, "timesteps_total": 5189280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5189280, "timers": {"training_iteration_time_ms": 3711.749, "sample_time_ms": 3701.07, "load_time_ms": 0.3, "load_throughput": 1199705.578, "learn_time_ms": 9.624, "learn_throughput": 37404.892, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280}, "done": false, "episodes_total": 1504, "training_iteration": 675, "trial_id": "36440_00000", "date": "2023-07-25_03-05-22", "timestamp": 1690243522, "time_this_iter_s": 11.305989980697632, "time_total_s": 11235.35984826088, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1166.2460293769836, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 23.075000000000003, "ram_util_percent": 77.68125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.68367309570313, "policy_loss": -68646.06328125, "vf_loss": 16145518.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1588.0, "diff_num_grad_updates_vs_sampler_policy": 1587.0}}, "num_env_steps_sampled": 5190360, "num_env_steps_trained": 5190360, "num_agent_steps_sampled": 5190360, "num_agent_steps_trained": 5190360}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2713.867497459345, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535829718586386, "mean_inference_ms": 0.40591254631918017, "mean_action_processing_ms": 0.09645073407576855, "mean_env_wait_ms": 2.1781882112676114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004258871078491211, "StateBufferConnector_ms": 0.0029859542846679688, "ViewRequirementAgentConnector_ms": 0.07345008850097656}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2713.867497459345, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2693.168093857254, -2631.556516556, -2739.602423759919, -2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535829718586386, "mean_inference_ms": 0.40591254631918017, "mean_action_processing_ms": 0.09645073407576855, "mean_env_wait_ms": 2.1781882112676114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004258871078491211, "StateBufferConnector_ms": 0.0029859542846679688, "ViewRequirementAgentConnector_ms": 0.07345008850097656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5190360, "num_agent_steps_trained": 5190360, "num_env_steps_sampled": 5190360, "num_env_steps_trained": 5190360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.78457252679415, "num_env_steps_trained_throughput_per_sec": 96.78457252679415, "timesteps_total": 5190360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5190360, "timers": {"training_iteration_time_ms": 3714.209, "sample_time_ms": 3703.46, "load_time_ms": 0.3, "load_throughput": 1198657.966, "learn_time_ms": 9.68, "learn_throughput": 37191.789, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 5190360, "num_env_steps_trained": 5190360, "num_agent_steps_sampled": 5190360, "num_agent_steps_trained": 5190360}, "done": false, "episodes_total": 1507, "training_iteration": 676, "trial_id": "36440_00000", "date": "2023-07-25_03-05-33", "timestamp": 1690243533, "time_this_iter_s": 11.161598205566406, "time_total_s": 11246.521446466446, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1177.40762758255, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 26.23125, "ram_util_percent": 78.11875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.27316741943359, "policy_loss": -67513.31796875, "vf_loss": 16025958.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1603.0, "diff_num_grad_updates_vs_sampler_policy": 1602.0}}, "num_env_steps_sampled": 5191440, "num_env_steps_trained": 5191440, "num_agent_steps_sampled": 5191440, "num_agent_steps_trained": 5191440}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2714.579434476372, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535507967723018, "mean_inference_ms": 0.4059189841221659, "mean_action_processing_ms": 0.09645172261427847, "mean_env_wait_ms": 2.179130863281567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004256010055541992, "StateBufferConnector_ms": 0.002978801727294922, "ViewRequirementAgentConnector_ms": 0.0735008716583252}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2714.579434476372, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2750.1254416226634, -2755.476963239541, -2716.3791403767846, -2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535507967723018, "mean_inference_ms": 0.4059189841221659, "mean_action_processing_ms": 0.09645172261427847, "mean_env_wait_ms": 2.179130863281567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004256010055541992, "StateBufferConnector_ms": 0.002978801727294922, "ViewRequirementAgentConnector_ms": 0.0735008716583252}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5191440, "num_agent_steps_trained": 5191440, "num_env_steps_sampled": 5191440, "num_env_steps_trained": 5191440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.20506560629984, "num_env_steps_trained_throughput_per_sec": 96.20506560629984, "timesteps_total": 5191440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5191440, "timers": {"training_iteration_time_ms": 3745.965, "sample_time_ms": 3735.339, "load_time_ms": 0.297, "load_throughput": 1211059.865, "learn_time_ms": 9.571, "learn_throughput": 37615.202, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 5191440, "num_env_steps_trained": 5191440, "num_agent_steps_sampled": 5191440, "num_agent_steps_trained": 5191440}, "done": false, "episodes_total": 1510, "training_iteration": 677, "trial_id": "36440_00000", "date": "2023-07-25_03-05-44", "timestamp": 1690243544, "time_this_iter_s": 11.228830814361572, "time_total_s": 11257.750277280807, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1188.6364583969116, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 21.9375, "ram_util_percent": 78.05625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.55589904785157, "policy_loss": -66172.096875, "vf_loss": 16273891.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1618.0, "diff_num_grad_updates_vs_sampler_policy": 1617.0}}, "num_env_steps_sampled": 5192520, "num_env_steps_trained": 5192520, "num_agent_steps_sampled": 5192520, "num_agent_steps_trained": 5192520}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2714.2795727841235, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535188379323614, "mean_inference_ms": 0.40597940872401567, "mean_action_processing_ms": 0.0964526673491208, "mean_env_wait_ms": 2.180071348749178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263162612915039, "StateBufferConnector_ms": 0.0029823780059814453, "ViewRequirementAgentConnector_ms": 0.07343077659606934}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2714.2795727841235, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2712.2131730855485, -2698.1121034149573, -2693.4808475246227, -2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535188379323614, "mean_inference_ms": 0.40597940872401567, "mean_action_processing_ms": 0.0964526673491208, "mean_env_wait_ms": 2.180071348749178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263162612915039, "StateBufferConnector_ms": 0.0029823780059814453, "ViewRequirementAgentConnector_ms": 0.07343077659606934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5192520, "num_agent_steps_trained": 5192520, "num_env_steps_sampled": 5192520, "num_env_steps_trained": 5192520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 93.76588771790303, "num_env_steps_trained_throughput_per_sec": 93.76588771790303, "timesteps_total": 5192520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5192520, "timers": {"training_iteration_time_ms": 3773.408, "sample_time_ms": 3762.691, "load_time_ms": 0.303, "load_throughput": 1186787.267, "learn_time_ms": 9.648, "learn_throughput": 37314.673, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 5192520, "num_env_steps_trained": 5192520, "num_agent_steps_sampled": 5192520, "num_agent_steps_trained": 5192520}, "done": false, "episodes_total": 1513, "training_iteration": 678, "trial_id": "36440_00000", "date": "2023-07-25_03-05-56", "timestamp": 1690243556, "time_this_iter_s": 11.521163940429688, "time_total_s": 11269.271441221237, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1200.1576223373413, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 25.11875, "ram_util_percent": 77.23124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.78706359863281, "policy_loss": -69721.5703125, "vf_loss": 17063232.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1633.0, "diff_num_grad_updates_vs_sampler_policy": 1632.0}}, "num_env_steps_sampled": 5193600, "num_env_steps_trained": 5193600, "num_agent_steps_sampled": 5193600, "num_agent_steps_trained": 5193600}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2715.670905678225, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534818507408969, "mean_inference_ms": 0.4060372857520775, "mean_action_processing_ms": 0.09645321804908816, "mean_env_wait_ms": 2.181013842196396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042819976806640625, "StateBufferConnector_ms": 0.0029892921447753906, "ViewRequirementAgentConnector_ms": 0.07349801063537598}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2715.670905678225, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2807.661404231508, -2705.0780770640254, -2679.7554391925464, -2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534818507408969, "mean_inference_ms": 0.4060372857520775, "mean_action_processing_ms": 0.09645321804908816, "mean_env_wait_ms": 2.181013842196396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042819976806640625, "StateBufferConnector_ms": 0.0029892921447753906, "ViewRequirementAgentConnector_ms": 0.07349801063537598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5193600, "num_agent_steps_trained": 5193600, "num_env_steps_sampled": 5193600, "num_env_steps_trained": 5193600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.2894283442589, "num_env_steps_trained_throughput_per_sec": 97.2894283442589, "timesteps_total": 5193600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5193600, "timers": {"training_iteration_time_ms": 3759.047, "sample_time_ms": 3748.284, "load_time_ms": 0.305, "load_throughput": 1180385.741, "learn_time_ms": 9.674, "learn_throughput": 37211.954, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 5193600, "num_env_steps_trained": 5193600, "num_agent_steps_sampled": 5193600, "num_agent_steps_trained": 5193600}, "done": false, "episodes_total": 1516, "training_iteration": 679, "trial_id": "36440_00000", "date": "2023-07-25_03-06-07", "timestamp": 1690243567, "time_this_iter_s": 11.103740930557251, "time_total_s": 11280.375182151794, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1211.2613632678986, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 26.1375, "ram_util_percent": 77.36250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.86934814453124, "policy_loss": -74086.015625, "vf_loss": 15632271.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1648.0, "diff_num_grad_updates_vs_sampler_policy": 1647.0}}, "num_env_steps_sampled": 5194680, "num_env_steps_trained": 5194680, "num_agent_steps_sampled": 5194680, "num_agent_steps_trained": 5194680}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2715.551139165769, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534454301646231, "mean_inference_ms": 0.4060934524894472, "mean_action_processing_ms": 0.09645342840316368, "mean_env_wait_ms": 2.181952793668891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00428009033203125, "StateBufferConnector_ms": 0.0029816627502441406, "ViewRequirementAgentConnector_ms": 0.07352566719055176}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2715.551139165769, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2677.486202768219, -2725.95362040977, -2687.890893837454, -2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534454301646231, "mean_inference_ms": 0.4060934524894472, "mean_action_processing_ms": 0.09645342840316368, "mean_env_wait_ms": 2.181952793668891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00428009033203125, "StateBufferConnector_ms": 0.0029816627502441406, "ViewRequirementAgentConnector_ms": 0.07352566719055176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5194680, "num_agent_steps_trained": 5194680, "num_env_steps_sampled": 5194680, "num_env_steps_trained": 5194680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.8484009013232, "num_env_steps_trained_throughput_per_sec": 96.8484009013232, "timesteps_total": 5194680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5194680, "timers": {"training_iteration_time_ms": 3762.657, "sample_time_ms": 3751.969, "load_time_ms": 0.305, "load_throughput": 1180293.473, "learn_time_ms": 9.613, "learn_throughput": 37448.957, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 5194680, "num_env_steps_trained": 5194680, "num_agent_steps_sampled": 5194680, "num_agent_steps_trained": 5194680}, "done": false, "episodes_total": 1519, "training_iteration": 680, "trial_id": "36440_00000", "date": "2023-07-25_03-06-18", "timestamp": 1690243578, "time_this_iter_s": 11.154370069503784, "time_total_s": 11291.529552221298, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1222.4157333374023, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 24.71875, "ram_util_percent": 77.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.18478851318359, "policy_loss": -66538.58515625, "vf_loss": 16012709.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1663.0, "diff_num_grad_updates_vs_sampler_policy": 1662.0}}, "num_env_steps_sampled": 5195760, "num_env_steps_trained": 5195760, "num_agent_steps_sampled": 5195760, "num_agent_steps_trained": 5195760}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2716.234511823589, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534122019136148, "mean_inference_ms": 0.40614781410595013, "mean_action_processing_ms": 0.09645334167417097, "mean_env_wait_ms": 2.182873714892365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004264354705810547, "StateBufferConnector_ms": 0.0029785633087158203, "ViewRequirementAgentConnector_ms": 0.0732583999633789}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2716.234511823589, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2725.1560568552536, -2662.0186639515896, -2737.212247192077, -2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534122019136148, "mean_inference_ms": 0.40614781410595013, "mean_action_processing_ms": 0.09645334167417097, "mean_env_wait_ms": 2.182873714892365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004264354705810547, "StateBufferConnector_ms": 0.0029785633087158203, "ViewRequirementAgentConnector_ms": 0.0732583999633789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5195760, "num_agent_steps_trained": 5195760, "num_env_steps_sampled": 5195760, "num_env_steps_trained": 5195760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.98391179490861, "num_env_steps_trained_throughput_per_sec": 95.98391179490861, "timesteps_total": 5195760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5195760, "timers": {"training_iteration_time_ms": 3729.8, "sample_time_ms": 3719.108, "load_time_ms": 0.298, "load_throughput": 1206415.34, "learn_time_ms": 9.622, "learn_throughput": 37413.696, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 5195760, "num_env_steps_trained": 5195760, "num_agent_steps_sampled": 5195760, "num_agent_steps_trained": 5195760}, "done": false, "episodes_total": 1522, "training_iteration": 681, "trial_id": "36440_00000", "date": "2023-07-25_03-06-30", "timestamp": 1690243590, "time_this_iter_s": 11.254660844802856, "time_total_s": 11302.784213066101, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1233.6703941822052, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 23.99375, "ram_util_percent": 77.29375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.16131896972657, "policy_loss": -74332.81796875, "vf_loss": 16667951.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1678.0, "diff_num_grad_updates_vs_sampler_policy": 1677.0}}, "num_env_steps_sampled": 5196840, "num_env_steps_trained": 5196840, "num_agent_steps_sampled": 5196840, "num_agent_steps_trained": 5196840}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2716.800551711178, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533776911125443, "mean_inference_ms": 0.4062034350967697, "mean_action_processing_ms": 0.09645331627403289, "mean_env_wait_ms": 2.183771612961092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004264116287231445, "StateBufferConnector_ms": 0.0029785633087158203, "ViewRequirementAgentConnector_ms": 0.07335066795349121}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2716.800551711178, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2710.877985449531, -2694.544263249996, -2723.9419340097256, -2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533776911125443, "mean_inference_ms": 0.4062034350967697, "mean_action_processing_ms": 0.09645331627403289, "mean_env_wait_ms": 2.183771612961092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004264116287231445, "StateBufferConnector_ms": 0.0029785633087158203, "ViewRequirementAgentConnector_ms": 0.07335066795349121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5196840, "num_agent_steps_trained": 5196840, "num_env_steps_sampled": 5196840, "num_env_steps_trained": 5196840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.80958812039472, "num_env_steps_trained_throughput_per_sec": 96.80958812039472, "timesteps_total": 5196840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5196840, "timers": {"training_iteration_time_ms": 3719.013, "sample_time_ms": 3708.375, "load_time_ms": 0.297, "load_throughput": 1213590.612, "learn_time_ms": 9.591, "learn_throughput": 37536.934, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 5196840, "num_env_steps_trained": 5196840, "num_agent_steps_sampled": 5196840, "num_agent_steps_trained": 5196840}, "done": false, "episodes_total": 1525, "training_iteration": 682, "trial_id": "36440_00000", "date": "2023-07-25_03-06-41", "timestamp": 1690243601, "time_this_iter_s": 11.15879201889038, "time_total_s": 11313.943005084991, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1244.8291862010956, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 24.175, "ram_util_percent": 77.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.09927825927734, "policy_loss": -67695.51875, "vf_loss": 16543896.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1693.0, "diff_num_grad_updates_vs_sampler_policy": 1692.0}}, "num_env_steps_sampled": 5197920, "num_env_steps_trained": 5197920, "num_agent_steps_sampled": 5197920, "num_agent_steps_trained": 5197920}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2717.8858795801148, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533459735485853, "mean_inference_ms": 0.40625959936087347, "mean_action_processing_ms": 0.09645337852449183, "mean_env_wait_ms": 2.184647509402405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004288196563720703, "StateBufferConnector_ms": 0.002989530563354492, "ViewRequirementAgentConnector_ms": 0.0735926628112793}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2907.9795591968673, "episode_reward_mean": -2717.8858795801148, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2651.8518498493913, -2744.712593292086, -2907.9795591968673, -2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533459735485853, "mean_inference_ms": 0.40625959936087347, "mean_action_processing_ms": 0.09645337852449183, "mean_env_wait_ms": 2.184647509402405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004288196563720703, "StateBufferConnector_ms": 0.002989530563354492, "ViewRequirementAgentConnector_ms": 0.0735926628112793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5197920, "num_agent_steps_trained": 5197920, "num_env_steps_sampled": 5197920, "num_env_steps_trained": 5197920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.53445450530687, "num_env_steps_trained_throughput_per_sec": 95.53445450530687, "timesteps_total": 5197920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5197920, "timers": {"training_iteration_time_ms": 3727.139, "sample_time_ms": 3716.481, "load_time_ms": 0.297, "load_throughput": 1213005.656, "learn_time_ms": 9.622, "learn_throughput": 37416.014, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 5197920, "num_env_steps_trained": 5197920, "num_agent_steps_sampled": 5197920, "num_agent_steps_trained": 5197920}, "done": false, "episodes_total": 1528, "training_iteration": 683, "trial_id": "36440_00000", "date": "2023-07-25_03-06-52", "timestamp": 1690243612, "time_this_iter_s": 11.307551383972168, "time_total_s": 11325.250556468964, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1256.1367375850677, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 22.825, "ram_util_percent": 77.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.20777740478516, "policy_loss": -69801.05859375, "vf_loss": 15719989.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1708.0, "diff_num_grad_updates_vs_sampler_policy": 1707.0}}, "num_env_steps_sampled": 5199000, "num_env_steps_trained": 5199000, "num_agent_steps_sampled": 5199000, "num_agent_steps_trained": 5199000}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2715.865547785189, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533164240291135, "mean_inference_ms": 0.4063128343492099, "mean_action_processing_ms": 0.09645313121726268, "mean_env_wait_ms": 2.185489790410432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042803287506103516, "StateBufferConnector_ms": 0.0029854774475097656, "ViewRequirementAgentConnector_ms": 0.07352137565612793}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2715.865547785189, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2717.924934618319, -2750.0209192938873, -2696.123975879039, -2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533164240291135, "mean_inference_ms": 0.4063128343492099, "mean_action_processing_ms": 0.09645313121726268, "mean_env_wait_ms": 2.185489790410432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042803287506103516, "StateBufferConnector_ms": 0.0029854774475097656, "ViewRequirementAgentConnector_ms": 0.07352137565612793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5199000, "num_agent_steps_trained": 5199000, "num_env_steps_sampled": 5199000, "num_env_steps_trained": 5199000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.72646234862576, "num_env_steps_trained_throughput_per_sec": 96.72646234862576, "timesteps_total": 5199000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5199000, "timers": {"training_iteration_time_ms": 3726.039, "sample_time_ms": 3715.357, "load_time_ms": 0.297, "load_throughput": 1213298.063, "learn_time_ms": 9.633, "learn_throughput": 37373.228, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 5199000, "num_env_steps_trained": 5199000, "num_agent_steps_sampled": 5199000, "num_agent_steps_trained": 5199000}, "done": false, "episodes_total": 1531, "training_iteration": 684, "trial_id": "36440_00000", "date": "2023-07-25_03-07-03", "timestamp": 1690243623, "time_this_iter_s": 11.16824197769165, "time_total_s": 11336.418798446655, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1267.3049795627594, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 24.043750000000003, "ram_util_percent": 77.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.48785552978515, "policy_loss": -70438.696875, "vf_loss": 17098541.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1723.0, "diff_num_grad_updates_vs_sampler_policy": 1722.0}}, "num_env_steps_sampled": 5200080, "num_env_steps_trained": 5200080, "num_agent_steps_sampled": 5200080, "num_agent_steps_trained": 5200080}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2716.4094776345473, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532902044700264, "mean_inference_ms": 0.40636430156406766, "mean_action_processing_ms": 0.09645277215714751, "mean_env_wait_ms": 2.1863131587060654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004282474517822266, "StateBufferConnector_ms": 0.002989053726196289, "ViewRequirementAgentConnector_ms": 0.0735769271850586}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2716.4094776345473, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2694.636120651799, -2695.4281578417126, -2724.6753159757995, -2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532902044700264, "mean_inference_ms": 0.40636430156406766, "mean_action_processing_ms": 0.09645277215714751, "mean_env_wait_ms": 2.1863131587060654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004282474517822266, "StateBufferConnector_ms": 0.002989053726196289, "ViewRequirementAgentConnector_ms": 0.0735769271850586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5200080, "num_agent_steps_trained": 5200080, "num_env_steps_sampled": 5200080, "num_env_steps_trained": 5200080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.1841865269598, "num_env_steps_trained_throughput_per_sec": 96.1841865269598, "timesteps_total": 5200080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5200080, "timers": {"training_iteration_time_ms": 3740.426, "sample_time_ms": 3729.806, "load_time_ms": 0.296, "load_throughput": 1215348.873, "learn_time_ms": 9.59, "learn_throughput": 37540.667, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 5200080, "num_env_steps_trained": 5200080, "num_agent_steps_sampled": 5200080, "num_agent_steps_trained": 5200080}, "done": false, "episodes_total": 1534, "training_iteration": 685, "trial_id": "36440_00000", "date": "2023-07-25_03-07-14", "timestamp": 1690243634, "time_this_iter_s": 11.231283903121948, "time_total_s": 11347.650082349777, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1278.5362634658813, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 22.0375, "ram_util_percent": 77.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.52021026611328, "policy_loss": -68964.60859375, "vf_loss": 16387637.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1738.0, "diff_num_grad_updates_vs_sampler_policy": 1737.0}}, "num_env_steps_sampled": 5201160, "num_env_steps_trained": 5201160, "num_agent_steps_sampled": 5201160, "num_agent_steps_trained": 5201160}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2717.0919376887005, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532607191223819, "mean_inference_ms": 0.4064133345169783, "mean_action_processing_ms": 0.09645224720451497, "mean_env_wait_ms": 2.1871151581399184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004273653030395508, "StateBufferConnector_ms": 0.0029783248901367188, "ViewRequirementAgentConnector_ms": 0.07323455810546875}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2717.0919376887005, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2719.9253462878214, -2655.9093723019687, -2753.3618326464416, -2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532607191223819, "mean_inference_ms": 0.4064133345169783, "mean_action_processing_ms": 0.09645224720451497, "mean_env_wait_ms": 2.1871151581399184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004273653030395508, "StateBufferConnector_ms": 0.0029783248901367188, "ViewRequirementAgentConnector_ms": 0.07323455810546875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5201160, "num_agent_steps_trained": 5201160, "num_env_steps_sampled": 5201160, "num_env_steps_trained": 5201160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.47516914444793, "num_env_steps_trained_throughput_per_sec": 97.47516914444793, "timesteps_total": 5201160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5201160, "timers": {"training_iteration_time_ms": 3734.411, "sample_time_ms": 3723.7, "load_time_ms": 0.297, "load_throughput": 1211545.727, "learn_time_ms": 9.676, "learn_throughput": 37206.819, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 5201160, "num_env_steps_trained": 5201160, "num_agent_steps_sampled": 5201160, "num_agent_steps_trained": 5201160}, "done": false, "episodes_total": 1537, "training_iteration": 686, "trial_id": "36440_00000", "date": "2023-07-25_03-07-26", "timestamp": 1690243646, "time_this_iter_s": 11.082552194595337, "time_total_s": 11358.732634544373, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1289.6188156604767, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 26.013333333333332, "ram_util_percent": 77.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.69913787841797, "policy_loss": -66373.51171875, "vf_loss": 15749312.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1753.0, "diff_num_grad_updates_vs_sampler_policy": 1752.0}}, "num_env_steps_sampled": 5202240, "num_env_steps_trained": 5202240, "num_agent_steps_sampled": 5202240, "num_agent_steps_trained": 5202240}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2716.4844149421115, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532243317476162, "mean_inference_ms": 0.4064622909993645, "mean_action_processing_ms": 0.09645178205529932, "mean_env_wait_ms": 2.1879006321623957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004273176193237305, "StateBufferConnector_ms": 0.0029828548431396484, "ViewRequirementAgentConnector_ms": 0.07325410842895508}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2716.4844149421115, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2696.361078575781, -2720.9117918083357, -2730.2977831785515, -2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532243317476162, "mean_inference_ms": 0.4064622909993645, "mean_action_processing_ms": 0.09645178205529932, "mean_env_wait_ms": 2.1879006321623957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004273176193237305, "StateBufferConnector_ms": 0.0029828548431396484, "ViewRequirementAgentConnector_ms": 0.07325410842895508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5202240, "num_agent_steps_trained": 5202240, "num_env_steps_sampled": 5202240, "num_env_steps_trained": 5202240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 98.07617296643504, "num_env_steps_trained_throughput_per_sec": 98.07617296643504, "timesteps_total": 5202240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5202240, "timers": {"training_iteration_time_ms": 3703.487, "sample_time_ms": 3692.757, "load_time_ms": 0.299, "load_throughput": 1205548.455, "learn_time_ms": 9.68, "learn_throughput": 37191.148, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 5202240, "num_env_steps_trained": 5202240, "num_agent_steps_sampled": 5202240, "num_agent_steps_trained": 5202240}, "done": false, "episodes_total": 1540, "training_iteration": 687, "trial_id": "36440_00000", "date": "2023-07-25_03-07-37", "timestamp": 1690243657, "time_this_iter_s": 11.014584064483643, "time_total_s": 11369.747218608856, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1300.6333997249603, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 23.81875, "ram_util_percent": 77.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.41896514892578, "policy_loss": -72299.15, "vf_loss": 16540180.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1768.0, "diff_num_grad_updates_vs_sampler_policy": 1767.0}}, "num_env_steps_sampled": 5203320, "num_env_steps_trained": 5203320, "num_agent_steps_sampled": 5203320, "num_agent_steps_trained": 5203320}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2715.4786246739745, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531878755517428, "mean_inference_ms": 0.4065099995684352, "mean_action_processing_ms": 0.09645118893911184, "mean_env_wait_ms": 2.188649920213092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270315170288086, "StateBufferConnector_ms": 0.002972126007080078, "ViewRequirementAgentConnector_ms": 0.07318878173828125}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2715.4786246739745, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2778.052444034543, -2732.6193685003254, -2715.537897525372, -2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531878755517428, "mean_inference_ms": 0.4065099995684352, "mean_action_processing_ms": 0.09645118893911184, "mean_env_wait_ms": 2.188649920213092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270315170288086, "StateBufferConnector_ms": 0.002972126007080078, "ViewRequirementAgentConnector_ms": 0.07318878173828125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5203320, "num_agent_steps_trained": 5203320, "num_env_steps_sampled": 5203320, "num_env_steps_trained": 5203320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.93772710910655, "num_env_steps_trained_throughput_per_sec": 96.93772710910655, "timesteps_total": 5203320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5203320, "timers": {"training_iteration_time_ms": 3706.667, "sample_time_ms": 3695.915, "load_time_ms": 0.3, "load_throughput": 1201328.22, "learn_time_ms": 9.699, "learn_throughput": 37116.731, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 5203320, "num_env_steps_trained": 5203320, "num_agent_steps_sampled": 5203320, "num_agent_steps_trained": 5203320}, "done": false, "episodes_total": 1543, "training_iteration": 688, "trial_id": "36440_00000", "date": "2023-07-25_03-07-48", "timestamp": 1690243668, "time_this_iter_s": 11.143937110900879, "time_total_s": 11380.891155719757, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1311.7773368358612, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 24.4, "ram_util_percent": 76.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.67829895019531, "policy_loss": -71226.0, "vf_loss": 16676971.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1783.0, "diff_num_grad_updates_vs_sampler_policy": 1782.0}}, "num_env_steps_sampled": 5204400, "num_env_steps_trained": 5204400, "num_agent_steps_sampled": 5204400, "num_agent_steps_trained": 5204400}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.6928002719187, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531507096086205, "mean_inference_ms": 0.4065564147748695, "mean_action_processing_ms": 0.09645042777597118, "mean_env_wait_ms": 2.189372245888282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004301309585571289, "StateBufferConnector_ms": 0.0029861927032470703, "ViewRequirementAgentConnector_ms": 0.07360291481018066}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.6928002719187, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2699.535989514589, -2679.3006377750075, -2616.916877269921, -2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531507096086205, "mean_inference_ms": 0.4065564147748695, "mean_action_processing_ms": 0.09645042777597118, "mean_env_wait_ms": 2.189372245888282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004301309585571289, "StateBufferConnector_ms": 0.0029861927032470703, "ViewRequirementAgentConnector_ms": 0.07360291481018066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5204400, "num_agent_steps_trained": 5204400, "num_env_steps_sampled": 5204400, "num_env_steps_trained": 5204400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.1773146571874, "num_env_steps_trained_throughput_per_sec": 97.1773146571874, "timesteps_total": 5204400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5204400, "timers": {"training_iteration_time_ms": 3703.235, "sample_time_ms": 3692.529, "load_time_ms": 0.301, "load_throughput": 1197232.35, "learn_time_ms": 9.648, "learn_throughput": 37312.46, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 5204400, "num_env_steps_trained": 5204400, "num_agent_steps_sampled": 5204400, "num_agent_steps_trained": 5204400}, "done": false, "episodes_total": 1546, "training_iteration": 689, "trial_id": "36440_00000", "date": "2023-07-25_03-07-59", "timestamp": 1690243679, "time_this_iter_s": 11.11647891998291, "time_total_s": 11392.00763463974, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1322.8938157558441, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 24.993333333333336, "ram_util_percent": 76.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.00880279541016, "policy_loss": -70244.3765625, "vf_loss": 16393341.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1798.0, "diff_num_grad_updates_vs_sampler_policy": 1797.0}}, "num_env_steps_sampled": 5205480, "num_env_steps_trained": 5205480, "num_agent_steps_sampled": 5205480, "num_agent_steps_trained": 5205480}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2716.0267420331033, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531146240455342, "mean_inference_ms": 0.4066050334797292, "mean_action_processing_ms": 0.09644989416320339, "mean_env_wait_ms": 2.1900877727176913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004289150238037109, "StateBufferConnector_ms": 0.002979755401611328, "ViewRequirementAgentConnector_ms": 0.07349348068237305}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2716.0267420331033, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2783.4051636272707, -2603.2451801561683, -2719.6873742361026, -2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531146240455342, "mean_inference_ms": 0.4066050334797292, "mean_action_processing_ms": 0.09644989416320339, "mean_env_wait_ms": 2.1900877727176913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004289150238037109, "StateBufferConnector_ms": 0.002979755401611328, "ViewRequirementAgentConnector_ms": 0.07349348068237305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5205480, "num_agent_steps_trained": 5205480, "num_env_steps_sampled": 5205480, "num_env_steps_trained": 5205480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.9139951695417, "num_env_steps_trained_throughput_per_sec": 95.9139951695417, "timesteps_total": 5205480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5205480, "timers": {"training_iteration_time_ms": 3719.398, "sample_time_ms": 3708.664, "load_time_ms": 0.298, "load_throughput": 1207476.561, "learn_time_ms": 9.687, "learn_throughput": 37163.138, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 5205480, "num_env_steps_trained": 5205480, "num_agent_steps_sampled": 5205480, "num_agent_steps_trained": 5205480}, "done": false, "episodes_total": 1549, "training_iteration": 690, "trial_id": "36440_00000", "date": "2023-07-25_03-08-10", "timestamp": 1690243690, "time_this_iter_s": 11.2628333568573, "time_total_s": 11403.270467996597, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1334.1566491127014, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 23.825000000000003, "ram_util_percent": 77.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.63341369628907, "policy_loss": -71333.68203125, "vf_loss": 15879336.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1813.0, "diff_num_grad_updates_vs_sampler_policy": 1812.0}}, "num_env_steps_sampled": 5206560, "num_env_steps_trained": 5206560, "num_agent_steps_sampled": 5206560, "num_agent_steps_trained": 5206560}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.7703361747535, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.530835828737644, "mean_inference_ms": 0.4066535570417083, "mean_action_processing_ms": 0.09644928876369298, "mean_env_wait_ms": 2.1907943804886454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004262447357177734, "StateBufferConnector_ms": 0.0029709339141845703, "ViewRequirementAgentConnector_ms": 0.07312440872192383}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.7703361747535, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2785.8969097857653, -2727.685701442284, -2703.2767299847546, -2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.530835828737644, "mean_inference_ms": 0.4066535570417083, "mean_action_processing_ms": 0.09644928876369298, "mean_env_wait_ms": 2.1907943804886454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004262447357177734, "StateBufferConnector_ms": 0.0029709339141845703, "ViewRequirementAgentConnector_ms": 0.07312440872192383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5206560, "num_agent_steps_trained": 5206560, "num_env_steps_sampled": 5206560, "num_env_steps_trained": 5206560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.60009609292118, "num_env_steps_trained_throughput_per_sec": 95.60009609292118, "timesteps_total": 5206560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5206560, "timers": {"training_iteration_time_ms": 3728.344, "sample_time_ms": 3717.702, "load_time_ms": 0.297, "load_throughput": 1212908.218, "learn_time_ms": 9.604, "learn_throughput": 37486.146, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 5206560, "num_env_steps_trained": 5206560, "num_agent_steps_sampled": 5206560, "num_agent_steps_trained": 5206560}, "done": false, "episodes_total": 1552, "training_iteration": 691, "trial_id": "36440_00000", "date": "2023-07-25_03-08-22", "timestamp": 1690243702, "time_this_iter_s": 11.299714803695679, "time_total_s": 11414.570182800293, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1345.456363916397, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 23.93125, "ram_util_percent": 77.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.61417388916016, "policy_loss": -65537.553125, "vf_loss": 15965771.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1828.0, "diff_num_grad_updates_vs_sampler_policy": 1827.0}}, "num_env_steps_sampled": 5207640, "num_env_steps_trained": 5207640, "num_agent_steps_sampled": 5207640, "num_agent_steps_trained": 5207640}, "sampler_results": {"episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.1478175304524, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5305318575440365, "mean_inference_ms": 0.4067017902259036, "mean_action_processing_ms": 0.09644877911638244, "mean_env_wait_ms": 2.1915093323649937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042438507080078125, "StateBufferConnector_ms": 0.0029706954956054688, "ViewRequirementAgentConnector_ms": 0.07290339469909668}}, "episode_reward_max": -2577.723135127108, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.1478175304524, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2702.1635939310663, -2577.723135127108, -2692.151556942366, -2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5305318575440365, "mean_inference_ms": 0.4067017902259036, "mean_action_processing_ms": 0.09644877911638244, "mean_env_wait_ms": 2.1915093323649937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042438507080078125, "StateBufferConnector_ms": 0.0029706954956054688, "ViewRequirementAgentConnector_ms": 0.07290339469909668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5207640, "num_agent_steps_trained": 5207640, "num_env_steps_sampled": 5207640, "num_env_steps_trained": 5207640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.24217228023421, "num_env_steps_trained_throughput_per_sec": 96.24217228023421, "timesteps_total": 5207640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5207640, "timers": {"training_iteration_time_ms": 3739.416, "sample_time_ms": 3728.512, "load_time_ms": 0.299, "load_throughput": 1204971.223, "learn_time_ms": 9.825, "learn_throughput": 36641.076, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 5207640, "num_env_steps_trained": 5207640, "num_agent_steps_sampled": 5207640, "num_agent_steps_trained": 5207640}, "done": false, "episodes_total": 1555, "training_iteration": 692, "trial_id": "36440_00000", "date": "2023-07-25_03-08-33", "timestamp": 1690243713, "time_this_iter_s": 11.224742889404297, "time_total_s": 11425.794925689697, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1356.6811068058014, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 23.1625, "ram_util_percent": 77.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 98.58834991455078, "policy_loss": -73321.6421875, "vf_loss": 17008661.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1843.0, "diff_num_grad_updates_vs_sampler_policy": 1842.0}}, "num_env_steps_sampled": 5208720, "num_env_steps_trained": 5208720, "num_agent_steps_sampled": 5208720, "num_agent_steps_trained": 5208720}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2715.9205931221218, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53028590843631, "mean_inference_ms": 0.4067498707386804, "mean_action_processing_ms": 0.09644823306302021, "mean_env_wait_ms": 2.192203275420553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004236698150634766, "StateBufferConnector_ms": 0.002959728240966797, "ViewRequirementAgentConnector_ms": 0.07293343544006348}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2715.9205931221218, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2757.424479442206, -2741.2569129276712, -2762.426244098466, -2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53028590843631, "mean_inference_ms": 0.4067498707386804, "mean_action_processing_ms": 0.09644823306302021, "mean_env_wait_ms": 2.192203275420553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004236698150634766, "StateBufferConnector_ms": 0.002959728240966797, "ViewRequirementAgentConnector_ms": 0.07293343544006348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5208720, "num_agent_steps_trained": 5208720, "num_env_steps_sampled": 5208720, "num_env_steps_trained": 5208720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.22645251365081, "num_env_steps_trained_throughput_per_sec": 96.22645251365081, "timesteps_total": 5208720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5208720, "timers": {"training_iteration_time_ms": 3743.982, "sample_time_ms": 3733.053, "load_time_ms": 0.299, "load_throughput": 1202284.768, "learn_time_ms": 9.836, "learn_throughput": 36600.487, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 5208720, "num_env_steps_trained": 5208720, "num_agent_steps_sampled": 5208720, "num_agent_steps_trained": 5208720}, "done": false, "episodes_total": 1558, "training_iteration": 693, "trial_id": "36440_00000", "date": "2023-07-25_03-08-44", "timestamp": 1690243724, "time_this_iter_s": 11.226721048355103, "time_total_s": 11437.021646738052, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1367.9078278541565, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 23.9125, "ram_util_percent": 77.35624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 102.37245330810546, "policy_loss": -69095.896875, "vf_loss": 15378583.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1858.0, "diff_num_grad_updates_vs_sampler_policy": 1857.0}}, "num_env_steps_sampled": 5209800, "num_env_steps_trained": 5209800, "num_agent_steps_sampled": 5209800, "num_agent_steps_trained": 5209800}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.847866357517, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.530068161851241, "mean_inference_ms": 0.4067974557067769, "mean_action_processing_ms": 0.09644769357827605, "mean_env_wait_ms": 2.192887998135342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004233837127685547, "StateBufferConnector_ms": 0.0029582977294921875, "ViewRequirementAgentConnector_ms": 0.07290840148925781}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.847866357517, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2667.0506852810777, -2726.10116680888, -2748.0218165429255, -2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.530068161851241, "mean_inference_ms": 0.4067974557067769, "mean_action_processing_ms": 0.09644769357827605, "mean_env_wait_ms": 2.192887998135342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004233837127685547, "StateBufferConnector_ms": 0.0029582977294921875, "ViewRequirementAgentConnector_ms": 0.07290840148925781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5209800, "num_agent_steps_trained": 5209800, "num_env_steps_sampled": 5209800, "num_env_steps_trained": 5209800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.21829309914588, "num_env_steps_trained_throughput_per_sec": 96.21829309914588, "timesteps_total": 5209800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5209800, "timers": {"training_iteration_time_ms": 3740.979, "sample_time_ms": 3730.059, "load_time_ms": 0.307, "load_throughput": 1174235.508, "learn_time_ms": 9.815, "learn_throughput": 36679.884, "synch_weights_time_ms": 0.75}, "counters": {"num_env_steps_sampled": 5209800, "num_env_steps_trained": 5209800, "num_agent_steps_sampled": 5209800, "num_agent_steps_trained": 5209800}, "done": false, "episodes_total": 1561, "training_iteration": 694, "trial_id": "36440_00000", "date": "2023-07-25_03-08-55", "timestamp": 1690243735, "time_this_iter_s": 11.227189779281616, "time_total_s": 11448.248836517334, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1379.135017633438, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 24.0, "ram_util_percent": 77.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.75237274169922, "policy_loss": -65544.59375, "vf_loss": 15293844.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1873.0, "diff_num_grad_updates_vs_sampler_policy": 1872.0}}, "num_env_steps_sampled": 5210880, "num_env_steps_trained": 5210880, "num_agent_steps_sampled": 5210880, "num_agent_steps_trained": 5210880}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.1522991315487, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529852684238939, "mean_inference_ms": 0.4068428767945618, "mean_action_processing_ms": 0.0964466927717797, "mean_env_wait_ms": 2.1935594000961647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004235029220581055, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.07282233238220215}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.1522991315487, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2711.010578491162, -2710.3412378326248, -2709.817777681545, -2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529852684238939, "mean_inference_ms": 0.4068428767945618, "mean_action_processing_ms": 0.0964466927717797, "mean_env_wait_ms": 2.1935594000961647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004235029220581055, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.07282233238220215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5210880, "num_agent_steps_trained": 5210880, "num_env_steps_sampled": 5210880, "num_env_steps_trained": 5210880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.40485572402567, "num_env_steps_trained_throughput_per_sec": 96.40485572402567, "timesteps_total": 5210880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5210880, "timers": {"training_iteration_time_ms": 3745.459, "sample_time_ms": 3734.681, "load_time_ms": 0.314, "load_throughput": 1147029.353, "learn_time_ms": 9.669, "learn_throughput": 37230.763, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 5210880, "num_env_steps_trained": 5210880, "num_agent_steps_sampled": 5210880, "num_agent_steps_trained": 5210880}, "done": false, "episodes_total": 1564, "training_iteration": 695, "trial_id": "36440_00000", "date": "2023-07-25_03-09-07", "timestamp": 1690243747, "time_this_iter_s": 11.205687761306763, "time_total_s": 11459.45452427864, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1390.3407053947449, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 23.8625, "ram_util_percent": 77.17499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.86217346191407, "policy_loss": -71764.32109375, "vf_loss": 17035116.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1888.0, "diff_num_grad_updates_vs_sampler_policy": 1887.0}}, "num_env_steps_sampled": 5211960, "num_env_steps_trained": 5211960, "num_agent_steps_sampled": 5211960, "num_agent_steps_trained": 5211960}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.120910462239, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529635617246864, "mean_inference_ms": 0.4068868380862445, "mean_action_processing_ms": 0.09644535191295792, "mean_env_wait_ms": 2.1942203632264805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004204273223876953, "StateBufferConnector_ms": 0.0029463768005371094, "ViewRequirementAgentConnector_ms": 0.07241058349609375}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.120910462239, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2677.6376851652985, -2625.521779812418, -2708.8038931536403, -2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529635617246864, "mean_inference_ms": 0.4068868380862445, "mean_action_processing_ms": 0.09644535191295792, "mean_env_wait_ms": 2.1942203632264805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004204273223876953, "StateBufferConnector_ms": 0.0029463768005371094, "ViewRequirementAgentConnector_ms": 0.07241058349609375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5211960, "num_agent_steps_trained": 5211960, "num_env_steps_sampled": 5211960, "num_env_steps_trained": 5211960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.96080873416251, "num_env_steps_trained_throughput_per_sec": 96.96080873416251, "timesteps_total": 5211960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5211960, "timers": {"training_iteration_time_ms": 3741.694, "sample_time_ms": 3731.077, "load_time_ms": 0.313, "load_throughput": 1149561.812, "learn_time_ms": 9.539, "learn_throughput": 37739.301, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 5211960, "num_env_steps_trained": 5211960, "num_agent_steps_sampled": 5211960, "num_agent_steps_trained": 5211960}, "done": false, "episodes_total": 1567, "training_iteration": 696, "trial_id": "36440_00000", "date": "2023-07-25_03-09-18", "timestamp": 1690243758, "time_this_iter_s": 11.1412992477417, "time_total_s": 11470.595823526382, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1401.4820046424866, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 25.03125, "ram_util_percent": 77.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.16798248291016, "policy_loss": -74646.35390625, "vf_loss": 16225559.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1903.0, "diff_num_grad_updates_vs_sampler_policy": 1902.0}}, "num_env_steps_sampled": 5213040, "num_env_steps_trained": 5213040, "num_agent_steps_sampled": 5213040, "num_agent_steps_trained": 5213040}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.7314148347295, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5293949389320485, "mean_inference_ms": 0.4069301447219073, "mean_action_processing_ms": 0.09644396960223213, "mean_env_wait_ms": 2.194847714607496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004221677780151367, "StateBufferConnector_ms": 0.002938985824584961, "ViewRequirementAgentConnector_ms": 0.07252883911132812}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2815.6360689790245, "episode_reward_mean": -2714.7314148347295, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2741.3868636138864, -2815.6360689790245, -2759.771631912432, -2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5293949389320485, "mean_inference_ms": 0.4069301447219073, "mean_action_processing_ms": 0.09644396960223213, "mean_env_wait_ms": 2.194847714607496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004221677780151367, "StateBufferConnector_ms": 0.002938985824584961, "ViewRequirementAgentConnector_ms": 0.07252883911132812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5213040, "num_agent_steps_trained": 5213040, "num_env_steps_sampled": 5213040, "num_env_steps_trained": 5213040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 98.77208063290036, "num_env_steps_trained_throughput_per_sec": 98.77208063290036, "timesteps_total": 5213040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5213040, "timers": {"training_iteration_time_ms": 3707.85, "sample_time_ms": 3697.281, "load_time_ms": 0.307, "load_throughput": 1173961.623, "learn_time_ms": 9.498, "learn_throughput": 37902.05, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 5213040, "num_env_steps_trained": 5213040, "num_agent_steps_sampled": 5213040, "num_agent_steps_trained": 5213040}, "done": false, "episodes_total": 1570, "training_iteration": 697, "trial_id": "36440_00000", "date": "2023-07-25_03-09-29", "timestamp": 1690243769, "time_this_iter_s": 10.93695592880249, "time_total_s": 11481.532779455185, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1412.418960571289, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 30.866666666666667, "ram_util_percent": 77.29333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.29001312255859, "policy_loss": -66548.81796875, "vf_loss": 15983211.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1918.0, "diff_num_grad_updates_vs_sampler_policy": 1917.0}}, "num_env_steps_sampled": 5214120, "num_env_steps_trained": 5214120, "num_agent_steps_sampled": 5214120, "num_agent_steps_trained": 5214120}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2800.9354917402256, "episode_reward_mean": -2712.0185518532885, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529165436233215, "mean_inference_ms": 0.40697695315051113, "mean_action_processing_ms": 0.0964430488155557, "mean_env_wait_ms": 2.195448056399972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004210948944091797, "StateBufferConnector_ms": 0.0029354095458984375, "ViewRequirementAgentConnector_ms": 0.0725090503692627}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2800.9354917402256, "episode_reward_mean": -2712.0185518532885, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2702.6280142430164, -2774.943872204627, -2744.124157455462, -2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529165436233215, "mean_inference_ms": 0.40697695315051113, "mean_action_processing_ms": 0.0964430488155557, "mean_env_wait_ms": 2.195448056399972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004210948944091797, "StateBufferConnector_ms": 0.0029354095458984375, "ViewRequirementAgentConnector_ms": 0.0725090503692627}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5214120, "num_agent_steps_trained": 5214120, "num_env_steps_sampled": 5214120, "num_env_steps_trained": 5214120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.36371331930332, "num_env_steps_trained_throughput_per_sec": 97.36371331930332, "timesteps_total": 5214120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5214120, "timers": {"training_iteration_time_ms": 3696.241, "sample_time_ms": 3685.581, "load_time_ms": 0.308, "load_throughput": 1170321.997, "learn_time_ms": 9.577, "learn_throughput": 37589.731, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 5214120, "num_env_steps_trained": 5214120, "num_agent_steps_sampled": 5214120, "num_agent_steps_trained": 5214120}, "done": false, "episodes_total": 1573, "training_iteration": 698, "trial_id": "36440_00000", "date": "2023-07-25_03-09-40", "timestamp": 1690243780, "time_this_iter_s": 11.095319032669067, "time_total_s": 11492.628098487854, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1423.5142796039581, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 25.8125, "ram_util_percent": 77.23124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.30251922607422, "policy_loss": -64033.24375, "vf_loss": 16867181.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1933.0, "diff_num_grad_updates_vs_sampler_policy": 1932.0}}, "num_env_steps_sampled": 5215200, "num_env_steps_trained": 5215200, "num_agent_steps_sampled": 5215200, "num_agent_steps_trained": 5215200}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2800.9354917402256, "episode_reward_mean": -2711.573857414653, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528995283925002, "mean_inference_ms": 0.4070225299283519, "mean_action_processing_ms": 0.09644183747558806, "mean_env_wait_ms": 2.196055277920511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004217386245727539, "StateBufferConnector_ms": 0.0029382705688476562, "ViewRequirementAgentConnector_ms": 0.07268643379211426}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2800.9354917402256, "episode_reward_mean": -2711.573857414653, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2753.284352038439, -2707.2113241511993, -2702.6257739864054, -2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528995283925002, "mean_inference_ms": 0.4070225299283519, "mean_action_processing_ms": 0.09644183747558806, "mean_env_wait_ms": 2.196055277920511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004217386245727539, "StateBufferConnector_ms": 0.0029382705688476562, "ViewRequirementAgentConnector_ms": 0.07268643379211426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5215200, "num_agent_steps_trained": 5215200, "num_env_steps_sampled": 5215200, "num_env_steps_trained": 5215200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.03038564358029, "num_env_steps_trained_throughput_per_sec": 97.03038564358029, "timesteps_total": 5215200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5215200, "timers": {"training_iteration_time_ms": 3692.328, "sample_time_ms": 3681.598, "load_time_ms": 0.299, "load_throughput": 1204490.619, "learn_time_ms": 9.666, "learn_throughput": 37242.793, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 5215200, "num_env_steps_trained": 5215200, "num_agent_steps_sampled": 5215200, "num_agent_steps_trained": 5215200}, "done": false, "episodes_total": 1576, "training_iteration": 699, "trial_id": "36440_00000", "date": "2023-07-25_03-09-51", "timestamp": 1690243791, "time_this_iter_s": 11.13329792022705, "time_total_s": 11503.761396408081, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1434.6475775241852, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 30.543750000000003, "ram_util_percent": 77.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 98.45897979736328, "policy_loss": -78363.46796875, "vf_loss": 17129679.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1948.0, "diff_num_grad_updates_vs_sampler_policy": 1947.0}}, "num_env_steps_sampled": 5216280, "num_env_steps_trained": 5216280, "num_agent_steps_sampled": 5216280, "num_agent_steps_trained": 5216280}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2712.239445417747, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528842819181805, "mean_inference_ms": 0.40706812849459584, "mean_action_processing_ms": 0.09644054536275172, "mean_env_wait_ms": 2.196664725698753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004199028015136719, "StateBufferConnector_ms": 0.0029268264770507812, "ViewRequirementAgentConnector_ms": 0.07245182991027832}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2712.239445417747, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2763.294946111469, -2725.302925048121, -2695.2200779737454, -2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528842819181805, "mean_inference_ms": 0.40706812849459584, "mean_action_processing_ms": 0.09644054536275172, "mean_env_wait_ms": 2.196664725698753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004199028015136719, "StateBufferConnector_ms": 0.0029268264770507812, "ViewRequirementAgentConnector_ms": 0.07245182991027832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5216280, "num_agent_steps_trained": 5216280, "num_env_steps_sampled": 5216280, "num_env_steps_trained": 5216280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.13733608274099, "num_env_steps_trained_throughput_per_sec": 96.13733608274099, "timesteps_total": 5216280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5216280, "timers": {"training_iteration_time_ms": 3707.91, "sample_time_ms": 3697.092, "load_time_ms": 0.299, "load_throughput": 1202667.814, "learn_time_ms": 9.746, "learn_throughput": 36938.219, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 5216280, "num_env_steps_trained": 5216280, "num_agent_steps_sampled": 5216280, "num_agent_steps_trained": 5216280}, "done": false, "episodes_total": 1579, "training_iteration": 700, "trial_id": "36440_00000", "date": "2023-07-25_03-10-02", "timestamp": 1690243802, "time_this_iter_s": 11.236760139465332, "time_total_s": 11514.998156547546, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1445.8843376636505, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 24.268749999999997, "ram_util_percent": 77.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.77349395751953, "policy_loss": -66382.64921875, "vf_loss": 15907819.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1963.0, "diff_num_grad_updates_vs_sampler_policy": 1962.0}}, "num_env_steps_sampled": 5217360, "num_env_steps_trained": 5217360, "num_agent_steps_sampled": 5217360, "num_agent_steps_trained": 5217360}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2710.782985324886, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52863454440842, "mean_inference_ms": 0.4071190107172263, "mean_action_processing_ms": 0.09644025366981987, "mean_env_wait_ms": 2.1972523887907505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004194974899291992, "StateBufferConnector_ms": 0.002928018569946289, "ViewRequirementAgentConnector_ms": 0.07238554954528809}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2710.782985324886, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2707.2157215821644, -2714.1410936701595, -2750.3683035902523, -2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52863454440842, "mean_inference_ms": 0.4071190107172263, "mean_action_processing_ms": 0.09644025366981987, "mean_env_wait_ms": 2.1972523887907505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004194974899291992, "StateBufferConnector_ms": 0.002928018569946289, "ViewRequirementAgentConnector_ms": 0.07238554954528809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5217360, "num_agent_steps_trained": 5217360, "num_env_steps_sampled": 5217360, "num_env_steps_trained": 5217360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 100.47552956314195, "num_env_steps_trained_throughput_per_sec": 100.47552956314195, "timesteps_total": 5217360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5217360, "timers": {"training_iteration_time_ms": 3670.208, "sample_time_ms": 3659.383, "load_time_ms": 0.3, "load_throughput": 1200086.981, "learn_time_ms": 9.762, "learn_throughput": 36878.045, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 5217360, "num_env_steps_trained": 5217360, "num_agent_steps_sampled": 5217360, "num_agent_steps_trained": 5217360}, "done": false, "episodes_total": 1582, "training_iteration": 701, "trial_id": "36440_00000", "date": "2023-07-25_03-10-13", "timestamp": 1690243813, "time_this_iter_s": 10.752053022384644, "time_total_s": 11525.750209569931, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1456.6363906860352, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 37.153333333333336, "ram_util_percent": 77.52666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.5973114013672, "policy_loss": -69328.640625, "vf_loss": 16040693.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1978.0, "diff_num_grad_updates_vs_sampler_policy": 1977.0}}, "num_env_steps_sampled": 5218440, "num_env_steps_trained": 5218440, "num_agent_steps_sampled": 5218440, "num_agent_steps_trained": 5218440}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2710.616486303053, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528460223245348, "mean_inference_ms": 0.4071685531822884, "mean_action_processing_ms": 0.09643992080386747, "mean_env_wait_ms": 2.197818629944038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042171478271484375, "StateBufferConnector_ms": 0.0029397010803222656, "ViewRequirementAgentConnector_ms": 0.07263517379760742}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2710.616486303053, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2686.8564358652575, -2718.8925507608856, -2657.813141631447, -2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528460223245348, "mean_inference_ms": 0.4071685531822884, "mean_action_processing_ms": 0.09643992080386747, "mean_env_wait_ms": 2.197818629944038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042171478271484375, "StateBufferConnector_ms": 0.0029397010803222656, "ViewRequirementAgentConnector_ms": 0.07263517379760742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5218440, "num_agent_steps_trained": 5218440, "num_env_steps_sampled": 5218440, "num_env_steps_trained": 5218440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.52155191737853, "num_env_steps_trained_throughput_per_sec": 96.52155191737853, "timesteps_total": 5218440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5218440, "timers": {"training_iteration_time_ms": 3680.471, "sample_time_ms": 3669.65, "load_time_ms": 0.303, "load_throughput": 1188001.133, "learn_time_ms": 9.768, "learn_throughput": 36854.822, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 5218440, "num_env_steps_trained": 5218440, "num_agent_steps_sampled": 5218440, "num_agent_steps_trained": 5218440}, "done": false, "episodes_total": 1585, "training_iteration": 702, "trial_id": "36440_00000", "date": "2023-07-25_03-10-24", "timestamp": 1690243824, "time_this_iter_s": 11.192012786865234, "time_total_s": 11536.942222356796, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1467.8284034729004, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 23.1375, "ram_util_percent": 77.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.6817855834961, "policy_loss": -76982.584375, "vf_loss": 16837379.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1993.0, "diff_num_grad_updates_vs_sampler_policy": 1992.0}}, "num_env_steps_sampled": 5219520, "num_env_steps_trained": 5219520, "num_agent_steps_sampled": 5219520, "num_agent_steps_trained": 5219520}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2712.1806247682607, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528264956661162, "mean_inference_ms": 0.4072190587617988, "mean_action_processing_ms": 0.09643970296592767, "mean_env_wait_ms": 2.19836876447823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00423741340637207, "StateBufferConnector_ms": 0.0029473304748535156, "ViewRequirementAgentConnector_ms": 0.07291841506958008}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2712.1806247682607, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2689.6324045647434, -2711.443348444733, -2670.295304213507, -2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528264956661162, "mean_inference_ms": 0.4072190587617988, "mean_action_processing_ms": 0.09643970296592767, "mean_env_wait_ms": 2.19836876447823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00423741340637207, "StateBufferConnector_ms": 0.0029473304748535156, "ViewRequirementAgentConnector_ms": 0.07291841506958008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5219520, "num_agent_steps_trained": 5219520, "num_env_steps_sampled": 5219520, "num_env_steps_trained": 5219520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.61230202705735, "num_env_steps_trained_throughput_per_sec": 97.61230202705735, "timesteps_total": 5219520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5219520, "timers": {"training_iteration_time_ms": 3678.724, "sample_time_ms": 3667.628, "load_time_ms": 0.331, "load_throughput": 1088330.287, "learn_time_ms": 9.947, "learn_throughput": 36190.552, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 5219520, "num_env_steps_trained": 5219520, "num_agent_steps_sampled": 5219520, "num_agent_steps_trained": 5219520}, "done": false, "episodes_total": 1588, "training_iteration": 703, "trial_id": "36440_00000", "date": "2023-07-25_03-10-35", "timestamp": 1690243835, "time_this_iter_s": 11.067424058914185, "time_total_s": 11548.00964641571, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1478.8958275318146, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 26.512500000000003, "ram_util_percent": 77.54375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.0108871459961, "policy_loss": -70927.078125, "vf_loss": 16132039.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2008.0, "diff_num_grad_updates_vs_sampler_policy": 2007.0}}, "num_env_steps_sampled": 5220600, "num_env_steps_trained": 5220600, "num_agent_steps_sampled": 5220600, "num_agent_steps_trained": 5220600}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2712.968851783462, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528124171960953, "mean_inference_ms": 0.4072675694006112, "mean_action_processing_ms": 0.09643912787665375, "mean_env_wait_ms": 2.1989142156232084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248857498168945, "StateBufferConnector_ms": 0.0029795169830322266, "ViewRequirementAgentConnector_ms": 0.0730428695678711}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2712.968851783462, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2720.1722055145747, -2721.159821645771, -2734.5158850414987, -2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528124171960953, "mean_inference_ms": 0.4072675694006112, "mean_action_processing_ms": 0.09643912787665375, "mean_env_wait_ms": 2.1989142156232084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248857498168945, "StateBufferConnector_ms": 0.0029795169830322266, "ViewRequirementAgentConnector_ms": 0.0730428695678711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5220600, "num_agent_steps_trained": 5220600, "num_env_steps_sampled": 5220600, "num_env_steps_trained": 5220600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.15951346836562, "num_env_steps_trained_throughput_per_sec": 96.15951346836562, "timesteps_total": 5220600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5220600, "timers": {"training_iteration_time_ms": 3710.091, "sample_time_ms": 3698.976, "load_time_ms": 0.335, "load_throughput": 1074238.361, "learn_time_ms": 9.972, "learn_throughput": 36101.255, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 5220600, "num_env_steps_trained": 5220600, "num_agent_steps_sampled": 5220600, "num_agent_steps_trained": 5220600}, "done": false, "episodes_total": 1591, "training_iteration": 704, "trial_id": "36440_00000", "date": "2023-07-25_03-10-47", "timestamp": 1690243847, "time_this_iter_s": 11.234188795089722, "time_total_s": 11559.2438352108, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1490.1300163269043, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 24.6875, "ram_util_percent": 77.45625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.7256866455078, "policy_loss": -72557.60703125, "vf_loss": 16819814.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2023.0, "diff_num_grad_updates_vs_sampler_policy": 2022.0}}, "num_env_steps_sampled": 5221680, "num_env_steps_trained": 5221680, "num_agent_steps_sampled": 5221680, "num_agent_steps_trained": 5221680}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2712.3002920588724, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527974629477402, "mean_inference_ms": 0.407313615609158, "mean_action_processing_ms": 0.09643805299806393, "mean_env_wait_ms": 2.199455119586796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042498111724853516, "StateBufferConnector_ms": 0.002976655960083008, "ViewRequirementAgentConnector_ms": 0.07305574417114258}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2712.3002920588724, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2721.1707860998613, -2679.5615031109023, -2714.779193964395, -2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527974629477402, "mean_inference_ms": 0.407313615609158, "mean_action_processing_ms": 0.09643805299806393, "mean_env_wait_ms": 2.199455119586796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042498111724853516, "StateBufferConnector_ms": 0.002976655960083008, "ViewRequirementAgentConnector_ms": 0.07305574417114258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5221680, "num_agent_steps_trained": 5221680, "num_env_steps_sampled": 5221680, "num_env_steps_trained": 5221680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.46099011429136, "num_env_steps_trained_throughput_per_sec": 96.46099011429136, "timesteps_total": 5221680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5221680, "timers": {"training_iteration_time_ms": 3731.053, "sample_time_ms": 3720.042, "load_time_ms": 0.333, "load_throughput": 1081625.673, "learn_time_ms": 9.872, "learn_throughput": 36466.043, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 5221680, "num_env_steps_trained": 5221680, "num_agent_steps_sampled": 5221680, "num_agent_steps_trained": 5221680}, "done": false, "episodes_total": 1594, "training_iteration": 705, "trial_id": "36440_00000", "date": "2023-07-25_03-10-58", "timestamp": 1690243858, "time_this_iter_s": 11.199005842208862, "time_total_s": 11570.442841053009, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1501.3290221691132, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 21.075000000000003, "ram_util_percent": 77.70625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.21692810058593, "policy_loss": -73334.39765625, "vf_loss": 16753681.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2038.0, "diff_num_grad_updates_vs_sampler_policy": 2037.0}}, "num_env_steps_sampled": 5222760, "num_env_steps_trained": 5222760, "num_agent_steps_sampled": 5222760, "num_agent_steps_trained": 5222760}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2713.6239024163187, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527824623363542, "mean_inference_ms": 0.4073614456477721, "mean_action_processing_ms": 0.09643723398388905, "mean_env_wait_ms": 2.1999965601741347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004251241683959961, "StateBufferConnector_ms": 0.003009796142578125, "ViewRequirementAgentConnector_ms": 0.07302474975585938}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2713.6239024163187, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2713.876311433749, -2734.8537978328322, -2699.850046484044, -2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527824623363542, "mean_inference_ms": 0.4073614456477721, "mean_action_processing_ms": 0.09643723398388905, "mean_env_wait_ms": 2.1999965601741347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004251241683959961, "StateBufferConnector_ms": 0.003009796142578125, "ViewRequirementAgentConnector_ms": 0.07302474975585938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5222760, "num_agent_steps_trained": 5222760, "num_env_steps_sampled": 5222760, "num_env_steps_trained": 5222760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.99517032762405, "num_env_steps_trained_throughput_per_sec": 95.99517032762405, "timesteps_total": 5222760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5222760, "timers": {"training_iteration_time_ms": 3732.491, "sample_time_ms": 3721.643, "load_time_ms": 0.333, "load_throughput": 1082013.214, "learn_time_ms": 9.722, "learn_throughput": 37029.439, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 5222760, "num_env_steps_trained": 5222760, "num_agent_steps_sampled": 5222760, "num_agent_steps_trained": 5222760}, "done": false, "episodes_total": 1597, "training_iteration": 706, "trial_id": "36440_00000", "date": "2023-07-25_03-11-09", "timestamp": 1690243869, "time_this_iter_s": 11.253500938415527, "time_total_s": 11581.696341991425, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1512.5825231075287, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 24.9375, "ram_util_percent": 77.58749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.53066558837891, "policy_loss": -66908.94921875, "vf_loss": 15166207.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2053.0, "diff_num_grad_updates_vs_sampler_policy": 2052.0}}, "num_env_steps_sampled": 5223840, "num_env_steps_trained": 5223840, "num_agent_steps_sampled": 5223840, "num_agent_steps_trained": 5223840}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2713.245311153693, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527701566555951, "mean_inference_ms": 0.407407850738094, "mean_action_processing_ms": 0.09643601684288113, "mean_env_wait_ms": 2.2005262971541173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004237174987792969, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.07290339469909668}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2713.245311153693, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2698.0288398472026, -2697.744580118291, -2689.2840271898935, -2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527701566555951, "mean_inference_ms": 0.407407850738094, "mean_action_processing_ms": 0.09643601684288113, "mean_env_wait_ms": 2.2005262971541173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004237174987792969, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.07290339469909668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5223840, "num_agent_steps_trained": 5223840, "num_env_steps_sampled": 5223840, "num_env_steps_trained": 5223840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.30850945223786, "num_env_steps_trained_throughput_per_sec": 97.30850945223786, "timesteps_total": 5223840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5223840, "timers": {"training_iteration_time_ms": 3737.349, "sample_time_ms": 3726.687, "load_time_ms": 0.303, "load_throughput": 1187814.223, "learn_time_ms": 9.608, "learn_throughput": 37467.077, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 5223840, "num_env_steps_trained": 5223840, "num_agent_steps_sampled": 5223840, "num_agent_steps_trained": 5223840}, "done": false, "episodes_total": 1600, "training_iteration": 707, "trial_id": "36440_00000", "date": "2023-07-25_03-11-20", "timestamp": 1690243880, "time_this_iter_s": 11.101599931716919, "time_total_s": 11592.797941923141, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1523.6841230392456, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 24.71333333333333, "ram_util_percent": 77.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.74507446289063, "policy_loss": -74745.365625, "vf_loss": 16507609.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2068.0, "diff_num_grad_updates_vs_sampler_policy": 2067.0}}, "num_env_steps_sampled": 5224920, "num_env_steps_trained": 5224920, "num_agent_steps_sampled": 5224920, "num_agent_steps_trained": 5224920}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2715.3225303326662, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5275970662421745, "mean_inference_ms": 0.4074567590579609, "mean_action_processing_ms": 0.09643514280576192, "mean_env_wait_ms": 2.2010457754000488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042324066162109375, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.0729069709777832}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2715.3225303326662, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2665.731812801377, -2770.356015164032, -2671.045723751607, -2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5275970662421745, "mean_inference_ms": 0.4074567590579609, "mean_action_processing_ms": 0.09643514280576192, "mean_env_wait_ms": 2.2010457754000488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042324066162109375, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.0729069709777832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5224920, "num_agent_steps_trained": 5224920, "num_env_steps_sampled": 5224920, "num_env_steps_trained": 5224920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.46971386410398, "num_env_steps_trained_throughput_per_sec": 95.46971386410398, "timesteps_total": 5224920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5224920, "timers": {"training_iteration_time_ms": 3749.264, "sample_time_ms": 3738.16, "load_time_ms": 0.304, "load_throughput": 1184274.071, "learn_time_ms": 10.011, "learn_throughput": 35960.424, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 5224920, "num_env_steps_trained": 5224920, "num_agent_steps_sampled": 5224920, "num_agent_steps_trained": 5224920}, "done": false, "episodes_total": 1603, "training_iteration": 708, "trial_id": "36440_00000", "date": "2023-07-25_03-11-32", "timestamp": 1690243892, "time_this_iter_s": 11.315258026123047, "time_total_s": 11604.113199949265, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1534.9993810653687, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 26.512500000000003, "ram_util_percent": 77.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.95189056396484, "policy_loss": -65155.71640625, "vf_loss": 16524224.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2083.0, "diff_num_grad_updates_vs_sampler_policy": 2082.0}}, "num_env_steps_sampled": 5226000, "num_env_steps_trained": 5226000, "num_agent_steps_sampled": 5226000, "num_agent_steps_trained": 5226000}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2715.583937161881, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527525381254342, "mean_inference_ms": 0.40750397888440054, "mean_action_processing_ms": 0.09643398617680064, "mean_env_wait_ms": 2.2015511652733135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224538803100586, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.07287716865539551}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2715.583937161881, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2712.105943756122, -2717.1768586806993, -2718.4849675194937, -2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527525381254342, "mean_inference_ms": 0.40750397888440054, "mean_action_processing_ms": 0.09643398617680064, "mean_env_wait_ms": 2.2015511652733135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224538803100586, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.07287716865539551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5226000, "num_agent_steps_trained": 5226000, "num_env_steps_sampled": 5226000, "num_env_steps_trained": 5226000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.2337711016879, "num_env_steps_trained_throughput_per_sec": 95.2337711016879, "timesteps_total": 5226000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5226000, "timers": {"training_iteration_time_ms": 3747.838, "sample_time_ms": 3736.789, "load_time_ms": 0.31, "load_throughput": 1160071.789, "learn_time_ms": 9.96, "learn_throughput": 36143.426, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 5226000, "num_env_steps_trained": 5226000, "num_agent_steps_sampled": 5226000, "num_agent_steps_trained": 5226000}, "done": false, "episodes_total": 1606, "training_iteration": 709, "trial_id": "36440_00000", "date": "2023-07-25_03-11-43", "timestamp": 1690243903, "time_this_iter_s": 11.343514680862427, "time_total_s": 11615.456714630127, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1546.342895746231, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 24.25, "ram_util_percent": 77.93125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 102.56743011474609, "policy_loss": -66148.06875, "vf_loss": 15498115.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2098.0, "diff_num_grad_updates_vs_sampler_policy": 2097.0}}, "num_env_steps_sampled": 5227080, "num_env_steps_trained": 5227080, "num_agent_steps_sampled": 5227080, "num_agent_steps_trained": 5227080}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2715.393033204355, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527445780740754, "mean_inference_ms": 0.40755045164251, "mean_action_processing_ms": 0.09643280357400202, "mean_env_wait_ms": 2.2020636818805737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004216670989990234, "StateBufferConnector_ms": 0.002994537353515625, "ViewRequirementAgentConnector_ms": 0.07279467582702637}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2715.393033204355, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2699.8589096758064, -2735.1542957969473, -2731.8808200474778, -2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527445780740754, "mean_inference_ms": 0.40755045164251, "mean_action_processing_ms": 0.09643280357400202, "mean_env_wait_ms": 2.2020636818805737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004216670989990234, "StateBufferConnector_ms": 0.002994537353515625, "ViewRequirementAgentConnector_ms": 0.07279467582702637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5227080, "num_agent_steps_trained": 5227080, "num_env_steps_sampled": 5227080, "num_env_steps_trained": 5227080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.05437241209087, "num_env_steps_trained_throughput_per_sec": 96.05437241209087, "timesteps_total": 5227080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5227080, "timers": {"training_iteration_time_ms": 3746.14, "sample_time_ms": 3735.103, "load_time_ms": 0.306, "load_throughput": 1176889.665, "learn_time_ms": 9.957, "learn_throughput": 36154.503, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 5227080, "num_env_steps_trained": 5227080, "num_agent_steps_sampled": 5227080, "num_agent_steps_trained": 5227080}, "done": false, "episodes_total": 1609, "training_iteration": 710, "trial_id": "36440_00000", "date": "2023-07-25_03-11-54", "timestamp": 1690243914, "time_this_iter_s": 11.24633002281189, "time_total_s": 11626.703044652939, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1557.589225769043, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 23.20625, "ram_util_percent": 77.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.2830825805664, "policy_loss": -72176.0640625, "vf_loss": 15845574.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2113.0, "diff_num_grad_updates_vs_sampler_policy": 2112.0}}, "num_env_steps_sampled": 5228160, "num_env_steps_trained": 5228160, "num_agent_steps_sampled": 5228160, "num_agent_steps_trained": 5228160}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2715.1583957095513, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527353093242373, "mean_inference_ms": 0.40756266399709296, "mean_action_processing_ms": 0.09643206663703158, "mean_env_wait_ms": 2.2025446973419758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004244804382324219, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.07291722297668457}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2715.1583957095513, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2724.960260169715, -2691.74526952717, -2769.933227942662, -2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527353093242373, "mean_inference_ms": 0.40756266399709296, "mean_action_processing_ms": 0.09643206663703158, "mean_env_wait_ms": 2.2025446973419758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004244804382324219, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.07291722297668457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5228160, "num_agent_steps_trained": 5228160, "num_env_steps_sampled": 5228160, "num_env_steps_trained": 5228160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.98100898395354, "num_env_steps_trained_throughput_per_sec": 96.98100898395354, "timesteps_total": 5228160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5228160, "timers": {"training_iteration_time_ms": 3736.358, "sample_time_ms": 3725.786, "load_time_ms": 0.304, "load_throughput": 1183809.831, "learn_time_ms": 9.514, "learn_throughput": 37839.93, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 5228160, "num_env_steps_trained": 5228160, "num_agent_steps_sampled": 5228160, "num_agent_steps_trained": 5228160}, "done": false, "episodes_total": 1612, "training_iteration": 711, "trial_id": "36440_00000", "date": "2023-07-25_03-12-05", "timestamp": 1690243925, "time_this_iter_s": 11.13902997970581, "time_total_s": 11637.842074632645, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1568.7282557487488, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 23.4375, "ram_util_percent": 77.95625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.80077514648437, "policy_loss": -77562.6265625, "vf_loss": 15950661.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2128.0, "diff_num_grad_updates_vs_sampler_policy": 2127.0}}, "num_env_steps_sampled": 5229240, "num_env_steps_trained": 5229240, "num_agent_steps_sampled": 5229240, "num_agent_steps_trained": 5229240}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2714.9349513373186, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527286261715103, "mean_inference_ms": 0.4075558451073826, "mean_action_processing_ms": 0.096431191958961, "mean_env_wait_ms": 2.203002899915881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004202127456665039, "StateBufferConnector_ms": 0.0029942989349365234, "ViewRequirementAgentConnector_ms": 0.07247567176818848}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2714.9349513373186, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2781.2609159653816, -2791.963922771338, -2718.7719010202595, -2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527286261715103, "mean_inference_ms": 0.4075558451073826, "mean_action_processing_ms": 0.096431191958961, "mean_env_wait_ms": 2.203002899915881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004202127456665039, "StateBufferConnector_ms": 0.0029942989349365234, "ViewRequirementAgentConnector_ms": 0.07247567176818848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5229240, "num_agent_steps_trained": 5229240, "num_env_steps_sampled": 5229240, "num_env_steps_trained": 5229240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.2986639165285, "num_env_steps_trained_throughput_per_sec": 96.2986639165285, "timesteps_total": 5229240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5229240, "timers": {"training_iteration_time_ms": 3740.476, "sample_time_ms": 3729.749, "load_time_ms": 0.302, "load_throughput": 1190624.066, "learn_time_ms": 9.661, "learn_throughput": 37262.001, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 5229240, "num_env_steps_trained": 5229240, "num_agent_steps_sampled": 5229240, "num_agent_steps_trained": 5229240}, "done": false, "episodes_total": 1615, "training_iteration": 712, "trial_id": "36440_00000", "date": "2023-07-25_03-12-17", "timestamp": 1690243937, "time_this_iter_s": 11.217817068099976, "time_total_s": 11649.059891700745, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1579.9460728168488, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 21.775, "ram_util_percent": 77.88749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.13926239013672, "policy_loss": -73909.94140625, "vf_loss": 15474291.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2143.0, "diff_num_grad_updates_vs_sampler_policy": 2142.0}}, "num_env_steps_sampled": 5230320, "num_env_steps_trained": 5230320, "num_agent_steps_sampled": 5230320, "num_agent_steps_trained": 5230320}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2712.684443589931, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527247833023845, "mean_inference_ms": 0.4075493360491405, "mean_action_processing_ms": 0.09643054456625651, "mean_env_wait_ms": 2.2034467386939567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004227399826049805, "StateBufferConnector_ms": 0.0029921531677246094, "ViewRequirementAgentConnector_ms": 0.07253885269165039}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2712.684443589931, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2669.7824454508454, -2721.7760594558763, -2722.797673767265, -2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527247833023845, "mean_inference_ms": 0.4075493360491405, "mean_action_processing_ms": 0.09643054456625651, "mean_env_wait_ms": 2.2034467386939567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004227399826049805, "StateBufferConnector_ms": 0.0029921531677246094, "ViewRequirementAgentConnector_ms": 0.07253885269165039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5230320, "num_agent_steps_trained": 5230320, "num_env_steps_sampled": 5230320, "num_env_steps_trained": 5230320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.16258772211012, "num_env_steps_trained_throughput_per_sec": 96.16258772211012, "timesteps_total": 5230320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5230320, "timers": {"training_iteration_time_ms": 3739.734, "sample_time_ms": 3728.963, "load_time_ms": 0.303, "load_throughput": 1188375.13, "learn_time_ms": 9.692, "learn_throughput": 37142.935, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 5230320, "num_env_steps_trained": 5230320, "num_agent_steps_sampled": 5230320, "num_agent_steps_trained": 5230320}, "done": false, "episodes_total": 1618, "training_iteration": 713, "trial_id": "36440_00000", "date": "2023-07-25_03-12-28", "timestamp": 1690243948, "time_this_iter_s": 11.233994007110596, "time_total_s": 11660.293885707855, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1591.1800668239594, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 22.96875, "ram_util_percent": 77.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.73416900634766, "policy_loss": -69934.44609375, "vf_loss": 16705573.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2158.0, "diff_num_grad_updates_vs_sampler_policy": 2157.0}}, "num_env_steps_sampled": 5231400, "num_env_steps_trained": 5231400, "num_agent_steps_sampled": 5231400, "num_agent_steps_trained": 5231400}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2713.7686356594163, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527173422827548, "mean_inference_ms": 0.40754492131689296, "mean_action_processing_ms": 0.0964304303149636, "mean_env_wait_ms": 2.203896861252709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004256725311279297, "StateBufferConnector_ms": 0.003004789352416992, "ViewRequirementAgentConnector_ms": 0.07295060157775879}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2817.4727760062547, "episode_reward_mean": -2713.7686356594163, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2715.0942495742825, -2702.190269169617, -2724.66858025306, -2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527173422827548, "mean_inference_ms": 0.40754492131689296, "mean_action_processing_ms": 0.0964304303149636, "mean_env_wait_ms": 2.203896861252709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004256725311279297, "StateBufferConnector_ms": 0.003004789352416992, "ViewRequirementAgentConnector_ms": 0.07295060157775879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5231400, "num_agent_steps_trained": 5231400, "num_env_steps_sampled": 5231400, "num_env_steps_trained": 5231400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.07645266649764, "num_env_steps_trained_throughput_per_sec": 97.07645266649764, "timesteps_total": 5231400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5231400, "timers": {"training_iteration_time_ms": 3734.312, "sample_time_ms": 3723.481, "load_time_ms": 0.302, "load_throughput": 1192316.361, "learn_time_ms": 9.738, "learn_throughput": 36968.244, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 5231400, "num_env_steps_trained": 5231400, "num_agent_steps_sampled": 5231400, "num_agent_steps_trained": 5231400}, "done": false, "episodes_total": 1621, "training_iteration": 714, "trial_id": "36440_00000", "date": "2023-07-25_03-12-39", "timestamp": 1690243959, "time_this_iter_s": 11.12802791595459, "time_total_s": 11671.42191362381, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1602.308094739914, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 24.36875, "ram_util_percent": 78.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.42312469482422, "policy_loss": -75478.0640625, "vf_loss": 16549590.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2173.0, "diff_num_grad_updates_vs_sampler_policy": 2172.0}}, "num_env_steps_sampled": 5232480, "num_env_steps_trained": 5232480, "num_agent_steps_sampled": 5232480, "num_agent_steps_trained": 5232480}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2716.0738749082348, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5271046412793154, "mean_inference_ms": 0.4075393865091365, "mean_action_processing_ms": 0.09643018144328856, "mean_env_wait_ms": 2.2043513390098166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248380661010742, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.07279253005981445}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2716.0738749082348, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2754.132107335066, -2751.455905802569, -2726.895189005706, -2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5271046412793154, "mean_inference_ms": 0.4075393865091365, "mean_action_processing_ms": 0.09643018144328856, "mean_env_wait_ms": 2.2043513390098166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248380661010742, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.07279253005981445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5232480, "num_agent_steps_trained": 5232480, "num_env_steps_sampled": 5232480, "num_env_steps_trained": 5232480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.8250934214886, "num_env_steps_trained_throughput_per_sec": 95.8250934214886, "timesteps_total": 5232480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5232480, "timers": {"training_iteration_time_ms": 3744.835, "sample_time_ms": 3734.071, "load_time_ms": 0.297, "load_throughput": 1212031.979, "learn_time_ms": 9.689, "learn_throughput": 37155.091, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 5232480, "num_env_steps_trained": 5232480, "num_agent_steps_sampled": 5232480, "num_agent_steps_trained": 5232480}, "done": false, "episodes_total": 1624, "training_iteration": 715, "trial_id": "36440_00000", "date": "2023-07-25_03-12-50", "timestamp": 1690243970, "time_this_iter_s": 11.273231983184814, "time_total_s": 11682.695145606995, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1613.5813267230988, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 25.28125, "ram_util_percent": 77.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.93252716064453, "policy_loss": -67266.20703125, "vf_loss": 16024555.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2188.0, "diff_num_grad_updates_vs_sampler_policy": 2187.0}}, "num_env_steps_sampled": 5233560, "num_env_steps_trained": 5233560, "num_agent_steps_sampled": 5233560, "num_agent_steps_trained": 5233560}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2715.484608269407, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527036438930358, "mean_inference_ms": 0.4075337015759697, "mean_action_processing_ms": 0.09643007220582071, "mean_env_wait_ms": 2.2047931981040643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042531490325927734, "StateBufferConnector_ms": 0.0030057430267333984, "ViewRequirementAgentConnector_ms": 0.07286596298217773}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2715.484608269407, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2759.545874794773, -2766.9493998187054, -2660.723435264674, -2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527036438930358, "mean_inference_ms": 0.4075337015759697, "mean_action_processing_ms": 0.09643007220582071, "mean_env_wait_ms": 2.2047931981040643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042531490325927734, "StateBufferConnector_ms": 0.0030057430267333984, "ViewRequirementAgentConnector_ms": 0.07286596298217773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5233560, "num_agent_steps_trained": 5233560, "num_env_steps_sampled": 5233560, "num_env_steps_trained": 5233560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.02044095631507, "num_env_steps_trained_throughput_per_sec": 96.02044095631507, "timesteps_total": 5233560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5233560, "timers": {"training_iteration_time_ms": 3745.034, "sample_time_ms": 3734.316, "load_time_ms": 0.296, "load_throughput": 1215642.412, "learn_time_ms": 9.638, "learn_throughput": 37351.688, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 5233560, "num_env_steps_trained": 5233560, "num_agent_steps_sampled": 5233560, "num_agent_steps_trained": 5233560}, "done": false, "episodes_total": 1627, "training_iteration": 716, "trial_id": "36440_00000", "date": "2023-07-25_03-13-02", "timestamp": 1690243982, "time_this_iter_s": 11.25040578842163, "time_total_s": 11693.945551395416, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1624.8317325115204, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 24.862499999999997, "ram_util_percent": 77.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.83204040527343, "policy_loss": -65806.53671875, "vf_loss": 15701028.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2203.0, "diff_num_grad_updates_vs_sampler_policy": 2202.0}}, "num_env_steps_sampled": 5234640, "num_env_steps_trained": 5234640, "num_agent_steps_sampled": 5234640, "num_agent_steps_trained": 5234640}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2715.5519877320294, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526982726674805, "mean_inference_ms": 0.4075263043266137, "mean_action_processing_ms": 0.09642972739119607, "mean_env_wait_ms": 2.20522312425298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004236459732055664, "StateBufferConnector_ms": 0.0030057430267333984, "ViewRequirementAgentConnector_ms": 0.07261872291564941}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2715.5519877320294, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2674.837987762375, -2785.286607504131, -2638.2079397752427, -2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526982726674805, "mean_inference_ms": 0.4075263043266137, "mean_action_processing_ms": 0.09642972739119607, "mean_env_wait_ms": 2.20522312425298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004236459732055664, "StateBufferConnector_ms": 0.0030057430267333984, "ViewRequirementAgentConnector_ms": 0.07261872291564941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5234640, "num_agent_steps_trained": 5234640, "num_env_steps_sampled": 5234640, "num_env_steps_trained": 5234640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.93281276144818, "num_env_steps_trained_throughput_per_sec": 95.93281276144818, "timesteps_total": 5234640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5234640, "timers": {"training_iteration_time_ms": 3753.795, "sample_time_ms": 3743.093, "load_time_ms": 0.298, "load_throughput": 1209217.138, "learn_time_ms": 9.626, "learn_throughput": 37399.796, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 5234640, "num_env_steps_trained": 5234640, "num_agent_steps_sampled": 5234640, "num_agent_steps_trained": 5234640}, "done": false, "episodes_total": 1630, "training_iteration": 717, "trial_id": "36440_00000", "date": "2023-07-25_03-13-13", "timestamp": 1690243993, "time_this_iter_s": 11.260765790939331, "time_total_s": 11705.206317186356, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1636.0924983024597, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 23.85625, "ram_util_percent": 77.78750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.71585693359376, "policy_loss": -68682.4578125, "vf_loss": 15719604.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2218.0, "diff_num_grad_updates_vs_sampler_policy": 2217.0}}, "num_env_steps_sampled": 5235720, "num_env_steps_trained": 5235720, "num_agent_steps_sampled": 5235720, "num_agent_steps_trained": 5235720}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2715.502005590426, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5269216426289915, "mean_inference_ms": 0.4075193981871669, "mean_action_processing_ms": 0.096429541722399, "mean_env_wait_ms": 2.205650416478343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004231691360473633, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.07251763343811035}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2715.502005590426, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2794.9682674476985, -2731.042275619099, -2717.089024283691, -2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5269216426289915, "mean_inference_ms": 0.4075193981871669, "mean_action_processing_ms": 0.096429541722399, "mean_env_wait_ms": 2.205650416478343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004231691360473633, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.07251763343811035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5235720, "num_agent_steps_trained": 5235720, "num_env_steps_sampled": 5235720, "num_env_steps_trained": 5235720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.436493080418, "num_env_steps_trained_throughput_per_sec": 96.436493080418, "timesteps_total": 5235720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5235720, "timers": {"training_iteration_time_ms": 3736.973, "sample_time_ms": 3726.23, "load_time_ms": 0.298, "load_throughput": 1208636.388, "learn_time_ms": 9.664, "learn_throughput": 37251.429, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 5235720, "num_env_steps_trained": 5235720, "num_agent_steps_sampled": 5235720, "num_agent_steps_trained": 5235720}, "done": false, "episodes_total": 1633, "training_iteration": 718, "trial_id": "36440_00000", "date": "2023-07-25_03-13-24", "timestamp": 1690244004, "time_this_iter_s": 11.20193362236023, "time_total_s": 11716.408250808716, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1647.29443192482, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 21.88125, "ram_util_percent": 77.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.34312896728515, "policy_loss": -72036.2421875, "vf_loss": 16791692.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2233.0, "diff_num_grad_updates_vs_sampler_policy": 2232.0}}, "num_env_steps_sampled": 5236800, "num_env_steps_trained": 5236800, "num_agent_steps_sampled": 5236800, "num_agent_steps_trained": 5236800}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2714.3649644501647, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526878547793819, "mean_inference_ms": 0.40751509816785797, "mean_action_processing_ms": 0.09642982524787248, "mean_env_wait_ms": 2.206083754633013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004212856292724609, "StateBufferConnector_ms": 0.0030050277709960938, "ViewRequirementAgentConnector_ms": 0.07261061668395996}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2714.3649644501647, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2734.8542999817946, -2709.0893512980388, -2668.379637397945, -2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526878547793819, "mean_inference_ms": 0.40751509816785797, "mean_action_processing_ms": 0.09642982524787248, "mean_env_wait_ms": 2.206083754633013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004212856292724609, "StateBufferConnector_ms": 0.0030050277709960938, "ViewRequirementAgentConnector_ms": 0.07261061668395996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5236800, "num_agent_steps_trained": 5236800, "num_env_steps_sampled": 5236800, "num_env_steps_trained": 5236800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.63278617866162, "num_env_steps_trained_throughput_per_sec": 95.63278617866162, "timesteps_total": 5236800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5236800, "timers": {"training_iteration_time_ms": 3731.59, "sample_time_ms": 3720.803, "load_time_ms": 0.306, "load_throughput": 1175973.084, "learn_time_ms": 9.691, "learn_throughput": 37146.955, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 5236800, "num_env_steps_trained": 5236800, "num_agent_steps_sampled": 5236800, "num_agent_steps_trained": 5236800}, "done": false, "episodes_total": 1636, "training_iteration": 719, "trial_id": "36440_00000", "date": "2023-07-25_03-13-35", "timestamp": 1690244015, "time_this_iter_s": 11.296095848083496, "time_total_s": 11727.7043466568, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1658.5905277729034, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 24.28125, "ram_util_percent": 77.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.38930969238281, "policy_loss": -74242.4640625, "vf_loss": 16341175.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2248.0, "diff_num_grad_updates_vs_sampler_policy": 2247.0}}, "num_env_steps_sampled": 5237880, "num_env_steps_trained": 5237880, "num_agent_steps_sampled": 5237880, "num_agent_steps_trained": 5237880}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2714.959158668882, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526892647168952, "mean_inference_ms": 0.4075082999547214, "mean_action_processing_ms": 0.09642972289835886, "mean_env_wait_ms": 2.2065036894434034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004214048385620117, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.07262492179870605}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2714.959158668882, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2690.9752878814065, -2672.3587084530886, -2631.504209558091, -2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526892647168952, "mean_inference_ms": 0.4075082999547214, "mean_action_processing_ms": 0.09642972289835886, "mean_env_wait_ms": 2.2065036894434034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004214048385620117, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.07262492179870605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5237880, "num_agent_steps_trained": 5237880, "num_env_steps_sampled": 5237880, "num_env_steps_trained": 5237880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.01579035723309, "num_env_steps_trained_throughput_per_sec": 96.01579035723309, "timesteps_total": 5237880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5237880, "timers": {"training_iteration_time_ms": 3744.217, "sample_time_ms": 3733.322, "load_time_ms": 0.307, "load_throughput": 1172229.982, "learn_time_ms": 9.812, "learn_throughput": 36690.847, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 5237880, "num_env_steps_trained": 5237880, "num_agent_steps_sampled": 5237880, "num_agent_steps_trained": 5237880}, "done": false, "episodes_total": 1639, "training_iteration": 720, "trial_id": "36440_00000", "date": "2023-07-25_03-13-47", "timestamp": 1690244027, "time_this_iter_s": 11.25095009803772, "time_total_s": 11738.955296754837, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1669.8414778709412, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 23.20625, "ram_util_percent": 77.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 98.80155639648437, "policy_loss": -62262.50234375, "vf_loss": 16274314.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2263.0, "diff_num_grad_updates_vs_sampler_policy": 2262.0}}, "num_env_steps_sampled": 5238960, "num_env_steps_trained": 5238960, "num_agent_steps_sampled": 5238960, "num_agent_steps_trained": 5238960}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2717.4151498151764, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526921265796086, "mean_inference_ms": 0.40750170481303577, "mean_action_processing_ms": 0.09642965917816008, "mean_env_wait_ms": 2.206917952520483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00421452522277832, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.07257723808288574}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2717.4151498151764, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2743.1287087378714, -2737.012353156719, -2646.499475478781, -2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526921265796086, "mean_inference_ms": 0.40750170481303577, "mean_action_processing_ms": 0.09642965917816008, "mean_env_wait_ms": 2.206917952520483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00421452522277832, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.07257723808288574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5238960, "num_agent_steps_trained": 5238960, "num_env_steps_sampled": 5238960, "num_env_steps_trained": 5238960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.80239279593413, "num_env_steps_trained_throughput_per_sec": 96.80239279593413, "timesteps_total": 5238960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5238960, "timers": {"training_iteration_time_ms": 3746.813, "sample_time_ms": 3735.984, "load_time_ms": 0.31, "load_throughput": 1161053.01, "learn_time_ms": 9.755, "learn_throughput": 36905.266, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 5238960, "num_env_steps_trained": 5238960, "num_agent_steps_sampled": 5238960, "num_agent_steps_trained": 5238960}, "done": false, "episodes_total": 1642, "training_iteration": 721, "trial_id": "36440_00000", "date": "2023-07-25_03-13-58", "timestamp": 1690244038, "time_this_iter_s": 11.15950608253479, "time_total_s": 11750.114802837372, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1681.000983953476, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 22.953333333333333, "ram_util_percent": 77.71333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.57094268798828, "policy_loss": -70317.58125, "vf_loss": 15741133.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2278.0, "diff_num_grad_updates_vs_sampler_policy": 2277.0}}, "num_env_steps_sampled": 5240040, "num_env_steps_trained": 5240040, "num_agent_steps_sampled": 5240040, "num_agent_steps_trained": 5240040}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2716.7592372107315, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526939497103438, "mean_inference_ms": 0.40749563015186036, "mean_action_processing_ms": 0.09642969192764247, "mean_env_wait_ms": 2.2073475728498493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004199028015136719, "StateBufferConnector_ms": 0.0029959678649902344, "ViewRequirementAgentConnector_ms": 0.07235479354858398}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2716.7592372107315, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2764.115441219058, -2749.4826146130854, -2619.6974839583468, -2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526939497103438, "mean_inference_ms": 0.40749563015186036, "mean_action_processing_ms": 0.09642969192764247, "mean_env_wait_ms": 2.2073475728498493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004199028015136719, "StateBufferConnector_ms": 0.0029959678649902344, "ViewRequirementAgentConnector_ms": 0.07235479354858398}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5240040, "num_agent_steps_trained": 5240040, "num_env_steps_sampled": 5240040, "num_env_steps_trained": 5240040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.67034253903404, "num_env_steps_trained_throughput_per_sec": 96.67034253903404, "timesteps_total": 5240040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5240040, "timers": {"training_iteration_time_ms": 3741.336, "sample_time_ms": 3730.551, "load_time_ms": 0.311, "load_throughput": 1157936.687, "learn_time_ms": 9.705, "learn_throughput": 37094.209, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 5240040, "num_env_steps_trained": 5240040, "num_agent_steps_sampled": 5240040, "num_agent_steps_trained": 5240040}, "done": false, "episodes_total": 1645, "training_iteration": 722, "trial_id": "36440_00000", "date": "2023-07-25_03-14-09", "timestamp": 1690244049, "time_this_iter_s": 11.174853086471558, "time_total_s": 11761.289655923843, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1692.1758370399475, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 24.70625, "ram_util_percent": 77.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.9050537109375, "policy_loss": -71197.11640625, "vf_loss": 16557518.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2293.0, "diff_num_grad_updates_vs_sampler_policy": 2292.0}}, "num_env_steps_sampled": 5241120, "num_env_steps_trained": 5241120, "num_agent_steps_sampled": 5241120, "num_agent_steps_trained": 5241120}, "sampler_results": {"episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2718.027562412588, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526937678146073, "mean_inference_ms": 0.4074879005067625, "mean_action_processing_ms": 0.09642956319917645, "mean_env_wait_ms": 2.2077682857731995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004212141036987305, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.07245588302612305}}, "episode_reward_max": -2611.528177320149, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2718.027562412588, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2759.967582106574, -2611.528177320149, -2677.063382498101, -2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526937678146073, "mean_inference_ms": 0.4074879005067625, "mean_action_processing_ms": 0.09642956319917645, "mean_env_wait_ms": 2.2077682857731995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004212141036987305, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.07245588302612305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5241120, "num_agent_steps_trained": 5241120, "num_env_steps_sampled": 5241120, "num_env_steps_trained": 5241120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.43867981784423, "num_env_steps_trained_throughput_per_sec": 97.43867981784423, "timesteps_total": 5241120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5241120, "timers": {"training_iteration_time_ms": 3720.843, "sample_time_ms": 3710.32, "load_time_ms": 0.302, "load_throughput": 1193635.921, "learn_time_ms": 9.483, "learn_throughput": 37961.224, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 5241120, "num_env_steps_trained": 5241120, "num_agent_steps_sampled": 5241120, "num_agent_steps_trained": 5241120}, "done": false, "episodes_total": 1648, "training_iteration": 723, "trial_id": "36440_00000", "date": "2023-07-25_03-14-20", "timestamp": 1690244060, "time_this_iter_s": 11.086637020111084, "time_total_s": 11772.376292943954, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1703.2624740600586, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 24.168750000000003, "ram_util_percent": 77.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.98214111328124, "policy_loss": -67085.35859375, "vf_loss": 16709602.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2308.0, "diff_num_grad_updates_vs_sampler_policy": 2307.0}}, "num_env_steps_sampled": 5242200, "num_env_steps_trained": 5242200, "num_agent_steps_sampled": 5242200, "num_agent_steps_trained": 5242200}, "sampler_results": {"episode_reward_max": -2624.2014468658967, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2719.263478295547, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5268981559674, "mean_inference_ms": 0.40747960919498366, "mean_action_processing_ms": 0.09642941649064707, "mean_env_wait_ms": 2.2081947231386416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042285919189453125, "StateBufferConnector_ms": 0.0030112266540527344, "ViewRequirementAgentConnector_ms": 0.07272195816040039}}, "episode_reward_max": -2624.2014468658967, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2719.263478295547, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2692.105572366277, -2763.6939456595514, -2699.4701192789134, -2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5268981559674, "mean_inference_ms": 0.40747960919498366, "mean_action_processing_ms": 0.09642941649064707, "mean_env_wait_ms": 2.2081947231386416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042285919189453125, "StateBufferConnector_ms": 0.0030112266540527344, "ViewRequirementAgentConnector_ms": 0.07272195816040039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5242200, "num_agent_steps_trained": 5242200, "num_env_steps_sampled": 5242200, "num_env_steps_trained": 5242200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.73109735794183, "num_env_steps_trained_throughput_per_sec": 96.73109735794183, "timesteps_total": 5242200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5242200, "timers": {"training_iteration_time_ms": 3719.094, "sample_time_ms": 3708.609, "load_time_ms": 0.295, "load_throughput": 1220555.687, "learn_time_ms": 9.459, "learn_throughput": 38060.643, "synch_weights_time_ms": 0.688}, "counters": {"num_env_steps_sampled": 5242200, "num_env_steps_trained": 5242200, "num_agent_steps_sampled": 5242200, "num_agent_steps_trained": 5242200}, "done": false, "episodes_total": 1651, "training_iteration": 724, "trial_id": "36440_00000", "date": "2023-07-25_03-14-31", "timestamp": 1690244071, "time_this_iter_s": 11.167686700820923, "time_total_s": 11783.543979644775, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1714.4301607608795, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 25.012500000000003, "ram_util_percent": 77.55624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.64753112792968, "policy_loss": -66047.41171875, "vf_loss": 16176903.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2323.0, "diff_num_grad_updates_vs_sampler_policy": 2322.0}}, "num_env_steps_sampled": 5243280, "num_env_steps_trained": 5243280, "num_agent_steps_sampled": 5243280, "num_agent_steps_trained": 5243280}, "sampler_results": {"episode_reward_max": -2624.2014468658967, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2719.1053516118664, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526844532577156, "mean_inference_ms": 0.4074722047530262, "mean_action_processing_ms": 0.09642935020760218, "mean_env_wait_ms": 2.2086107316293346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004250764846801758, "StateBufferConnector_ms": 0.003009319305419922, "ViewRequirementAgentConnector_ms": 0.07291078567504883}}, "episode_reward_max": -2624.2014468658967, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2719.1053516118664, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2691.4434118441395, -2676.819734595433, -2671.5606188319093, -2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526844532577156, "mean_inference_ms": 0.4074722047530262, "mean_action_processing_ms": 0.09642935020760218, "mean_env_wait_ms": 2.2086107316293346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004250764846801758, "StateBufferConnector_ms": 0.003009319305419922, "ViewRequirementAgentConnector_ms": 0.07291078567504883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5243280, "num_agent_steps_trained": 5243280, "num_env_steps_sampled": 5243280, "num_env_steps_trained": 5243280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.74162485797139, "num_env_steps_trained_throughput_per_sec": 96.74162485797139, "timesteps_total": 5243280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5243280, "timers": {"training_iteration_time_ms": 3722.793, "sample_time_ms": 3712.282, "load_time_ms": 0.296, "load_throughput": 1217701.161, "learn_time_ms": 9.486, "learn_throughput": 37949.012, "synch_weights_time_ms": 0.685}, "counters": {"num_env_steps_sampled": 5243280, "num_env_steps_trained": 5243280, "num_agent_steps_sampled": 5243280, "num_agent_steps_trained": 5243280}, "done": false, "episodes_total": 1654, "training_iteration": 725, "trial_id": "36440_00000", "date": "2023-07-25_03-14-43", "timestamp": 1690244083, "time_this_iter_s": 11.166574954986572, "time_total_s": 11794.710554599762, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1725.596735715866, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 24.2875, "ram_util_percent": 77.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.50357971191406, "policy_loss": -70226.33359375, "vf_loss": 16441663.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2338.0, "diff_num_grad_updates_vs_sampler_policy": 2337.0}}, "num_env_steps_sampled": 5244360, "num_env_steps_trained": 5244360, "num_agent_steps_sampled": 5244360, "num_agent_steps_trained": 5244360}, "sampler_results": {"episode_reward_max": -2624.2014468658967, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.0909555673425, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526821724485382, "mean_inference_ms": 0.40746506952400013, "mean_action_processing_ms": 0.09642935004593921, "mean_env_wait_ms": 2.209007048467829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248142242431641, "StateBufferConnector_ms": 0.0030095577239990234, "ViewRequirementAgentConnector_ms": 0.07287287712097168}}, "episode_reward_max": -2624.2014468658967, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.0909555673425, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2800.9354917402256, -2791.6200792810278, -2735.3403903633293, -2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526821724485382, "mean_inference_ms": 0.40746506952400013, "mean_action_processing_ms": 0.09642935004593921, "mean_env_wait_ms": 2.209007048467829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248142242431641, "StateBufferConnector_ms": 0.0030095577239990234, "ViewRequirementAgentConnector_ms": 0.07287287712097168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5244360, "num_agent_steps_trained": 5244360, "num_env_steps_sampled": 5244360, "num_env_steps_trained": 5244360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.35549349920048, "num_env_steps_trained_throughput_per_sec": 95.35549349920048, "timesteps_total": 5244360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5244360, "timers": {"training_iteration_time_ms": 3736.799, "sample_time_ms": 3726.304, "load_time_ms": 0.296, "load_throughput": 1217602.968, "learn_time_ms": 9.459, "learn_throughput": 38057.381, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 5244360, "num_env_steps_trained": 5244360, "num_agent_steps_sampled": 5244360, "num_agent_steps_trained": 5244360}, "done": false, "episodes_total": 1657, "training_iteration": 726, "trial_id": "36440_00000", "date": "2023-07-25_03-14-54", "timestamp": 1690244094, "time_this_iter_s": 11.328792095184326, "time_total_s": 11806.039346694946, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1736.9255278110504, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 23.95625, "ram_util_percent": 77.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.94808349609374, "policy_loss": -66442.54921875, "vf_loss": 15934095.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2353.0, "diff_num_grad_updates_vs_sampler_policy": 2352.0}}, "num_env_steps_sampled": 5245440, "num_env_steps_trained": 5245440, "num_agent_steps_sampled": 5245440, "num_agent_steps_trained": 5245440}, "sampler_results": {"episode_reward_max": -2624.2014468658967, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2719.2737213495006, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526763096490388, "mean_inference_ms": 0.407458524362022, "mean_action_processing_ms": 0.09642950092420902, "mean_env_wait_ms": 2.2094076989166256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248380661010742, "StateBufferConnector_ms": 0.0030083656311035156, "ViewRequirementAgentConnector_ms": 0.0729532241821289}}, "episode_reward_max": -2624.2014468658967, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2719.2737213495006, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2626.874490363532, -2701.6311535342247, -2709.673892004801, -2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526763096490388, "mean_inference_ms": 0.407458524362022, "mean_action_processing_ms": 0.09642950092420902, "mean_env_wait_ms": 2.2094076989166256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248380661010742, "StateBufferConnector_ms": 0.0030083656311035156, "ViewRequirementAgentConnector_ms": 0.0729532241821289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5245440, "num_agent_steps_trained": 5245440, "num_env_steps_sampled": 5245440, "num_env_steps_trained": 5245440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.36079406597685, "num_env_steps_trained_throughput_per_sec": 97.36079406597685, "timesteps_total": 5245440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5245440, "timers": {"training_iteration_time_ms": 3717.08, "sample_time_ms": 3706.409, "load_time_ms": 0.301, "load_throughput": 1194674.769, "learn_time_ms": 9.587, "learn_throughput": 37549.162, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 5245440, "num_env_steps_trained": 5245440, "num_agent_steps_sampled": 5245440, "num_agent_steps_trained": 5245440}, "done": false, "episodes_total": 1660, "training_iteration": 727, "trial_id": "36440_00000", "date": "2023-07-25_03-15-05", "timestamp": 1690244105, "time_this_iter_s": 11.09557294845581, "time_total_s": 11817.134919643402, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1748.0211007595062, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 32.54, "ram_util_percent": 77.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.2842529296875, "policy_loss": -71550.41875, "vf_loss": 15585725.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2368.0, "diff_num_grad_updates_vs_sampler_policy": 2367.0}}, "num_env_steps_sampled": 5246520, "num_env_steps_trained": 5246520, "num_agent_steps_sampled": 5246520, "num_agent_steps_trained": 5246520}, "sampler_results": {"episode_reward_max": -2624.2014468658967, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2719.5858428639035, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526697726656834, "mean_inference_ms": 0.4074531518483868, "mean_action_processing_ms": 0.0964298988890574, "mean_env_wait_ms": 2.2098005227779276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004250288009643555, "StateBufferConnector_ms": 0.0030050277709960938, "ViewRequirementAgentConnector_ms": 0.0729835033416748}}, "episode_reward_max": -2624.2014468658967, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2719.5858428639035, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2660.3119004969285, -2708.0939954116975, -2624.2014468658967, -2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526697726656834, "mean_inference_ms": 0.4074531518483868, "mean_action_processing_ms": 0.0964298988890574, "mean_env_wait_ms": 2.2098005227779276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004250288009643555, "StateBufferConnector_ms": 0.0030050277709960938, "ViewRequirementAgentConnector_ms": 0.0729835033416748}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5246520, "num_agent_steps_trained": 5246520, "num_env_steps_sampled": 5246520, "num_env_steps_trained": 5246520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.65692447467923, "num_env_steps_trained_throughput_per_sec": 96.65692447467923, "timesteps_total": 5246520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5246520, "timers": {"training_iteration_time_ms": 3718.473, "sample_time_ms": 3707.781, "load_time_ms": 0.308, "load_throughput": 1168239.412, "learn_time_ms": 9.597, "learn_throughput": 37513.34, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 5246520, "num_env_steps_trained": 5246520, "num_agent_steps_sampled": 5246520, "num_agent_steps_trained": 5246520}, "done": false, "episodes_total": 1663, "training_iteration": 728, "trial_id": "36440_00000", "date": "2023-07-25_03-15-16", "timestamp": 1690244116, "time_this_iter_s": 11.176551103591919, "time_total_s": 11828.311470746994, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1759.1976518630981, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 28.0875, "ram_util_percent": 77.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.6353775024414, "policy_loss": -67455.43671875, "vf_loss": 16235940.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2383.0, "diff_num_grad_updates_vs_sampler_policy": 2382.0}}, "num_env_steps_sampled": 5247600, "num_env_steps_trained": 5247600, "num_agent_steps_sampled": 5247600, "num_agent_steps_trained": 5247600}, "sampler_results": {"episode_reward_max": -2626.1167738139516, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.6525332267506, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5266763393821305, "mean_inference_ms": 0.40744800841829987, "mean_action_processing_ms": 0.09643044892621205, "mean_env_wait_ms": 2.210185270472708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270315170288086, "StateBufferConnector_ms": 0.003019094467163086, "ViewRequirementAgentConnector_ms": 0.07331228256225586}}, "episode_reward_max": -2626.1167738139516, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.6525332267506, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2795.735284796777, -2655.7253749473, -2696.1443624858052, -2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5266763393821305, "mean_inference_ms": 0.40744800841829987, "mean_action_processing_ms": 0.09643044892621205, "mean_env_wait_ms": 2.210185270472708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270315170288086, "StateBufferConnector_ms": 0.003019094467163086, "ViewRequirementAgentConnector_ms": 0.07331228256225586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5247600, "num_agent_steps_trained": 5247600, "num_env_steps_sampled": 5247600, "num_env_steps_trained": 5247600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.81865910330319, "num_env_steps_trained_throughput_per_sec": 94.81865910330319, "timesteps_total": 5247600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5247600, "timers": {"training_iteration_time_ms": 3740.937, "sample_time_ms": 3730.241, "load_time_ms": 0.306, "load_throughput": 1174600.887, "learn_time_ms": 9.604, "learn_throughput": 37485.308, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 5247600, "num_env_steps_trained": 5247600, "num_agent_steps_sampled": 5247600, "num_agent_steps_trained": 5247600}, "done": false, "episodes_total": 1666, "training_iteration": 729, "trial_id": "36440_00000", "date": "2023-07-25_03-15-28", "timestamp": 1690244128, "time_this_iter_s": 11.392945051193237, "time_total_s": 11839.704415798187, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1770.5905969142914, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 24.60625, "ram_util_percent": 77.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.25420227050782, "policy_loss": -66232.28515625, "vf_loss": 16455760.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2398.0, "diff_num_grad_updates_vs_sampler_policy": 2397.0}}, "num_env_steps_sampled": 5248680, "num_env_steps_trained": 5248680, "num_agent_steps_sampled": 5248680, "num_agent_steps_trained": 5248680}, "sampler_results": {"episode_reward_max": -2626.1167738139516, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.1231960240375, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526662327295725, "mean_inference_ms": 0.4074421401958002, "mean_action_processing_ms": 0.0964309253528917, "mean_env_wait_ms": 2.210586200067852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004266500473022461, "StateBufferConnector_ms": 0.0030219554901123047, "ViewRequirementAgentConnector_ms": 0.07328653335571289}}, "episode_reward_max": -2626.1167738139516, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.1231960240375, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2721.144057947383, -2653.0212701315127, -2701.6699176750967, -2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526662327295725, "mean_inference_ms": 0.4074421401958002, "mean_action_processing_ms": 0.0964309253528917, "mean_env_wait_ms": 2.210586200067852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004266500473022461, "StateBufferConnector_ms": 0.0030219554901123047, "ViewRequirementAgentConnector_ms": 0.07328653335571289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5248680, "num_agent_steps_trained": 5248680, "num_env_steps_sampled": 5248680, "num_env_steps_trained": 5248680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.16301980336593, "num_env_steps_trained_throughput_per_sec": 97.16301980336593, "timesteps_total": 5248680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5248680, "timers": {"training_iteration_time_ms": 3737.906, "sample_time_ms": 3727.253, "load_time_ms": 0.306, "load_throughput": 1175515.329, "learn_time_ms": 9.573, "learn_throughput": 37603.961, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 5248680, "num_env_steps_trained": 5248680, "num_agent_steps_sampled": 5248680, "num_agent_steps_trained": 5248680}, "done": false, "episodes_total": 1669, "training_iteration": 730, "trial_id": "36440_00000", "date": "2023-07-25_03-15-39", "timestamp": 1690244139, "time_this_iter_s": 11.118321180343628, "time_total_s": 11850.82273697853, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1781.708918094635, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 24.34375, "ram_util_percent": 78.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.99498291015625, "policy_loss": -63958.6390625, "vf_loss": 15118620.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2413.0, "diff_num_grad_updates_vs_sampler_policy": 2412.0}}, "num_env_steps_sampled": 5249760, "num_env_steps_trained": 5249760, "num_agent_steps_sampled": 5249760, "num_agent_steps_trained": 5249760}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.543497249735, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526658946420665, "mean_inference_ms": 0.4074343747993715, "mean_action_processing_ms": 0.09643123271553317, "mean_env_wait_ms": 2.2109927355814802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004252195358276367, "StateBufferConnector_ms": 0.0030198097229003906, "ViewRequirementAgentConnector_ms": 0.0731651782989502}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.543497249735, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2690.817078554643, -2682.4111319282833, -2746.640380256341, -2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526658946420665, "mean_inference_ms": 0.4074343747993715, "mean_action_processing_ms": 0.09643123271553317, "mean_env_wait_ms": 2.2109927355814802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004252195358276367, "StateBufferConnector_ms": 0.0030198097229003906, "ViewRequirementAgentConnector_ms": 0.0731651782989502}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5249760, "num_agent_steps_trained": 5249760, "num_env_steps_sampled": 5249760, "num_env_steps_trained": 5249760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.15141484219637, "num_env_steps_trained_throughput_per_sec": 97.15141484219637, "timesteps_total": 5249760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5249760, "timers": {"training_iteration_time_ms": 3743.88, "sample_time_ms": 3733.031, "load_time_ms": 0.298, "load_throughput": 1209895.385, "learn_time_ms": 9.791, "learn_throughput": 36768.757, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 5249760, "num_env_steps_trained": 5249760, "num_agent_steps_sampled": 5249760, "num_agent_steps_trained": 5249760}, "done": false, "episodes_total": 1672, "training_iteration": 731, "trial_id": "36440_00000", "date": "2023-07-25_03-15-50", "timestamp": 1690244150, "time_this_iter_s": 11.119426012039185, "time_total_s": 11861.94216299057, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1792.8283441066742, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 24.868750000000002, "ram_util_percent": 77.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.19372863769532, "policy_loss": -68897.26328125, "vf_loss": 15636037.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2428.0, "diff_num_grad_updates_vs_sampler_policy": 2427.0}}, "num_env_steps_sampled": 5250840, "num_env_steps_trained": 5250840, "num_agent_steps_sampled": 5250840, "num_agent_steps_trained": 5250840}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.9840939753003, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526659680934809, "mean_inference_ms": 0.40742745117363377, "mean_action_processing_ms": 0.09643170636577768, "mean_env_wait_ms": 2.2114012681376978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004265308380126953, "StateBufferConnector_ms": 0.0030236244201660156, "ViewRequirementAgentConnector_ms": 0.07325243949890137}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.9840939753003, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2748.175087854952, -2741.34580771053, -2670.8616667685556, -2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526659680934809, "mean_inference_ms": 0.40742745117363377, "mean_action_processing_ms": 0.09643170636577768, "mean_env_wait_ms": 2.2114012681376978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004265308380126953, "StateBufferConnector_ms": 0.0030236244201660156, "ViewRequirementAgentConnector_ms": 0.07325243949890137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5250840, "num_agent_steps_trained": 5250840, "num_env_steps_sampled": 5250840, "num_env_steps_trained": 5250840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.67063755139802, "num_env_steps_trained_throughput_per_sec": 96.67063755139802, "timesteps_total": 5250840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5250840, "timers": {"training_iteration_time_ms": 3721.295, "sample_time_ms": 3710.444, "load_time_ms": 0.3, "load_throughput": 1201519.408, "learn_time_ms": 9.782, "learn_throughput": 36802.812, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 5250840, "num_env_steps_trained": 5250840, "num_agent_steps_sampled": 5250840, "num_agent_steps_trained": 5250840}, "done": false, "episodes_total": 1675, "training_iteration": 732, "trial_id": "36440_00000", "date": "2023-07-25_03-16-01", "timestamp": 1690244161, "time_this_iter_s": 11.174689054489136, "time_total_s": 11873.11685204506, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1804.0030331611633, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 24.9375, "ram_util_percent": 77.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.55294036865234, "policy_loss": -72445.63046875, "vf_loss": 16794746.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2443.0, "diff_num_grad_updates_vs_sampler_policy": 2442.0}}, "num_env_steps_sampled": 5251920, "num_env_steps_trained": 5251920, "num_agent_steps_sampled": 5251920, "num_agent_steps_trained": 5251920}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.1903995609678, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526594521353856, "mean_inference_ms": 0.40742100797814584, "mean_action_processing_ms": 0.09643222723635583, "mean_env_wait_ms": 2.211800869267464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042879581451416016, "StateBufferConnector_ms": 0.003049135208129883, "ViewRequirementAgentConnector_ms": 0.0735480785369873}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.1903995609678, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2817.4727760062547, -2702.826180209133, -2673.328066236556, -2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526594521353856, "mean_inference_ms": 0.40742100797814584, "mean_action_processing_ms": 0.09643222723635583, "mean_env_wait_ms": 2.211800869267464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042879581451416016, "StateBufferConnector_ms": 0.003049135208129883, "ViewRequirementAgentConnector_ms": 0.0735480785369873}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5251920, "num_agent_steps_trained": 5251920, "num_env_steps_sampled": 5251920, "num_env_steps_trained": 5251920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 100.01434514264841, "num_env_steps_trained_throughput_per_sec": 100.01434514264841, "timesteps_total": 5251920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5251920, "timers": {"training_iteration_time_ms": 3692.229, "sample_time_ms": 3681.259, "load_time_ms": 0.301, "load_throughput": 1195052.98, "learn_time_ms": 9.897, "learn_throughput": 36373.894, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 5251920, "num_env_steps_trained": 5251920, "num_agent_steps_sampled": 5251920, "num_agent_steps_trained": 5251920}, "done": false, "episodes_total": 1678, "training_iteration": 733, "trial_id": "36440_00000", "date": "2023-07-25_03-16-12", "timestamp": 1690244172, "time_this_iter_s": 10.801245212554932, "time_total_s": 11883.918097257614, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1814.8042783737183, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 30.71333333333333, "ram_util_percent": 77.50666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.9824722290039, "policy_loss": -73342.34921875, "vf_loss": 16350209.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2458.0, "diff_num_grad_updates_vs_sampler_policy": 2457.0}}, "num_env_steps_sampled": 5253000, "num_env_steps_trained": 5253000, "num_agent_steps_sampled": 5253000, "num_agent_steps_trained": 5253000}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.8737641803828, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526607334818295, "mean_inference_ms": 0.4074125175157175, "mean_action_processing_ms": 0.09643231530000262, "mean_env_wait_ms": 2.2122110539513344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004286527633666992, "StateBufferConnector_ms": 0.003044605255126953, "ViewRequirementAgentConnector_ms": 0.07353448867797852}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.8737641803828, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2662.017693401585, -2724.9688501012474, -2708.0406842911384, -2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526607334818295, "mean_inference_ms": 0.4074125175157175, "mean_action_processing_ms": 0.09643231530000262, "mean_env_wait_ms": 2.2122110539513344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004286527633666992, "StateBufferConnector_ms": 0.003044605255126953, "ViewRequirementAgentConnector_ms": 0.07353448867797852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5253000, "num_agent_steps_trained": 5253000, "num_env_steps_sampled": 5253000, "num_env_steps_trained": 5253000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 94.92128195295112, "num_env_steps_trained_throughput_per_sec": 94.92128195295112, "timesteps_total": 5253000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5253000, "timers": {"training_iteration_time_ms": 3712.287, "sample_time_ms": 3701.68, "load_time_ms": 0.298, "load_throughput": 1207283.473, "learn_time_ms": 9.559, "learn_throughput": 37661.268, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 5253000, "num_env_steps_trained": 5253000, "num_agent_steps_sampled": 5253000, "num_agent_steps_trained": 5253000}, "done": false, "episodes_total": 1681, "training_iteration": 734, "trial_id": "36440_00000", "date": "2023-07-25_03-16-23", "timestamp": 1690244183, "time_this_iter_s": 11.380598068237305, "time_total_s": 11895.298695325851, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1826.1848764419556, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 23.2, "ram_util_percent": 77.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.27294311523437, "policy_loss": -76008.08125, "vf_loss": 16030625.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2473.0, "diff_num_grad_updates_vs_sampler_policy": 2472.0}}, "num_env_steps_sampled": 5254080, "num_env_steps_trained": 5254080, "num_agent_steps_sampled": 5254080, "num_agent_steps_trained": 5254080}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2723.6373153129057, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526650297360587, "mean_inference_ms": 0.4074013893122923, "mean_action_processing_ms": 0.09643191931005698, "mean_env_wait_ms": 2.212610758254014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042765140533447266, "StateBufferConnector_ms": 0.0030379295349121094, "ViewRequirementAgentConnector_ms": 0.07334232330322266}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2723.6373153129057, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2722.0656822668757, -2703.994445684359, -2755.479449841281, -2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526650297360587, "mean_inference_ms": 0.4074013893122923, "mean_action_processing_ms": 0.09643191931005698, "mean_env_wait_ms": 2.212610758254014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042765140533447266, "StateBufferConnector_ms": 0.0030379295349121094, "ViewRequirementAgentConnector_ms": 0.07334232330322266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5254080, "num_agent_steps_trained": 5254080, "num_env_steps_sampled": 5254080, "num_env_steps_trained": 5254080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.9825849199277, "num_env_steps_trained_throughput_per_sec": 96.9825849199277, "timesteps_total": 5254080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5254080, "timers": {"training_iteration_time_ms": 3699.239, "sample_time_ms": 3688.51, "load_time_ms": 0.309, "load_throughput": 1166614.726, "learn_time_ms": 9.653, "learn_throughput": 37294.029, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 5254080, "num_env_steps_trained": 5254080, "num_agent_steps_sampled": 5254080, "num_agent_steps_trained": 5254080}, "done": false, "episodes_total": 1684, "training_iteration": 735, "trial_id": "36440_00000", "date": "2023-07-25_03-16-35", "timestamp": 1690244195, "time_this_iter_s": 11.13915205001831, "time_total_s": 11906.43784737587, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1837.3240284919739, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 25.174999999999997, "ram_util_percent": 77.95625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.7624755859375, "policy_loss": -70341.0890625, "vf_loss": 16087027.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2488.0, "diff_num_grad_updates_vs_sampler_policy": 2487.0}}, "num_env_steps_sampled": 5255160, "num_env_steps_trained": 5255160, "num_agent_steps_sampled": 5255160, "num_agent_steps_trained": 5255160}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.681520771448, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526717051935488, "mean_inference_ms": 0.40739000645782036, "mean_action_processing_ms": 0.09643152565591119, "mean_env_wait_ms": 2.2129954818102022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00426483154296875, "StateBufferConnector_ms": 0.003033161163330078, "ViewRequirementAgentConnector_ms": 0.0731966495513916}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.681520771448, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2760.502079252801, -2735.9694859005626, -2698.2249822572985, -2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526717051935488, "mean_inference_ms": 0.40739000645782036, "mean_action_processing_ms": 0.09643152565591119, "mean_env_wait_ms": 2.2129954818102022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00426483154296875, "StateBufferConnector_ms": 0.003033161163330078, "ViewRequirementAgentConnector_ms": 0.0731966495513916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5255160, "num_agent_steps_trained": 5255160, "num_env_steps_sampled": 5255160, "num_env_steps_trained": 5255160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.73262386867088, "num_env_steps_trained_throughput_per_sec": 96.73262386867088, "timesteps_total": 5255160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5255160, "timers": {"training_iteration_time_ms": 3728.058, "sample_time_ms": 3717.376, "load_time_ms": 0.312, "load_throughput": 1153689.976, "learn_time_ms": 9.624, "learn_throughput": 37405.633, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 5255160, "num_env_steps_trained": 5255160, "num_agent_steps_sampled": 5255160, "num_agent_steps_trained": 5255160}, "done": false, "episodes_total": 1687, "training_iteration": 736, "trial_id": "36440_00000", "date": "2023-07-25_03-16-46", "timestamp": 1690244206, "time_this_iter_s": 11.16769003868103, "time_total_s": 11917.60553741455, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1848.491718530655, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 24.0875, "ram_util_percent": 77.76875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.09563598632812, "policy_loss": -60949.7078125, "vf_loss": 15281988.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2503.0, "diff_num_grad_updates_vs_sampler_policy": 2502.0}}, "num_env_steps_sampled": 5256240, "num_env_steps_trained": 5256240, "num_agent_steps_sampled": 5256240, "num_agent_steps_trained": 5256240}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.29945031114, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52677673086334, "mean_inference_ms": 0.4073798996716422, "mean_action_processing_ms": 0.09643128113157214, "mean_env_wait_ms": 2.213375946370618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042591094970703125, "StateBufferConnector_ms": 0.0029952526092529297, "ViewRequirementAgentConnector_ms": 0.073089599609375}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.29945031114, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2715.9992905852523, -2724.487010154072, -2626.1167738139516, -2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52677673086334, "mean_inference_ms": 0.4073798996716422, "mean_action_processing_ms": 0.09643128113157214, "mean_env_wait_ms": 2.213375946370618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042591094970703125, "StateBufferConnector_ms": 0.0029952526092529297, "ViewRequirementAgentConnector_ms": 0.073089599609375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5256240, "num_agent_steps_trained": 5256240, "num_env_steps_sampled": 5256240, "num_env_steps_trained": 5256240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.91504213538586, "num_env_steps_trained_throughput_per_sec": 96.91504213538586, "timesteps_total": 5256240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5256240, "timers": {"training_iteration_time_ms": 3709.348, "sample_time_ms": 3698.698, "load_time_ms": 0.313, "load_throughput": 1151578.279, "learn_time_ms": 9.585, "learn_throughput": 37558.502, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 5256240, "num_env_steps_trained": 5256240, "num_agent_steps_sampled": 5256240, "num_agent_steps_trained": 5256240}, "done": false, "episodes_total": 1690, "training_iteration": 737, "trial_id": "36440_00000", "date": "2023-07-25_03-16-57", "timestamp": 1690244217, "time_this_iter_s": 11.146560907363892, "time_total_s": 11928.752098321915, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1859.6382794380188, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 23.1375, "ram_util_percent": 77.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.99837036132813, "policy_loss": -72135.440625, "vf_loss": 15967829.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2518.0, "diff_num_grad_updates_vs_sampler_policy": 2517.0}}, "num_env_steps_sampled": 5257320, "num_env_steps_trained": 5257320, "num_agent_steps_sampled": 5257320, "num_agent_steps_trained": 5257320}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.5023399313272, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5268573090566315, "mean_inference_ms": 0.4073706251650225, "mean_action_processing_ms": 0.0964311722592208, "mean_env_wait_ms": 2.213745497382048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004272937774658203, "StateBufferConnector_ms": 0.0030045509338378906, "ViewRequirementAgentConnector_ms": 0.07328367233276367}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.5023399313272, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2758.3881557748578, -2762.629605798612, -2714.512747196906, -2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5268573090566315, "mean_inference_ms": 0.4073706251650225, "mean_action_processing_ms": 0.0964311722592208, "mean_env_wait_ms": 2.213745497382048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004272937774658203, "StateBufferConnector_ms": 0.0030045509338378906, "ViewRequirementAgentConnector_ms": 0.07328367233276367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5257320, "num_agent_steps_trained": 5257320, "num_env_steps_sampled": 5257320, "num_env_steps_trained": 5257320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.47559758027649, "num_env_steps_trained_throughput_per_sec": 95.47559758027649, "timesteps_total": 5257320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5257320, "timers": {"training_iteration_time_ms": 3724.748, "sample_time_ms": 3714.149, "load_time_ms": 0.302, "load_throughput": 1192316.361, "learn_time_ms": 9.539, "learn_throughput": 37738.264, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 5257320, "num_env_steps_trained": 5257320, "num_agent_steps_sampled": 5257320, "num_agent_steps_trained": 5257320}, "done": false, "episodes_total": 1693, "training_iteration": 738, "trial_id": "36440_00000", "date": "2023-07-25_03-17-08", "timestamp": 1690244228, "time_this_iter_s": 11.314663887023926, "time_total_s": 11940.066762208939, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1870.9529433250427, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 23.3375, "ram_util_percent": 77.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 102.09307708740235, "policy_loss": -68530.7359375, "vf_loss": 15677779.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2533.0, "diff_num_grad_updates_vs_sampler_policy": 2532.0}}, "num_env_steps_sampled": 5258400, "num_env_steps_trained": 5258400, "num_agent_steps_sampled": 5258400, "num_agent_steps_trained": 5258400}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.3843029766263, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526956571087564, "mean_inference_ms": 0.4073600270921356, "mean_action_processing_ms": 0.09643079885544464, "mean_env_wait_ms": 2.2140939415633154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004261970520019531, "StateBufferConnector_ms": 0.002989530563354492, "ViewRequirementAgentConnector_ms": 0.07311725616455078}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.3843029766263, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2770.730165924253, -2746.2664744582635, -2709.8567042521245, -2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.526956571087564, "mean_inference_ms": 0.4073600270921356, "mean_action_processing_ms": 0.09643079885544464, "mean_env_wait_ms": 2.2140939415633154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004261970520019531, "StateBufferConnector_ms": 0.002989530563354492, "ViewRequirementAgentConnector_ms": 0.07311725616455078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5258400, "num_agent_steps_trained": 5258400, "num_env_steps_sampled": 5258400, "num_env_steps_trained": 5258400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.98950513507013, "num_env_steps_trained_throughput_per_sec": 95.98950513507013, "timesteps_total": 5258400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5258400, "timers": {"training_iteration_time_ms": 3745.29, "sample_time_ms": 3734.736, "load_time_ms": 0.301, "load_throughput": 1194391.267, "learn_time_ms": 9.495, "learn_throughput": 37914.803, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 5258400, "num_env_steps_trained": 5258400, "num_agent_steps_sampled": 5258400, "num_agent_steps_trained": 5258400}, "done": false, "episodes_total": 1696, "training_iteration": 739, "trial_id": "36440_00000", "date": "2023-07-25_03-17-20", "timestamp": 1690244240, "time_this_iter_s": 11.25402307510376, "time_total_s": 11951.320785284042, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1882.2069664001465, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 23.862499999999997, "ram_util_percent": 77.66875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 102.62975463867187, "policy_loss": -67824.98515625, "vf_loss": 15553847.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2548.0, "diff_num_grad_updates_vs_sampler_policy": 2547.0}}, "num_env_steps_sampled": 5259480, "num_env_steps_trained": 5259480, "num_agent_steps_sampled": 5259480, "num_agent_steps_trained": 5259480}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2720.3032804710733, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527049727359245, "mean_inference_ms": 0.4073490796639561, "mean_action_processing_ms": 0.09643047778198921, "mean_env_wait_ms": 2.214456128303151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004259347915649414, "StateBufferConnector_ms": 0.0029859542846679688, "ViewRequirementAgentConnector_ms": 0.07303237915039062}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2720.3032804710733, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2654.597850777588, -2764.9605397017726, -2768.2372678699517, -2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527049727359245, "mean_inference_ms": 0.4073490796639561, "mean_action_processing_ms": 0.09643047778198921, "mean_env_wait_ms": 2.214456128303151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004259347915649414, "StateBufferConnector_ms": 0.0029859542846679688, "ViewRequirementAgentConnector_ms": 0.07303237915039062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5259480, "num_agent_steps_trained": 5259480, "num_env_steps_sampled": 5259480, "num_env_steps_trained": 5259480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.25327264116923, "num_env_steps_trained_throughput_per_sec": 96.25327264116923, "timesteps_total": 5259480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5259480, "timers": {"training_iteration_time_ms": 3754.484, "sample_time_ms": 3743.811, "load_time_ms": 0.308, "load_throughput": 1169596.778, "learn_time_ms": 9.594, "learn_throughput": 37525.366, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 5259480, "num_env_steps_trained": 5259480, "num_agent_steps_sampled": 5259480, "num_agent_steps_trained": 5259480}, "done": false, "episodes_total": 1699, "training_iteration": 740, "trial_id": "36440_00000", "date": "2023-07-25_03-17-31", "timestamp": 1690244251, "time_this_iter_s": 11.223124980926514, "time_total_s": 11962.543910264969, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1893.430091381073, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 25.64375, "ram_util_percent": 77.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.109814453125, "policy_loss": -67176.425, "vf_loss": 16910839.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2563.0, "diff_num_grad_updates_vs_sampler_policy": 2562.0}}, "num_env_steps_sampled": 5260560, "num_env_steps_trained": 5260560, "num_agent_steps_sampled": 5260560, "num_agent_steps_trained": 5260560}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2720.663354132857, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527132832658944, "mean_inference_ms": 0.40733749079869463, "mean_action_processing_ms": 0.09643009224391999, "mean_env_wait_ms": 2.2148132981206934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042688846588134766, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.07306194305419922}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2720.663354132857, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2759.581557481069, -2676.3092708133245, -2717.394792531554, -2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527132832658944, "mean_inference_ms": 0.40733749079869463, "mean_action_processing_ms": 0.09643009224391999, "mean_env_wait_ms": 2.2148132981206934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042688846588134766, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.07306194305419922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5260560, "num_agent_steps_trained": 5260560, "num_env_steps_sampled": 5260560, "num_env_steps_trained": 5260560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.55861502428179, "num_env_steps_trained_throughput_per_sec": 96.55861502428179, "timesteps_total": 5260560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5260560, "timers": {"training_iteration_time_ms": 3750.332, "sample_time_ms": 3739.638, "load_time_ms": 0.312, "load_throughput": 1154130.887, "learn_time_ms": 9.614, "learn_throughput": 37444.314, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 5260560, "num_env_steps_trained": 5260560, "num_agent_steps_sampled": 5260560, "num_agent_steps_trained": 5260560}, "done": false, "episodes_total": 1702, "training_iteration": 741, "trial_id": "36440_00000", "date": "2023-07-25_03-17-42", "timestamp": 1690244262, "time_this_iter_s": 11.18753981590271, "time_total_s": 11973.731450080872, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1904.6176311969757, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 25.813333333333333, "ram_util_percent": 77.55333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 98.62312164306641, "policy_loss": -64121.27265625, "vf_loss": 16136071.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2578.0, "diff_num_grad_updates_vs_sampler_policy": 2577.0}}, "num_env_steps_sampled": 5261640, "num_env_steps_trained": 5261640, "num_agent_steps_sampled": 5261640, "num_agent_steps_trained": 5261640}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.6388648949023, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527175813011423, "mean_inference_ms": 0.40732552153491824, "mean_action_processing_ms": 0.09642967364079169, "mean_env_wait_ms": 2.215171784918053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042591094970703125, "StateBufferConnector_ms": 0.002996206283569336, "ViewRequirementAgentConnector_ms": 0.07295751571655273}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.6388648949023, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2739.570171293548, -2758.643151017172, -2699.5705665922806, -2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527175813011423, "mean_inference_ms": 0.40732552153491824, "mean_action_processing_ms": 0.09642967364079169, "mean_env_wait_ms": 2.215171784918053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042591094970703125, "StateBufferConnector_ms": 0.002996206283569336, "ViewRequirementAgentConnector_ms": 0.07295751571655273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5261640, "num_agent_steps_trained": 5261640, "num_env_steps_sampled": 5261640, "num_env_steps_trained": 5261640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.8429099177494, "num_env_steps_trained_throughput_per_sec": 96.8429099177494, "timesteps_total": 5261640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5261640, "timers": {"training_iteration_time_ms": 3740.644, "sample_time_ms": 3729.987, "load_time_ms": 0.307, "load_throughput": 1171138.944, "learn_time_ms": 9.599, "learn_throughput": 37502.904, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 5261640, "num_env_steps_trained": 5261640, "num_agent_steps_sampled": 5261640, "num_agent_steps_trained": 5261640}, "done": false, "episodes_total": 1705, "training_iteration": 742, "trial_id": "36440_00000", "date": "2023-07-25_03-17-53", "timestamp": 1690244273, "time_this_iter_s": 11.154845952987671, "time_total_s": 11984.88629603386, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1915.7724771499634, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 24.9875, "ram_util_percent": 77.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.06761016845704, "policy_loss": -70402.22265625, "vf_loss": 16259573.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2593.0, "diff_num_grad_updates_vs_sampler_policy": 2592.0}}, "num_env_steps_sampled": 5262720, "num_env_steps_trained": 5262720, "num_agent_steps_sampled": 5262720, "num_agent_steps_trained": 5262720}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.3933580320177, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527207931934739, "mean_inference_ms": 0.4073158988067756, "mean_action_processing_ms": 0.09642956071995014, "mean_env_wait_ms": 2.2155166707559957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004280805587768555, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.07314538955688477}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2721.3933580320177, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2670.463656594259, -2729.197566718379, -2717.385354345607, -2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527207931934739, "mean_inference_ms": 0.4073158988067756, "mean_action_processing_ms": 0.09642956071995014, "mean_env_wait_ms": 2.2155166707559957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004280805587768555, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.07314538955688477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5262720, "num_agent_steps_trained": 5262720, "num_env_steps_sampled": 5262720, "num_env_steps_trained": 5262720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.48741296591855, "num_env_steps_trained_throughput_per_sec": 96.48741296591855, "timesteps_total": 5262720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5262720, "timers": {"training_iteration_time_ms": 3733.875, "sample_time_ms": 3723.222, "load_time_ms": 0.302, "load_throughput": 1192128.091, "learn_time_ms": 9.583, "learn_throughput": 37565.043, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 5262720, "num_env_steps_trained": 5262720, "num_agent_steps_sampled": 5262720, "num_agent_steps_trained": 5262720}, "done": false, "episodes_total": 1708, "training_iteration": 743, "trial_id": "36440_00000", "date": "2023-07-25_03-18-04", "timestamp": 1690244284, "time_this_iter_s": 11.195914030075073, "time_total_s": 11996.082210063934, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1926.9683911800385, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 23.293750000000003, "ram_util_percent": 77.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.93578186035157, "policy_loss": -69111.36953125, "vf_loss": 16178909.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2608.0, "diff_num_grad_updates_vs_sampler_policy": 2607.0}}, "num_env_steps_sampled": 5263800, "num_env_steps_trained": 5263800, "num_agent_steps_sampled": 5263800, "num_agent_steps_trained": 5263800}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.316279154955, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52726170458199, "mean_inference_ms": 0.40730375493199117, "mean_action_processing_ms": 0.09642898304419449, "mean_env_wait_ms": 2.2158546501464906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004278898239135742, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.07310295104980469}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.316279154955, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2696.8473549758655, -2739.86201928941, -2729.7182400069487, -2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52726170458199, "mean_inference_ms": 0.40730375493199117, "mean_action_processing_ms": 0.09642898304419449, "mean_env_wait_ms": 2.2158546501464906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004278898239135742, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.07310295104980469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5263800, "num_agent_steps_trained": 5263800, "num_env_steps_sampled": 5263800, "num_env_steps_trained": 5263800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.82448529581153, "num_env_steps_trained_throughput_per_sec": 95.82448529581153, "timesteps_total": 5263800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5263800, "timers": {"training_iteration_time_ms": 3724.68, "sample_time_ms": 3714.04, "load_time_ms": 0.299, "load_throughput": 1205259.77, "learn_time_ms": 9.584, "learn_throughput": 37563.08, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 5263800, "num_env_steps_trained": 5263800, "num_agent_steps_sampled": 5263800, "num_agent_steps_trained": 5263800}, "done": false, "episodes_total": 1711, "training_iteration": 744, "trial_id": "36440_00000", "date": "2023-07-25_03-18-16", "timestamp": 1690244296, "time_this_iter_s": 11.27333402633667, "time_total_s": 12007.355544090271, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1938.2417252063751, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 23.8125, "ram_util_percent": 77.86875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 102.22586822509766, "policy_loss": -67049.703125, "vf_loss": 15381457.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2623.0, "diff_num_grad_updates_vs_sampler_policy": 2622.0}}, "num_env_steps_sampled": 5264880, "num_env_steps_trained": 5264880, "num_agent_steps_sampled": 5264880, "num_agent_steps_trained": 5264880}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.472196011311, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527315751790997, "mean_inference_ms": 0.40729194426593146, "mean_action_processing_ms": 0.09642846904679747, "mean_env_wait_ms": 2.2161968214488383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004256010055541992, "StateBufferConnector_ms": 0.0030045509338378906, "ViewRequirementAgentConnector_ms": 0.07309818267822266}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.472196011311, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2694.714061120025, -2652.7186047928967, -2754.921177227394, -2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527315751790997, "mean_inference_ms": 0.40729194426593146, "mean_action_processing_ms": 0.09642846904679747, "mean_env_wait_ms": 2.2161968214488383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004256010055541992, "StateBufferConnector_ms": 0.0030045509338378906, "ViewRequirementAgentConnector_ms": 0.07309818267822266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5264880, "num_agent_steps_trained": 5264880, "num_env_steps_sampled": 5264880, "num_env_steps_trained": 5264880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.0321498419667, "num_env_steps_trained_throughput_per_sec": 96.0321498419667, "timesteps_total": 5264880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5264880, "timers": {"training_iteration_time_ms": 3725.627, "sample_time_ms": 3715.004, "load_time_ms": 0.299, "load_throughput": 1202859.428, "learn_time_ms": 9.567, "learn_throughput": 37628.419, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 5264880, "num_env_steps_trained": 5264880, "num_agent_steps_sampled": 5264880, "num_agent_steps_trained": 5264880}, "done": false, "episodes_total": 1714, "training_iteration": 745, "trial_id": "36440_00000", "date": "2023-07-25_03-18-27", "timestamp": 1690244307, "time_this_iter_s": 11.24942684173584, "time_total_s": 12018.604970932007, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1949.491152048111, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 22.90625, "ram_util_percent": 77.76875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.07683868408203, "policy_loss": -72253.525, "vf_loss": 16647608.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2638.0, "diff_num_grad_updates_vs_sampler_policy": 2637.0}}, "num_env_steps_sampled": 5265960, "num_env_steps_trained": 5265960, "num_agent_steps_sampled": 5265960, "num_agent_steps_trained": 5265960}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.972253296645, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527363029065302, "mean_inference_ms": 0.40728058175742055, "mean_action_processing_ms": 0.0964279612759964, "mean_env_wait_ms": 2.216525466871066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224061965942383, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.07293343544006348}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2722.972253296645, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2659.306182997888, -2781.5623400202417, -2685.3958463369027, -2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527363029065302, "mean_inference_ms": 0.40728058175742055, "mean_action_processing_ms": 0.0964279612759964, "mean_env_wait_ms": 2.216525466871066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224061965942383, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.07293343544006348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5265960, "num_agent_steps_trained": 5265960, "num_env_steps_sampled": 5265960, "num_env_steps_trained": 5265960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.97775138143867, "num_env_steps_trained_throughput_per_sec": 96.97775138143867, "timesteps_total": 5265960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5265960, "timers": {"training_iteration_time_ms": 3727.053, "sample_time_ms": 3716.471, "load_time_ms": 0.3, "load_throughput": 1201328.22, "learn_time_ms": 9.538, "learn_throughput": 37742.225, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 5265960, "num_env_steps_trained": 5265960, "num_agent_steps_sampled": 5265960, "num_agent_steps_trained": 5265960}, "done": false, "episodes_total": 1717, "training_iteration": 746, "trial_id": "36440_00000", "date": "2023-07-25_03-18-38", "timestamp": 1690244318, "time_this_iter_s": 11.139526128768921, "time_total_s": 12029.744497060776, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1960.6306781768799, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 25.362499999999997, "ram_util_percent": 78.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.78397674560547, "policy_loss": -71842.8125, "vf_loss": 16621742.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2653.0, "diff_num_grad_updates_vs_sampler_policy": 2652.0}}, "num_env_steps_sampled": 5267040, "num_env_steps_trained": 5267040, "num_agent_steps_sampled": 5267040, "num_agent_steps_trained": 5267040}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2723.4451951864826, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527444698418751, "mean_inference_ms": 0.40726750204016887, "mean_action_processing_ms": 0.09642701219634216, "mean_env_wait_ms": 2.2168457552747687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004205226898193359, "StateBufferConnector_ms": 0.0029938220977783203, "ViewRequirementAgentConnector_ms": 0.07265353202819824}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2823.2705799200858, "episode_reward_mean": -2723.4451951864826, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2755.8171992653283, -2794.200802754804, -2823.2705799200858, -2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527444698418751, "mean_inference_ms": 0.40726750204016887, "mean_action_processing_ms": 0.09642701219634216, "mean_env_wait_ms": 2.2168457552747687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004205226898193359, "StateBufferConnector_ms": 0.0029938220977783203, "ViewRequirementAgentConnector_ms": 0.07265353202819824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5267040, "num_agent_steps_trained": 5267040, "num_env_steps_sampled": 5267040, "num_env_steps_trained": 5267040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.29017724587483, "num_env_steps_trained_throughput_per_sec": 95.29017724587483, "timesteps_total": 5267040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5267040, "timers": {"training_iteration_time_ms": 3744.737, "sample_time_ms": 3734.24, "load_time_ms": 0.297, "load_throughput": 1212518.622, "learn_time_ms": 9.457, "learn_throughput": 38067.744, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 5267040, "num_env_steps_trained": 5267040, "num_agent_steps_sampled": 5267040, "num_agent_steps_trained": 5267040}, "done": false, "episodes_total": 1720, "training_iteration": 747, "trial_id": "36440_00000", "date": "2023-07-25_03-18-50", "timestamp": 1690244330, "time_this_iter_s": 11.336593866348267, "time_total_s": 12041.081090927124, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1971.9672720432281, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 23.15, "ram_util_percent": 77.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.20828094482422, "policy_loss": -74997.7421875, "vf_loss": 16687268.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2668.0, "diff_num_grad_updates_vs_sampler_policy": 2667.0}}, "num_env_steps_sampled": 5268120, "num_env_steps_trained": 5268120, "num_agent_steps_sampled": 5268120, "num_agent_steps_trained": 5268120}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2721.2617093982713, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527516827516734, "mean_inference_ms": 0.40725478569039936, "mean_action_processing_ms": 0.09642609968998887, "mean_env_wait_ms": 2.2171596331894308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004217386245727539, "StateBufferConnector_ms": 0.0029914379119873047, "ViewRequirementAgentConnector_ms": 0.0726463794708252}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2721.2617093982713, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2755.005641203919, -2805.9134549471573, -2692.8166545455374, -2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527516827516734, "mean_inference_ms": 0.40725478569039936, "mean_action_processing_ms": 0.09642609968998887, "mean_env_wait_ms": 2.2171596331894308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004217386245727539, "StateBufferConnector_ms": 0.0029914379119873047, "ViewRequirementAgentConnector_ms": 0.0726463794708252}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5268120, "num_agent_steps_trained": 5268120, "num_env_steps_sampled": 5268120, "num_env_steps_trained": 5268120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.7901954616314, "num_env_steps_trained_throughput_per_sec": 96.7901954616314, "timesteps_total": 5268120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5268120, "timers": {"training_iteration_time_ms": 3745.317, "sample_time_ms": 3734.843, "load_time_ms": 0.299, "load_throughput": 1205933.584, "learn_time_ms": 9.425, "learn_throughput": 38195.142, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 5268120, "num_env_steps_trained": 5268120, "num_agent_steps_sampled": 5268120, "num_agent_steps_trained": 5268120}, "done": false, "episodes_total": 1723, "training_iteration": 748, "trial_id": "36440_00000", "date": "2023-07-25_03-19-01", "timestamp": 1690244341, "time_this_iter_s": 11.161020994186401, "time_total_s": 12052.24211192131, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1983.1282930374146, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 23.825, "ram_util_percent": 77.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.17327270507812, "policy_loss": -78241.49765625, "vf_loss": 17188809.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2683.0, "diff_num_grad_updates_vs_sampler_policy": 2682.0}}, "num_env_steps_sampled": 5269200, "num_env_steps_trained": 5269200, "num_agent_steps_sampled": 5269200, "num_agent_steps_trained": 5269200}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2720.2966235420718, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527568063036284, "mean_inference_ms": 0.40724195484009795, "mean_action_processing_ms": 0.09642512318057878, "mean_env_wait_ms": 2.2174759877573322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004212617874145508, "StateBufferConnector_ms": 0.0029935836791992188, "ViewRequirementAgentConnector_ms": 0.07250285148620605}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2720.2966235420718, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2674.8264287678903, -2776.208191119656, -2747.721100131472, -2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527568063036284, "mean_inference_ms": 0.40724195484009795, "mean_action_processing_ms": 0.09642512318057878, "mean_env_wait_ms": 2.2174759877573322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004212617874145508, "StateBufferConnector_ms": 0.0029935836791992188, "ViewRequirementAgentConnector_ms": 0.07250285148620605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5269200, "num_agent_steps_trained": 5269200, "num_env_steps_sampled": 5269200, "num_env_steps_trained": 5269200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.61726962909542, "num_env_steps_trained_throughput_per_sec": 96.61726962909542, "timesteps_total": 5269200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5269200, "timers": {"training_iteration_time_ms": 3743.012, "sample_time_ms": 3732.541, "load_time_ms": 0.302, "load_throughput": 1191469.613, "learn_time_ms": 9.431, "learn_throughput": 38170.713, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 5269200, "num_env_steps_trained": 5269200, "num_agent_steps_sampled": 5269200, "num_agent_steps_trained": 5269200}, "done": false, "episodes_total": 1726, "training_iteration": 749, "trial_id": "36440_00000", "date": "2023-07-25_03-19-12", "timestamp": 1690244352, "time_this_iter_s": 11.180931806564331, "time_total_s": 12063.423043727875, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1994.3092248439789, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 26.50625, "ram_util_percent": 77.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.49191741943359, "policy_loss": -72245.45, "vf_loss": 16312685.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2698.0, "diff_num_grad_updates_vs_sampler_policy": 2697.0}}, "num_env_steps_sampled": 5270280, "num_env_steps_trained": 5270280, "num_agent_steps_sampled": 5270280, "num_agent_steps_trained": 5270280}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2718.98308234356, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527607931077969, "mean_inference_ms": 0.40722943466424577, "mean_action_processing_ms": 0.09642416286776631, "mean_env_wait_ms": 2.217790955709209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004201650619506836, "StateBufferConnector_ms": 0.002988100051879883, "ViewRequirementAgentConnector_ms": 0.07245755195617676}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2718.98308234356, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2670.0273648893303, -2654.9293404896725, -2745.696189437123, -2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527607931077969, "mean_inference_ms": 0.40722943466424577, "mean_action_processing_ms": 0.09642416286776631, "mean_env_wait_ms": 2.217790955709209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004201650619506836, "StateBufferConnector_ms": 0.002988100051879883, "ViewRequirementAgentConnector_ms": 0.07245755195617676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5270280, "num_agent_steps_trained": 5270280, "num_env_steps_sampled": 5270280, "num_env_steps_trained": 5270280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.29561575614838, "num_env_steps_trained_throughput_per_sec": 96.29561575614838, "timesteps_total": 5270280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5270280, "timers": {"training_iteration_time_ms": 3740.457, "sample_time_ms": 3729.983, "load_time_ms": 0.303, "load_throughput": 1186321.056, "learn_time_ms": 9.433, "learn_throughput": 38162.224, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 5270280, "num_env_steps_trained": 5270280, "num_agent_steps_sampled": 5270280, "num_agent_steps_trained": 5270280}, "done": false, "episodes_total": 1729, "training_iteration": 750, "trial_id": "36440_00000", "date": "2023-07-25_03-19-23", "timestamp": 1690244363, "time_this_iter_s": 11.218153953552246, "time_total_s": 12074.641197681427, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2005.5273787975311, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 22.96875, "ram_util_percent": 77.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.8936996459961, "policy_loss": -71993.84765625, "vf_loss": 15575594.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2713.0, "diff_num_grad_updates_vs_sampler_policy": 2712.0}}, "num_env_steps_sampled": 5271360, "num_env_steps_trained": 5271360, "num_agent_steps_sampled": 5271360, "num_agent_steps_trained": 5271360}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2719.35279075063, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527623174970255, "mean_inference_ms": 0.40721809655933894, "mean_action_processing_ms": 0.09642339154585815, "mean_env_wait_ms": 2.2181058213843943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004208087921142578, "StateBufferConnector_ms": 0.0029900074005126953, "ViewRequirementAgentConnector_ms": 0.07246088981628418}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2719.35279075063, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2692.7087909545935, -2656.44851985662, -2705.3244873280696, -2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527623174970255, "mean_inference_ms": 0.40721809655933894, "mean_action_processing_ms": 0.09642339154585815, "mean_env_wait_ms": 2.2181058213843943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004208087921142578, "StateBufferConnector_ms": 0.0029900074005126953, "ViewRequirementAgentConnector_ms": 0.07246088981628418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5271360, "num_agent_steps_trained": 5271360, "num_env_steps_sampled": 5271360, "num_env_steps_trained": 5271360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.29967436596345, "num_env_steps_trained_throughput_per_sec": 97.29967436596345, "timesteps_total": 5271360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5271360, "timers": {"training_iteration_time_ms": 3727.428, "sample_time_ms": 3716.857, "load_time_ms": 0.304, "load_throughput": 1184738.674, "learn_time_ms": 9.508, "learn_throughput": 37864.697, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 5271360, "num_env_steps_trained": 5271360, "num_agent_steps_sampled": 5271360, "num_agent_steps_trained": 5271360}, "done": false, "episodes_total": 1732, "training_iteration": 751, "trial_id": "36440_00000", "date": "2023-07-25_03-19-34", "timestamp": 1690244374, "time_this_iter_s": 11.102674961090088, "time_total_s": 12085.743872642517, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2016.6300537586212, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 27.993333333333336, "ram_util_percent": 77.85333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.53980560302735, "policy_loss": -70658.03515625, "vf_loss": 16418207.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2728.0, "diff_num_grad_updates_vs_sampler_policy": 2727.0}}, "num_env_steps_sampled": 5272440, "num_env_steps_trained": 5272440, "num_agent_steps_sampled": 5272440, "num_agent_steps_trained": 5272440}, "sampler_results": {"episode_reward_max": -2622.2775937191786, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2719.752781748905, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527644426677114, "mean_inference_ms": 0.4072055402222553, "mean_action_processing_ms": 0.09642238567738579, "mean_env_wait_ms": 2.2184073128102213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004201412200927734, "StateBufferConnector_ms": 0.00299072265625, "ViewRequirementAgentConnector_ms": 0.07239103317260742}}, "episode_reward_max": -2622.2775937191786, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2719.752781748905, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2767.622446139651, -2729.2320202081564, -2708.0689164812347, -2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527644426677114, "mean_inference_ms": 0.4072055402222553, "mean_action_processing_ms": 0.09642238567738579, "mean_env_wait_ms": 2.2184073128102213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004201412200927734, "StateBufferConnector_ms": 0.00299072265625, "ViewRequirementAgentConnector_ms": 0.07239103317260742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5272440, "num_agent_steps_trained": 5272440, "num_env_steps_sampled": 5272440, "num_env_steps_trained": 5272440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.04185784247781, "num_env_steps_trained_throughput_per_sec": 96.04185784247781, "timesteps_total": 5272440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5272440, "timers": {"training_iteration_time_ms": 3736.012, "sample_time_ms": 3725.382, "load_time_ms": 0.306, "load_throughput": 1174692.267, "learn_time_ms": 9.559, "learn_throughput": 37660.141, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 5272440, "num_env_steps_trained": 5272440, "num_agent_steps_sampled": 5272440, "num_agent_steps_trained": 5272440}, "done": false, "episodes_total": 1735, "training_iteration": 752, "trial_id": "36440_00000", "date": "2023-07-25_03-19-46", "timestamp": 1690244386, "time_this_iter_s": 11.2479829788208, "time_total_s": 12096.991855621338, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2027.878036737442, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 23.537499999999998, "ram_util_percent": 77.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 102.03435668945312, "policy_loss": -70923.13671875, "vf_loss": 14954556.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2743.0, "diff_num_grad_updates_vs_sampler_policy": 2742.0}}, "num_env_steps_sampled": 5273520, "num_env_steps_trained": 5273520, "num_agent_steps_sampled": 5273520, "num_agent_steps_trained": 5273520}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2717.3880668071483, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527647499263934, "mean_inference_ms": 0.4071927648334086, "mean_action_processing_ms": 0.09642136220172373, "mean_env_wait_ms": 2.2186979036567944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004178762435913086, "StateBufferConnector_ms": 0.0030040740966796875, "ViewRequirementAgentConnector_ms": 0.07219123840332031}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2717.3880668071483, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2734.4417738601064, -2739.6366122922936, -2767.5409052728323, -2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527647499263934, "mean_inference_ms": 0.4071927648334086, "mean_action_processing_ms": 0.09642136220172373, "mean_env_wait_ms": 2.2186979036567944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004178762435913086, "StateBufferConnector_ms": 0.0030040740966796875, "ViewRequirementAgentConnector_ms": 0.07219123840332031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5273520, "num_agent_steps_trained": 5273520, "num_env_steps_sampled": 5273520, "num_env_steps_trained": 5273520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.21946914031611, "num_env_steps_trained_throughput_per_sec": 97.21946914031611, "timesteps_total": 5273520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5273520, "timers": {"training_iteration_time_ms": 3707.834, "sample_time_ms": 3697.141, "load_time_ms": 0.302, "load_throughput": 1190999.716, "learn_time_ms": 9.618, "learn_throughput": 37428.72, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 5273520, "num_env_steps_trained": 5273520, "num_agent_steps_sampled": 5273520, "num_agent_steps_trained": 5273520}, "done": false, "episodes_total": 1738, "training_iteration": 753, "trial_id": "36440_00000", "date": "2023-07-25_03-19-57", "timestamp": 1690244397, "time_this_iter_s": 11.111698389053345, "time_total_s": 12108.103554010391, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2038.9897351264954, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 23.174999999999997, "ram_util_percent": 77.39375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.66896362304688, "policy_loss": -64951.4125, "vf_loss": 16026242.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2758.0, "diff_num_grad_updates_vs_sampler_policy": 2757.0}}, "num_env_steps_sampled": 5274600, "num_env_steps_trained": 5274600, "num_agent_steps_sampled": 5274600, "num_agent_steps_trained": 5274600}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2715.2335946644835, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527635140395908, "mean_inference_ms": 0.4071804831880874, "mean_action_processing_ms": 0.09642035259854596, "mean_env_wait_ms": 2.219002342147484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004178285598754883, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.07220911979675293}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2715.2335946644835, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2733.2598029568358, -2637.8498269433017, -2728.476959224456, -2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527635140395908, "mean_inference_ms": 0.4071804831880874, "mean_action_processing_ms": 0.09642035259854596, "mean_env_wait_ms": 2.219002342147484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004178285598754883, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.07220911979675293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5274600, "num_agent_steps_trained": 5274600, "num_env_steps_sampled": 5274600, "num_env_steps_trained": 5274600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.39804865940619, "num_env_steps_trained_throughput_per_sec": 96.39804865940619, "timesteps_total": 5274600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5274600, "timers": {"training_iteration_time_ms": 3713.779, "sample_time_ms": 3703.054, "load_time_ms": 0.3, "load_throughput": 1198562.819, "learn_time_ms": 9.648, "learn_throughput": 37314.028, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 5274600, "num_env_steps_trained": 5274600, "num_agent_steps_sampled": 5274600, "num_agent_steps_trained": 5274600}, "done": false, "episodes_total": 1741, "training_iteration": 754, "trial_id": "36440_00000", "date": "2023-07-25_03-20-08", "timestamp": 1690244408, "time_this_iter_s": 11.206341743469238, "time_total_s": 12119.30989575386, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2050.1960768699646, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 24.575, "ram_util_percent": 77.73124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.53057098388672, "policy_loss": -64801.5671875, "vf_loss": 16053004.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2773.0, "diff_num_grad_updates_vs_sampler_policy": 2772.0}}, "num_env_steps_sampled": 5275680, "num_env_steps_trained": 5275680, "num_agent_steps_sampled": 5275680, "num_agent_steps_trained": 5275680}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2715.354005303344, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52765206390442, "mean_inference_ms": 0.407168817355183, "mean_action_processing_ms": 0.09641942116225541, "mean_env_wait_ms": 2.2192988123274615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004155874252319336, "StateBufferConnector_ms": 0.002991199493408203, "ViewRequirementAgentConnector_ms": 0.07193589210510254}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2715.354005303344, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2694.7224907612144, -2764.7197462372196, -2711.085724830205, -2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52765206390442, "mean_inference_ms": 0.407168817355183, "mean_action_processing_ms": 0.09641942116225541, "mean_env_wait_ms": 2.2192988123274615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004155874252319336, "StateBufferConnector_ms": 0.002991199493408203, "ViewRequirementAgentConnector_ms": 0.07193589210510254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5275680, "num_agent_steps_trained": 5275680, "num_env_steps_sampled": 5275680, "num_env_steps_trained": 5275680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.30226810162044, "num_env_steps_trained_throughput_per_sec": 95.30226810162044, "timesteps_total": 5275680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5275680, "timers": {"training_iteration_time_ms": 3735.142, "sample_time_ms": 3724.43, "load_time_ms": 0.295, "load_throughput": 1222334.202, "learn_time_ms": 9.657, "learn_throughput": 37280.309, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 5275680, "num_env_steps_trained": 5275680, "num_agent_steps_sampled": 5275680, "num_agent_steps_trained": 5275680}, "done": false, "episodes_total": 1744, "training_iteration": 755, "trial_id": "36440_00000", "date": "2023-07-25_03-20-19", "timestamp": 1690244419, "time_this_iter_s": 11.33519172668457, "time_total_s": 12130.645087480545, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2061.531268596649, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 23.45, "ram_util_percent": 77.53125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.24032440185547, "policy_loss": -68773.2, "vf_loss": 16848336.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2788.0, "diff_num_grad_updates_vs_sampler_policy": 2787.0}}, "num_env_steps_sampled": 5276760, "num_env_steps_trained": 5276760, "num_agent_steps_sampled": 5276760, "num_agent_steps_trained": 5276760}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2714.6622801035883, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527688650507445, "mean_inference_ms": 0.40715704728079516, "mean_action_processing_ms": 0.09641849739988913, "mean_env_wait_ms": 2.219578773680298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004139900207519531, "StateBufferConnector_ms": 0.002989530563354492, "ViewRequirementAgentConnector_ms": 0.07184076309204102}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2714.6622801035883, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2784.3225889087344, -2692.5472678707747, -2735.322541565938, -2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527688650507445, "mean_inference_ms": 0.40715704728079516, "mean_action_processing_ms": 0.09641849739988913, "mean_env_wait_ms": 2.219578773680298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004139900207519531, "StateBufferConnector_ms": 0.002989530563354492, "ViewRequirementAgentConnector_ms": 0.07184076309204102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5276760, "num_agent_steps_trained": 5276760, "num_env_steps_sampled": 5276760, "num_env_steps_trained": 5276760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.91816488873647, "num_env_steps_trained_throughput_per_sec": 96.91816488873647, "timesteps_total": 5276760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5276760, "timers": {"training_iteration_time_ms": 3736.393, "sample_time_ms": 3725.446, "load_time_ms": 0.3, "load_throughput": 1201901.966, "learn_time_ms": 9.869, "learn_throughput": 36478.024, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 5276760, "num_env_steps_trained": 5276760, "num_agent_steps_sampled": 5276760, "num_agent_steps_trained": 5276760}, "done": false, "episodes_total": 1747, "training_iteration": 756, "trial_id": "36440_00000", "date": "2023-07-25_03-20-30", "timestamp": 1690244430, "time_this_iter_s": 11.146548986434937, "time_total_s": 12141.79163646698, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2072.677817583084, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 24.13125, "ram_util_percent": 77.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.57985382080078, "policy_loss": -71577.3421875, "vf_loss": 17200416.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2803.0, "diff_num_grad_updates_vs_sampler_policy": 2802.0}}, "num_env_steps_sampled": 5277840, "num_env_steps_trained": 5277840, "num_agent_steps_sampled": 5277840, "num_agent_steps_trained": 5277840}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2714.941359395058, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527737784826153, "mean_inference_ms": 0.40714798146537573, "mean_action_processing_ms": 0.09641821348989132, "mean_env_wait_ms": 2.219871299537893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004130125045776367, "StateBufferConnector_ms": 0.0029888153076171875, "ViewRequirementAgentConnector_ms": 0.07173681259155273}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2714.941359395058, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2744.280920783946, -2700.4595467948648, -2737.36351986476, -2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527737784826153, "mean_inference_ms": 0.40714798146537573, "mean_action_processing_ms": 0.09641821348989132, "mean_env_wait_ms": 2.219871299537893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004130125045776367, "StateBufferConnector_ms": 0.0029888153076171875, "ViewRequirementAgentConnector_ms": 0.07173681259155273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5277840, "num_agent_steps_trained": 5277840, "num_env_steps_sampled": 5277840, "num_env_steps_trained": 5277840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.20241762550411, "num_env_steps_trained_throughput_per_sec": 95.20241762550411, "timesteps_total": 5277840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5277840, "timers": {"training_iteration_time_ms": 3763.448, "sample_time_ms": 3752.495, "load_time_ms": 0.299, "load_throughput": 1202667.814, "learn_time_ms": 9.859, "learn_throughput": 36513.838, "synch_weights_time_ms": 0.748}, "counters": {"num_env_steps_sampled": 5277840, "num_env_steps_trained": 5277840, "num_agent_steps_sampled": 5277840, "num_agent_steps_trained": 5277840}, "done": false, "episodes_total": 1750, "training_iteration": 757, "trial_id": "36440_00000", "date": "2023-07-25_03-20-42", "timestamp": 1690244442, "time_this_iter_s": 11.347516059875488, "time_total_s": 12153.139152526855, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2084.0253336429596, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 24.0, "ram_util_percent": 77.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.37357635498047, "policy_loss": -69935.0515625, "vf_loss": 15697094.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2818.0, "diff_num_grad_updates_vs_sampler_policy": 2817.0}}, "num_env_steps_sampled": 5278920, "num_env_steps_trained": 5278920, "num_agent_steps_sampled": 5278920, "num_agent_steps_trained": 5278920}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2714.366390365343, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527804502044046, "mean_inference_ms": 0.40713866679546634, "mean_action_processing_ms": 0.09641790509147499, "mean_env_wait_ms": 2.220154277722821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041141510009765625, "StateBufferConnector_ms": 0.0029838085174560547, "ViewRequirementAgentConnector_ms": 0.07164978981018066}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2714.366390365343, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2701.6339022770762, -2806.1554294385614, -2689.179064536154, -2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527804502044046, "mean_inference_ms": 0.40713866679546634, "mean_action_processing_ms": 0.09641790509147499, "mean_env_wait_ms": 2.220154277722821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041141510009765625, "StateBufferConnector_ms": 0.0029838085174560547, "ViewRequirementAgentConnector_ms": 0.07164978981018066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5278920, "num_agent_steps_trained": 5278920, "num_env_steps_sampled": 5278920, "num_env_steps_trained": 5278920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.11606626416804, "num_env_steps_trained_throughput_per_sec": 96.11606626416804, "timesteps_total": 5278920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5278920, "timers": {"training_iteration_time_ms": 3758.29, "sample_time_ms": 3747.402, "load_time_ms": 0.3, "load_throughput": 1198182.384, "learn_time_ms": 9.798, "learn_throughput": 36742.542, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 5278920, "num_env_steps_trained": 5278920, "num_agent_steps_sampled": 5278920, "num_agent_steps_trained": 5278920}, "done": false, "episodes_total": 1753, "training_iteration": 758, "trial_id": "36440_00000", "date": "2023-07-25_03-20-53", "timestamp": 1690244453, "time_this_iter_s": 11.239085912704468, "time_total_s": 12164.37823843956, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2095.264419555664, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 24.03125, "ram_util_percent": 77.58749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.19313354492188, "policy_loss": -72735.6546875, "vf_loss": 16737490.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2833.0, "diff_num_grad_updates_vs_sampler_policy": 2832.0}}, "num_env_steps_sampled": 5280000, "num_env_steps_trained": 5280000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2715.0022411511627, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52783901394885, "mean_inference_ms": 0.40712897835610257, "mean_action_processing_ms": 0.09641760718614925, "mean_env_wait_ms": 2.220434720231858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004122257232666016, "StateBufferConnector_ms": 0.0029926300048828125, "ViewRequirementAgentConnector_ms": 0.07179117202758789}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2715.0022411511627, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2743.04966684429, -2691.1465965356033, -2754.94092554149, -2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52783901394885, "mean_inference_ms": 0.40712897835610257, "mean_action_processing_ms": 0.09641760718614925, "mean_env_wait_ms": 2.220434720231858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004122257232666016, "StateBufferConnector_ms": 0.0029926300048828125, "ViewRequirementAgentConnector_ms": 0.07179117202758789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000, "num_env_steps_sampled": 5280000, "num_env_steps_trained": 5280000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.45896646490336, "num_env_steps_trained_throughput_per_sec": 97.45896646490336, "timesteps_total": 5280000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5280000, "timers": {"training_iteration_time_ms": 3745.998, "sample_time_ms": 3734.941, "load_time_ms": 0.328, "load_throughput": 1096709.355, "learn_time_ms": 9.93, "learn_throughput": 36255.116, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 5280000, "num_env_steps_trained": 5280000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "done": false, "episodes_total": 1756, "training_iteration": 759, "trial_id": "36440_00000", "date": "2023-07-25_03-21-04", "timestamp": 1690244464, "time_this_iter_s": 11.08451795578003, "time_total_s": 12175.46275639534, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2106.348937511444, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 25.68, "ram_util_percent": 77.51333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 103.05855407714844, "policy_loss": -69652.7640625, "vf_loss": 15164613.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2848.0, "diff_num_grad_updates_vs_sampler_policy": 2847.0}}, "num_env_steps_sampled": 5281080, "num_env_steps_trained": 5281080, "num_agent_steps_sampled": 5281080, "num_agent_steps_trained": 5281080}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2712.906048314845, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527886630785132, "mean_inference_ms": 0.4071200384508057, "mean_action_processing_ms": 0.09641743193576566, "mean_env_wait_ms": 2.220715070947633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004139900207519531, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.07191324234008789}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2712.906048314845, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2700.0850175233672, -2680.0224649592806, -2722.197239645898, -2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527886630785132, "mean_inference_ms": 0.4071200384508057, "mean_action_processing_ms": 0.09641743193576566, "mean_env_wait_ms": 2.220715070947633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004139900207519531, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.07191324234008789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5281080, "num_agent_steps_trained": 5281080, "num_env_steps_sampled": 5281080, "num_env_steps_trained": 5281080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.69561134737828, "num_env_steps_trained_throughput_per_sec": 95.69561134737828, "timesteps_total": 5281080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5281080, "timers": {"training_iteration_time_ms": 3743.381, "sample_time_ms": 3732.337, "load_time_ms": 0.327, "load_throughput": 1099584.503, "learn_time_ms": 9.916, "learn_throughput": 36303.668, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 5281080, "num_env_steps_trained": 5281080, "num_agent_steps_sampled": 5281080, "num_agent_steps_trained": 5281080}, "done": false, "episodes_total": 1759, "training_iteration": 760, "trial_id": "36440_00000", "date": "2023-07-25_03-21-16", "timestamp": 1690244476, "time_this_iter_s": 11.288640975952148, "time_total_s": 12186.751397371292, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2117.6375784873962, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 25.125, "ram_util_percent": 77.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 102.43052368164062, "policy_loss": -69831.36796875, "vf_loss": 15768095.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2863.0, "diff_num_grad_updates_vs_sampler_policy": 2862.0}}, "num_env_steps_sampled": 5282160, "num_env_steps_trained": 5282160, "num_agent_steps_sampled": 5282160, "num_agent_steps_trained": 5282160}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2713.5229448669534, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5279488655416795, "mean_inference_ms": 0.4071110641379112, "mean_action_processing_ms": 0.09641725865861772, "mean_env_wait_ms": 2.220989051737492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004126548767089844, "StateBufferConnector_ms": 0.0029981136322021484, "ViewRequirementAgentConnector_ms": 0.07181692123413086}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2713.5229448669534, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2667.171982737652, -2716.291159859933, -2758.98436190566, -2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5279488655416795, "mean_inference_ms": 0.4071110641379112, "mean_action_processing_ms": 0.09641725865861772, "mean_env_wait_ms": 2.220989051737492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004126548767089844, "StateBufferConnector_ms": 0.0029981136322021484, "ViewRequirementAgentConnector_ms": 0.07181692123413086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5282160, "num_agent_steps_trained": 5282160, "num_env_steps_sampled": 5282160, "num_env_steps_trained": 5282160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.2982770003209, "num_env_steps_trained_throughput_per_sec": 96.2982770003209, "timesteps_total": 5282160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5282160, "timers": {"training_iteration_time_ms": 3733.012, "sample_time_ms": 3721.977, "load_time_ms": 0.328, "load_throughput": 1096629.704, "learn_time_ms": 9.936, "learn_throughput": 36233.105, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 5282160, "num_env_steps_trained": 5282160, "num_agent_steps_sampled": 5282160, "num_agent_steps_trained": 5282160}, "done": false, "episodes_total": 1762, "training_iteration": 761, "trial_id": "36440_00000", "date": "2023-07-25_03-21-27", "timestamp": 1690244487, "time_this_iter_s": 11.217918157577515, "time_total_s": 12197.96931552887, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2128.8554966449738, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 25.03125, "ram_util_percent": 77.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.20535888671876, "policy_loss": -67026.46015625, "vf_loss": 15856695.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2878.0, "diff_num_grad_updates_vs_sampler_policy": 2877.0}}, "num_env_steps_sampled": 5283240, "num_env_steps_trained": 5283240, "num_agent_steps_sampled": 5283240, "num_agent_steps_trained": 5283240}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2712.673188913349, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527981132794061, "mean_inference_ms": 0.4071025349121101, "mean_action_processing_ms": 0.09641710992098877, "mean_env_wait_ms": 2.2212633682282226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004124879837036133, "StateBufferConnector_ms": 0.002991914749145508, "ViewRequirementAgentConnector_ms": 0.07174086570739746}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2808.8194362886875, "episode_reward_mean": -2712.673188913349, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2724.0008572936385, -2720.9948842696786, -2756.1327556123056, -2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527981132794061, "mean_inference_ms": 0.4071025349121101, "mean_action_processing_ms": 0.09641710992098877, "mean_env_wait_ms": 2.2212633682282226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004124879837036133, "StateBufferConnector_ms": 0.002991914749145508, "ViewRequirementAgentConnector_ms": 0.07174086570739746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5283240, "num_agent_steps_trained": 5283240, "num_env_steps_sampled": 5283240, "num_env_steps_trained": 5283240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.70322583730292, "num_env_steps_trained_throughput_per_sec": 96.70322583730292, "timesteps_total": 5283240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5283240, "timers": {"training_iteration_time_ms": 3721.494, "sample_time_ms": 3710.383, "load_time_ms": 0.335, "load_throughput": 1075385.97, "learn_time_ms": 9.981, "learn_throughput": 36068.744, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 5283240, "num_env_steps_trained": 5283240, "num_agent_steps_sampled": 5283240, "num_agent_steps_trained": 5283240}, "done": false, "episodes_total": 1765, "training_iteration": 762, "trial_id": "36440_00000", "date": "2023-07-25_03-21-38", "timestamp": 1690244498, "time_this_iter_s": 11.171241998672485, "time_total_s": 12209.140557527542, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2140.0267386436462, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 21.95625, "ram_util_percent": 77.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.92106323242187, "policy_loss": -73750.69609375, "vf_loss": 17324698.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2893.0, "diff_num_grad_updates_vs_sampler_policy": 2892.0}}, "num_env_steps_sampled": 5284320, "num_env_steps_trained": 5284320, "num_agent_steps_sampled": 5284320, "num_agent_steps_trained": 5284320}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2821.660518054355, "episode_reward_mean": -2713.421850757417, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528006300019469, "mean_inference_ms": 0.4070948143733311, "mean_action_processing_ms": 0.0964170936643316, "mean_env_wait_ms": 2.221538290101466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00413966178894043, "StateBufferConnector_ms": 0.002988100051879883, "ViewRequirementAgentConnector_ms": 0.07188773155212402}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2821.660518054355, "episode_reward_mean": -2713.421850757417, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2717.5436620765945, -2686.7683383158646, -2808.8194362886875, -2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528006300019469, "mean_inference_ms": 0.4070948143733311, "mean_action_processing_ms": 0.0964170936643316, "mean_env_wait_ms": 2.221538290101466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00413966178894043, "StateBufferConnector_ms": 0.002988100051879883, "ViewRequirementAgentConnector_ms": 0.07188773155212402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5284320, "num_agent_steps_trained": 5284320, "num_env_steps_sampled": 5284320, "num_env_steps_trained": 5284320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.45939616568089, "num_env_steps_trained_throughput_per_sec": 96.45939616568089, "timesteps_total": 5284320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5284320, "timers": {"training_iteration_time_ms": 3725.848, "sample_time_ms": 3715.231, "load_time_ms": 0.305, "load_throughput": 1180662.632, "learn_time_ms": 9.548, "learn_throughput": 37704.057, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 5284320, "num_env_steps_trained": 5284320, "num_agent_steps_sampled": 5284320, "num_agent_steps_trained": 5284320}, "done": false, "episodes_total": 1768, "training_iteration": 763, "trial_id": "36440_00000", "date": "2023-07-25_03-21-49", "timestamp": 1690244509, "time_this_iter_s": 11.1993088722229, "time_total_s": 12220.339866399765, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2151.226047515869, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 23.3, "ram_util_percent": 77.55625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 98.83275604248047, "policy_loss": -75543.91640625, "vf_loss": 17546936.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2908.0, "diff_num_grad_updates_vs_sampler_policy": 2907.0}}, "num_env_steps_sampled": 5285400, "num_env_steps_trained": 5285400, "num_agent_steps_sampled": 5285400, "num_agent_steps_trained": 5285400}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2823.64986138075, "episode_reward_mean": -2713.4164690978905, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528064355371937, "mean_inference_ms": 0.4070872128961864, "mean_action_processing_ms": 0.09641700597251257, "mean_env_wait_ms": 2.2218087797455635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004141330718994141, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.07202672958374023}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2823.64986138075, "episode_reward_mean": -2713.4164690978905, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2622.2775937191786, -2680.2255995576097, -2742.743189137174, -2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528064355371937, "mean_inference_ms": 0.4070872128961864, "mean_action_processing_ms": 0.09641700597251257, "mean_env_wait_ms": 2.2218087797455635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004141330718994141, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.07202672958374023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5285400, "num_agent_steps_trained": 5285400, "num_env_steps_sampled": 5285400, "num_env_steps_trained": 5285400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.3923131816396, "num_env_steps_trained_throughput_per_sec": 95.3923131816396, "timesteps_total": 5285400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5285400, "timers": {"training_iteration_time_ms": 3734.193, "sample_time_ms": 3723.43, "load_time_ms": 0.303, "load_throughput": 1188001.133, "learn_time_ms": 9.676, "learn_throughput": 37207.369, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 5285400, "num_env_steps_trained": 5285400, "num_agent_steps_sampled": 5285400, "num_agent_steps_trained": 5285400}, "done": false, "episodes_total": 1771, "training_iteration": 764, "trial_id": "36440_00000", "date": "2023-07-25_03-22-01", "timestamp": 1690244521, "time_this_iter_s": 11.324532985687256, "time_total_s": 12231.664399385452, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2162.5505805015564, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 23.4875, "ram_util_percent": 77.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 102.208642578125, "policy_loss": -68219.95546875, "vf_loss": 15604483.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2923.0, "diff_num_grad_updates_vs_sampler_policy": 2922.0}}, "num_env_steps_sampled": 5286480, "num_env_steps_trained": 5286480, "num_agent_steps_sampled": 5286480, "num_agent_steps_trained": 5286480}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2823.64986138075, "episode_reward_mean": -2714.3154710882754, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528130374258572, "mean_inference_ms": 0.40707809694635166, "mean_action_processing_ms": 0.09641657620736377, "mean_env_wait_ms": 2.222077618824749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041391849517822266, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.07196497917175293}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2823.64986138075, "episode_reward_mean": -2714.3154710882754, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2640.959474600974, -2726.3530574027245, -2686.8277847493173, -2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528130374258572, "mean_inference_ms": 0.40707809694635166, "mean_action_processing_ms": 0.09641657620736377, "mean_env_wait_ms": 2.222077618824749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041391849517822266, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.07196497917175293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5286480, "num_agent_steps_trained": 5286480, "num_env_steps_sampled": 5286480, "num_env_steps_trained": 5286480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.42022952231287, "num_env_steps_trained_throughput_per_sec": 96.42022952231287, "timesteps_total": 5286480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5286480, "timers": {"training_iteration_time_ms": 3750.234, "sample_time_ms": 3739.335, "load_time_ms": 0.304, "load_throughput": 1185948.351, "learn_time_ms": 9.818, "learn_throughput": 36667.058, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 5286480, "num_env_steps_trained": 5286480, "num_agent_steps_sampled": 5286480, "num_agent_steps_trained": 5286480}, "done": false, "episodes_total": 1774, "training_iteration": 765, "trial_id": "36440_00000", "date": "2023-07-25_03-22-12", "timestamp": 1690244532, "time_this_iter_s": 11.20378589630127, "time_total_s": 12242.868185281754, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2173.7543663978577, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 25.95, "ram_util_percent": 77.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 102.14533233642578, "policy_loss": -72177.40546875, "vf_loss": 15962738.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2938.0, "diff_num_grad_updates_vs_sampler_policy": 2937.0}}, "num_env_steps_sampled": 5287560, "num_env_steps_trained": 5287560, "num_agent_steps_sampled": 5287560, "num_agent_steps_trained": 5287560}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2823.64986138075, "episode_reward_mean": -2714.981516515823, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528232762603692, "mean_inference_ms": 0.407069538529682, "mean_action_processing_ms": 0.09641621180805625, "mean_env_wait_ms": 2.222349679420084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004138946533203125, "StateBufferConnector_ms": 0.002987384796142578, "ViewRequirementAgentConnector_ms": 0.07173871994018555}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2823.64986138075, "episode_reward_mean": -2714.981516515823, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2767.832278748881, -2769.9603438795257, -2744.7937291844933, -2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528232762603692, "mean_inference_ms": 0.407069538529682, "mean_action_processing_ms": 0.09641621180805625, "mean_env_wait_ms": 2.222349679420084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004138946533203125, "StateBufferConnector_ms": 0.002987384796142578, "ViewRequirementAgentConnector_ms": 0.07173871994018555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5287560, "num_agent_steps_trained": 5287560, "num_env_steps_sampled": 5287560, "num_env_steps_trained": 5287560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.64381941653426, "num_env_steps_trained_throughput_per_sec": 96.64381941653426, "timesteps_total": 5287560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5287560, "timers": {"training_iteration_time_ms": 3751.854, "sample_time_ms": 3741.032, "load_time_ms": 0.296, "load_throughput": 1214469.106, "learn_time_ms": 9.753, "learn_throughput": 36911.22, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 5287560, "num_env_steps_trained": 5287560, "num_agent_steps_sampled": 5287560, "num_agent_steps_trained": 5287560}, "done": false, "episodes_total": 1777, "training_iteration": 766, "trial_id": "36440_00000", "date": "2023-07-25_03-22-23", "timestamp": 1690244543, "time_this_iter_s": 11.177737951278687, "time_total_s": 12254.045923233032, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2184.9321043491364, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 23.8375, "ram_util_percent": 77.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.42251281738281, "policy_loss": -62333.67734375, "vf_loss": 15520891.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2953.0, "diff_num_grad_updates_vs_sampler_policy": 2952.0}}, "num_env_steps_sampled": 5288640, "num_env_steps_trained": 5288640, "num_agent_steps_sampled": 5288640, "num_agent_steps_trained": 5288640}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2823.64986138075, "episode_reward_mean": -2713.5018993521826, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528329715418805, "mean_inference_ms": 0.4070594016731943, "mean_action_processing_ms": 0.096415532018575, "mean_env_wait_ms": 2.222612612240549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004145145416259766, "StateBufferConnector_ms": 0.0029752254486083984, "ViewRequirementAgentConnector_ms": 0.07169961929321289}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2823.64986138075, "episode_reward_mean": -2713.5018993521826, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2747.2094113293792, -2754.654139668758, -2712.063270065492, -2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528329715418805, "mean_inference_ms": 0.4070594016731943, "mean_action_processing_ms": 0.096415532018575, "mean_env_wait_ms": 2.222612612240549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004145145416259766, "StateBufferConnector_ms": 0.0029752254486083984, "ViewRequirementAgentConnector_ms": 0.07169961929321289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5288640, "num_agent_steps_trained": 5288640, "num_env_steps_sampled": 5288640, "num_env_steps_trained": 5288640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.37287191233827, "num_env_steps_trained_throughput_per_sec": 97.37287191233827, "timesteps_total": 5288640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5288640, "timers": {"training_iteration_time_ms": 3731.83, "sample_time_ms": 3720.965, "load_time_ms": 0.296, "load_throughput": 1214273.776, "learn_time_ms": 9.779, "learn_throughput": 36815.284, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 5288640, "num_env_steps_trained": 5288640, "num_agent_steps_sampled": 5288640, "num_agent_steps_trained": 5288640}, "done": false, "episodes_total": 1780, "training_iteration": 767, "trial_id": "36440_00000", "date": "2023-07-25_03-22-34", "timestamp": 1690244554, "time_this_iter_s": 11.09423279762268, "time_total_s": 12265.140156030655, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2196.026337146759, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 25.48125, "ram_util_percent": 77.51875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.39407196044922, "policy_loss": -70934.25703125, "vf_loss": 16226169.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2968.0, "diff_num_grad_updates_vs_sampler_policy": 2967.0}}, "num_env_steps_sampled": 5289720, "num_env_steps_trained": 5289720, "num_agent_steps_sampled": 5289720, "num_agent_steps_trained": 5289720}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2823.64986138075, "episode_reward_mean": -2712.739514879596, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528427914085293, "mean_inference_ms": 0.40704931851196774, "mean_action_processing_ms": 0.09641478981434792, "mean_env_wait_ms": 2.222873191427725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150867462158203, "StateBufferConnector_ms": 0.0029833316802978516, "ViewRequirementAgentConnector_ms": 0.07201337814331055}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2823.64986138075, "episode_reward_mean": -2712.739514879596, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2704.664931312007, -2656.3515428052997, -2730.3044375312156, -2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528427914085293, "mean_inference_ms": 0.40704931851196774, "mean_action_processing_ms": 0.09641478981434792, "mean_env_wait_ms": 2.222873191427725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150867462158203, "StateBufferConnector_ms": 0.0029833316802978516, "ViewRequirementAgentConnector_ms": 0.07201337814331055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5289720, "num_agent_steps_trained": 5289720, "num_env_steps_sampled": 5289720, "num_env_steps_trained": 5289720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.09950080896002, "num_env_steps_trained_throughput_per_sec": 96.09950080896002, "timesteps_total": 5289720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5289720, "timers": {"training_iteration_time_ms": 3734.004, "sample_time_ms": 3723.437, "load_time_ms": 0.297, "load_throughput": 1213395.564, "learn_time_ms": 9.524, "learn_throughput": 37799.86, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 5289720, "num_env_steps_trained": 5289720, "num_agent_steps_sampled": 5289720, "num_agent_steps_trained": 5289720}, "done": false, "episodes_total": 1783, "training_iteration": 768, "trial_id": "36440_00000", "date": "2023-07-25_03-22-45", "timestamp": 1690244565, "time_this_iter_s": 11.241266012191772, "time_total_s": 12276.381422042847, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2207.267603158951, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 24.56875, "ram_util_percent": 77.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 99.81346130371094, "policy_loss": -80546.86171875, "vf_loss": 17338243.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2983.0, "diff_num_grad_updates_vs_sampler_policy": 2982.0}}, "num_env_steps_sampled": 5290800, "num_env_steps_trained": 5290800, "num_agent_steps_sampled": 5290800, "num_agent_steps_trained": 5290800}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2714.5191441771244, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528545446532782, "mean_inference_ms": 0.4070391766310091, "mean_action_processing_ms": 0.09641397036656064, "mean_env_wait_ms": 2.2231393646218183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041790008544921875, "StateBufferConnector_ms": 0.00299072265625, "ViewRequirementAgentConnector_ms": 0.07235574722290039}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2714.5191441771244, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2699.3041433102344, -2712.8102334625128, -2702.095586265578, -2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528545446532782, "mean_inference_ms": 0.4070391766310091, "mean_action_processing_ms": 0.09641397036656064, "mean_env_wait_ms": 2.2231393646218183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041790008544921875, "StateBufferConnector_ms": 0.00299072265625, "ViewRequirementAgentConnector_ms": 0.07235574722290039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5290800, "num_agent_steps_trained": 5290800, "num_env_steps_sampled": 5290800, "num_env_steps_trained": 5290800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.15365613909199, "num_env_steps_trained_throughput_per_sec": 95.15365613909199, "timesteps_total": 5290800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5290800, "timers": {"training_iteration_time_ms": 3750.226, "sample_time_ms": 3739.615, "load_time_ms": 0.297, "load_throughput": 1210865.63, "learn_time_ms": 9.566, "learn_throughput": 37634.609, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 5290800, "num_env_steps_trained": 5290800, "num_agent_steps_sampled": 5290800, "num_agent_steps_trained": 5290800}, "done": false, "episodes_total": 1786, "training_iteration": 769, "trial_id": "36440_00000", "date": "2023-07-25_03-22-57", "timestamp": 1690244577, "time_this_iter_s": 11.353302001953125, "time_total_s": 12287.7347240448, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2218.620905160904, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 23.081249999999997, "ram_util_percent": 77.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.35231475830078, "policy_loss": -69277.98203125, "vf_loss": 16239797.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2998.0, "diff_num_grad_updates_vs_sampler_policy": 2997.0}}, "num_env_steps_sampled": 5291880, "num_env_steps_trained": 5291880, "num_agent_steps_sampled": 5291880, "num_agent_steps_trained": 5291880}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2715.333397641059, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528665358918146, "mean_inference_ms": 0.40702743634077293, "mean_action_processing_ms": 0.09641288357742382, "mean_env_wait_ms": 2.2234049025408096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004174232482910156, "StateBufferConnector_ms": 0.002996683120727539, "ViewRequirementAgentConnector_ms": 0.07229423522949219}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2715.333397641059, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2641.583681651801, -2699.3219718862647, -2784.6588696669046, -2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528665358918146, "mean_inference_ms": 0.40702743634077293, "mean_action_processing_ms": 0.09641288357742382, "mean_env_wait_ms": 2.2234049025408096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004174232482910156, "StateBufferConnector_ms": 0.002996683120727539, "ViewRequirementAgentConnector_ms": 0.07229423522949219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5291880, "num_agent_steps_trained": 5291880, "num_env_steps_sampled": 5291880, "num_env_steps_trained": 5291880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.70280263285505, "num_env_steps_trained_throughput_per_sec": 96.70280263285505, "timesteps_total": 5291880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5291880, "timers": {"training_iteration_time_ms": 3734.334, "sample_time_ms": 3723.572, "load_time_ms": 0.299, "load_throughput": 1204202.44, "learn_time_ms": 9.666, "learn_throughput": 37244.079, "synch_weights_time_ms": 0.75}, "counters": {"num_env_steps_sampled": 5291880, "num_env_steps_trained": 5291880, "num_agent_steps_sampled": 5291880, "num_agent_steps_trained": 5291880}, "done": false, "episodes_total": 1789, "training_iteration": 770, "trial_id": "36440_00000", "date": "2023-07-25_03-23-08", "timestamp": 1690244588, "time_this_iter_s": 11.171257019042969, "time_total_s": 12298.905981063843, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2229.792162179947, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 23.60666666666667, "ram_util_percent": 77.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.26792755126954, "policy_loss": -68943.6328125, "vf_loss": 16326695.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3013.0, "diff_num_grad_updates_vs_sampler_policy": 3012.0}}, "num_env_steps_sampled": 5292960, "num_env_steps_trained": 5292960, "num_agent_steps_sampled": 5292960, "num_agent_steps_trained": 5292960}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2715.4962708753987, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5287727061427905, "mean_inference_ms": 0.40701645657835833, "mean_action_processing_ms": 0.09641193497876344, "mean_env_wait_ms": 2.2236716881547736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004185676574707031, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.07244253158569336}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2715.4962708753987, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2702.911195018732, -2771.203887370691, -2685.683564944636, -2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5287727061427905, "mean_inference_ms": 0.40701645657835833, "mean_action_processing_ms": 0.09641193497876344, "mean_env_wait_ms": 2.2236716881547736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004185676574707031, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.07244253158569336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5292960, "num_agent_steps_trained": 5292960, "num_env_steps_sampled": 5292960, "num_env_steps_trained": 5292960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.276489832926, "num_env_steps_trained_throughput_per_sec": 96.276489832926, "timesteps_total": 5292960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5292960, "timers": {"training_iteration_time_ms": 3734.421, "sample_time_ms": 3723.691, "load_time_ms": 0.298, "load_throughput": 1206415.34, "learn_time_ms": 9.645, "learn_throughput": 37324.819, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 5292960, "num_env_steps_trained": 5292960, "num_agent_steps_sampled": 5292960, "num_agent_steps_trained": 5292960}, "done": false, "episodes_total": 1792, "training_iteration": 771, "trial_id": "36440_00000", "date": "2023-07-25_03-23-19", "timestamp": 1690244599, "time_this_iter_s": 11.22048807144165, "time_total_s": 12310.126469135284, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2241.0126502513885, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 23.7875, "ram_util_percent": 77.58125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.59851989746093, "policy_loss": -73535.1421875, "vf_loss": 16409550.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3028.0, "diff_num_grad_updates_vs_sampler_policy": 3027.0}}, "num_env_steps_sampled": 5294040, "num_env_steps_trained": 5294040, "num_agent_steps_sampled": 5294040, "num_agent_steps_trained": 5294040}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2715.8636578820438, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528865101306949, "mean_inference_ms": 0.40700613216479015, "mean_action_processing_ms": 0.09641117364899184, "mean_env_wait_ms": 2.2239416910923335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00418543815612793, "StateBufferConnector_ms": 0.002985239028930664, "ViewRequirementAgentConnector_ms": 0.07235550880432129}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2715.8636578820438, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2666.839360984984, -2726.893291371473, -2713.6184663752224, -2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528865101306949, "mean_inference_ms": 0.40700613216479015, "mean_action_processing_ms": 0.09641117364899184, "mean_env_wait_ms": 2.2239416910923335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00418543815612793, "StateBufferConnector_ms": 0.002985239028930664, "ViewRequirementAgentConnector_ms": 0.07235550880432129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5294040, "num_agent_steps_trained": 5294040, "num_env_steps_sampled": 5294040, "num_env_steps_trained": 5294040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.1252955606982, "num_env_steps_trained_throughput_per_sec": 96.1252955606982, "timesteps_total": 5294040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5294040, "timers": {"training_iteration_time_ms": 3731.974, "sample_time_ms": 3721.08, "load_time_ms": 0.299, "load_throughput": 1205644.714, "learn_time_ms": 9.785, "learn_throughput": 36791.961, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 5294040, "num_env_steps_trained": 5294040, "num_agent_steps_sampled": 5294040, "num_agent_steps_trained": 5294040}, "done": false, "episodes_total": 1795, "training_iteration": 772, "trial_id": "36440_00000", "date": "2023-07-25_03-23-30", "timestamp": 1690244610, "time_this_iter_s": 11.239113092422485, "time_total_s": 12321.365582227707, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2252.251763343811, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 25.35, "ram_util_percent": 77.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.75555419921875, "policy_loss": -73167.79375, "vf_loss": 16146527.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3043.0, "diff_num_grad_updates_vs_sampler_policy": 3042.0}}, "num_env_steps_sampled": 5295120, "num_env_steps_trained": 5295120, "num_agent_steps_sampled": 5295120, "num_agent_steps_trained": 5295120}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.2497348983625, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528980393819691, "mean_inference_ms": 0.40699571046087085, "mean_action_processing_ms": 0.09641035510070571, "mean_env_wait_ms": 2.2242019098562342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041849613189697266, "StateBufferConnector_ms": 0.002974987030029297, "ViewRequirementAgentConnector_ms": 0.07240915298461914}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.2497348983625, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2678.239336332633, -2714.3796697027906, -2757.0761123565394, -2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528980393819691, "mean_inference_ms": 0.40699571046087085, "mean_action_processing_ms": 0.09641035510070571, "mean_env_wait_ms": 2.2242019098562342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041849613189697266, "StateBufferConnector_ms": 0.002974987030029297, "ViewRequirementAgentConnector_ms": 0.07240915298461914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5295120, "num_agent_steps_trained": 5295120, "num_env_steps_sampled": 5295120, "num_env_steps_trained": 5295120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.11258673303801, "num_env_steps_trained_throughput_per_sec": 95.11258673303801, "timesteps_total": 5295120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5295120, "timers": {"training_iteration_time_ms": 3755.123, "sample_time_ms": 3744.387, "load_time_ms": 0.298, "load_throughput": 1209313.984, "learn_time_ms": 9.678, "learn_throughput": 37196.095, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 5295120, "num_env_steps_trained": 5295120, "num_agent_steps_sampled": 5295120, "num_agent_steps_trained": 5295120}, "done": false, "episodes_total": 1798, "training_iteration": 773, "trial_id": "36440_00000", "date": "2023-07-25_03-23-42", "timestamp": 1690244622, "time_this_iter_s": 11.357814073562622, "time_total_s": 12332.72339630127, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2263.6095774173737, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 24.21875, "ram_util_percent": 77.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.39966583251953, "policy_loss": -78149.49140625, "vf_loss": 16730748.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3058.0, "diff_num_grad_updates_vs_sampler_policy": 3057.0}}, "num_env_steps_sampled": 5296200, "num_env_steps_trained": 5296200, "num_agent_steps_sampled": 5296200, "num_agent_steps_trained": 5296200}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.4601400134557, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529098639291313, "mean_inference_ms": 0.4069848943409932, "mean_action_processing_ms": 0.09640951816161789, "mean_env_wait_ms": 2.2244571308909857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041844844818115234, "StateBufferConnector_ms": 0.0029599666595458984, "ViewRequirementAgentConnector_ms": 0.07244682312011719}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.4601400134557, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2752.3472424683996, -2780.500473291072, -2757.0804827660645, -2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529098639291313, "mean_inference_ms": 0.4069848943409932, "mean_action_processing_ms": 0.09640951816161789, "mean_env_wait_ms": 2.2244571308909857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041844844818115234, "StateBufferConnector_ms": 0.0029599666595458984, "ViewRequirementAgentConnector_ms": 0.07244682312011719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5296200, "num_agent_steps_trained": 5296200, "num_env_steps_sampled": 5296200, "num_env_steps_trained": 5296200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.40884234472624, "num_env_steps_trained_throughput_per_sec": 96.40884234472624, "timesteps_total": 5296200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5296200, "timers": {"training_iteration_time_ms": 3767.195, "sample_time_ms": 3756.469, "load_time_ms": 0.297, "load_throughput": 1213980.897, "learn_time_ms": 9.665, "learn_throughput": 37247.662, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 5296200, "num_env_steps_trained": 5296200, "num_agent_steps_sampled": 5296200, "num_agent_steps_trained": 5296200}, "done": false, "episodes_total": 1801, "training_iteration": 774, "trial_id": "36440_00000", "date": "2023-07-25_03-23-53", "timestamp": 1690244633, "time_this_iter_s": 11.20518970489502, "time_total_s": 12343.928586006165, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2274.8147671222687, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 23.34375, "ram_util_percent": 77.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 102.21745452880859, "policy_loss": -68759.1125, "vf_loss": 15716452.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3073.0, "diff_num_grad_updates_vs_sampler_policy": 3072.0}}, "num_env_steps_sampled": 5297280, "num_env_steps_trained": 5297280, "num_agent_steps_sampled": 5297280, "num_agent_steps_trained": 5297280}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2715.2436994647724, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529201012269466, "mean_inference_ms": 0.4069744139563597, "mean_action_processing_ms": 0.0964087313006152, "mean_env_wait_ms": 2.2247065257749576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041866302490234375, "StateBufferConnector_ms": 0.00296783447265625, "ViewRequirementAgentConnector_ms": 0.07254385948181152}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2715.2436994647724, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2713.2557409732844, -2723.285858105944, -2727.6193602080416, -2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529201012269466, "mean_inference_ms": 0.4069744139563597, "mean_action_processing_ms": 0.0964087313006152, "mean_env_wait_ms": 2.2247065257749576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041866302490234375, "StateBufferConnector_ms": 0.00296783447265625, "ViewRequirementAgentConnector_ms": 0.07254385948181152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5297280, "num_agent_steps_trained": 5297280, "num_env_steps_sampled": 5297280, "num_env_steps_trained": 5297280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.95443149982663, "num_env_steps_trained_throughput_per_sec": 97.95443149982663, "timesteps_total": 5297280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5297280, "timers": {"training_iteration_time_ms": 3743.105, "sample_time_ms": 3732.305, "load_time_ms": 0.298, "load_throughput": 1209023.493, "learn_time_ms": 9.715, "learn_throughput": 37056.156, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 5297280, "num_env_steps_trained": 5297280, "num_agent_steps_sampled": 5297280, "num_agent_steps_trained": 5297280}, "done": false, "episodes_total": 1804, "training_iteration": 775, "trial_id": "36440_00000", "date": "2023-07-25_03-24-04", "timestamp": 1690244644, "time_this_iter_s": 11.028337955474854, "time_total_s": 12354.95692396164, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2285.8431050777435, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 22.512500000000003, "ram_util_percent": 77.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.79317169189453, "policy_loss": -71363.503125, "vf_loss": 17265668.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3088.0, "diff_num_grad_updates_vs_sampler_policy": 3087.0}}, "num_env_steps_sampled": 5298360, "num_env_steps_trained": 5298360, "num_agent_steps_sampled": 5298360, "num_agent_steps_trained": 5298360}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.730827005494, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533, -2753.624847042677, -2741.416117605228, -2817.8327487114993], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529299626116334, "mean_inference_ms": 0.4069631126844381, "mean_action_processing_ms": 0.09640779410394763, "mean_env_wait_ms": 2.2249529524585103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041692256927490234, "StateBufferConnector_ms": 0.0029604434967041016, "ViewRequirementAgentConnector_ms": 0.07236862182617188}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.730827005494, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2722.3279843005407, -2727.041956936366, -2783.435285369922, -2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533, -2753.624847042677, -2741.416117605228, -2817.8327487114993], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529299626116334, "mean_inference_ms": 0.4069631126844381, "mean_action_processing_ms": 0.09640779410394763, "mean_env_wait_ms": 2.2249529524585103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041692256927490234, "StateBufferConnector_ms": 0.0029604434967041016, "ViewRequirementAgentConnector_ms": 0.07236862182617188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5298360, "num_agent_steps_trained": 5298360, "num_env_steps_sampled": 5298360, "num_env_steps_trained": 5298360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.93075954790322, "num_env_steps_trained_throughput_per_sec": 96.93075954790322, "timesteps_total": 5298360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5298360, "timers": {"training_iteration_time_ms": 3724.474, "sample_time_ms": 3713.856, "load_time_ms": 0.298, "load_throughput": 1209895.385, "learn_time_ms": 9.56, "learn_throughput": 37655.069, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 5298360, "num_env_steps_trained": 5298360, "num_agent_steps_sampled": 5298360, "num_agent_steps_trained": 5298360}, "done": false, "episodes_total": 1807, "training_iteration": 776, "trial_id": "36440_00000", "date": "2023-07-25_03-24-15", "timestamp": 1690244655, "time_this_iter_s": 11.144623041152954, "time_total_s": 12366.101547002792, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2296.9877281188965, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 25.65625, "ram_util_percent": 77.68124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.47584686279296, "policy_loss": -67725.0953125, "vf_loss": 16011427.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3103.0, "diff_num_grad_updates_vs_sampler_policy": 3102.0}}, "num_env_steps_sampled": 5299440, "num_env_steps_trained": 5299440, "num_agent_steps_sampled": 5299440, "num_agent_steps_trained": 5299440}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.3566209799637, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533, -2753.624847042677, -2741.416117605228, -2817.8327487114993, -2794.6408341533293, -2710.885402748336, -2689.858387152165], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52938013032586, "mean_inference_ms": 0.4069525407804736, "mean_action_processing_ms": 0.09640701923325061, "mean_env_wait_ms": 2.225201245638965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004171133041381836, "StateBufferConnector_ms": 0.002959012985229492, "ViewRequirementAgentConnector_ms": 0.07239055633544922}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.3566209799637, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2698.8614476457205, -2799.8762973535745, -2723.1608099670507, -2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533, -2753.624847042677, -2741.416117605228, -2817.8327487114993, -2794.6408341533293, -2710.885402748336, -2689.858387152165], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52938013032586, "mean_inference_ms": 0.4069525407804736, "mean_action_processing_ms": 0.09640701923325061, "mean_env_wait_ms": 2.225201245638965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004171133041381836, "StateBufferConnector_ms": 0.002959012985229492, "ViewRequirementAgentConnector_ms": 0.07239055633544922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5299440, "num_agent_steps_trained": 5299440, "num_env_steps_sampled": 5299440, "num_env_steps_trained": 5299440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.73559646827653, "num_env_steps_trained_throughput_per_sec": 96.73559646827653, "timesteps_total": 5299440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5299440, "timers": {"training_iteration_time_ms": 3717.425, "sample_time_ms": 3706.687, "load_time_ms": 0.3, "load_throughput": 1201041.553, "learn_time_ms": 9.66, "learn_throughput": 37268.071, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 5299440, "num_env_steps_trained": 5299440, "num_agent_steps_sampled": 5299440, "num_agent_steps_trained": 5299440}, "done": false, "episodes_total": 1810, "training_iteration": 777, "trial_id": "36440_00000", "date": "2023-07-25_03-24-27", "timestamp": 1690244667, "time_this_iter_s": 11.167256832122803, "time_total_s": 12377.268803834915, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2308.1549849510193, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 24.6125, "ram_util_percent": 77.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.56307678222656, "policy_loss": -72032.721875, "vf_loss": 16290089.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3118.0, "diff_num_grad_updates_vs_sampler_policy": 3117.0}}, "num_env_steps_sampled": 5300520, "num_env_steps_trained": 5300520, "num_agent_steps_sampled": 5300520, "num_agent_steps_trained": 5300520}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2714.909142530685, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533, -2753.624847042677, -2741.416117605228, -2817.8327487114993, -2794.6408341533293, -2710.885402748336, -2689.858387152165, -2645.495436864205, -2707.138377068755, -2724.51689610558], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5294523758492655, "mean_inference_ms": 0.40694290785348386, "mean_action_processing_ms": 0.0964064461983381, "mean_env_wait_ms": 2.225451030539191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160881042480469, "StateBufferConnector_ms": 0.0029535293579101562, "ViewRequirementAgentConnector_ms": 0.07223200798034668}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2714.909142530685, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2658.9821925872257, -2664.9266892973324, -2732.6396986282034, -2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533, -2753.624847042677, -2741.416117605228, -2817.8327487114993, -2794.6408341533293, -2710.885402748336, -2689.858387152165, -2645.495436864205, -2707.138377068755, -2724.51689610558], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5294523758492655, "mean_inference_ms": 0.40694290785348386, "mean_action_processing_ms": 0.0964064461983381, "mean_env_wait_ms": 2.225451030539191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160881042480469, "StateBufferConnector_ms": 0.0029535293579101562, "ViewRequirementAgentConnector_ms": 0.07223200798034668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5300520, "num_agent_steps_trained": 5300520, "num_env_steps_sampled": 5300520, "num_env_steps_trained": 5300520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.01692599806154, "num_env_steps_trained_throughput_per_sec": 96.01692599806154, "timesteps_total": 5300520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5300520, "timers": {"training_iteration_time_ms": 3715.754, "sample_time_ms": 3705.031, "load_time_ms": 0.308, "load_throughput": 1169143.972, "learn_time_ms": 9.626, "learn_throughput": 37400.537, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 5300520, "num_env_steps_trained": 5300520, "num_agent_steps_sampled": 5300520, "num_agent_steps_trained": 5300520}, "done": false, "episodes_total": 1813, "training_iteration": 778, "trial_id": "36440_00000", "date": "2023-07-25_03-24-38", "timestamp": 1690244678, "time_this_iter_s": 11.250793933868408, "time_total_s": 12388.519597768784, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2319.4057788848877, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 23.55, "ram_util_percent": 77.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 101.023193359375, "policy_loss": -76063.63046875, "vf_loss": 16262272.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3133.0, "diff_num_grad_updates_vs_sampler_policy": 3132.0}}, "num_env_steps_sampled": 5301600, "num_env_steps_trained": 5301600, "num_agent_steps_sampled": 5301600, "num_agent_steps_trained": 5301600}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.498269469302, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533, -2753.624847042677, -2741.416117605228, -2817.8327487114993, -2794.6408341533293, -2710.885402748336, -2689.858387152165, -2645.495436864205, -2707.138377068755, -2724.51689610558, -2733.5592087600658, -2758.0904032167246, -2723.8116623976366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529521149492478, "mean_inference_ms": 0.406933562473563, "mean_action_processing_ms": 0.09640588524445025, "mean_env_wait_ms": 2.2257038768110204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004180192947387695, "StateBufferConnector_ms": 0.0029566287994384766, "ViewRequirementAgentConnector_ms": 0.07255148887634277}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.498269469302, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2754.793183748128, -2713.1508929040897, -2711.231534549776, -2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533, -2753.624847042677, -2741.416117605228, -2817.8327487114993, -2794.6408341533293, -2710.885402748336, -2689.858387152165, -2645.495436864205, -2707.138377068755, -2724.51689610558, -2733.5592087600658, -2758.0904032167246, -2723.8116623976366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529521149492478, "mean_inference_ms": 0.406933562473563, "mean_action_processing_ms": 0.09640588524445025, "mean_env_wait_ms": 2.2257038768110204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004180192947387695, "StateBufferConnector_ms": 0.0029566287994384766, "ViewRequirementAgentConnector_ms": 0.07255148887634277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5301600, "num_agent_steps_trained": 5301600, "num_env_steps_sampled": 5301600, "num_env_steps_trained": 5301600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 96.51009556033794, "num_env_steps_trained_throughput_per_sec": 96.51009556033794, "timesteps_total": 5301600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5301600, "timers": {"training_iteration_time_ms": 3720.046, "sample_time_ms": 3709.359, "load_time_ms": 0.307, "load_throughput": 1172048.001, "learn_time_ms": 9.604, "learn_throughput": 37483.633, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 5301600, "num_env_steps_trained": 5301600, "num_agent_steps_sampled": 5301600, "num_agent_steps_trained": 5301600}, "done": false, "episodes_total": 1816, "training_iteration": 779, "trial_id": "36440_00000", "date": "2023-07-25_03-24-49", "timestamp": 1690244689, "time_this_iter_s": 11.193371772766113, "time_total_s": 12399.71296954155, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2330.599150657654, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 21.793750000000003, "ram_util_percent": 77.63749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 100.71013488769532, "policy_loss": -69824.353125, "vf_loss": 16085707.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3148.0, "diff_num_grad_updates_vs_sampler_policy": 3147.0}}, "num_env_steps_sampled": 5302680, "num_env_steps_trained": 5302680, "num_agent_steps_sampled": 5302680, "num_agent_steps_trained": 5302680}, "sampler_results": {"episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.4421891001384, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533, -2753.624847042677, -2741.416117605228, -2817.8327487114993, -2794.6408341533293, -2710.885402748336, -2689.858387152165, -2645.495436864205, -2707.138377068755, -2724.51689610558, -2733.5592087600658, -2758.0904032167246, -2723.8116623976366, -2719.8013855953254, -2736.0807200888944, -2717.685468601419], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529580052004721, "mean_inference_ms": 0.40692499204995, "mean_action_processing_ms": 0.09640548283826554, "mean_env_wait_ms": 2.2259651408570815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041904449462890625, "StateBufferConnector_ms": 0.0029637813568115234, "ViewRequirementAgentConnector_ms": 0.07269525527954102}}, "episode_reward_max": -2618.175888122411, "episode_reward_min": -2824.2098058086644, "episode_reward_mean": -2716.4421891001384, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2749.176130884961, -2705.5602127659367, -2702.1331943951677, -2747.24659595794, -2687.871236684372, -2670.801694769042, -2798.554233623263, -2682.922873783081, -2647.294739692283, -2737.1839866925297, -2692.5902443416253, -2754.7014751819775, -2660.3320159995615, -2645.9978439368547, -2706.5677983811975, -2741.915255648655, -2710.846340128616, -2639.4296604023316, -2618.175888122411, -2661.4534717275856, -2671.453084473236, -2693.265520957984, -2721.837602992298, -2694.4462061801282, -2695.3438438381704, -2686.545619086517, -2658.261045711341, -2756.5487770552368, -2723.095490973594, -2713.965483390347, -2803.0393531285063, -2699.5486946278725, -2746.4856664583845, -2678.5727233857406, -2756.6547039565344, -2733.5192599510315, -2770.3795109262287, -2635.282504174181, -2700.987870402619, -2643.2475307128093, -2691.4852597886293, -2784.7829287617733, -2687.7261887889294, -2704.111763317289, -2655.786726689828, -2697.5734191356796, -2785.6995341724887, -2668.6346293556844, -2821.660518054355, -2692.6749279587043, -2696.26848138912, -2823.64986138075, -2758.5939639981602, -2704.8327901937014, -2671.719827260549, -2759.56120365341, -2648.2856132632123, -2712.898042591111, -2715.1631170786645, -2760.0857329786945, -2659.3757853914663, -2771.7026985962743, -2625.7304814932277, -2740.2551937154744, -2769.501535303719, -2675.572500289026, -2824.2098058086644, -2783.334601843977, -2687.007020706019, -2725.293686881796, -2683.646604771061, -2707.304778394228, -2750.900463473619, -2689.674430265464, -2736.303137216678, -2770.559780516477, -2666.020726213495, -2750.445568964406, -2729.4925251855902, -2652.7923624598834, -2746.313728427097, -2771.6295390142996, -2796.8989010996956, -2684.454824182968, -2686.930418374533, -2753.624847042677, -2741.416117605228, -2817.8327487114993, -2794.6408341533293, -2710.885402748336, -2689.858387152165, -2645.495436864205, -2707.138377068755, -2724.51689610558, -2733.5592087600658, -2758.0904032167246, -2723.8116623976366, -2719.8013855953254, -2736.0807200888944, -2717.685468601419], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529580052004721, "mean_inference_ms": 0.40692499204995, "mean_action_processing_ms": 0.09640548283826554, "mean_env_wait_ms": 2.2259651408570815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041904449462890625, "StateBufferConnector_ms": 0.0029637813568115234, "ViewRequirementAgentConnector_ms": 0.07269525527954102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5302680, "num_agent_steps_trained": 5302680, "num_env_steps_sampled": 5302680, "num_env_steps_trained": 5302680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 95.56797272867091, "num_env_steps_trained_throughput_per_sec": 95.56797272867091, "timesteps_total": 5302680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5302680, "timers": {"training_iteration_time_ms": 3729.424, "sample_time_ms": 3718.644, "load_time_ms": 0.305, "load_throughput": 1180847.298, "learn_time_ms": 9.704, "learn_throughput": 37099.404, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 5302680, "num_env_steps_trained": 5302680, "num_agent_steps_sampled": 5302680, "num_agent_steps_trained": 5302680}, "done": true, "episodes_total": 1819, "training_iteration": 780, "trial_id": "36440_00000", "date": "2023-07-25_03-25-00", "timestamp": 1690244700, "time_this_iter_s": 11.303698062896729, "time_total_s": 12411.016667604446, "pid": 55067, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16ad523a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2341.9028487205505, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 23.36875, "ram_util_percent": 77.54374999999999}}
