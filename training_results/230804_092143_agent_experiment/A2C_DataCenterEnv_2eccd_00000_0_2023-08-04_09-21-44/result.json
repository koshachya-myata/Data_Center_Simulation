{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -324.91689453125, "policy_loss": -8491390.275, "vf_loss": 20816495.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "sampler_results": {"episode_reward_max": -3531.9687409165917, "episode_reward_min": -3532.7345418266286, "episode_reward_mean": -3532.3875521407754, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.337108130371207, "mean_inference_ms": 0.39081127967799184, "mean_action_processing_ms": 0.09657077277621993, "mean_env_wait_ms": 3.371460806099383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003226598103841146, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06875991821289062}}, "episode_reward_max": -3531.9687409165917, "episode_reward_min": -3532.7345418266286, "episode_reward_mean": -3532.3875521407754, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.337108130371207, "mean_inference_ms": 0.39081127967799184, "mean_action_processing_ms": 0.09657077277621993, "mean_env_wait_ms": 3.371460806099383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003226598103841146, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06875991821289062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 88.68178916038498, "num_env_steps_trained_throughput_per_sec": 88.68178916038498, "timesteps_total": 121080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 121080, "timers": {"training_iteration_time_ms": 4059.441, "sample_time_ms": 4043.396, "load_time_ms": 0.439, "load_throughput": 820030.471, "learn_time_ms": 14.635, "learn_throughput": 24598.688, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "done": false, "episodes_total": 817, "training_iteration": 161, "trial_id": "2eccd_00000", "date": "2023-08-04_09-22-02", "timestamp": 1691130122, "time_this_iter_s": 12.182233810424805, "time_total_s": 1742.0129606723785, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.182233810424805, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.43333333333333, "ram_util_percent": 63.68333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.9666666666666666e-06, "entropy_coeff": 0.05, "policy_entropy": -326.4171875, "policy_loss": -7075266.928125, "vf_loss": 20832601.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520}, "sampler_results": {"episode_reward_max": -3531.334535806403, "episode_reward_min": -3533.864919418433, "episode_reward_mean": -3532.179841146655, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.461393329411563, "mean_inference_ms": 0.39803573461655706, "mean_action_processing_ms": 0.09804984413998355, "mean_env_wait_ms": 2.5867398669150035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003630774361746652, "StateBufferConnector_ms": 0.002738407679966518, "ViewRequirementAgentConnector_ms": 0.06947176797049386}}, "episode_reward_max": -3531.334535806403, "episode_reward_min": -3533.864919418433, "episode_reward_mean": -3532.179841146655, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.461393329411563, "mean_inference_ms": 0.39803573461655706, "mean_action_processing_ms": 0.09804984413998355, "mean_env_wait_ms": 2.5867398669150035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003630774361746652, "StateBufferConnector_ms": 0.002738407679966518, "ViewRequirementAgentConnector_ms": 0.06947176797049386}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520, "num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.97960340016273, "num_env_steps_trained_throughput_per_sec": 107.97960340016273, "timesteps_total": 122520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 122520, "timers": {"training_iteration_time_ms": 3644.875, "sample_time_ms": 3630.549, "load_time_ms": 0.37, "load_throughput": 971921.479, "learn_time_ms": 13.109, "learn_throughput": 27462.114, "synch_weights_time_ms": 0.798}, "counters": {"num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520}, "done": false, "episodes_total": 821, "training_iteration": 162, "trial_id": "2eccd_00000", "date": "2023-08-04_09-22-16", "timestamp": 1691130136, "time_this_iter_s": 13.338351011276245, "time_total_s": 1755.3513116836548, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 25.52058482170105, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 32.35263157894737, "ram_util_percent": 63.47368421052633}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.166666666666667e-06, "entropy_coeff": 0.05, "policy_entropy": -327.33156127929686, "policy_loss": -12401117.33125, "vf_loss": 20846938.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -3534.9052881195516, "episode_reward_mean": -3532.575323733632, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4924381452387685, "mean_inference_ms": 0.39793704979428546, "mean_action_processing_ms": 0.0978935731719467, "mean_env_wait_ms": 2.230313461956954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003723664717240767, "StateBufferConnector_ms": 0.0027006322687322445, "ViewRequirementAgentConnector_ms": 0.0683394345370206}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -3534.9052881195516, "episode_reward_mean": -3532.575323733632, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4924381452387685, "mean_inference_ms": 0.39793704979428546, "mean_action_processing_ms": 0.0978935731719467, "mean_env_wait_ms": 2.230313461956954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003723664717240767, "StateBufferConnector_ms": 0.0027006322687322445, "ViewRequirementAgentConnector_ms": 0.0683394345370206}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.19077358140261, "num_env_steps_trained_throughput_per_sec": 111.19077358140261, "timesteps_total": 123960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 123960, "timers": {"training_iteration_time_ms": 3265.209, "sample_time_ms": 3253.092, "load_time_ms": 0.32, "load_throughput": 1123307.127, "learn_time_ms": 10.963, "learn_throughput": 32838.123, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "done": false, "episodes_total": 825, "training_iteration": 163, "trial_id": "2eccd_00000", "date": "2023-08-04_09-22-29", "timestamp": 1691130149, "time_this_iter_s": 12.953260660171509, "time_total_s": 1768.3045723438263, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 38.47384548187256, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.31111111111111, "ram_util_percent": 63.41111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.327777777777778e-06, "entropy_coeff": 0.05, "policy_entropy": -330.41163940429686, "policy_loss": 300946.3796875, "vf_loss": 20880332.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -3539.1517377077284, "episode_reward_mean": -3533.7606484282896, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.486948737629523, "mean_inference_ms": 0.3977880987166025, "mean_action_processing_ms": 0.09779567149322595, "mean_env_wait_ms": 2.0148194281883245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036319096883138022, "StateBufferConnector_ms": 0.002673467000325521, "ViewRequirementAgentConnector_ms": 0.06889502207438152}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -3539.1517377077284, "episode_reward_mean": -3533.7606484282896, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.486948737629523, "mean_inference_ms": 0.3977880987166025, "mean_action_processing_ms": 0.09779567149322595, "mean_env_wait_ms": 2.0148194281883245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036319096883138022, "StateBufferConnector_ms": 0.002673467000325521, "ViewRequirementAgentConnector_ms": 0.06889502207438152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.52631297911384, "num_env_steps_trained_throughput_per_sec": 114.52631297911384, "timesteps_total": 125400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 125400, "timers": {"training_iteration_time_ms": 3203.805, "sample_time_ms": 3192.405, "load_time_ms": 0.306, "load_throughput": 1177807.676, "learn_time_ms": 10.281, "learn_throughput": 35017.624, "synch_weights_time_ms": 0.77}, "counters": {"num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "done": false, "episodes_total": 829, "training_iteration": 164, "trial_id": "2eccd_00000", "date": "2023-08-04_09-22-41", "timestamp": 1691130161, "time_this_iter_s": 12.576146841049194, "time_total_s": 1780.8807191848755, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 51.04999232292175, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.316666666666666, "ram_util_percent": 64.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.1277777777777774e-06, "entropy_coeff": 0.05, "policy_entropy": -332.35414428710936, "policy_loss": -6927810.615625, "vf_loss": 21032658.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -3554.7057265789203, "episode_reward_mean": -3537.0722982068514, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.479906457059068, "mean_inference_ms": 0.3974202814643336, "mean_action_processing_ms": 0.09766569363895396, "mean_env_wait_ms": 1.867863346572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003573769017269737, "StateBufferConnector_ms": 0.0026916202745939557, "ViewRequirementAgentConnector_ms": 0.06906484302721526}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -3554.7057265789203, "episode_reward_mean": -3537.0722982068514, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.479906457059068, "mean_inference_ms": 0.3974202814643336, "mean_action_processing_ms": 0.09766569363895396, "mean_env_wait_ms": 1.867863346572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003573769017269737, "StateBufferConnector_ms": 0.0026916202745939557, "ViewRequirementAgentConnector_ms": 0.06906484302721526}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.94662343458732, "num_env_steps_trained_throughput_per_sec": 112.94662343458732, "timesteps_total": 126840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 126840, "timers": {"training_iteration_time_ms": 3166.042, "sample_time_ms": 3154.195, "load_time_ms": 0.316, "load_throughput": 1138467.496, "learn_time_ms": 10.665, "learn_throughput": 33755.993, "synch_weights_time_ms": 0.817}, "counters": {"num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "done": false, "episodes_total": 833, "training_iteration": 165, "trial_id": "2eccd_00000", "date": "2023-08-04_09-22-54", "timestamp": 1691130174, "time_this_iter_s": 12.753572702407837, "time_total_s": 1793.6342918872833, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 63.80356502532959, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.911111111111108, "ram_util_percent": 64.32777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9277777777777773e-06, "entropy_coeff": 0.05, "policy_entropy": -333.7514587402344, "policy_loss": -1557381.10390625, "vf_loss": 21149765.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -3563.7172540441243, "episode_reward_mean": -3541.153990250826, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.476965550139439, "mean_inference_ms": 0.3967208989787355, "mean_action_processing_ms": 0.09751259238556641, "mean_env_wait_ms": 1.758516517884768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003626035607379416, "StateBufferConnector_ms": 0.0026962031488833222, "ViewRequirementAgentConnector_ms": 0.0686075376427692}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -3563.7172540441243, "episode_reward_mean": -3541.153990250826, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.476965550139439, "mean_inference_ms": 0.3967208989787355, "mean_action_processing_ms": 0.09751259238556641, "mean_env_wait_ms": 1.758516517884768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003626035607379416, "StateBufferConnector_ms": 0.0026962031488833222, "ViewRequirementAgentConnector_ms": 0.0686075376427692}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.26009706511427, "num_env_steps_trained_throughput_per_sec": 112.26009706511427, "timesteps_total": 128280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 128280, "timers": {"training_iteration_time_ms": 3182.185, "sample_time_ms": 3170.43, "load_time_ms": 0.317, "load_throughput": 1134106.534, "learn_time_ms": 10.586, "learn_throughput": 34008.177, "synch_weights_time_ms": 0.804}, "counters": {"num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "done": false, "episodes_total": 837, "training_iteration": 166, "trial_id": "2eccd_00000", "date": "2023-08-04_09-23-07", "timestamp": 1691130187, "time_this_iter_s": 12.82986068725586, "time_total_s": 1806.4641525745392, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 76.63342571258545, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.268421052631574, "ram_util_percent": 64.23684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -333.4335876464844, "policy_loss": -7470446.41875, "vf_loss": 21327949.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 133.0, "diff_num_grad_updates_vs_sampler_policy": 132.0}}, "num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -3642.8223350373905, "episode_reward_mean": -3549.086158071286, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.479791661711245, "mean_inference_ms": 0.39553410482695556, "mean_action_processing_ms": 0.09725552477627622, "mean_env_wait_ms": 1.6736305340585924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035568519874855323, "StateBufferConnector_ms": 0.002712673611111111, "ViewRequirementAgentConnector_ms": 0.06850737112539786}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -3642.8223350373905, "episode_reward_mean": -3549.086158071286, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.479791661711245, "mean_inference_ms": 0.39553410482695556, "mean_action_processing_ms": 0.09725552477627622, "mean_env_wait_ms": 1.6736305340585924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035568519874855323, "StateBufferConnector_ms": 0.002712673611111111, "ViewRequirementAgentConnector_ms": 0.06850737112539786}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720, "num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.28595714206284, "num_env_steps_trained_throughput_per_sec": 110.28595714206284, "timesteps_total": 129720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 129720, "timers": {"training_iteration_time_ms": 3234.717, "sample_time_ms": 3223.227, "load_time_ms": 0.315, "load_throughput": 1143035.155, "learn_time_ms": 10.381, "learn_throughput": 34680.15, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720}, "done": false, "episodes_total": 841, "training_iteration": 167, "trial_id": "2eccd_00000", "date": "2023-08-04_09-23-20", "timestamp": 1691130200, "time_this_iter_s": 13.059493780136108, "time_total_s": 1819.5236463546753, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 89.69291949272156, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.200000000000003, "ram_util_percent": 63.7388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -333.3139709472656, "policy_loss": -11597861.2625, "vf_loss": 21575780.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 152.0}}, "num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -3642.8223350373905, "episode_reward_mean": -3553.7679850693544, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4819800520288196, "mean_inference_ms": 0.39425147461956717, "mean_action_processing_ms": 0.09698119405139384, "mean_env_wait_ms": 1.6054651542691962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035908914381457915, "StateBufferConnector_ms": 0.002696437220419607, "ViewRequirementAgentConnector_ms": 0.06820155728247858}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -3642.8223350373905, "episode_reward_mean": -3553.7679850693544, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4819800520288196, "mean_inference_ms": 0.39425147461956717, "mean_action_processing_ms": 0.09698119405139384, "mean_env_wait_ms": 1.6054651542691962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035908914381457915, "StateBufferConnector_ms": 0.002696437220419607, "ViewRequirementAgentConnector_ms": 0.06820155728247858}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160, "num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.56757607539835, "num_env_steps_trained_throughput_per_sec": 112.56757607539835, "timesteps_total": 131160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 131160, "timers": {"training_iteration_time_ms": 3229.694, "sample_time_ms": 3218.958, "load_time_ms": 0.3, "load_throughput": 1199896.249, "learn_time_ms": 9.703, "learn_throughput": 37100.498, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160}, "done": false, "episodes_total": 845, "training_iteration": 168, "trial_id": "2eccd_00000", "date": "2023-08-04_09-23-33", "timestamp": 1691130213, "time_this_iter_s": 12.794862031936646, "time_total_s": 1832.318508386612, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 102.4877815246582, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.78888888888889, "ram_util_percent": 63.38333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -333.58265991210936, "policy_loss": -14457060.2, "vf_loss": 21663440.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 172.0}}, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -3642.8223350373905, "episode_reward_mean": -3558.2966479397587, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4810193990642215, "mean_inference_ms": 0.39306424783026456, "mean_action_processing_ms": 0.09672897638908266, "mean_env_wait_ms": 1.549411270376261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036219188145228793, "StateBufferConnector_ms": 0.0026757376534598215, "ViewRequirementAgentConnector_ms": 0.0678873062133789}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -3642.8223350373905, "episode_reward_mean": -3558.2966479397587, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4810193990642215, "mean_inference_ms": 0.39306424783026456, "mean_action_processing_ms": 0.09672897638908266, "mean_env_wait_ms": 1.549411270376261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036219188145228793, "StateBufferConnector_ms": 0.0026757376534598215, "ViewRequirementAgentConnector_ms": 0.0678873062133789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 115.08868432651143, "num_env_steps_trained_throughput_per_sec": 115.08868432651143, "timesteps_total": 132600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 132600, "timers": {"training_iteration_time_ms": 3183.475, "sample_time_ms": 3172.725, "load_time_ms": 0.3, "load_throughput": 1200659.542, "learn_time_ms": 9.709, "learn_throughput": 37080.362, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "done": false, "episodes_total": 849, "training_iteration": 169, "trial_id": "2eccd_00000", "date": "2023-08-04_09-23-45", "timestamp": 1691130225, "time_this_iter_s": 12.514887809753418, "time_total_s": 1844.8333961963654, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 115.00266933441162, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.25555555555556, "ram_util_percent": 64.30555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -334.3593383789063, "policy_loss": -2196485.275, "vf_loss": 21793579.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 192.0}}, "num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -3642.8223350373905, "episode_reward_mean": -3563.4574866113744, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.479645163868915, "mean_inference_ms": 0.39197153443095534, "mean_action_processing_ms": 0.09649772667054587, "mean_env_wait_ms": 1.5025440809496897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035591614552033255, "StateBufferConnector_ms": 0.0026819033500475762, "ViewRequirementAgentConnector_ms": 0.06777139810415414}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -3642.8223350373905, "episode_reward_mean": -3563.4574866113744, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.479645163868915, "mean_inference_ms": 0.39197153443095534, "mean_action_processing_ms": 0.09649772667054587, "mean_env_wait_ms": 1.5025440809496897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035591614552033255, "StateBufferConnector_ms": 0.0026819033500475762, "ViewRequirementAgentConnector_ms": 0.06777139810415414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040, "num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.30584511525335, "num_env_steps_trained_throughput_per_sec": 113.30584511525335, "timesteps_total": 134040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 134040, "timers": {"training_iteration_time_ms": 3151.72, "sample_time_ms": 3140.919, "load_time_ms": 0.297, "load_throughput": 1212518.622, "learn_time_ms": 9.746, "learn_throughput": 36939.123, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040}, "done": false, "episodes_total": 853, "training_iteration": 170, "trial_id": "2eccd_00000", "date": "2023-08-04_09-23-58", "timestamp": 1691130238, "time_this_iter_s": 12.711468935012817, "time_total_s": 1857.5448651313782, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 127.71413826942444, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.17777777777778, "ram_util_percent": 64.72777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -333.90842895507814, "policy_loss": -5206432.803125, "vf_loss": 21676191.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 213.0, "diff_num_grad_updates_vs_sampler_policy": 212.0}}, "num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -3872.205990484349, "episode_reward_mean": -3574.3601080423227, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.477190598140707, "mean_inference_ms": 0.39102654669357945, "mean_action_processing_ms": 0.09629907979051182, "mean_env_wait_ms": 1.4625154414010095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674972889035247, "StateBufferConnector_ms": 0.0026763871658680052, "ViewRequirementAgentConnector_ms": 0.06755174592483876}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -3872.205990484349, "episode_reward_mean": -3574.3601080423227, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.477190598140707, "mean_inference_ms": 0.39102654669357945, "mean_action_processing_ms": 0.09629907979051182, "mean_env_wait_ms": 1.4625154414010095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674972889035247, "StateBufferConnector_ms": 0.0026763871658680052, "ViewRequirementAgentConnector_ms": 0.06755174592483876}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480, "num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.80428293618972, "num_env_steps_trained_throughput_per_sec": 114.80428293618972, "timesteps_total": 135480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 135480, "timers": {"training_iteration_time_ms": 3144.192, "sample_time_ms": 3133.412, "load_time_ms": 0.303, "load_throughput": 1188655.782, "learn_time_ms": 9.691, "learn_throughput": 37149.057, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480}, "done": false, "episodes_total": 857, "training_iteration": 171, "trial_id": "2eccd_00000", "date": "2023-08-04_09-24-11", "timestamp": 1691130251, "time_this_iter_s": 12.545644044876099, "time_total_s": 1870.0905091762543, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 140.25978231430054, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.73888888888889, "ram_util_percent": 64.61111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -334.0539794921875, "policy_loss": -5889739.246875, "vf_loss": 24688943.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 232.0}}, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -3872.205990484349, "episode_reward_mean": -3591.3481549985277, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.474165115350991, "mean_inference_ms": 0.3903228356659556, "mean_action_processing_ms": 0.09614312365502606, "mean_env_wait_ms": 1.4282597745355803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036894006932035404, "StateBufferConnector_ms": 0.0026763753688081784, "ViewRequirementAgentConnector_ms": 0.06747955971575798}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -3872.205990484349, "episode_reward_mean": -3591.3481549985277, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.474165115350991, "mean_inference_ms": 0.3903228356659556, "mean_action_processing_ms": 0.09614312365502606, "mean_env_wait_ms": 1.4282597745355803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036894006932035404, "StateBufferConnector_ms": 0.0026763753688081784, "ViewRequirementAgentConnector_ms": 0.06747955971575798}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.80390045782167, "num_env_steps_trained_throughput_per_sec": 113.80390045782167, "timesteps_total": 136920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 136920, "timers": {"training_iteration_time_ms": 3156.459, "sample_time_ms": 3145.702, "load_time_ms": 0.305, "load_throughput": 1179095.299, "learn_time_ms": 9.694, "learn_throughput": 37136.357, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "done": false, "episodes_total": 861, "training_iteration": 172, "trial_id": "2eccd_00000", "date": "2023-08-04_09-24-23", "timestamp": 1691130263, "time_this_iter_s": 12.655887842178345, "time_total_s": 1882.7463970184326, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 152.91567015647888, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 25.477777777777778, "ram_util_percent": 64.41666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -333.8151550292969, "policy_loss": -13633202.6, "vf_loss": 35190806.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 253.0, "diff_num_grad_updates_vs_sampler_policy": 252.0}}, "num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -4603.385528718168, "episode_reward_mean": -3653.5731016063314, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.47171909588235, "mean_inference_ms": 0.3896327699290863, "mean_action_processing_ms": 0.09599247330216579, "mean_env_wait_ms": 1.3981505687870555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036417269239238663, "StateBufferConnector_ms": 0.002668885623707491, "ViewRequirementAgentConnector_ms": 0.06732893925087124}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -4603.385528718168, "episode_reward_mean": -3653.5731016063314, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.47171909588235, "mean_inference_ms": 0.3896327699290863, "mean_action_processing_ms": 0.09599247330216579, "mean_env_wait_ms": 1.3981505687870555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036417269239238663, "StateBufferConnector_ms": 0.002668885623707491, "ViewRequirementAgentConnector_ms": 0.06732893925087124}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360, "num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.24799448711303, "num_env_steps_trained_throughput_per_sec": 113.24799448711303, "timesteps_total": 138360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 138360, "timers": {"training_iteration_time_ms": 3164.739, "sample_time_ms": 3153.944, "load_time_ms": 0.305, "load_throughput": 1180478.024, "learn_time_ms": 9.733, "learn_throughput": 36986.445, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360}, "done": false, "episodes_total": 865, "training_iteration": 173, "trial_id": "2eccd_00000", "date": "2023-08-04_09-24-36", "timestamp": 1691130276, "time_this_iter_s": 12.718096017837524, "time_total_s": 1895.4644930362701, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 165.6337661743164, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 21.84444444444445, "ram_util_percent": 64.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.316666666666667e-06, "entropy_coeff": 0.05, "policy_entropy": -333.2013854980469, "policy_loss": -2525872.24375, "vf_loss": 34118207.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 273.0, "diff_num_grad_updates_vs_sampler_policy": 272.0}}, "num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -4670.662798824647, "episode_reward_mean": -3718.2644361078383, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.468780283469202, "mean_inference_ms": 0.3890635643226574, "mean_action_processing_ms": 0.0958666887046894, "mean_env_wait_ms": 1.371537418956594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003628297285600142, "StateBufferConnector_ms": 0.002683292735706676, "ViewRequirementAgentConnector_ms": 0.06777156483043324}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -4670.662798824647, "episode_reward_mean": -3718.2644361078383, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.468780283469202, "mean_inference_ms": 0.3890635643226574, "mean_action_processing_ms": 0.0958666887046894, "mean_env_wait_ms": 1.371537418956594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003628297285600142, "StateBufferConnector_ms": 0.002683292735706676, "ViewRequirementAgentConnector_ms": 0.06777156483043324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800, "num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 115.03275219723247, "num_env_steps_trained_throughput_per_sec": 115.03275219723247, "timesteps_total": 139800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 139800, "timers": {"training_iteration_time_ms": 3153.162, "sample_time_ms": 3142.347, "load_time_ms": 0.299, "load_throughput": 1205452.211, "learn_time_ms": 9.775, "learn_throughput": 36829.742, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800}, "done": false, "episodes_total": 869, "training_iteration": 174, "trial_id": "2eccd_00000", "date": "2023-08-04_09-24-48", "timestamp": 1691130288, "time_this_iter_s": 12.520721912384033, "time_total_s": 1907.9852149486542, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 178.15448808670044, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.361111111111114, "ram_util_percent": 64.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7166666666666666e-06, "entropy_coeff": 0.05, "policy_entropy": -333.5389831542969, "policy_loss": -1258644.0015625, "vf_loss": 34430325.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -4670.662798824647, "episode_reward_mean": -3776.7562413754213, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.466319347069708, "mean_inference_ms": 0.38849395406188064, "mean_action_processing_ms": 0.09574205664160693, "mean_env_wait_ms": 1.348014766229002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003579915580102953, "StateBufferConnector_ms": 0.0026759454759500796, "ViewRequirementAgentConnector_ms": 0.06762641971394168}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -4670.662798824647, "episode_reward_mean": -3776.7562413754213, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.466319347069708, "mean_inference_ms": 0.38849395406188064, "mean_action_processing_ms": 0.09574205664160693, "mean_env_wait_ms": 1.348014766229002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003579915580102953, "StateBufferConnector_ms": 0.0026759454759500796, "ViewRequirementAgentConnector_ms": 0.06762641971394168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.65538682380257, "num_env_steps_trained_throughput_per_sec": 112.65538682380257, "timesteps_total": 141240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 141240, "timers": {"training_iteration_time_ms": 3176.265, "sample_time_ms": 3165.466, "load_time_ms": 0.299, "load_throughput": 1204875.072, "learn_time_ms": 9.754, "learn_throughput": 36909.506, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "done": false, "episodes_total": 873, "training_iteration": 175, "trial_id": "2eccd_00000", "date": "2023-08-04_09-25-01", "timestamp": 1691130301, "time_this_iter_s": 12.78511381149292, "time_total_s": 1920.770328760147, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 190.93960189819336, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 20.483333333333334, "ram_util_percent": 64.52222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1166666666666666e-06, "entropy_coeff": 0.05, "policy_entropy": -333.464306640625, "policy_loss": -857929.26875, "vf_loss": 34729144.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 313.0, "diff_num_grad_updates_vs_sampler_policy": 312.0}}, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -4670.662798824647, "episode_reward_mean": -3830.3432930641443, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033, -4609.786343718493, -4646.731916170221, -4646.240126459231, -4580.250835543301], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4640598023042815, "mean_inference_ms": 0.38794849551233807, "mean_action_processing_ms": 0.09562389347542341, "mean_env_wait_ms": 1.3267926366947689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035448679848322793, "StateBufferConnector_ms": 0.0026721802968827503, "ViewRequirementAgentConnector_ms": 0.06750235481867714}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -4670.662798824647, "episode_reward_mean": -3830.3432930641443, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033, -4609.786343718493, -4646.731916170221, -4646.240126459231, -4580.250835543301], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4640598023042815, "mean_inference_ms": 0.38794849551233807, "mean_action_processing_ms": 0.09562389347542341, "mean_env_wait_ms": 1.3267926366947689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035448679848322793, "StateBufferConnector_ms": 0.0026721802968827503, "ViewRequirementAgentConnector_ms": 0.06750235481867714}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.00038108357026, "num_env_steps_trained_throughput_per_sec": 114.00038108357026, "timesteps_total": 142680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 142680, "timers": {"training_iteration_time_ms": 3169.405, "sample_time_ms": 3158.736, "load_time_ms": 0.301, "load_throughput": 1197232.35, "learn_time_ms": 9.634, "learn_throughput": 37366.477, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "done": false, "episodes_total": 877, "training_iteration": 176, "trial_id": "2eccd_00000", "date": "2023-08-04_09-25-14", "timestamp": 1691130314, "time_this_iter_s": 12.634060144424438, "time_total_s": 1933.4043889045715, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 203.5736620426178, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 22.522222222222226, "ram_util_percent": 64.46111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -333.6980346679687, "policy_loss": -703318.7, "vf_loss": 35576960.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 333.0, "diff_num_grad_updates_vs_sampler_policy": 332.0}}, "num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -4672.627212563203, "episode_reward_mean": -3878.946733658336, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033, -4609.786343718493, -4646.731916170221, -4646.240126459231, -4580.250835543301, -4672.627212563203, -4666.66564498654, -4603.40720630224, -4635.103628215427], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.462152620032271, "mean_inference_ms": 0.38741207017678353, "mean_action_processing_ms": 0.0955083215541032, "mean_env_wait_ms": 1.3076330081851602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003556351163494053, "StateBufferConnector_ms": 0.002682031090579816, "ViewRequirementAgentConnector_ms": 0.06741552210565824}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -4672.627212563203, "episode_reward_mean": -3878.946733658336, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033, -4609.786343718493, -4646.731916170221, -4646.240126459231, -4580.250835543301, -4672.627212563203, -4666.66564498654, -4603.40720630224, -4635.103628215427], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.462152620032271, "mean_inference_ms": 0.38741207017678353, "mean_action_processing_ms": 0.0955083215541032, "mean_env_wait_ms": 1.3076330081851602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003556351163494053, "StateBufferConnector_ms": 0.002682031090579816, "ViewRequirementAgentConnector_ms": 0.06741552210565824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120, "num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.0814335094386, "num_env_steps_trained_throughput_per_sec": 113.0814335094386, "timesteps_total": 144120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 144120, "timers": {"training_iteration_time_ms": 3176.088, "sample_time_ms": 3165.337, "load_time_ms": 0.299, "load_throughput": 1204490.619, "learn_time_ms": 9.704, "learn_throughput": 37098.036, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120}, "done": false, "episodes_total": 881, "training_iteration": 177, "trial_id": "2eccd_00000", "date": "2023-08-04_09-25-27", "timestamp": 1691130327, "time_this_iter_s": 12.736961841583252, "time_total_s": 1946.1413507461548, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 216.31062388420105, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 20.1, "ram_util_percent": 64.46111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -333.54986572265625, "policy_loss": -12571444.3, "vf_loss": 35534663.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 352.0}}, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -4687.77727719703, "episode_reward_mean": -3921.13233538763, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033, -4609.786343718493, -4646.731916170221, -4646.240126459231, -4580.250835543301, -4672.627212563203, -4666.66564498654, -4603.40720630224, -4635.103628215427, -4577.896971877172, -4612.85608087459, -4687.77727719703, -4632.434327464412], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.460280169884734, "mean_inference_ms": 0.38689886193116085, "mean_action_processing_ms": 0.09539774657029178, "mean_env_wait_ms": 1.2902798865014609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035739280808139854, "StateBufferConnector_ms": 0.002679690508775308, "ViewRequirementAgentConnector_ms": 0.06732940673828125}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -4687.77727719703, "episode_reward_mean": -3921.13233538763, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033, -4609.786343718493, -4646.731916170221, -4646.240126459231, -4580.250835543301, -4672.627212563203, -4666.66564498654, -4603.40720630224, -4635.103628215427, -4577.896971877172, -4612.85608087459, -4687.77727719703, -4632.434327464412], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.460280169884734, "mean_inference_ms": 0.38689886193116085, "mean_action_processing_ms": 0.09539774657029178, "mean_env_wait_ms": 1.2902798865014609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035739280808139854, "StateBufferConnector_ms": 0.002679690508775308, "ViewRequirementAgentConnector_ms": 0.06732940673828125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.87449916167462, "num_env_steps_trained_throughput_per_sec": 113.87449916167462, "timesteps_total": 145560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 145560, "timers": {"training_iteration_time_ms": 3175.935, "sample_time_ms": 3165.147, "load_time_ms": 0.298, "load_throughput": 1206222.591, "learn_time_ms": 9.741, "learn_throughput": 36958.381, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "done": false, "episodes_total": 885, "training_iteration": 178, "trial_id": "2eccd_00000", "date": "2023-08-04_09-25-39", "timestamp": 1691130339, "time_this_iter_s": 12.648157119750977, "time_total_s": 1958.7895078659058, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 228.95878100395203, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 21.627777777777776, "ram_util_percent": 64.3111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -333.2041809082031, "policy_loss": -2030467.83125, "vf_loss": 34935939.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 373.0, "diff_num_grad_updates_vs_sampler_policy": 372.0}}, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -4711.453726641512, "episode_reward_mean": -3959.051805506857, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033, -4609.786343718493, -4646.731916170221, -4646.240126459231, -4580.250835543301, -4672.627212563203, -4666.66564498654, -4603.40720630224, -4635.103628215427, -4577.896971877172, -4612.85608087459, -4687.77727719703, -4632.434327464412, -4586.535350456034, -4633.86890741869, -4711.453726641512, -4596.63161597638], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.458365468794157, "mean_inference_ms": 0.38647838965780346, "mean_action_processing_ms": 0.09530761512159075, "mean_env_wait_ms": 1.2744855718153094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035670598347981772, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06759166717529297}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -4711.453726641512, "episode_reward_mean": -3959.051805506857, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033, -4609.786343718493, -4646.731916170221, -4646.240126459231, -4580.250835543301, -4672.627212563203, -4666.66564498654, -4603.40720630224, -4635.103628215427, -4577.896971877172, -4612.85608087459, -4687.77727719703, -4632.434327464412, -4586.535350456034, -4633.86890741869, -4711.453726641512, -4596.63161597638], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.458365468794157, "mean_inference_ms": 0.38647838965780346, "mean_action_processing_ms": 0.09530761512159075, "mean_env_wait_ms": 1.2744855718153094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035670598347981772, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06759166717529297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.81542311678444, "num_env_steps_trained_throughput_per_sec": 113.81542311678444, "timesteps_total": 147000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 147000, "timers": {"training_iteration_time_ms": 3166.684, "sample_time_ms": 3155.424, "load_time_ms": 0.309, "load_throughput": 1166795.024, "learn_time_ms": 10.164, "learn_throughput": 35419.547, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "done": false, "episodes_total": 889, "training_iteration": 179, "trial_id": "2eccd_00000", "date": "2023-08-04_09-25-52", "timestamp": 1691130352, "time_this_iter_s": 12.654862880706787, "time_total_s": 1971.4443707466125, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 241.6136438846588, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 22.694444444444443, "ram_util_percent": 64.41666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -332.8693786621094, "policy_loss": -2655988.98125, "vf_loss": 34939641.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 393.0, "diff_num_grad_updates_vs_sampler_policy": 392.0}}, "num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440}, "sampler_results": {"episode_reward_max": -3530.501526627923, "episode_reward_min": -4727.562065039801, "episode_reward_mean": -3994.626656702419, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033, -4609.786343718493, -4646.731916170221, -4646.240126459231, -4580.250835543301, -4672.627212563203, -4666.66564498654, -4603.40720630224, -4635.103628215427, -4577.896971877172, -4612.85608087459, -4687.77727719703, -4632.434327464412, -4586.535350456034, -4633.86890741869, -4711.453726641512, -4596.63161597638, -4677.335131789493, -4727.562065039801, -4644.076273337796, -4597.646996309662], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.456625349014913, "mean_inference_ms": 0.38610983224737655, "mean_action_processing_ms": 0.09522735877009195, "mean_env_wait_ms": 1.2600703607692678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003587143330634395, "StateBufferConnector_ms": 0.0027228005324737934, "ViewRequirementAgentConnector_ms": 0.06970212429384642}}, "episode_reward_max": -3530.501526627923, "episode_reward_min": -4727.562065039801, "episode_reward_mean": -3994.626656702419, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3532.7345418266286, -3531.9687409165917, -3532.459373679105, -3531.3964208585558, -3531.5003555208627, -3531.334535806403, -3533.864919418433, -3530.501526627923, -3533.8401690093706, -3533.822689286526, -3534.9052881195516, -3534.751379571441, -3535.888675043948, -3538.2893730312794, -3539.1517377077284, -3542.8420293355884, -3547.092866930218, -3554.7057265789203, -3553.323316661104, -3557.621816236165, -3558.6386908397562, -3562.1903487187838, -3563.7172540441243, -3642.8223350373905, -3578.25644381622, -3574.7019404150315, -3583.003772887057, -3573.9400085887946, -3584.819394973064, -3584.5036620947044, -3598.218203568713, -3588.9294951271972, -3587.5338836154665, -3589.574333506343, -3607.5374284925424, -3600.1016543572155, -3613.640925664832, -3603.3412135438066, -3617.3755063861777, -3615.100209008487, -3872.205990484349, -3620.9025666772063, -3614.4339018062883, -3777.2711164808256, -3845.9817628418755, -3632.1978192639804, -3840.4279405242305, -4232.598974335809, -4341.341510536003, -4361.538883402118, -4603.385528718168, -4670.662798824647, -4524.6799021236375, -4458.300143575751, -4518.672959484199, -4526.91804899159, -4612.443138811434, -4623.8649530446355, -4560.848114371033, -4609.786343718493, -4646.731916170221, -4646.240126459231, -4580.250835543301, -4672.627212563203, -4666.66564498654, -4603.40720630224, -4635.103628215427, -4577.896971877172, -4612.85608087459, -4687.77727719703, -4632.434327464412, -4586.535350456034, -4633.86890741869, -4711.453726641512, -4596.63161597638, -4677.335131789493, -4727.562065039801, -4644.076273337796, -4597.646996309662], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.456625349014913, "mean_inference_ms": 0.38610983224737655, "mean_action_processing_ms": 0.09522735877009195, "mean_env_wait_ms": 1.2600703607692678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003587143330634395, "StateBufferConnector_ms": 0.0027228005324737934, "ViewRequirementAgentConnector_ms": 0.06970212429384642}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440, "num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.91738199761838, "num_env_steps_trained_throughput_per_sec": 112.91738199761838, "timesteps_total": 148440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 148440, "timers": {"training_iteration_time_ms": 3171.575, "sample_time_ms": 3160.297, "load_time_ms": 0.31, "load_throughput": 1162841.309, "learn_time_ms": 10.176, "learn_throughput": 35375.649, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440}, "done": false, "episodes_total": 893, "training_iteration": 180, "trial_id": "2eccd_00000", "date": "2023-08-04_09-26-05", "timestamp": 1691130365, "time_this_iter_s": 12.755532026290894, "time_total_s": 1984.1999027729034, "pid": 37095, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x31762fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 254.3691759109497, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.252631578947366, "ram_util_percent": 64.81052631578946}}
