{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -324.77691040039065, "policy_loss": -3995636.759375, "vf_loss": 20771567.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "sampler_results": {"episode_reward_max": -3527.6922681652113, "episode_reward_min": -3528.961153400203, "episode_reward_mean": -3528.4379542505994, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.50582445340505, "mean_inference_ms": 0.37659879749732145, "mean_action_processing_ms": 0.09316542322827533, "mean_env_wait_ms": 3.5090865524249644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00324249267578125, "StateBufferConnector_ms": 0.002940495808919271, "ViewRequirementAgentConnector_ms": 0.06629625956217448}}, "episode_reward_max": -3527.6922681652113, "episode_reward_min": -3528.961153400203, "episode_reward_mean": -3528.4379542505994, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.50582445340505, "mean_inference_ms": 0.37659879749732145, "mean_action_processing_ms": 0.09316542322827533, "mean_env_wait_ms": 3.5090865524249644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00324249267578125, "StateBufferConnector_ms": 0.002940495808919271, "ViewRequirementAgentConnector_ms": 0.06629625956217448}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 86.45497923779998, "num_env_steps_trained_throughput_per_sec": 86.45497923779998, "timesteps_total": 121080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 121080, "timers": {"training_iteration_time_ms": 4164.002, "sample_time_ms": 4147.09, "load_time_ms": 0.48, "load_throughput": 750099.076, "learn_time_ms": 15.602, "learn_throughput": 23073.447, "synch_weights_time_ms": 0.776}, "counters": {"num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "done": false, "episodes_total": 817, "training_iteration": 161, "trial_id": "21a58_00000", "date": "2023-08-04_09-28-50", "timestamp": 1691130530, "time_this_iter_s": 12.49455714225769, "time_total_s": 1742.3252840042114, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.49455714225769, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.53333333333333, "ram_util_percent": 63.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.9666666666666666e-06, "entropy_coeff": 0.05, "policy_entropy": -323.58648071289065, "policy_loss": -6059539.09375, "vf_loss": 20750307.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520}, "sampler_results": {"episode_reward_max": -3527.5774750716814, "episode_reward_min": -3529.4674508266644, "episode_reward_mean": -3528.3237685974223, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535219437879809, "mean_inference_ms": 0.374981513847635, "mean_action_processing_ms": 0.09257251446880563, "mean_env_wait_ms": 2.6554815085290406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003555842808314732, "StateBufferConnector_ms": 0.0029189246041434152, "ViewRequirementAgentConnector_ms": 0.06627014705113002}}, "episode_reward_max": -3527.5774750716814, "episode_reward_min": -3529.4674508266644, "episode_reward_mean": -3528.3237685974223, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535219437879809, "mean_inference_ms": 0.374981513847635, "mean_action_processing_ms": 0.09257251446880563, "mean_env_wait_ms": 2.6554815085290406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003555842808314732, "StateBufferConnector_ms": 0.0029189246041434152, "ViewRequirementAgentConnector_ms": 0.06627014705113002}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520, "num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.03431356445189, "num_env_steps_trained_throughput_per_sec": 111.03431356445189, "timesteps_total": 122520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 122520, "timers": {"training_iteration_time_ms": 3637.274, "sample_time_ms": 3623.886, "load_time_ms": 0.377, "load_throughput": 954025.28, "learn_time_ms": 12.218, "learn_throughput": 29465.138, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520}, "done": false, "episodes_total": 821, "training_iteration": 162, "trial_id": "21a58_00000", "date": "2023-08-04_09-29-03", "timestamp": 1691130543, "time_this_iter_s": 12.97152304649353, "time_total_s": 1755.296807050705, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 25.46608018875122, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.221052631578946, "ram_util_percent": 63.84736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.166666666666667e-06, "entropy_coeff": 0.05, "policy_entropy": -321.10533447265624, "policy_loss": -3725335.665625, "vf_loss": 20717913.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -3529.4674508266644, "episode_reward_mean": -3526.9843315947132, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.563368730040922, "mean_inference_ms": 0.3740514525135643, "mean_action_processing_ms": 0.09229422705753457, "mean_env_wait_ms": 2.2683988932485324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035979531028053975, "StateBufferConnector_ms": 0.003160129893909801, "ViewRequirementAgentConnector_ms": 0.06605928594415839}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -3529.4674508266644, "episode_reward_mean": -3526.9843315947132, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.563368730040922, "mean_inference_ms": 0.3740514525135643, "mean_action_processing_ms": 0.09229422705753457, "mean_env_wait_ms": 2.2683988932485324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035979531028053975, "StateBufferConnector_ms": 0.003160129893909801, "ViewRequirementAgentConnector_ms": 0.06605928594415839}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.22837419347633, "num_env_steps_trained_throughput_per_sec": 110.22837419347633, "timesteps_total": 123960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 123960, "timers": {"training_iteration_time_ms": 3245.341, "sample_time_ms": 3234.556, "load_time_ms": 0.301, "load_throughput": 1196189.052, "learn_time_ms": 9.732, "learn_throughput": 36990.523, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "done": false, "episodes_total": 825, "training_iteration": 163, "trial_id": "21a58_00000", "date": "2023-08-04_09-29-16", "timestamp": 1691130556, "time_this_iter_s": 13.066834926605225, "time_total_s": 1768.3636419773102, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 38.532915115356445, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.644444444444446, "ram_util_percent": 63.87222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.327777777777778e-06, "entropy_coeff": 0.05, "policy_entropy": -319.87107543945314, "policy_loss": 287354.2375, "vf_loss": 20699870.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -3538.3931126299844, "episode_reward_mean": -3527.2735048056416, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.576722680826519, "mean_inference_ms": 0.37346462051126805, "mean_action_processing_ms": 0.09212352321648033, "mean_env_wait_ms": 2.037319563636327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034809112548828125, "StateBufferConnector_ms": 0.0030851364135742188, "ViewRequirementAgentConnector_ms": 0.0657971700032552}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -3538.3931126299844, "episode_reward_mean": -3527.2735048056416, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.576722680826519, "mean_inference_ms": 0.37346462051126805, "mean_action_processing_ms": 0.09212352321648033, "mean_env_wait_ms": 2.037319563636327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034809112548828125, "StateBufferConnector_ms": 0.0030851364135742188, "ViewRequirementAgentConnector_ms": 0.0657971700032552}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.9635769520419, "num_env_steps_trained_throughput_per_sec": 110.9635769520419, "timesteps_total": 125400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 125400, "timers": {"training_iteration_time_ms": 3253.911, "sample_time_ms": 3243.202, "load_time_ms": 0.303, "load_throughput": 1186880.553, "learn_time_ms": 9.647, "learn_throughput": 37318.546, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "done": false, "episodes_total": 829, "training_iteration": 164, "trial_id": "21a58_00000", "date": "2023-08-04_09-29-29", "timestamp": 1691130569, "time_this_iter_s": 12.979719161987305, "time_total_s": 1781.3433611392975, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 51.51263427734375, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.942105263157895, "ram_util_percent": 63.821052631578944}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.1277777777777774e-06, "entropy_coeff": 0.05, "policy_entropy": -320.42877197265625, "policy_loss": -4349852.615625, "vf_loss": 20834585.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -3542.552841854304, "episode_reward_mean": -3528.9147786203307, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.582072988335142, "mean_inference_ms": 0.3731814683227082, "mean_action_processing_ms": 0.09203348344763228, "mean_env_wait_ms": 1.8813786339161205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003414405019659745, "StateBufferConnector_ms": 0.0030279159545898438, "ViewRequirementAgentConnector_ms": 0.06574706027382299}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -3542.552841854304, "episode_reward_mean": -3528.9147786203307, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.582072988335142, "mean_inference_ms": 0.3731814683227082, "mean_action_processing_ms": 0.09203348344763228, "mean_env_wait_ms": 1.8813786339161205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003414405019659745, "StateBufferConnector_ms": 0.0030279159545898438, "ViewRequirementAgentConnector_ms": 0.06574706027382299}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.36899724053788, "num_env_steps_trained_throughput_per_sec": 111.36899724053788, "timesteps_total": 126840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 126840, "timers": {"training_iteration_time_ms": 3242.398, "sample_time_ms": 3231.695, "load_time_ms": 0.3, "load_throughput": 1198562.819, "learn_time_ms": 9.644, "learn_throughput": 37327.587, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "done": false, "episodes_total": 833, "training_iteration": 165, "trial_id": "21a58_00000", "date": "2023-08-04_09-29-42", "timestamp": 1691130582, "time_this_iter_s": 12.932562828063965, "time_total_s": 1794.2759239673615, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 64.44519710540771, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.427777777777777, "ram_util_percent": 63.73333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9277777777777773e-06, "entropy_coeff": 0.05, "policy_entropy": -323.58306884765625, "policy_loss": -9854097.7875, "vf_loss": 27514473.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -3948.8174389697992, "episode_reward_mean": -3569.164009771854, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.587434823994625, "mean_inference_ms": 0.3729927660260033, "mean_action_processing_ms": 0.09196705439998375, "mean_env_wait_ms": 1.7680042050026226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034912772800611415, "StateBufferConnector_ms": 0.0030071839042331862, "ViewRequirementAgentConnector_ms": 0.06590407827626103}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -3948.8174389697992, "episode_reward_mean": -3569.164009771854, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.587434823994625, "mean_inference_ms": 0.3729927660260033, "mean_action_processing_ms": 0.09196705439998375, "mean_env_wait_ms": 1.7680042050026226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034912772800611415, "StateBufferConnector_ms": 0.0030071839042331862, "ViewRequirementAgentConnector_ms": 0.06590407827626103}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.00036935135564, "num_env_steps_trained_throughput_per_sec": 110.00036935135564, "timesteps_total": 128280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 128280, "timers": {"training_iteration_time_ms": 3254.215, "sample_time_ms": 3243.505, "load_time_ms": 0.298, "load_throughput": 1208636.388, "learn_time_ms": 9.651, "learn_throughput": 37300.109, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "done": false, "episodes_total": 837, "training_iteration": 166, "trial_id": "21a58_00000", "date": "2023-08-04_09-29-55", "timestamp": 1691130595, "time_this_iter_s": 13.093462944030762, "time_total_s": 1807.3693869113922, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 77.53866004943848, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.9, "ram_util_percent": 63.86842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -324.5049255371094, "policy_loss": 221342.428125, "vf_loss": 20856864.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 133.0, "diff_num_grad_updates_vs_sampler_policy": 132.0}}, "num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -3948.8174389697992, "episode_reward_mean": -3580.2394148530925, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.590947522673047, "mean_inference_ms": 0.37284791888930585, "mean_action_processing_ms": 0.0919069417476692, "mean_env_wait_ms": 1.6810728908716612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003452654238100405, "StateBufferConnector_ms": 0.002991711651837384, "ViewRequirementAgentConnector_ms": 0.06591743893093532}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -3948.8174389697992, "episode_reward_mean": -3580.2394148530925, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.590947522673047, "mean_inference_ms": 0.37284791888930585, "mean_action_processing_ms": 0.0919069417476692, "mean_env_wait_ms": 1.6810728908716612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003452654238100405, "StateBufferConnector_ms": 0.002991711651837384, "ViewRequirementAgentConnector_ms": 0.06591743893093532}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720, "num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.85929106119681, "num_env_steps_trained_throughput_per_sec": 110.85929106119681, "timesteps_total": 129720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 129720, "timers": {"training_iteration_time_ms": 3262.466, "sample_time_ms": 3251.747, "load_time_ms": 0.292, "load_throughput": 1233820.428, "learn_time_ms": 9.654, "learn_throughput": 37288.687, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720}, "done": false, "episodes_total": 841, "training_iteration": 167, "trial_id": "21a58_00000", "date": "2023-08-04_09-30-08", "timestamp": 1691130608, "time_this_iter_s": 12.992012977600098, "time_total_s": 1820.3613998889923, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 90.53067302703857, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.972222222222218, "ram_util_percent": 63.77222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -324.49432983398435, "policy_loss": -2450003.165625, "vf_loss": 20917833.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 152.0}}, "num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -3948.8174389697992, "episode_reward_mean": -3579.117035510697, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.594995298683682, "mean_inference_ms": 0.37276756137587685, "mean_action_processing_ms": 0.09186531697720651, "mean_env_wait_ms": 1.611619054544512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487063992408014, "StateBufferConnector_ms": 0.0029933068060105845, "ViewRequirementAgentConnector_ms": 0.06580198964764995}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -3948.8174389697992, "episode_reward_mean": -3579.117035510697, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.594995298683682, "mean_inference_ms": 0.37276756137587685, "mean_action_processing_ms": 0.09186531697720651, "mean_env_wait_ms": 1.611619054544512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487063992408014, "StateBufferConnector_ms": 0.0029933068060105845, "ViewRequirementAgentConnector_ms": 0.06580198964764995}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160, "num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.89701340681104, "num_env_steps_trained_throughput_per_sec": 109.89701340681104, "timesteps_total": 131160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 131160, "timers": {"training_iteration_time_ms": 3269.553, "sample_time_ms": 3258.837, "load_time_ms": 0.293, "load_throughput": 1229900.986, "learn_time_ms": 9.638, "learn_throughput": 37353.536, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160}, "done": false, "episodes_total": 845, "training_iteration": 168, "trial_id": "21a58_00000", "date": "2023-08-04_09-30-21", "timestamp": 1691130621, "time_this_iter_s": 13.105863094329834, "time_total_s": 1833.4672629833221, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 103.63653612136841, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.83157894736842, "ram_util_percent": 63.67368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -324.67747802734374, "policy_loss": -3979881.484375, "vf_loss": 22061125.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 172.0}}, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -3993.031919461991, "episode_reward_mean": -3594.7457635117794, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.597992359395603, "mean_inference_ms": 0.37276052189408426, "mean_action_processing_ms": 0.09183610626503942, "mean_env_wait_ms": 1.5548768615337811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034366335187639508, "StateBufferConnector_ms": 0.002968651907784598, "ViewRequirementAgentConnector_ms": 0.06575243813650948}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -3993.031919461991, "episode_reward_mean": -3594.7457635117794, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.597992359395603, "mean_inference_ms": 0.37276052189408426, "mean_action_processing_ms": 0.09183610626503942, "mean_env_wait_ms": 1.5548768615337811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034366335187639508, "StateBufferConnector_ms": 0.002968651907784598, "ViewRequirementAgentConnector_ms": 0.06575243813650948}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.69070822286496, "num_env_steps_trained_throughput_per_sec": 110.69070822286496, "timesteps_total": 132600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 132600, "timers": {"training_iteration_time_ms": 3264.846, "sample_time_ms": 3254.133, "load_time_ms": 0.294, "load_throughput": 1224415.699, "learn_time_ms": 9.646, "learn_throughput": 37322.236, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "done": false, "episodes_total": 849, "training_iteration": 169, "trial_id": "21a58_00000", "date": "2023-08-04_09-30-34", "timestamp": 1691130634, "time_this_iter_s": 13.01173210144043, "time_total_s": 1846.4789950847626, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 116.64826822280884, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.18421052631579, "ram_util_percent": 63.76842105263159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -324.62944946289065, "policy_loss": -5566595.134375, "vf_loss": 21008605.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 192.0}}, "num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -3993.031919461991, "episode_reward_mean": -3594.9171527688354, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.601064845017097, "mean_inference_ms": 0.3727626490633362, "mean_action_processing_ms": 0.09181129187805162, "mean_env_wait_ms": 1.5075249852156931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034106083405323518, "StateBufferConnector_ms": 0.002975952930939503, "ViewRequirementAgentConnector_ms": 0.0657796859741211}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -3993.031919461991, "episode_reward_mean": -3594.9171527688354, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.601064845017097, "mean_inference_ms": 0.3727626490633362, "mean_action_processing_ms": 0.09181129187805162, "mean_env_wait_ms": 1.5075249852156931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034106083405323518, "StateBufferConnector_ms": 0.002975952930939503, "ViewRequirementAgentConnector_ms": 0.0657796859741211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040, "num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.81946856725197, "num_env_steps_trained_throughput_per_sec": 109.81946856725197, "timesteps_total": 134040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 134040, "timers": {"training_iteration_time_ms": 3268.912, "sample_time_ms": 3258.196, "load_time_ms": 0.295, "load_throughput": 1219569.857, "learn_time_ms": 9.657, "learn_throughput": 37278.928, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040}, "done": false, "episodes_total": 853, "training_iteration": 170, "trial_id": "21a58_00000", "date": "2023-08-04_09-30-47", "timestamp": 1691130647, "time_this_iter_s": 13.115056991577148, "time_total_s": 1859.5940520763397, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 129.763325214386, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.733333333333334, "ram_util_percent": 63.80555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -324.8330810546875, "policy_loss": -54822.06796875, "vf_loss": 21060090.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 213.0, "diff_num_grad_updates_vs_sampler_policy": 212.0}}, "num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -3993.031919461991, "episode_reward_mean": -3591.648344582583, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.602978453877863, "mean_inference_ms": 0.3727368061248003, "mean_action_processing_ms": 0.09178583461187032, "mean_env_wait_ms": 1.467139041497852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035535457522370096, "StateBufferConnector_ms": 0.002960271613542424, "ViewRequirementAgentConnector_ms": 0.06564384283021439}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -3993.031919461991, "episode_reward_mean": -3591.648344582583, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.602978453877863, "mean_inference_ms": 0.3727368061248003, "mean_action_processing_ms": 0.09178583461187032, "mean_env_wait_ms": 1.467139041497852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035535457522370096, "StateBufferConnector_ms": 0.002960271613542424, "ViewRequirementAgentConnector_ms": 0.06564384283021439}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480, "num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.68835508943708, "num_env_steps_trained_throughput_per_sec": 111.68835508943708, "timesteps_total": 135480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 135480, "timers": {"training_iteration_time_ms": 3251.082, "sample_time_ms": 3240.389, "load_time_ms": 0.295, "load_throughput": 1219865.439, "learn_time_ms": 9.633, "learn_throughput": 37371.748, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480}, "done": false, "episodes_total": 857, "training_iteration": 171, "trial_id": "21a58_00000", "date": "2023-08-04_09-31-00", "timestamp": 1691130660, "time_this_iter_s": 12.895565032958984, "time_total_s": 1872.4896171092987, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 142.65889024734497, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.58421052631579, "ram_util_percent": 63.863157894736844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -323.921435546875, "policy_loss": -3290927.499609375, "vf_loss": 21797990.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 232.0}}, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -3993.031919461991, "episode_reward_mean": -3592.446152120206, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.604845879004401, "mean_inference_ms": 0.3726991864453778, "mean_action_processing_ms": 0.09176291326008185, "mean_env_wait_ms": 1.4323440544115131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003586424157974568, "StateBufferConnector_ms": 0.002963492210875166, "ViewRequirementAgentConnector_ms": 0.06568178217461769}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -3993.031919461991, "episode_reward_mean": -3592.446152120206, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.604845879004401, "mean_inference_ms": 0.3726991864453778, "mean_action_processing_ms": 0.09176291326008185, "mean_env_wait_ms": 1.4323440544115131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003586424157974568, "StateBufferConnector_ms": 0.002963492210875166, "ViewRequirementAgentConnector_ms": 0.06568178217461769}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.24330105779616, "num_env_steps_trained_throughput_per_sec": 110.24330105779616, "timesteps_total": 136920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 136920, "timers": {"training_iteration_time_ms": 3248.417, "sample_time_ms": 3237.705, "load_time_ms": 0.297, "load_throughput": 1213005.656, "learn_time_ms": 9.667, "learn_throughput": 37241.874, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "done": false, "episodes_total": 861, "training_iteration": 172, "trial_id": "21a58_00000", "date": "2023-08-04_09-31-13", "timestamp": 1691130673, "time_this_iter_s": 13.064688205718994, "time_total_s": 1885.5543053150177, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 155.72357845306396, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.5, "ram_util_percent": 63.54999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.05, "policy_entropy": -323.84474487304686, "policy_loss": -1772679.425, "vf_loss": 31168510.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 253.0, "diff_num_grad_updates_vs_sampler_policy": 252.0}}, "num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -4381.963606085635, "episode_reward_mean": -3635.0077256989384, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6069433903166495, "mean_inference_ms": 0.37265804110188183, "mean_action_processing_ms": 0.09174181105454757, "mean_env_wait_ms": 1.4020134468777785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544957030053232, "StateBufferConnector_ms": 0.002962467717189415, "ViewRequirementAgentConnector_ms": 0.0657198475856407}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -4381.963606085635, "episode_reward_mean": -3635.0077256989384, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6069433903166495, "mean_inference_ms": 0.37265804110188183, "mean_action_processing_ms": 0.09174181105454757, "mean_env_wait_ms": 1.4020134468777785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544957030053232, "StateBufferConnector_ms": 0.002962467717189415, "ViewRequirementAgentConnector_ms": 0.0657198475856407}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360, "num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.63488889211996, "num_env_steps_trained_throughput_per_sec": 109.63488889211996, "timesteps_total": 138360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 138360, "timers": {"training_iteration_time_ms": 3257.976, "sample_time_ms": 3247.318, "load_time_ms": 0.296, "load_throughput": 1217995.838, "learn_time_ms": 9.615, "learn_throughput": 37442.457, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360}, "done": false, "episodes_total": 865, "training_iteration": 173, "trial_id": "21a58_00000", "date": "2023-08-04_09-31-27", "timestamp": 1691130687, "time_this_iter_s": 13.137574911117554, "time_total_s": 1898.6918802261353, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 168.86115336418152, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.821052631578947, "ram_util_percent": 63.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.316666666666667e-06, "entropy_coeff": 0.05, "policy_entropy": -323.54871826171876, "policy_loss": -9898545.25, "vf_loss": 31836867.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 273.0, "diff_num_grad_updates_vs_sampler_policy": 272.0}}, "num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -4381.963606085635, "episode_reward_mean": -3686.8437617958475, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.608628248063188, "mean_inference_ms": 0.3726161471690651, "mean_action_processing_ms": 0.09172369996397065, "mean_env_wait_ms": 1.375238336924435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519925204190341, "StateBufferConnector_ms": 0.0029663606123490767, "ViewRequirementAgentConnector_ms": 0.06571596319025214}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -4381.963606085635, "episode_reward_mean": -3686.8437617958475, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.608628248063188, "mean_inference_ms": 0.3726161471690651, "mean_action_processing_ms": 0.09172369996397065, "mean_env_wait_ms": 1.375238336924435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519925204190341, "StateBufferConnector_ms": 0.0029663606123490767, "ViewRequirementAgentConnector_ms": 0.06571596319025214}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800, "num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.97558578467594, "num_env_steps_trained_throughput_per_sec": 110.97558578467594, "timesteps_total": 139800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 139800, "timers": {"training_iteration_time_ms": 3266.416, "sample_time_ms": 3255.75, "load_time_ms": 0.296, "load_throughput": 1217210.351, "learn_time_ms": 9.615, "learn_throughput": 37442.457, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800}, "done": false, "episodes_total": 869, "training_iteration": 174, "trial_id": "21a58_00000", "date": "2023-08-04_09-31-40", "timestamp": 1691130700, "time_this_iter_s": 12.978605031967163, "time_total_s": 1911.6704852581024, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 181.83975839614868, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.766666666666666, "ram_util_percent": 63.51666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7166666666666666e-06, "entropy_coeff": 0.05, "policy_entropy": -325.399755859375, "policy_loss": -10224437.5125, "vf_loss": 36212624.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -4631.277258745605, "episode_reward_mean": -3743.4694438687548, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.609908406540193, "mean_inference_ms": 0.37257258953292116, "mean_action_processing_ms": 0.09170758581278236, "mean_env_wait_ms": 1.3517091319596426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495054729914261, "StateBufferConnector_ms": 0.0029685133594577594, "ViewRequirementAgentConnector_ms": 0.0657421047404661}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -4631.277258745605, "episode_reward_mean": -3743.4694438687548, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.609908406540193, "mean_inference_ms": 0.37257258953292116, "mean_action_processing_ms": 0.09170758581278236, "mean_env_wait_ms": 1.3517091319596426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495054729914261, "StateBufferConnector_ms": 0.0029685133594577594, "ViewRequirementAgentConnector_ms": 0.0657421047404661}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.4077819472735, "num_env_steps_trained_throughput_per_sec": 110.4077819472735, "timesteps_total": 141240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 141240, "timers": {"training_iteration_time_ms": 3255.017, "sample_time_ms": 3244.276, "load_time_ms": 0.296, "load_throughput": 1214762.22, "learn_time_ms": 9.674, "learn_throughput": 37214.155, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "done": false, "episodes_total": 873, "training_iteration": 175, "trial_id": "21a58_00000", "date": "2023-08-04_09-31-53", "timestamp": 1691130713, "time_this_iter_s": 13.045248031616211, "time_total_s": 1924.7157332897186, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 194.8850064277649, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.4, "ram_util_percent": 63.60526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1166666666666666e-06, "entropy_coeff": 0.05, "policy_entropy": -324.2539978027344, "policy_loss": -13194159.290625, "vf_loss": 33294765.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 313.0, "diff_num_grad_updates_vs_sampler_policy": 312.0}}, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -4818.416084987273, "episode_reward_mean": -3797.926145871914, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605, -4818.416084987273, -4559.741430099256, -4540.460476808332, -4486.032009779131], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.611058921322128, "mean_inference_ms": 0.3725193167147171, "mean_action_processing_ms": 0.0916909923726812, "mean_env_wait_ms": 1.3306347166896635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034722070845346602, "StateBufferConnector_ms": 0.0029507137480236237, "ViewRequirementAgentConnector_ms": 0.06571043105352492}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -4818.416084987273, "episode_reward_mean": -3797.926145871914, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605, -4818.416084987273, -4559.741430099256, -4540.460476808332, -4486.032009779131], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.611058921322128, "mean_inference_ms": 0.3725193167147171, "mean_action_processing_ms": 0.0916909923726812, "mean_env_wait_ms": 1.3306347166896635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034722070845346602, "StateBufferConnector_ms": 0.0029507137480236237, "ViewRequirementAgentConnector_ms": 0.06571043105352492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.58122467497597, "num_env_steps_trained_throughput_per_sec": 110.58122467497597, "timesteps_total": 142680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 142680, "timers": {"training_iteration_time_ms": 3259.592, "sample_time_ms": 3248.877, "load_time_ms": 0.293, "load_throughput": 1229100.073, "learn_time_ms": 9.645, "learn_throughput": 37323.712, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "done": false, "episodes_total": 877, "training_iteration": 176, "trial_id": "21a58_00000", "date": "2023-08-04_09-32-06", "timestamp": 1691130726, "time_this_iter_s": 13.024874925613403, "time_total_s": 1937.740608215332, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 207.9098813533783, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.505555555555553, "ram_util_percent": 63.76111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -324.02960815429685, "policy_loss": -2719010.55, "vf_loss": 33397971.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 333.0, "diff_num_grad_updates_vs_sampler_policy": 332.0}}, "num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -4818.416084987273, "episode_reward_mean": -3841.411648310838, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605, -4818.416084987273, -4559.741430099256, -4540.460476808332, -4486.032009779131, -4496.091513789332, -4491.850403643645, -4624.155201041354, -4493.136128421254], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.612301160061486, "mean_inference_ms": 0.37247575343437833, "mean_action_processing_ms": 0.09167841976870401, "mean_env_wait_ms": 1.3115852041097211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035029738696653453, "StateBufferConnector_ms": 0.0029656424451230175, "ViewRequirementAgentConnector_ms": 0.06579036143288683}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -4818.416084987273, "episode_reward_mean": -3841.411648310838, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605, -4818.416084987273, -4559.741430099256, -4540.460476808332, -4486.032009779131, -4496.091513789332, -4491.850403643645, -4624.155201041354, -4493.136128421254], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.612301160061486, "mean_inference_ms": 0.37247575343437833, "mean_action_processing_ms": 0.09167841976870401, "mean_env_wait_ms": 1.3115852041097211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035029738696653453, "StateBufferConnector_ms": 0.0029656424451230175, "ViewRequirementAgentConnector_ms": 0.06579036143288683}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120, "num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.98763926991039, "num_env_steps_trained_throughput_per_sec": 109.98763926991039, "timesteps_total": 144120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 144120, "timers": {"training_iteration_time_ms": 3260.135, "sample_time_ms": 3249.44, "load_time_ms": 0.29, "load_throughput": 1240714.412, "learn_time_ms": 9.606, "learn_throughput": 37475.632, "synch_weights_time_ms": 0.754}, "counters": {"num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120}, "done": false, "episodes_total": 881, "training_iteration": 177, "trial_id": "21a58_00000", "date": "2023-08-04_09-32-19", "timestamp": 1691130739, "time_this_iter_s": 13.095091342926025, "time_total_s": 1950.835699558258, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 221.00497269630432, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.273684210526316, "ram_util_percent": 63.71052631578949}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -323.7714904785156, "policy_loss": 418455.06875, "vf_loss": 33364378.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 352.0}}, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -4818.416084987273, "episode_reward_mean": -3880.8489988657284, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605, -4818.416084987273, -4559.741430099256, -4540.460476808332, -4486.032009779131, -4496.091513789332, -4491.850403643645, -4624.155201041354, -4493.136128421254, -4570.098026911517, -4489.59130571768, -4613.8627619519575, -4492.146388059427], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.613191309370625, "mean_inference_ms": 0.3724346450857184, "mean_action_processing_ms": 0.09166722169259507, "mean_env_wait_ms": 1.2943178510519249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003526915966624945, "StateBufferConnector_ms": 0.002967136006959727, "ViewRequirementAgentConnector_ms": 0.06580655003937197}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -4818.416084987273, "episode_reward_mean": -3880.8489988657284, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605, -4818.416084987273, -4559.741430099256, -4540.460476808332, -4486.032009779131, -4496.091513789332, -4491.850403643645, -4624.155201041354, -4493.136128421254, -4570.098026911517, -4489.59130571768, -4613.8627619519575, -4492.146388059427], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.613191309370625, "mean_inference_ms": 0.3724346450857184, "mean_action_processing_ms": 0.09166722169259507, "mean_env_wait_ms": 1.2943178510519249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003526915966624945, "StateBufferConnector_ms": 0.002967136006959727, "ViewRequirementAgentConnector_ms": 0.06580655003937197}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.39353029795225, "num_env_steps_trained_throughput_per_sec": 111.39353029795225, "timesteps_total": 145560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 145560, "timers": {"training_iteration_time_ms": 3257.549, "sample_time_ms": 3246.846, "load_time_ms": 0.293, "load_throughput": 1229600.521, "learn_time_ms": 9.636, "learn_throughput": 37360.375, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "done": false, "episodes_total": 885, "training_iteration": 178, "trial_id": "21a58_00000", "date": "2023-08-04_09-32-32", "timestamp": 1691130752, "time_this_iter_s": 12.929798126220703, "time_total_s": 1963.7654976844788, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 233.93477082252502, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.626315789473686, "ram_util_percent": 63.81052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -323.84661865234375, "policy_loss": -16327761.65, "vf_loss": 34805304.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 373.0, "diff_num_grad_updates_vs_sampler_policy": 372.0}}, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -4818.416084987273, "episode_reward_mean": -3916.7098236312236, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605, -4818.416084987273, -4559.741430099256, -4540.460476808332, -4486.032009779131, -4496.091513789332, -4491.850403643645, -4624.155201041354, -4493.136128421254, -4570.098026911517, -4489.59130571768, -4613.8627619519575, -4492.146388059427, -4501.417032580811, -4585.62838128752, -4538.990334473089, -4586.92210453371], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.614140506715248, "mean_inference_ms": 0.3723968949267671, "mean_action_processing_ms": 0.09165756015939829, "mean_env_wait_ms": 1.278669313103043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035066604614257812, "StateBufferConnector_ms": 0.0029627482096354165, "ViewRequirementAgentConnector_ms": 0.06581687927246094}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -4818.416084987273, "episode_reward_mean": -3916.7098236312236, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605, -4818.416084987273, -4559.741430099256, -4540.460476808332, -4486.032009779131, -4496.091513789332, -4491.850403643645, -4624.155201041354, -4493.136128421254, -4570.098026911517, -4489.59130571768, -4613.8627619519575, -4492.146388059427, -4501.417032580811, -4585.62838128752, -4538.990334473089, -4586.92210453371], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.614140506715248, "mean_inference_ms": 0.3723968949267671, "mean_action_processing_ms": 0.09165756015939829, "mean_env_wait_ms": 1.278669313103043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035066604614257812, "StateBufferConnector_ms": 0.0029627482096354165, "ViewRequirementAgentConnector_ms": 0.06581687927246094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.59014779161744, "num_env_steps_trained_throughput_per_sec": 109.59014779161744, "timesteps_total": 147000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 147000, "timers": {"training_iteration_time_ms": 3253.309, "sample_time_ms": 3242.577, "load_time_ms": 0.294, "load_throughput": 1225210.516, "learn_time_ms": 9.671, "learn_throughput": 37224.613, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "done": false, "episodes_total": 889, "training_iteration": 179, "trial_id": "21a58_00000", "date": "2023-08-04_09-32-45", "timestamp": 1691130765, "time_this_iter_s": 13.142544984817505, "time_total_s": 1976.9080426692963, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 247.07731580734253, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.416666666666668, "ram_util_percent": 63.455555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -327.0672119140625, "policy_loss": -4672762.375, "vf_loss": 41420144.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 393.0, "diff_num_grad_updates_vs_sampler_policy": 392.0}}, "num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440}, "sampler_results": {"episode_reward_max": -3523.6114899242466, "episode_reward_min": -4949.658893951006, "episode_reward_mean": -3953.5476198856863, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605, -4818.416084987273, -4559.741430099256, -4540.460476808332, -4486.032009779131, -4496.091513789332, -4491.850403643645, -4624.155201041354, -4493.136128421254, -4570.098026911517, -4489.59130571768, -4613.8627619519575, -4492.146388059427, -4501.417032580811, -4585.62838128752, -4538.990334473089, -4586.92210453371, -4496.368391975939, -4635.433522738802, -4495.564389961736, -4949.658893951006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.615331886060371, "mean_inference_ms": 0.3723553257968514, "mean_action_processing_ms": 0.09164738364091174, "mean_env_wait_ms": 1.26435314259259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034875507596172865, "StateBufferConnector_ms": 0.002956390380859375, "ViewRequirementAgentConnector_ms": 0.06583732894704311}}, "episode_reward_max": -3523.6114899242466, "episode_reward_min": -4949.658893951006, "episode_reward_mean": -3953.5476198856863, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6922681652113, -3528.961153400203, -3528.6604411863846, -3528.175927990607, -3527.5774750716814, -3529.4674508266644, -3527.7316635412026, -3525.7402491930916, -3524.372079468787, -3523.6114899242466, -3524.837448773768, -3524.3207176166065, -3524.8772525495674, -3538.3931126299844, -3524.683841746617, -3530.3368161919757, -3528.93535681021, -3542.552841854304, -3538.4532068451726, -3744.191553665599, -3803.635018721793, -3544.747419609166, -3948.8174389697992, -3879.4764974468353, -3546.6217228752553, -3609.795806486946, -3539.7979494718365, -3638.5185062088435, -3547.8185977735325, -3554.314366470618, -3545.512429345124, -3993.031919461991, -3624.7617980123714, -3621.6175283160055, -3624.062376290263, -3553.214003235693, -3574.1264724566972, -3702.8608617630857, -3555.465897616823, -3557.0504401134867, -3561.2974453946676, -3561.6561812395976, -3559.105792318725, -3558.4537205927522, -3563.737626651346, -3627.4780940206524, -3654.420891333853, -3627.6193663668855, -4381.963606085635, -4232.639744160405, -4298.202144383295, -4319.126103621575, -4363.544689088293, -4343.149965286287, -4365.192130129581, -4464.173454318753, -4460.344129521906, -4532.4954468986825, -4631.277258745605, -4818.416084987273, -4559.741430099256, -4540.460476808332, -4486.032009779131, -4496.091513789332, -4491.850403643645, -4624.155201041354, -4493.136128421254, -4570.098026911517, -4489.59130571768, -4613.8627619519575, -4492.146388059427, -4501.417032580811, -4585.62838128752, -4538.990334473089, -4586.92210453371, -4496.368391975939, -4635.433522738802, -4495.564389961736, -4949.658893951006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.615331886060371, "mean_inference_ms": 0.3723553257968514, "mean_action_processing_ms": 0.09164738364091174, "mean_env_wait_ms": 1.26435314259259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034875507596172865, "StateBufferConnector_ms": 0.002956390380859375, "ViewRequirementAgentConnector_ms": 0.06583732894704311}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440, "num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.95810393562093, "num_env_steps_trained_throughput_per_sec": 108.95810393562093, "timesteps_total": 148440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 148440, "timers": {"training_iteration_time_ms": 3271.318, "sample_time_ms": 3260.582, "load_time_ms": 0.292, "load_throughput": 1231003.946, "learn_time_ms": 9.686, "learn_throughput": 37166.98, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440}, "done": false, "episodes_total": 893, "training_iteration": 180, "trial_id": "21a58_00000", "date": "2023-08-04_09-32-58", "timestamp": 1691130778, "time_this_iter_s": 13.218996047973633, "time_total_s": 1990.12703871727, "pid": 37387, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-06], [124600, 8e-06], [128200, 2.5e-06], [131800, 2.5e-06], [135400, 2.5e-06], [139000, 2.5e-06], [142600, 1e-06], [146200, 1e-06], [149800, 1e-06], [153400, 5e-07], [157000, 5e-07], [160600, 5e-07], [164200, 5e-07], [167800, 1e-07], [171400, 1e-07], [175000, 1e-07], [178600, 1e-07], [182200, 5e-08], [185800, 5e-08], [189400, 2.5e-08], [193000, 2.5e-08], [196600, 1e-08], [200200, 1e-08], [203800, 5e-09], [207400, 5e-09], [211000, 1e-09]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17ff1cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 260.29631185531616, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.01578947368421, "ram_util_percent": 63.56842105263158}}
