{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.29949340820315, "policy_loss": -3674836.225, "vf_loss": 20748882.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 393600, "num_env_steps_trained": 393600, "num_agent_steps_sampled": 393600, "num_agent_steps_trained": 393600}, "sampler_results": {"episode_reward_max": -3526.845482406289, "episode_reward_min": -3528.5741034382445, "episode_reward_mean": -3527.484294803745, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043], "episode_lengths": [360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349466696638057, "mean_inference_ms": 0.23539327105702718, "mean_action_processing_ms": 0.057506534803052664, "mean_env_wait_ms": 1.5314790290438551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027894973754882812, "StateBufferConnector_ms": 0.0017023086547851562, "ViewRequirementAgentConnector_ms": 0.0439453125}}, "episode_reward_max": -3526.845482406289, "episode_reward_min": -3528.5741034382445, "episode_reward_mean": -3527.484294803745, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043], "episode_lengths": [360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349466696638057, "mean_inference_ms": 0.23539327105702718, "mean_action_processing_ms": 0.057506534803052664, "mean_env_wait_ms": 1.5314790290438551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027894973754882812, "StateBufferConnector_ms": 0.0017023086547851562, "ViewRequirementAgentConnector_ms": 0.0439453125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 393600, "num_agent_steps_trained": 393600, "num_env_steps_sampled": 393600, "num_env_steps_trained": 393600, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.7281522890414, "num_env_steps_trained_throughput_per_sec": 160.7281522890414, "timesteps_total": 393600, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 393600, "timers": {"training_iteration_time_ms": 2239.795, "sample_time_ms": 2229.689, "load_time_ms": 0.285, "load_throughput": 1261444.812, "learn_time_ms": 9.277, "learn_throughput": 38806.006, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 393600, "num_env_steps_trained": 393600, "num_agent_steps_sampled": 393600, "num_agent_steps_trained": 393600}, "done": false, "episodes_total": 1574, "training_iteration": 306, "trial_id": "6192e_00000", "date": "2023-08-04_10-49-18", "timestamp": 1691135358, "time_this_iter_s": 11.200889110565186, "time_total_s": 3381.6599128246307, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.200889110565186, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 26.1625, "ram_util_percent": 65.83125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.26860961914065, "policy_loss": 307557.6359375, "vf_loss": 20732723.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 395760, "num_env_steps_trained": 395760, "num_agent_steps_sampled": 395760, "num_agent_steps_trained": 395760}, "sampler_results": {"episode_reward_max": -3525.8403646850343, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.5783922789547, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349658571288127, "mean_inference_ms": 0.23518893859605813, "mean_action_processing_ms": 0.05738650985941935, "mean_env_wait_ms": 1.2492819896161798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027548183094371448, "StateBufferConnector_ms": 0.0017816370183771307, "ViewRequirementAgentConnector_ms": 0.04409226504239169}}, "episode_reward_max": -3525.8403646850343, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.5783922789547, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349658571288127, "mean_inference_ms": 0.23518893859605813, "mean_action_processing_ms": 0.05738650985941935, "mean_env_wait_ms": 1.2492819896161798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027548183094371448, "StateBufferConnector_ms": 0.0017816370183771307, "ViewRequirementAgentConnector_ms": 0.04409226504239169}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 395760, "num_agent_steps_trained": 395760, "num_env_steps_sampled": 395760, "num_env_steps_trained": 395760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.11110561556438, "num_env_steps_trained_throughput_per_sec": 190.11110561556438, "timesteps_total": 395760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 395760, "timers": {"training_iteration_time_ms": 1891.974, "sample_time_ms": 1884.988, "load_time_ms": 0.212, "load_throughput": 1694668.283, "learn_time_ms": 6.252, "learn_throughput": 57579.134, "synch_weights_time_ms": 0.491}, "counters": {"num_env_steps_sampled": 395760, "num_env_steps_trained": 395760, "num_agent_steps_sampled": 395760, "num_agent_steps_trained": 395760}, "done": false, "episodes_total": 1580, "training_iteration": 307, "trial_id": "6192e_00000", "date": "2023-08-04_10-49-29", "timestamp": 1691135369, "time_this_iter_s": 11.36363434791565, "time_total_s": 3393.0235471725464, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.564523458480835, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.288235294117648, "ram_util_percent": 65.84705882352942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2224426269531, "policy_loss": 328575.65, "vf_loss": 20729878.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 397920, "num_env_steps_trained": 397920, "num_agent_steps_sampled": 397920, "num_agent_steps_trained": 397920}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.366480267468, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349101174049276, "mean_inference_ms": 0.23528023004669887, "mean_action_processing_ms": 0.05735212655778067, "mean_env_wait_ms": 1.109946268295464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025847378899069395, "StateBufferConnector_ms": 0.0017923467299517464, "ViewRequirementAgentConnector_ms": 0.043812920065487135}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.366480267468, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349101174049276, "mean_inference_ms": 0.23528023004669887, "mean_action_processing_ms": 0.05735212655778067, "mean_env_wait_ms": 1.109946268295464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025847378899069395, "StateBufferConnector_ms": 0.0017923467299517464, "ViewRequirementAgentConnector_ms": 0.043812920065487135}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 397920, "num_agent_steps_trained": 397920, "num_env_steps_sampled": 397920, "num_env_steps_trained": 397920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.97907012212636, "num_env_steps_trained_throughput_per_sec": 190.97907012212636, "timesteps_total": 397920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 397920, "timers": {"training_iteration_time_ms": 1890.166, "sample_time_ms": 1883.1, "load_time_ms": 0.203, "load_throughput": 1774532.189, "learn_time_ms": 6.322, "learn_throughput": 56941.192, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 397920, "num_env_steps_trained": 397920, "num_agent_steps_sampled": 397920, "num_agent_steps_trained": 397920}, "done": false, "episodes_total": 1586, "training_iteration": 308, "trial_id": "6192e_00000", "date": "2023-08-04_10-49-41", "timestamp": 1691135381, "time_this_iter_s": 11.311929941177368, "time_total_s": 3404.3354771137238, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 33.8764533996582, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 21.55625, "ram_util_percent": 65.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.599999999999999e-08, "entropy_coeff": 0.1, "policy_entropy": -322.3271484375, "policy_loss": -2032731.015625, "vf_loss": 20733866.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 400080, "num_env_steps_trained": 400080, "num_agent_steps_sampled": 400080, "num_agent_steps_trained": 400080}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.255211248331, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349163387141428, "mean_inference_ms": 0.23522675665114404, "mean_action_processing_ms": 0.05732742975153819, "mean_env_wait_ms": 1.0234285559543657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002576993859332541, "StateBufferConnector_ms": 0.0017725903054942255, "ViewRequirementAgentConnector_ms": 0.043752919072690216}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.255211248331, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349163387141428, "mean_inference_ms": 0.23522675665114404, "mean_action_processing_ms": 0.05732742975153819, "mean_env_wait_ms": 1.0234285559543657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002576993859332541, "StateBufferConnector_ms": 0.0017725903054942255, "ViewRequirementAgentConnector_ms": 0.043752919072690216}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400080, "num_agent_steps_trained": 400080, "num_env_steps_sampled": 400080, "num_env_steps_trained": 400080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.76041500412487, "num_env_steps_trained_throughput_per_sec": 190.76041500412487, "timesteps_total": 400080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 400080, "timers": {"training_iteration_time_ms": 1884.401, "sample_time_ms": 1877.316, "load_time_ms": 0.206, "load_throughput": 1748436.128, "learn_time_ms": 6.339, "learn_throughput": 56792.132, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 400080, "num_env_steps_trained": 400080, "num_agent_steps_sampled": 400080, "num_agent_steps_trained": 400080}, "done": false, "episodes_total": 1592, "training_iteration": 309, "trial_id": "6192e_00000", "date": "2023-08-04_10-49-52", "timestamp": 1691135392, "time_this_iter_s": 11.324939966201782, "time_total_s": 3415.6604170799255, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 45.201393365859985, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.587500000000002, "ram_util_percent": 65.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.4e-08, "entropy_coeff": 0.1, "policy_entropy": -322.49285278320315, "policy_loss": -6912463.39375, "vf_loss": 20756291.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 402240, "num_env_steps_trained": 402240, "num_agent_steps_sampled": 402240, "num_agent_steps_trained": 402240}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.299476507632, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349330861715612, "mean_inference_ms": 0.23522104296090657, "mean_action_processing_ms": 0.0573179357722816, "mean_env_wait_ms": 0.96431756370726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026004067782698006, "StateBufferConnector_ms": 0.001774163081728179, "ViewRequirementAgentConnector_ms": 0.043781050320329334}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.299476507632, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349330861715612, "mean_inference_ms": 0.23522104296090657, "mean_action_processing_ms": 0.0573179357722816, "mean_env_wait_ms": 0.96431756370726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026004067782698006, "StateBufferConnector_ms": 0.001774163081728179, "ViewRequirementAgentConnector_ms": 0.043781050320329334}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 402240, "num_agent_steps_trained": 402240, "num_env_steps_sampled": 402240, "num_env_steps_trained": 402240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.00103958795825, "num_env_steps_trained_throughput_per_sec": 190.00103958795825, "timesteps_total": 402240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 402240, "timers": {"training_iteration_time_ms": 1893.516, "sample_time_ms": 1886.52, "load_time_ms": 0.212, "load_throughput": 1697144.476, "learn_time_ms": 6.251, "learn_throughput": 57589.016, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 402240, "num_env_steps_trained": 402240, "num_agent_steps_sampled": 402240, "num_agent_steps_trained": 402240}, "done": false, "episodes_total": 1598, "training_iteration": 310, "trial_id": "6192e_00000", "date": "2023-08-04_10-50-03", "timestamp": 1691135403, "time_this_iter_s": 11.370326042175293, "time_total_s": 3427.030743122101, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 56.57171940803528, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.6, "ram_util_percent": 65.76875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.8e-08, "entropy_coeff": 0.1, "policy_entropy": -322.2774291992188, "policy_loss": -1528762.29375, "vf_loss": 20738203.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 172.0}}, "num_env_steps_sampled": 404400, "num_env_steps_trained": 404400, "num_agent_steps_sampled": 404400, "num_agent_steps_trained": 404400}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.3198467129987, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349087801484538, "mean_inference_ms": 0.2351471927086827, "mean_action_processing_ms": 0.05730117032572625, "mean_env_wait_ms": 0.9207404368510288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025497164045061383, "StateBufferConnector_ms": 0.001762253897530692, "ViewRequirementAgentConnector_ms": 0.04375594002859933}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.3198467129987, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349087801484538, "mean_inference_ms": 0.2351471927086827, "mean_action_processing_ms": 0.05730117032572625, "mean_env_wait_ms": 0.9207404368510288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025497164045061383, "StateBufferConnector_ms": 0.001762253897530692, "ViewRequirementAgentConnector_ms": 0.04375594002859933}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404400, "num_agent_steps_trained": 404400, "num_env_steps_sampled": 404400, "num_env_steps_trained": 404400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.83962387915884, "num_env_steps_trained_throughput_per_sec": 190.83962387915884, "timesteps_total": 404400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 404400, "timers": {"training_iteration_time_ms": 1889.741, "sample_time_ms": 1882.733, "load_time_ms": 0.211, "load_throughput": 1704424.247, "learn_time_ms": 6.268, "learn_throughput": 57431.306, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 404400, "num_env_steps_trained": 404400, "num_agent_steps_sampled": 404400, "num_agent_steps_trained": 404400}, "done": false, "episodes_total": 1604, "training_iteration": 311, "trial_id": "6192e_00000", "date": "2023-08-04_10-50-15", "timestamp": 1691135415, "time_this_iter_s": 11.32036304473877, "time_total_s": 3438.3511061668396, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 67.89208245277405, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.28125, "ram_util_percent": 65.80625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.1, "policy_entropy": -322.33904418945315, "policy_loss": -5707589.9625, "vf_loss": 20734934.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 202.0}}, "num_env_steps_sampled": 406560, "num_env_steps_trained": 406560, "num_agent_steps_sampled": 406560, "num_agent_steps_trained": 406560}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.2358945777905, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348729281435764, "mean_inference_ms": 0.23509251679571616, "mean_action_processing_ms": 0.05728975128353478, "mean_env_wait_ms": 0.8869954321271789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026290009661418634, "StateBufferConnector_ms": 0.0017503412758431783, "ViewRequirementAgentConnector_ms": 0.04353872159632241}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.2358945777905, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348729281435764, "mean_inference_ms": 0.23509251679571616, "mean_action_processing_ms": 0.05728975128353478, "mean_env_wait_ms": 0.8869954321271789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026290009661418634, "StateBufferConnector_ms": 0.0017503412758431783, "ViewRequirementAgentConnector_ms": 0.04353872159632241}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 406560, "num_agent_steps_trained": 406560, "num_env_steps_sampled": 406560, "num_env_steps_trained": 406560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.8302537754534, "num_env_steps_trained_throughput_per_sec": 190.8302537754534, "timesteps_total": 406560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 406560, "timers": {"training_iteration_time_ms": 1886.662, "sample_time_ms": 1879.672, "load_time_ms": 0.21, "load_throughput": 1712154.938, "learn_time_ms": 6.242, "learn_throughput": 57673.042, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 406560, "num_env_steps_trained": 406560, "num_agent_steps_sampled": 406560, "num_agent_steps_trained": 406560}, "done": false, "episodes_total": 1610, "training_iteration": 312, "trial_id": "6192e_00000", "date": "2023-08-04_10-50-26", "timestamp": 1691135426, "time_this_iter_s": 11.321022987365723, "time_total_s": 3449.6721291542053, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 79.21310544013977, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.2875, "ram_util_percent": 65.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.1, "policy_entropy": -322.3265319824219, "policy_loss": -565153.61875, "vf_loss": 20736303.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 232.0}}, "num_env_steps_sampled": 408720, "num_env_steps_trained": 408720, "num_agent_steps_sampled": 408720, "num_agent_steps_trained": 408720}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.1874371701147, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3482944729040875, "mean_inference_ms": 0.2350348973205271, "mean_action_processing_ms": 0.057278836911540405, "mean_env_wait_ms": 0.8599244704429243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026322425679957615, "StateBufferConnector_ms": 0.0017551665610455452, "ViewRequirementAgentConnector_ms": 0.043497187026003574}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3530.234374353649, "episode_reward_mean": -3527.1874371701147, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3482944729040875, "mean_inference_ms": 0.2350348973205271, "mean_action_processing_ms": 0.057278836911540405, "mean_env_wait_ms": 0.8599244704429243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026322425679957615, "StateBufferConnector_ms": 0.0017551665610455452, "ViewRequirementAgentConnector_ms": 0.043497187026003574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408720, "num_agent_steps_trained": 408720, "num_env_steps_sampled": 408720, "num_env_steps_trained": 408720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.0480901225526, "num_env_steps_trained_throughput_per_sec": 191.0480901225526, "timesteps_total": 408720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 408720, "timers": {"training_iteration_time_ms": 1885.911, "sample_time_ms": 1878.843, "load_time_ms": 0.212, "load_throughput": 1701926.781, "learn_time_ms": 6.299, "learn_throughput": 57149.811, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 408720, "num_env_steps_trained": 408720, "num_agent_steps_sampled": 408720, "num_agent_steps_trained": 408720}, "done": false, "episodes_total": 1616, "training_iteration": 313, "trial_id": "6192e_00000", "date": "2023-08-04_10-50-37", "timestamp": 1691135437, "time_this_iter_s": 11.30807900428772, "time_total_s": 3460.980208158493, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 90.52118444442749, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.637500000000003, "ram_util_percent": 65.48125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.1, "policy_entropy": -322.4993103027344, "policy_loss": -13068151.34375, "vf_loss": 20747717.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 262.0}}, "num_env_steps_sampled": 410880, "num_env_steps_trained": 410880, "num_agent_steps_sampled": 410880, "num_agent_steps_trained": 410880}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.3264770614182, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347715773470395, "mean_inference_ms": 0.23497781109820282, "mean_action_processing_ms": 0.05726822070597285, "mean_env_wait_ms": 0.837763270044307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025834677354344784, "StateBufferConnector_ms": 0.0017602488679705926, "ViewRequirementAgentConnector_ms": 0.04345111127169627}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.3264770614182, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347715773470395, "mean_inference_ms": 0.23497781109820282, "mean_action_processing_ms": 0.05726822070597285, "mean_env_wait_ms": 0.837763270044307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025834677354344784, "StateBufferConnector_ms": 0.0017602488679705926, "ViewRequirementAgentConnector_ms": 0.04345111127169627}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 410880, "num_agent_steps_trained": 410880, "num_env_steps_sampled": 410880, "num_env_steps_trained": 410880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.10738371264216, "num_env_steps_trained_throughput_per_sec": 191.10738371264216, "timesteps_total": 410880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 410880, "timers": {"training_iteration_time_ms": 1881.854, "sample_time_ms": 1874.783, "load_time_ms": 0.211, "load_throughput": 1702886.478, "learn_time_ms": 6.311, "learn_throughput": 57046.604, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 410880, "num_env_steps_trained": 410880, "num_agent_steps_sampled": 410880, "num_agent_steps_trained": 410880}, "done": false, "episodes_total": 1622, "training_iteration": 314, "trial_id": "6192e_00000", "date": "2023-08-04_10-50-49", "timestamp": 1691135449, "time_this_iter_s": 11.304372072219849, "time_total_s": 3472.284580230713, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 101.82555651664734, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 20.8125, "ram_util_percent": 65.24375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.1, "policy_entropy": -322.38939208984374, "policy_loss": -986284.9625, "vf_loss": 20738894.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 413040, "num_env_steps_trained": 413040, "num_agent_steps_sampled": 413040, "num_agent_steps_trained": 413040}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.289938073703, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347139690292097, "mean_inference_ms": 0.23492863794226748, "mean_action_processing_ms": 0.05726103498362186, "mean_env_wait_ms": 0.8192251343437081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025623935764118775, "StateBufferConnector_ms": 0.0017614687903452727, "ViewRequirementAgentConnector_ms": 0.043539677636098055}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.289938073703, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347139690292097, "mean_inference_ms": 0.23492863794226748, "mean_action_processing_ms": 0.05726103498362186, "mean_env_wait_ms": 0.8192251343437081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025623935764118775, "StateBufferConnector_ms": 0.0017614687903452727, "ViewRequirementAgentConnector_ms": 0.043539677636098055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 413040, "num_agent_steps_trained": 413040, "num_env_steps_sampled": 413040, "num_env_steps_trained": 413040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.9171363645387, "num_env_steps_trained_throughput_per_sec": 190.9171363645387, "timesteps_total": 413040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 413040, "timers": {"training_iteration_time_ms": 1884.402, "sample_time_ms": 1877.391, "load_time_ms": 0.211, "load_throughput": 1705772.074, "learn_time_ms": 6.258, "learn_throughput": 57526.266, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 413040, "num_env_steps_trained": 413040, "num_agent_steps_sampled": 413040, "num_agent_steps_trained": 413040}, "done": false, "episodes_total": 1628, "training_iteration": 315, "trial_id": "6192e_00000", "date": "2023-08-04_10-51-00", "timestamp": 1691135460, "time_this_iter_s": 11.315752983093262, "time_total_s": 3483.600333213806, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 113.1413094997406, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 21.450000000000003, "ram_util_percent": 65.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.1, "policy_entropy": -322.2256103515625, "policy_loss": 10098.34375, "vf_loss": 20730767.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 323.0, "diff_num_grad_updates_vs_sampler_policy": 322.0}}, "num_env_steps_sampled": 415200, "num_env_steps_trained": 415200, "num_agent_steps_sampled": 415200, "num_agent_steps_trained": 415200}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.241561116002, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34654767439978, "mean_inference_ms": 0.23488193142809766, "mean_action_processing_ms": 0.057255746200381125, "mean_env_wait_ms": 0.8033172759638139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025818898127629207, "StateBufferConnector_ms": 0.0017595291137695312, "ViewRequirementAgentConnector_ms": 0.04352129422701322}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.241561116002, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34654767439978, "mean_inference_ms": 0.23488193142809766, "mean_action_processing_ms": 0.057255746200381125, "mean_env_wait_ms": 0.8033172759638139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025818898127629207, "StateBufferConnector_ms": 0.0017595291137695312, "ViewRequirementAgentConnector_ms": 0.04352129422701322}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 415200, "num_agent_steps_trained": 415200, "num_env_steps_sampled": 415200, "num_env_steps_trained": 415200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.68801591139976, "num_env_steps_trained_throughput_per_sec": 191.68801591139976, "timesteps_total": 415200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 415200, "timers": {"training_iteration_time_ms": 1879.917, "sample_time_ms": 1872.91, "load_time_ms": 0.213, "load_throughput": 1693717.824, "learn_time_ms": 6.263, "learn_throughput": 57475.903, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 415200, "num_env_steps_trained": 415200, "num_agent_steps_sampled": 415200, "num_agent_steps_trained": 415200}, "done": false, "episodes_total": 1634, "training_iteration": 316, "trial_id": "6192e_00000", "date": "2023-08-04_10-51-11", "timestamp": 1691135471, "time_this_iter_s": 11.270698547363281, "time_total_s": 3494.8710317611694, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 124.41200804710388, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 20.200000000000003, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.1, "policy_entropy": -322.2197265625, "policy_loss": -565292.4375, "vf_loss": 20735463.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 352.0}}, "num_env_steps_sampled": 417360, "num_env_steps_trained": 417360, "num_agent_steps_sampled": 417360, "num_agent_steps_trained": 417360}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.2202291582366, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345885356179798, "mean_inference_ms": 0.23483720713819822, "mean_action_processing_ms": 0.057250209515775675, "mean_env_wait_ms": 0.7895430196269556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025802934673470512, "StateBufferConnector_ms": 0.0017515370543573943, "ViewRequirementAgentConnector_ms": 0.04346269956776794}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.2202291582366, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345885356179798, "mean_inference_ms": 0.23483720713819822, "mean_action_processing_ms": 0.057250209515775675, "mean_env_wait_ms": 0.7895430196269556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025802934673470512, "StateBufferConnector_ms": 0.0017515370543573943, "ViewRequirementAgentConnector_ms": 0.04346269956776794}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 417360, "num_agent_steps_trained": 417360, "num_env_steps_sampled": 417360, "num_env_steps_trained": 417360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.853338839525, "num_env_steps_trained_throughput_per_sec": 191.853338839525, "timesteps_total": 417360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 417360, "timers": {"training_iteration_time_ms": 1878.595, "sample_time_ms": 1871.578, "load_time_ms": 0.212, "load_throughput": 1698480.81, "learn_time_ms": 6.268, "learn_throughput": 57435.894, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 417360, "num_env_steps_trained": 417360, "num_agent_steps_sampled": 417360, "num_agent_steps_trained": 417360}, "done": false, "episodes_total": 1640, "training_iteration": 317, "trial_id": "6192e_00000", "date": "2023-08-04_10-51-23", "timestamp": 1691135483, "time_this_iter_s": 11.260730743408203, "time_total_s": 3506.1317625045776, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 135.67273879051208, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.125, "ram_util_percent": 65.63749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5999999999999998e-08, "entropy_coeff": 0.1, "policy_entropy": -322.25275268554685, "policy_loss": -1461312.69375, "vf_loss": 20733007.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 382.0}}, "num_env_steps_sampled": 419520, "num_env_steps_trained": 419520, "num_agent_steps_sampled": 419520, "num_agent_steps_trained": 419520}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.1742444100296, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345250607355756, "mean_inference_ms": 0.23479873690413303, "mean_action_processing_ms": 0.05724462081215709, "mean_env_wait_ms": 0.7774508890500214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002555104045124797, "StateBufferConnector_ms": 0.001737359282258269, "ViewRequirementAgentConnector_ms": 0.04347918869613053}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.1742444100296, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345250607355756, "mean_inference_ms": 0.23479873690413303, "mean_action_processing_ms": 0.05724462081215709, "mean_env_wait_ms": 0.7774508890500214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002555104045124797, "StateBufferConnector_ms": 0.001737359282258269, "ViewRequirementAgentConnector_ms": 0.04347918869613053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 419520, "num_agent_steps_trained": 419520, "num_env_steps_sampled": 419520, "num_env_steps_trained": 419520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.68355869353505, "num_env_steps_trained_throughput_per_sec": 191.68355869353505, "timesteps_total": 419520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 419520, "timers": {"training_iteration_time_ms": 1877.602, "sample_time_ms": 1870.617, "load_time_ms": 0.213, "load_throughput": 1687094.346, "learn_time_ms": 6.229, "learn_throughput": 57792.241, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 419520, "num_env_steps_trained": 419520, "num_agent_steps_sampled": 419520, "num_agent_steps_trained": 419520}, "done": false, "episodes_total": 1646, "training_iteration": 318, "trial_id": "6192e_00000", "date": "2023-08-04_10-51-34", "timestamp": 1691135494, "time_this_iter_s": 11.270498037338257, "time_total_s": 3517.402260541916, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 146.94323682785034, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.45625, "ram_util_percent": 65.53125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.1, "policy_entropy": -322.4196533203125, "policy_loss": -5414578.396875, "vf_loss": 20756853.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 412.0}}, "num_env_steps_sampled": 421680, "num_env_steps_trained": 421680, "num_agent_steps_sampled": 421680, "num_agent_steps_trained": 421680}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.163826502168, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3446762127126455, "mean_inference_ms": 0.2347643854601051, "mean_action_processing_ms": 0.057238943346501044, "mean_env_wait_ms": 0.7666838511537254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025507915450865963, "StateBufferConnector_ms": 0.0017378703657403049, "ViewRequirementAgentConnector_ms": 0.04353034927184323}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.163826502168, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3446762127126455, "mean_inference_ms": 0.2347643854601051, "mean_action_processing_ms": 0.057238943346501044, "mean_env_wait_ms": 0.7666838511537254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025507915450865963, "StateBufferConnector_ms": 0.0017378703657403049, "ViewRequirementAgentConnector_ms": 0.04353034927184323}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 421680, "num_agent_steps_trained": 421680, "num_env_steps_sampled": 421680, "num_env_steps_trained": 421680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.88115677713157, "num_env_steps_trained_throughput_per_sec": 191.88115677713157, "timesteps_total": 421680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 421680, "timers": {"training_iteration_time_ms": 1877.171, "sample_time_ms": 1870.207, "load_time_ms": 0.215, "load_throughput": 1677535.207, "learn_time_ms": 6.206, "learn_throughput": 58004.704, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 421680, "num_env_steps_trained": 421680, "num_agent_steps_sampled": 421680, "num_agent_steps_trained": 421680}, "done": false, "episodes_total": 1652, "training_iteration": 319, "trial_id": "6192e_00000", "date": "2023-08-04_10-51-45", "timestamp": 1691135505, "time_this_iter_s": 11.259215116500854, "time_total_s": 3528.6614756584167, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 158.2024519443512, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 31.125, "ram_util_percent": 65.38125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.1, "policy_entropy": -322.31732177734375, "policy_loss": -5523626.30625, "vf_loss": 20751087.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 443.0, "diff_num_grad_updates_vs_sampler_policy": 442.0}}, "num_env_steps_sampled": 423840, "num_env_steps_trained": 423840, "num_agent_steps_sampled": 423840, "num_agent_steps_trained": 423840}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.1470080082404, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344213901093999, "mean_inference_ms": 0.234733187726323, "mean_action_processing_ms": 0.05723359476835534, "mean_env_wait_ms": 0.7570998019076182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002549739366167047, "StateBufferConnector_ms": 0.0017267934392007549, "ViewRequirementAgentConnector_ms": 0.0435320179114181}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.1470080082404, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344213901093999, "mean_inference_ms": 0.234733187726323, "mean_action_processing_ms": 0.05723359476835534, "mean_env_wait_ms": 0.7570998019076182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002549739366167047, "StateBufferConnector_ms": 0.0017267934392007549, "ViewRequirementAgentConnector_ms": 0.0435320179114181}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 423840, "num_agent_steps_trained": 423840, "num_env_steps_sampled": 423840, "num_env_steps_trained": 423840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.79657563013575, "num_env_steps_trained_throughput_per_sec": 190.79657563013575, "timesteps_total": 423840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 423840, "timers": {"training_iteration_time_ms": 1880.056, "sample_time_ms": 1873.051, "load_time_ms": 0.212, "load_throughput": 1701543.205, "learn_time_ms": 6.243, "learn_throughput": 57664.011, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 423840, "num_env_steps_trained": 423840, "num_agent_steps_sampled": 423840, "num_agent_steps_trained": 423840}, "done": false, "episodes_total": 1658, "training_iteration": 320, "trial_id": "6192e_00000", "date": "2023-08-04_10-51-57", "timestamp": 1691135517, "time_this_iter_s": 11.323025226593018, "time_total_s": 3539.9845008850098, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 169.5254771709442, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.26875, "ram_util_percent": 65.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.1, "policy_entropy": -322.2338439941406, "policy_loss": -608778.61875, "vf_loss": 20734651.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 426000, "num_env_steps_trained": 426000, "num_agent_steps_sampled": 426000, "num_agent_steps_trained": 426000}, "sampler_results": {"episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.1449411679205, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34382584099074, "mean_inference_ms": 0.2347235791215817, "mean_action_processing_ms": 0.057231702304026896, "mean_env_wait_ms": 0.748599056351067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002528993706954153, "StateBufferConnector_ms": 0.0017258995457699424, "ViewRequirementAgentConnector_ms": 0.04353623641164679}}, "episode_reward_max": -3525.6316342446657, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.1449411679205, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.64252092612, -3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34382584099074, "mean_inference_ms": 0.2347235791215817, "mean_action_processing_ms": 0.057231702304026896, "mean_env_wait_ms": 0.748599056351067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002528993706954153, "StateBufferConnector_ms": 0.0017258995457699424, "ViewRequirementAgentConnector_ms": 0.04353623641164679}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 426000, "num_agent_steps_trained": 426000, "num_env_steps_sampled": 426000, "num_env_steps_trained": 426000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.84916774860915, "num_env_steps_trained_throughput_per_sec": 189.84916774860915, "timesteps_total": 426000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 426000, "timers": {"training_iteration_time_ms": 1892.077, "sample_time_ms": 1885.031, "load_time_ms": 0.213, "load_throughput": 1686340.675, "learn_time_ms": 6.291, "learn_throughput": 57228.438, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 426000, "num_env_steps_trained": 426000, "num_agent_steps_sampled": 426000, "num_agent_steps_trained": 426000}, "done": false, "episodes_total": 1664, "training_iteration": 321, "trial_id": "6192e_00000", "date": "2023-08-04_10-52-08", "timestamp": 1691135528, "time_this_iter_s": 11.379453897476196, "time_total_s": 3551.363954782486, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 180.9049310684204, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 20.7875, "ram_util_percent": 65.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.1, "policy_entropy": -322.11589965820315, "policy_loss": 328486.625, "vf_loss": 20729521.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 503.0, "diff_num_grad_updates_vs_sampler_policy": 502.0}}, "num_env_steps_sampled": 428160, "num_env_steps_trained": 428160, "num_agent_steps_sampled": 428160, "num_agent_steps_trained": 428160}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.094448374011, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343413441060233, "mean_inference_ms": 0.2347060195352555, "mean_action_processing_ms": 0.057227453986421234, "mean_env_wait_ms": 0.7330027086849915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002509593963623047, "StateBufferConnector_ms": 0.0017278194427490234, "ViewRequirementAgentConnector_ms": 0.04351997375488281}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.094448374011, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.5741034382445, -3526.845482406289, -3527.1503598040663, -3527.2090074440043, -3526.5625114320706, -3527.8573828545123, -3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343413441060233, "mean_inference_ms": 0.2347060195352555, "mean_action_processing_ms": 0.057227453986421234, "mean_env_wait_ms": 0.7330027086849915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002509593963623047, "StateBufferConnector_ms": 0.0017278194427490234, "ViewRequirementAgentConnector_ms": 0.04351997375488281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428160, "num_agent_steps_trained": 428160, "num_env_steps_sampled": 428160, "num_env_steps_trained": 428160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.29054220501573, "num_env_steps_trained_throughput_per_sec": 191.29054220501573, "timesteps_total": 428160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 428160, "timers": {"training_iteration_time_ms": 1890.302, "sample_time_ms": 1883.314, "load_time_ms": 0.213, "load_throughput": 1689926.626, "learn_time_ms": 6.241, "learn_throughput": 57678.549, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 428160, "num_env_steps_trained": 428160, "num_agent_steps_sampled": 428160, "num_agent_steps_trained": 428160}, "done": false, "episodes_total": 1670, "training_iteration": 322, "trial_id": "6192e_00000", "date": "2023-08-04_10-52-19", "timestamp": 1691135539, "time_this_iter_s": 11.29374098777771, "time_total_s": 3562.6576957702637, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 192.19867205619812, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 20.15625, "ram_util_percent": 65.25625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.999999999999999e-09, "entropy_coeff": 0.1, "policy_entropy": -322.1575622558594, "policy_loss": -3291981.659375, "vf_loss": 20736064.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 532.0}}, "num_env_steps_sampled": 430320, "num_env_steps_trained": 430320, "num_agent_steps_sampled": 430320, "num_agent_steps_trained": 430320}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.0484279510883, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342755493451596, "mean_inference_ms": 0.23466046992385764, "mean_action_processing_ms": 0.05721337574152689, "mean_env_wait_ms": 0.6884544724642356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002507925033569336, "StateBufferConnector_ms": 0.0017306804656982422, "ViewRequirementAgentConnector_ms": 0.04352283477783203}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.0484279510883, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.934242845958, -3528.5119648785562, -3530.234374353649, -3525.8403646850343, -3527.4301176650324, -3527.1586322796684, -3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342755493451596, "mean_inference_ms": 0.23466046992385764, "mean_action_processing_ms": 0.05721337574152689, "mean_env_wait_ms": 0.6884544724642356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002507925033569336, "StateBufferConnector_ms": 0.0017306804656982422, "ViewRequirementAgentConnector_ms": 0.04352283477783203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 430320, "num_agent_steps_trained": 430320, "num_env_steps_sampled": 430320, "num_env_steps_trained": 430320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.45751592491527, "num_env_steps_trained_throughput_per_sec": 190.45751592491527, "timesteps_total": 430320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 430320, "timers": {"training_iteration_time_ms": 1885.863, "sample_time_ms": 1878.865, "load_time_ms": 0.213, "load_throughput": 1692009.682, "learn_time_ms": 6.238, "learn_throughput": 57707.206, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 430320, "num_env_steps_trained": 430320, "num_agent_steps_sampled": 430320, "num_agent_steps_trained": 430320}, "done": false, "episodes_total": 1676, "training_iteration": 323, "trial_id": "6192e_00000", "date": "2023-08-04_10-52-31", "timestamp": 1691135551, "time_this_iter_s": 11.34306287765503, "time_total_s": 3574.0007586479187, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 203.54173493385315, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 20.28125, "ram_util_percent": 65.70625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.330078125, "policy_loss": -8320324.46875, "vf_loss": 20744042.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 562.0}}, "num_env_steps_sampled": 432480, "num_env_steps_trained": 432480, "num_agent_steps_sampled": 432480, "num_agent_steps_trained": 432480}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.016950053076, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342172154001175, "mean_inference_ms": 0.23462408052168793, "mean_action_processing_ms": 0.057208160701308845, "mean_env_wait_ms": 0.6676749710151814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025098323822021484, "StateBufferConnector_ms": 0.0017268657684326172, "ViewRequirementAgentConnector_ms": 0.0436098575592041}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.016950053076, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.3269505726403, -3526.515724651391, -3527.804790065052, -3525.6316342446657, -3527.2854012448947, -3526.841749170829, -3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342172154001175, "mean_inference_ms": 0.23462408052168793, "mean_action_processing_ms": 0.057208160701308845, "mean_env_wait_ms": 0.6676749710151814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025098323822021484, "StateBufferConnector_ms": 0.0017268657684326172, "ViewRequirementAgentConnector_ms": 0.0436098575592041}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432480, "num_agent_steps_trained": 432480, "num_env_steps_sampled": 432480, "num_env_steps_trained": 432480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.96664568855843, "num_env_steps_trained_throughput_per_sec": 189.96664568855843, "timesteps_total": 432480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 432480, "timers": {"training_iteration_time_ms": 1890.938, "sample_time_ms": 1883.809, "load_time_ms": 0.214, "load_throughput": 1686152.362, "learn_time_ms": 6.366, "learn_throughput": 56550.295, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 432480, "num_env_steps_trained": 432480, "num_agent_steps_sampled": 432480, "num_agent_steps_trained": 432480}, "done": false, "episodes_total": 1682, "training_iteration": 324, "trial_id": "6192e_00000", "date": "2023-08-04_10-52-42", "timestamp": 1691135562, "time_this_iter_s": 11.37258791923523, "time_total_s": 3585.373346567154, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 214.91432285308838, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 19.056250000000002, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.43345947265624, "policy_loss": -16620884.43125, "vf_loss": 20758361.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 592.0}}, "num_env_steps_sampled": 434640, "num_env_steps_trained": 434640, "num_agent_steps_sampled": 434640, "num_agent_steps_trained": 434640}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.031257639556, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341597555028473, "mean_inference_ms": 0.23458338417856375, "mean_action_processing_ms": 0.05720456698950673, "mean_env_wait_ms": 0.6546990619429198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017130374908447266, "ViewRequirementAgentConnector_ms": 0.04365181922912598}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.0934343969684, "episode_reward_mean": -3527.031257639556, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.8253218767354, -3528.1556702704806, -3526.582501023724, -3525.9490505779963, -3530.1174725807664, -3526.8057317623234, -3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341597555028473, "mean_inference_ms": 0.23458338417856375, "mean_action_processing_ms": 0.05720456698950673, "mean_env_wait_ms": 0.6546990619429198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017130374908447266, "ViewRequirementAgentConnector_ms": 0.04365181922912598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 434640, "num_agent_steps_trained": 434640, "num_env_steps_sampled": 434640, "num_env_steps_trained": 434640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.93539558333518, "num_env_steps_trained_throughput_per_sec": 190.93539558333518, "timesteps_total": 434640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 434640, "timers": {"training_iteration_time_ms": 1889.568, "sample_time_ms": 1882.503, "load_time_ms": 0.215, "load_throughput": 1671037.45, "learn_time_ms": 6.323, "learn_throughput": 56933.248, "synch_weights_time_ms": 0.494}, "counters": {"num_env_steps_sampled": 434640, "num_env_steps_trained": 434640, "num_agent_steps_sampled": 434640, "num_agent_steps_trained": 434640}, "done": false, "episodes_total": 1688, "training_iteration": 325, "trial_id": "6192e_00000", "date": "2023-08-04_10-52-53", "timestamp": 1691135573, "time_this_iter_s": 11.314719915390015, "time_total_s": 3596.688066482544, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 226.2290427684784, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.293750000000003, "ram_util_percent": 65.79375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.24782104492186, "policy_loss": -4222741.8125, "vf_loss": 20750174.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 623.0, "diff_num_grad_updates_vs_sampler_policy": 622.0}}, "num_env_steps_sampled": 436800, "num_env_steps_trained": 436800, "num_agent_steps_sampled": 436800, "num_agent_steps_trained": 436800}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.94920963008, "episode_reward_mean": -3527.0733944214403, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3409521372966475, "mean_inference_ms": 0.23455809257821758, "mean_action_processing_ms": 0.05720212931021022, "mean_env_wait_ms": 0.6454529775226274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025072097778320312, "StateBufferConnector_ms": 0.0017116069793701172, "ViewRequirementAgentConnector_ms": 0.043678998947143555}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.94920963008, "episode_reward_mean": -3527.0733944214403, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.2390857445785, -3527.5125611932176, -3526.1673250963368, -3527.9727836324873, -3528.8050659998726, -3527.5862917109134, -3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3409521372966475, "mean_inference_ms": 0.23455809257821758, "mean_action_processing_ms": 0.05720212931021022, "mean_env_wait_ms": 0.6454529775226274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025072097778320312, "StateBufferConnector_ms": 0.0017116069793701172, "ViewRequirementAgentConnector_ms": 0.043678998947143555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436800, "num_agent_steps_trained": 436800, "num_env_steps_sampled": 436800, "num_env_steps_trained": 436800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.08672168573662, "num_env_steps_trained_throughput_per_sec": 191.08672168573662, "timesteps_total": 436800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 436800, "timers": {"training_iteration_time_ms": 1884.904, "sample_time_ms": 1877.86, "load_time_ms": 0.217, "load_throughput": 1661476.056, "learn_time_ms": 6.292, "learn_throughput": 57215.427, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 436800, "num_env_steps_trained": 436800, "num_agent_steps_sampled": 436800, "num_agent_steps_trained": 436800}, "done": false, "episodes_total": 1694, "training_iteration": 326, "trial_id": "6192e_00000", "date": "2023-08-04_10-53-05", "timestamp": 1691135585, "time_this_iter_s": 11.30581784248352, "time_total_s": 3607.9938843250275, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 237.5348606109619, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.231250000000003, "ram_util_percent": 65.60625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.2189453125, "policy_loss": -6065638.51875, "vf_loss": 20741445.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 652.0}}, "num_env_steps_sampled": 438960, "num_env_steps_trained": 438960, "num_agent_steps_sampled": 438960, "num_agent_steps_trained": 438960}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.94920963008, "episode_reward_mean": -3527.079565725185, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.340361074827766, "mean_inference_ms": 0.23454112514551556, "mean_action_processing_ms": 0.057200458311048336, "mean_env_wait_ms": 0.6382762913252278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025064945220947266, "StateBufferConnector_ms": 0.0017099380493164062, "ViewRequirementAgentConnector_ms": 0.04364752769470215}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.94920963008, "episode_reward_mean": -3527.079565725185, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.107500380167, -3529.793028479579, -3526.0117017364537, -3526.2062279266593, -3527.078352149652, -3526.8254381932447, -3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.340361074827766, "mean_inference_ms": 0.23454112514551556, "mean_action_processing_ms": 0.057200458311048336, "mean_env_wait_ms": 0.6382762913252278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025064945220947266, "StateBufferConnector_ms": 0.0017099380493164062, "ViewRequirementAgentConnector_ms": 0.04364752769470215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 438960, "num_agent_steps_trained": 438960, "num_env_steps_sampled": 438960, "num_env_steps_trained": 438960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.29398527575142, "num_env_steps_trained_throughput_per_sec": 190.29398527575142, "timesteps_total": 438960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 438960, "timers": {"training_iteration_time_ms": 1890.324, "sample_time_ms": 1883.271, "load_time_ms": 0.219, "load_throughput": 1640179.709, "learn_time_ms": 6.288, "learn_throughput": 57252.524, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 438960, "num_env_steps_trained": 438960, "num_agent_steps_sampled": 438960, "num_agent_steps_trained": 438960}, "done": false, "episodes_total": 1700, "training_iteration": 327, "trial_id": "6192e_00000", "date": "2023-08-04_10-53-16", "timestamp": 1691135596, "time_this_iter_s": 11.353004932403564, "time_total_s": 3619.346889257431, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 248.88786554336548, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 22.38823529411765, "ram_util_percent": 65.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.29652709960936, "policy_loss": -2703970.3625, "vf_loss": 20742776.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 683.0, "diff_num_grad_updates_vs_sampler_policy": 682.0}}, "num_env_steps_sampled": 441120, "num_env_steps_trained": 441120, "num_agent_steps_sampled": 441120, "num_agent_steps_trained": 441120}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.94920963008, "episode_reward_mean": -3527.07526995162, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339867155523714, "mean_inference_ms": 0.23454177004013688, "mean_action_processing_ms": 0.057201376718427774, "mean_env_wait_ms": 0.6325079682381027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025005340576171875, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.04364013671875}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.94920963008, "episode_reward_mean": -3527.07526995162, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.862771336135, -3526.455839238923, -3526.8257219135726, -3526.428919902915, -3527.334015917554, -3526.9998224009078, -3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339867155523714, "mean_inference_ms": 0.23454177004013688, "mean_action_processing_ms": 0.057201376718427774, "mean_env_wait_ms": 0.6325079682381027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025005340576171875, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.04364013671875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 441120, "num_agent_steps_trained": 441120, "num_env_steps_sampled": 441120, "num_env_steps_trained": 441120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.9536904933283, "num_env_steps_trained_throughput_per_sec": 190.9536904933283, "timesteps_total": 441120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 441120, "timers": {"training_iteration_time_ms": 1887.188, "sample_time_ms": 1880.068, "load_time_ms": 0.218, "load_throughput": 1652565.875, "learn_time_ms": 6.328, "learn_throughput": 56889.489, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 441120, "num_env_steps_trained": 441120, "num_agent_steps_sampled": 441120, "num_agent_steps_trained": 441120}, "done": false, "episodes_total": 1706, "training_iteration": 328, "trial_id": "6192e_00000", "date": "2023-08-04_10-53-27", "timestamp": 1691135607, "time_this_iter_s": 11.313724994659424, "time_total_s": 3630.6606142520905, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 260.2015905380249, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.643749999999997, "ram_util_percent": 65.40625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.1999999999999996e-09, "entropy_coeff": 0.1, "policy_entropy": -322.41326904296875, "policy_loss": -4544663.9, "vf_loss": 20747660.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 713.0, "diff_num_grad_updates_vs_sampler_policy": 712.0}}, "num_env_steps_sampled": 443280, "num_env_steps_trained": 443280, "num_agent_steps_sampled": 443280, "num_agent_steps_trained": 443280}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.94920963008, "episode_reward_mean": -3527.0777138552407, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3394851366662985, "mean_inference_ms": 0.23454258175060871, "mean_action_processing_ms": 0.057201816395066114, "mean_env_wait_ms": 0.6277367294837614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513408660888672, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.043749094009399414}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.94920963008, "episode_reward_mean": -3527.0777138552407, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.4855175608905, -3526.695597495472, -3527.3839005182244, -3526.239015412906, -3527.706669353277, -3527.8740377142094, -3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3394851366662985, "mean_inference_ms": 0.23454258175060871, "mean_action_processing_ms": 0.057201816395066114, "mean_env_wait_ms": 0.6277367294837614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513408660888672, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.043749094009399414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 443280, "num_agent_steps_trained": 443280, "num_env_steps_sampled": 443280, "num_env_steps_trained": 443280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.62200169272114, "num_env_steps_trained_throughput_per_sec": 190.62200169272114, "timesteps_total": 443280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 443280, "timers": {"training_iteration_time_ms": 1886.705, "sample_time_ms": 1879.538, "load_time_ms": 0.217, "load_throughput": 1656191.115, "learn_time_ms": 6.382, "learn_throughput": 56405.59, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 443280, "num_env_steps_trained": 443280, "num_agent_steps_sampled": 443280, "num_agent_steps_trained": 443280}, "done": false, "episodes_total": 1712, "training_iteration": 329, "trial_id": "6192e_00000", "date": "2023-08-04_10-53-39", "timestamp": 1691135619, "time_this_iter_s": 11.333470821380615, "time_total_s": 3641.994085073471, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 271.5350613594055, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.3375, "ram_util_percent": 65.34375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7999999999999996e-09, "entropy_coeff": 0.1, "policy_entropy": -322.271826171875, "policy_loss": -4577537.8125, "vf_loss": 20745957.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 742.0}}, "num_env_steps_sampled": 445440, "num_env_steps_trained": 445440, "num_agent_steps_sampled": 445440, "num_agent_steps_trained": 445440}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.94920963008, "episode_reward_mean": -3527.0525106617906, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339224238547322, "mean_inference_ms": 0.2345500360875233, "mean_action_processing_ms": 0.05720300503416941, "mean_env_wait_ms": 0.6237033776605488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025186538696289062, "StateBufferConnector_ms": 0.0017101764678955078, "ViewRequirementAgentConnector_ms": 0.043717384338378906}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3533.94920963008, "episode_reward_mean": -3527.0525106617906, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.141368935141, -3533.0934343969684, -3526.3986167020644, -3527.2796101581885, -3527.32166197139, -3528.6802415217626, -3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339224238547322, "mean_inference_ms": 0.2345500360875233, "mean_action_processing_ms": 0.05720300503416941, "mean_env_wait_ms": 0.6237033776605488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025186538696289062, "StateBufferConnector_ms": 0.0017101764678955078, "ViewRequirementAgentConnector_ms": 0.043717384338378906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 445440, "num_agent_steps_trained": 445440, "num_env_steps_sampled": 445440, "num_env_steps_trained": 445440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.53875754348957, "num_env_steps_trained_throughput_per_sec": 190.53875754348957, "timesteps_total": 445440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 445440, "timers": {"training_iteration_time_ms": 1889.973, "sample_time_ms": 1882.728, "load_time_ms": 0.22, "load_throughput": 1638044.522, "learn_time_ms": 6.475, "learn_throughput": 55598.084, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 445440, "num_env_steps_trained": 445440, "num_agent_steps_sampled": 445440, "num_agent_steps_trained": 445440}, "done": false, "episodes_total": 1718, "training_iteration": 330, "trial_id": "6192e_00000", "date": "2023-08-04_10-53-50", "timestamp": 1691135630, "time_this_iter_s": 11.33853793144226, "time_total_s": 3653.3326230049133, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 282.8735992908478, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.25, "ram_util_percent": 65.27499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.1, "policy_entropy": -322.3357299804687, "policy_loss": -3488185.375, "vf_loss": 20842549.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 773.0, "diff_num_grad_updates_vs_sampler_policy": 772.0}}, "num_env_steps_sampled": 447600, "num_env_steps_trained": 447600, "num_agent_steps_sampled": 447600, "num_agent_steps_trained": 447600}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.0267535801145, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339087639171649, "mean_inference_ms": 0.23456313802634304, "mean_action_processing_ms": 0.05720465026136711, "mean_env_wait_ms": 0.6201996651144818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025191307067871094, "StateBufferConnector_ms": 0.0017070770263671875, "ViewRequirementAgentConnector_ms": 0.043703556060791016}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.0267535801145, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6770461383353, -3526.767476770941, -3525.757735078833, -3526.5989006119917, -3527.0512579685096, -3527.593370137862, -3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339087639171649, "mean_inference_ms": 0.23456313802634304, "mean_action_processing_ms": 0.05720465026136711, "mean_env_wait_ms": 0.6201996651144818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025191307067871094, "StateBufferConnector_ms": 0.0017070770263671875, "ViewRequirementAgentConnector_ms": 0.043703556060791016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 447600, "num_agent_steps_trained": 447600, "num_env_steps_sampled": 447600, "num_env_steps_trained": 447600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.59861350223488, "num_env_steps_trained_throughput_per_sec": 190.59861350223488, "timesteps_total": 447600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 447600, "timers": {"training_iteration_time_ms": 1888.968, "sample_time_ms": 1881.932, "load_time_ms": 0.216, "load_throughput": 1665324.187, "learn_time_ms": 6.279, "learn_throughput": 57334.264, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 447600, "num_env_steps_trained": 447600, "num_agent_steps_sampled": 447600, "num_agent_steps_trained": 447600}, "done": false, "episodes_total": 1724, "training_iteration": 331, "trial_id": "6192e_00000", "date": "2023-08-04_10-54-01", "timestamp": 1691135641, "time_this_iter_s": 11.334753036499023, "time_total_s": 3664.6673760414124, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 294.2083523273468, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 21.193749999999998, "ram_util_percent": 65.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.1, "policy_entropy": -322.2143493652344, "policy_loss": -5012078.003125, "vf_loss": 20739695.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 803.0, "diff_num_grad_updates_vs_sampler_policy": 802.0}}, "num_env_steps_sampled": 449760, "num_env_steps_trained": 449760, "num_agent_steps_sampled": 449760, "num_agent_steps_trained": 449760}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.0614863975734, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339054844735671, "mean_inference_ms": 0.2345791671231889, "mean_action_processing_ms": 0.05720555503146737, "mean_env_wait_ms": 0.6171552370648442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025179386138916016, "StateBufferConnector_ms": 0.0017080307006835938, "ViewRequirementAgentConnector_ms": 0.04372715950012207}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.0614863975734, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.8321291198645, -3526.064597788075, -3527.29107843982, -3525.7626927375395, -3526.64353389149, -3527.145384003836, -3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339054844735671, "mean_inference_ms": 0.2345791671231889, "mean_action_processing_ms": 0.05720555503146737, "mean_env_wait_ms": 0.6171552370648442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025179386138916016, "StateBufferConnector_ms": 0.0017080307006835938, "ViewRequirementAgentConnector_ms": 0.04372715950012207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 449760, "num_agent_steps_trained": 449760, "num_env_steps_sampled": 449760, "num_env_steps_trained": 449760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.14968240476628, "num_env_steps_trained_throughput_per_sec": 190.14968240476628, "timesteps_total": 449760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 449760, "timers": {"training_iteration_time_ms": 1893.657, "sample_time_ms": 1886.586, "load_time_ms": 0.218, "load_throughput": 1653832.903, "learn_time_ms": 6.305, "learn_throughput": 57095.786, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 449760, "num_env_steps_trained": 449760, "num_agent_steps_sampled": 449760, "num_agent_steps_trained": 449760}, "done": false, "episodes_total": 1730, "training_iteration": 332, "trial_id": "6192e_00000", "date": "2023-08-04_10-54-13", "timestamp": 1691135653, "time_this_iter_s": 11.361506938934326, "time_total_s": 3676.0288829803467, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 305.5698592662811, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.33125, "ram_util_percent": 65.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.1, "policy_entropy": -322.21640625, "policy_loss": -4470638.465625, "vf_loss": 20743530.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 832.0}}, "num_env_steps_sampled": 451920, "num_env_steps_trained": 451920, "num_agent_steps_sampled": 451920, "num_agent_steps_trained": 451920}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.099703259681, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339134672760233, "mean_inference_ms": 0.23459876697267285, "mean_action_processing_ms": 0.0572068276881221, "mean_env_wait_ms": 0.614503202289634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025069713592529297, "StateBufferConnector_ms": 0.0017070770263671875, "ViewRequirementAgentConnector_ms": 0.04372453689575195}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.099703259681, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.6064692179943, -3526.4051439012196, -3526.552719341332, -3526.581547338775, -3526.1828339167437, -3527.155098861309, -3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339134672760233, "mean_inference_ms": 0.23459876697267285, "mean_action_processing_ms": 0.0572068276881221, "mean_env_wait_ms": 0.614503202289634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025069713592529297, "StateBufferConnector_ms": 0.0017070770263671875, "ViewRequirementAgentConnector_ms": 0.04372453689575195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 451920, "num_agent_steps_trained": 451920, "num_env_steps_sampled": 451920, "num_env_steps_trained": 451920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.75808538163002, "num_env_steps_trained_throughput_per_sec": 190.75808538163002, "timesteps_total": 451920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 451920, "timers": {"training_iteration_time_ms": 1890.214, "sample_time_ms": 1883.022, "load_time_ms": 0.226, "load_throughput": 1596141.057, "learn_time_ms": 6.414, "learn_throughput": 56129.863, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 451920, "num_env_steps_trained": 451920, "num_agent_steps_sampled": 451920, "num_agent_steps_trained": 451920}, "done": false, "episodes_total": 1736, "training_iteration": 333, "trial_id": "6192e_00000", "date": "2023-08-04_10-54-24", "timestamp": 1691135664, "time_this_iter_s": 11.325445890426636, "time_total_s": 3687.3543288707733, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 316.89530515670776, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 22.76875, "ram_util_percent": 65.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.1, "policy_entropy": -322.2794616699219, "policy_loss": -3550252.31875, "vf_loss": 20747188.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 863.0, "diff_num_grad_updates_vs_sampler_policy": 862.0}}, "num_env_steps_sampled": 454080, "num_env_steps_trained": 454080, "num_agent_steps_sampled": 454080, "num_agent_steps_trained": 454080}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.1184486436214, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339313442905532, "mean_inference_ms": 0.23462186029379414, "mean_action_processing_ms": 0.057208798226698845, "mean_env_wait_ms": 0.6121677065294098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002504110336303711, "StateBufferConnector_ms": 0.0017096996307373047, "ViewRequirementAgentConnector_ms": 0.043723106384277344}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.1184486436214, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.8392547814424, -3526.277989902227, -3526.177653684397, -3526.1477181913788, -3526.841249560447, -3526.274813303893, -3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339313442905532, "mean_inference_ms": 0.23462186029379414, "mean_action_processing_ms": 0.057208798226698845, "mean_env_wait_ms": 0.6121677065294098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002504110336303711, "StateBufferConnector_ms": 0.0017096996307373047, "ViewRequirementAgentConnector_ms": 0.043723106384277344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 454080, "num_agent_steps_trained": 454080, "num_env_steps_sampled": 454080, "num_env_steps_trained": 454080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.8978669799351, "num_env_steps_trained_throughput_per_sec": 190.8978669799351, "timesteps_total": 454080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 454080, "timers": {"training_iteration_time_ms": 1885.94, "sample_time_ms": 1878.797, "load_time_ms": 0.218, "load_throughput": 1654014.065, "learn_time_ms": 6.37, "learn_throughput": 56517.064, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 454080, "num_env_steps_trained": 454080, "num_agent_steps_sampled": 454080, "num_agent_steps_trained": 454080}, "done": false, "episodes_total": 1742, "training_iteration": 334, "trial_id": "6192e_00000", "date": "2023-08-04_10-54-35", "timestamp": 1691135675, "time_this_iter_s": 11.31698489189148, "time_total_s": 3698.671313762665, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 328.21229004859924, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 22.56875, "ram_util_percent": 65.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.1, "policy_entropy": -322.2243713378906, "policy_loss": -1588328.0875, "vf_loss": 20758128.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 893.0, "diff_num_grad_updates_vs_sampler_policy": 892.0}}, "num_env_steps_sampled": 456240, "num_env_steps_trained": 456240, "num_agent_steps_sampled": 456240, "num_agent_steps_trained": 456240}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.188557279396, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339559009343875, "mean_inference_ms": 0.2346413007452044, "mean_action_processing_ms": 0.057210642464990864, "mean_env_wait_ms": 0.6101257435749469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025091171264648438, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.043703556060791016}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.188557279396, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.9195471494822, -3526.2776104662935, -3527.1656190502686, -3527.7019405772803, -3525.9793546756987, -3526.656945275313, -3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.339559009343875, "mean_inference_ms": 0.2346413007452044, "mean_action_processing_ms": 0.057210642464990864, "mean_env_wait_ms": 0.6101257435749469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025091171264648438, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.043703556060791016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456240, "num_agent_steps_trained": 456240, "num_env_steps_sampled": 456240, "num_env_steps_trained": 456240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.67320544724024, "num_env_steps_trained_throughput_per_sec": 190.67320544724024, "timesteps_total": 456240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 456240, "timers": {"training_iteration_time_ms": 1887.355, "sample_time_ms": 1880.259, "load_time_ms": 0.216, "load_throughput": 1665324.187, "learn_time_ms": 6.342, "learn_throughput": 56762.883, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 456240, "num_env_steps_trained": 456240, "num_agent_steps_sampled": 456240, "num_agent_steps_trained": 456240}, "done": false, "episodes_total": 1748, "training_iteration": 335, "trial_id": "6192e_00000", "date": "2023-08-04_10-54-47", "timestamp": 1691135687, "time_this_iter_s": 11.330420970916748, "time_total_s": 3710.0017347335815, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 339.542711019516, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 24.4375, "ram_util_percent": 65.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8e-10, "entropy_coeff": 0.1, "policy_entropy": -322.25439453125, "policy_loss": -1275812.371875, "vf_loss": 20742608.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 922.0}}, "num_env_steps_sampled": 458400, "num_env_steps_trained": 458400, "num_agent_steps_sampled": 458400, "num_agent_steps_trained": 458400}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.186757380908, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.33981960880333, "mean_inference_ms": 0.23466064304310108, "mean_action_processing_ms": 0.05721291553350463, "mean_env_wait_ms": 0.6083383081782633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00252532958984375, "StateBufferConnector_ms": 0.0017147064208984375, "ViewRequirementAgentConnector_ms": 0.043747901916503906}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.186757380908, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.403536764271, -3527.9621083022053, -3526.3061502077176, -3527.178017828249, -3527.1212941765593, -3528.317432107096, -3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.33981960880333, "mean_inference_ms": 0.23466064304310108, "mean_action_processing_ms": 0.05721291553350463, "mean_env_wait_ms": 0.6083383081782633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00252532958984375, "StateBufferConnector_ms": 0.0017147064208984375, "ViewRequirementAgentConnector_ms": 0.043747901916503906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 458400, "num_agent_steps_trained": 458400, "num_env_steps_sampled": 458400, "num_env_steps_trained": 458400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.81105014945575, "num_env_steps_trained_throughput_per_sec": 190.81105014945575, "timesteps_total": 458400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 458400, "timers": {"training_iteration_time_ms": 1888.149, "sample_time_ms": 1881.085, "load_time_ms": 0.22, "load_throughput": 1633614.021, "learn_time_ms": 6.306, "learn_throughput": 57090.389, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 458400, "num_env_steps_trained": 458400, "num_agent_steps_sampled": 458400, "num_agent_steps_trained": 458400}, "done": false, "episodes_total": 1754, "training_iteration": 336, "trial_id": "6192e_00000", "date": "2023-08-04_10-54-58", "timestamp": 1691135698, "time_this_iter_s": 11.322158813476562, "time_total_s": 3721.323893547058, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 350.86486983299255, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.975, "ram_util_percent": 65.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2884948730469, "policy_loss": -2380711.9375, "vf_loss": 20756546.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 953.0, "diff_num_grad_updates_vs_sampler_policy": 952.0}}, "num_env_steps_sampled": 460560, "num_env_steps_trained": 460560, "num_agent_steps_sampled": 460560, "num_agent_steps_trained": 460560}, "sampler_results": {"episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.1967984556723, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.340060394759877, "mean_inference_ms": 0.23467426843761038, "mean_action_processing_ms": 0.05721416896959717, "mean_env_wait_ms": 0.6067100336713219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025255680084228516, "StateBufferConnector_ms": 0.0017311573028564453, "ViewRequirementAgentConnector_ms": 0.043718814849853516}}, "episode_reward_max": -3525.467096499989, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.1967984556723, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.0839412764217, -3527.0361253303477, -3525.968694337601, -3526.158210990996, -3525.467096499989, -3527.7435914470684, -3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.340060394759877, "mean_inference_ms": 0.23467426843761038, "mean_action_processing_ms": 0.05721416896959717, "mean_env_wait_ms": 0.6067100336713219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025255680084228516, "StateBufferConnector_ms": 0.0017311573028564453, "ViewRequirementAgentConnector_ms": 0.043718814849853516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460560, "num_agent_steps_trained": 460560, "num_env_steps_sampled": 460560, "num_env_steps_trained": 460560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.55931726494305, "num_env_steps_trained_throughput_per_sec": 190.55931726494305, "timesteps_total": 460560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 460560, "timers": {"training_iteration_time_ms": 1888.95, "sample_time_ms": 1881.93, "load_time_ms": 0.222, "load_throughput": 1620987.053, "learn_time_ms": 6.249, "learn_throughput": 57606.812, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 460560, "num_env_steps_trained": 460560, "num_agent_steps_sampled": 460560, "num_agent_steps_trained": 460560}, "done": false, "episodes_total": 1760, "training_iteration": 337, "trial_id": "6192e_00000", "date": "2023-08-04_10-55-09", "timestamp": 1691135709, "time_this_iter_s": 11.337158918380737, "time_total_s": 3732.661052465439, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 362.2020287513733, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 19.46875, "ram_util_percent": 65.38749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4014831542969, "policy_loss": -5680894.1, "vf_loss": 20754484.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 983.0, "diff_num_grad_updates_vs_sampler_policy": 982.0}}, "num_env_steps_sampled": 462720, "num_env_steps_trained": 462720, "num_agent_steps_sampled": 462720, "num_agent_steps_trained": 462720}, "sampler_results": {"episode_reward_max": -3525.5884117665673, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.241026155905, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.340310184634074, "mean_inference_ms": 0.234675472280696, "mean_action_processing_ms": 0.05721318651061501, "mean_env_wait_ms": 0.605196991384266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002534151077270508, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.04381752014160156}}, "episode_reward_max": -3525.5884117665673, "episode_reward_min": -3535.3868324495397, "episode_reward_mean": -3527.241026155905, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.170489409206, -3526.263509325779, -3526.0649038482834, -3525.608356844451, -3526.6515837307584, -3526.962364013717, -3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.340310184634074, "mean_inference_ms": 0.234675472280696, "mean_action_processing_ms": 0.05721318651061501, "mean_env_wait_ms": 0.605196991384266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002534151077270508, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.04381752014160156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 462720, "num_agent_steps_trained": 462720, "num_env_steps_sampled": 462720, "num_env_steps_trained": 462720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.2852002284255, "num_env_steps_trained_throughput_per_sec": 190.2852002284255, "timesteps_total": 462720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 462720, "timers": {"training_iteration_time_ms": 1889.958, "sample_time_ms": 1883.008, "load_time_ms": 0.217, "load_throughput": 1661476.056, "learn_time_ms": 6.181, "learn_throughput": 58247.256, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 462720, "num_env_steps_trained": 462720, "num_agent_steps_sampled": 462720, "num_agent_steps_trained": 462720}, "done": false, "episodes_total": 1766, "training_iteration": 338, "trial_id": "6192e_00000", "date": "2023-08-04_10-55-21", "timestamp": 1691135721, "time_this_iter_s": 11.353470802307129, "time_total_s": 3744.014523267746, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 373.5554995536804, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 19.000000000000004, "ram_util_percent": 65.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3337036132813, "policy_loss": -4401891.6375, "vf_loss": 21027717.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 1012.0}}, "num_env_steps_sampled": 464880, "num_env_steps_trained": 464880, "num_agent_steps_sampled": 464880, "num_agent_steps_trained": 464880}, "sampler_results": {"episode_reward_max": -3525.5884117665673, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.4889385791016, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3405907400129715, "mean_inference_ms": 0.234678587562391, "mean_action_processing_ms": 0.057212189748004044, "mean_env_wait_ms": 0.6038345087967021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025403499603271484, "StateBufferConnector_ms": 0.0017352104187011719, "ViewRequirementAgentConnector_ms": 0.04383277893066406}}, "episode_reward_max": -3525.5884117665673, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.4889385791016, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.43366186349, -3526.431660911777, -3526.9493400816878, -3526.168194485526, -3527.0038150656073, -3527.7865734779666, -3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3405907400129715, "mean_inference_ms": 0.234678587562391, "mean_action_processing_ms": 0.057212189748004044, "mean_env_wait_ms": 0.6038345087967021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025403499603271484, "StateBufferConnector_ms": 0.0017352104187011719, "ViewRequirementAgentConnector_ms": 0.04383277893066406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464880, "num_agent_steps_trained": 464880, "num_env_steps_sampled": 464880, "num_env_steps_trained": 464880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.84509797676185, "num_env_steps_trained_throughput_per_sec": 189.84509797676185, "timesteps_total": 464880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 464880, "timers": {"training_iteration_time_ms": 1894.046, "sample_time_ms": 1887.071, "load_time_ms": 0.213, "load_throughput": 1692199.305, "learn_time_ms": 6.201, "learn_throughput": 58056.222, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 464880, "num_env_steps_trained": 464880, "num_agent_steps_sampled": 464880, "num_agent_steps_trained": 464880}, "done": false, "episodes_total": 1772, "training_iteration": 339, "trial_id": "6192e_00000", "date": "2023-08-04_10-55-32", "timestamp": 1691135732, "time_this_iter_s": 11.379741907119751, "time_total_s": 3755.3942651748657, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 384.93524146080017, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.79375, "ram_util_percent": 65.35625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3142822265625, "policy_loss": -6373089.40625, "vf_loss": 20747229.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1043.0, "diff_num_grad_updates_vs_sampler_policy": 1042.0}}, "num_env_steps_sampled": 467040, "num_env_steps_trained": 467040, "num_agent_steps_sampled": 467040, "num_agent_steps_trained": 467040}, "sampler_results": {"episode_reward_max": -3525.5884117665673, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.49763398715, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34083555716599, "mean_inference_ms": 0.2346815637037917, "mean_action_processing_ms": 0.05721104970158738, "mean_env_wait_ms": 0.6025758605912455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025331974029541016, "StateBufferConnector_ms": 0.0017330646514892578, "ViewRequirementAgentConnector_ms": 0.04369044303894043}}, "episode_reward_max": -3525.5884117665673, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.49763398715, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.945423960142, -3527.549137050744, -3526.0089056686606, -3526.6680516835345, -3527.854961749146, -3526.7094468785854, -3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34083555716599, "mean_inference_ms": 0.2346815637037917, "mean_action_processing_ms": 0.05721104970158738, "mean_env_wait_ms": 0.6025758605912455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025331974029541016, "StateBufferConnector_ms": 0.0017330646514892578, "ViewRequirementAgentConnector_ms": 0.04369044303894043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 467040, "num_agent_steps_trained": 467040, "num_env_steps_sampled": 467040, "num_env_steps_trained": 467040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.49622943612658, "num_env_steps_trained_throughput_per_sec": 190.49622943612658, "timesteps_total": 467040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 467040, "timers": {"training_iteration_time_ms": 1893.072, "sample_time_ms": 1886.071, "load_time_ms": 0.214, "load_throughput": 1679027.51, "learn_time_ms": 6.246, "learn_throughput": 57636.938, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 467040, "num_env_steps_trained": 467040, "num_agent_steps_sampled": 467040, "num_agent_steps_trained": 467040}, "done": false, "episodes_total": 1778, "training_iteration": 340, "trial_id": "6192e_00000", "date": "2023-08-04_10-55-44", "timestamp": 1691135744, "time_this_iter_s": 11.341074228286743, "time_total_s": 3766.7353394031525, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 396.2763156890869, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 20.03125, "ram_util_percent": 65.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-10, "entropy_coeff": 0.1, "policy_entropy": -322.224951171875, "policy_loss": -604118.69375, "vf_loss": 20726109.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1073.0, "diff_num_grad_updates_vs_sampler_policy": 1072.0}}, "num_env_steps_sampled": 469200, "num_env_steps_trained": 469200, "num_agent_steps_sampled": 469200, "num_agent_steps_trained": 469200}, "sampler_results": {"episode_reward_max": -3525.5870791410653, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.5561934444386, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341069774102898, "mean_inference_ms": 0.2346782162268898, "mean_action_processing_ms": 0.05720900554836799, "mean_env_wait_ms": 0.6013861254080274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002523183822631836, "StateBufferConnector_ms": 0.0017368793487548828, "ViewRequirementAgentConnector_ms": 0.04359698295593262}}, "episode_reward_max": -3525.5870791410653, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.5561934444386, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.3292552822772, -3526.5401746846446, -3526.2911393943405, -3528.1120306084176, -3526.0909990692217, -3533.94920963008, -3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341069774102898, "mean_inference_ms": 0.2346782162268898, "mean_action_processing_ms": 0.05720900554836799, "mean_env_wait_ms": 0.6013861254080274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002523183822631836, "StateBufferConnector_ms": 0.0017368793487548828, "ViewRequirementAgentConnector_ms": 0.04359698295593262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 469200, "num_agent_steps_trained": 469200, "num_env_steps_sampled": 469200, "num_env_steps_trained": 469200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.67086591569435, "num_env_steps_trained_throughput_per_sec": 190.67086591569435, "timesteps_total": 469200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 469200, "timers": {"training_iteration_time_ms": 1888.975, "sample_time_ms": 1881.971, "load_time_ms": 0.217, "load_throughput": 1661476.056, "learn_time_ms": 6.254, "learn_throughput": 57559.379, "synch_weights_time_ms": 0.501}, "counters": {"num_env_steps_sampled": 469200, "num_env_steps_trained": 469200, "num_agent_steps_sampled": 469200, "num_agent_steps_trained": 469200}, "done": false, "episodes_total": 1784, "training_iteration": 341, "trial_id": "6192e_00000", "date": "2023-08-04_10-55-55", "timestamp": 1691135755, "time_this_iter_s": 11.330512285232544, "time_total_s": 3778.065851688385, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 407.60682797431946, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.025, "ram_util_percent": 65.36875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2637634277344, "policy_loss": -2893519.4875, "vf_loss": 20728521.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 1102.0}}, "num_env_steps_sampled": 471360, "num_env_steps_trained": 471360, "num_agent_steps_sampled": 471360, "num_agent_steps_trained": 471360}, "sampler_results": {"episode_reward_max": -3525.586976814355, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.494027918825, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341303279943725, "mean_inference_ms": 0.2346699762157107, "mean_action_processing_ms": 0.057206103609038605, "mean_env_wait_ms": 0.60027489657314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025238990783691406, "StateBufferConnector_ms": 0.0017423629760742188, "ViewRequirementAgentConnector_ms": 0.043562889099121094}}, "episode_reward_max": -3525.586976814355, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.494027918825, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.256454544288, -3526.282620558676, -3527.190158527758, -3527.87998395044, -3527.5063192947055, -3528.8479266959557, -3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341303279943725, "mean_inference_ms": 0.2346699762157107, "mean_action_processing_ms": 0.057206103609038605, "mean_env_wait_ms": 0.60027489657314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025238990783691406, "StateBufferConnector_ms": 0.0017423629760742188, "ViewRequirementAgentConnector_ms": 0.043562889099121094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 471360, "num_agent_steps_trained": 471360, "num_env_steps_sampled": 471360, "num_env_steps_trained": 471360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.308335633967, "num_env_steps_trained_throughput_per_sec": 191.308335633967, "timesteps_total": 471360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 471360, "timers": {"training_iteration_time_ms": 1885.266, "sample_time_ms": 1878.183, "load_time_ms": 0.216, "load_throughput": 1663123.075, "learn_time_ms": 6.322, "learn_throughput": 56944.413, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 471360, "num_env_steps_trained": 471360, "num_agent_steps_sampled": 471360, "num_agent_steps_trained": 471360}, "done": false, "episodes_total": 1790, "training_iteration": 342, "trial_id": "6192e_00000", "date": "2023-08-04_10-56-06", "timestamp": 1691135766, "time_this_iter_s": 11.29281997680664, "time_total_s": 3789.3586716651917, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 418.8996479511261, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 19.25, "ram_util_percent": 65.34375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6000000000000002e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2629760742187, "policy_loss": -878467.409375, "vf_loss": 20751532.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1133.0, "diff_num_grad_updates_vs_sampler_policy": 1132.0}}, "num_env_steps_sampled": 473520, "num_env_steps_trained": 473520, "num_agent_steps_sampled": 473520, "num_agent_steps_trained": 473520}, "sampler_results": {"episode_reward_max": -3525.5868971486966, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.552591616263, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341528321267306, "mean_inference_ms": 0.23465655142049388, "mean_action_processing_ms": 0.05720254727870931, "mean_env_wait_ms": 0.5992662273720559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518892288208008, "StateBufferConnector_ms": 0.0017397403717041016, "ViewRequirementAgentConnector_ms": 0.04349851608276367}}, "episode_reward_max": -3525.5868971486966, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.552591616263, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.454145856538, -3528.1409263485, -3526.3899567722137, -3526.5609687839737, -3526.595209404454, -3525.7711427982026, -3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341528321267306, "mean_inference_ms": 0.23465655142049388, "mean_action_processing_ms": 0.05720254727870931, "mean_env_wait_ms": 0.5992662273720559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518892288208008, "StateBufferConnector_ms": 0.0017397403717041016, "ViewRequirementAgentConnector_ms": 0.04349851608276367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 473520, "num_agent_steps_trained": 473520, "num_env_steps_sampled": 473520, "num_env_steps_trained": 473520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.46609665641338, "num_env_steps_trained_throughput_per_sec": 190.46609665641338, "timesteps_total": 473520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 473520, "timers": {"training_iteration_time_ms": 1886.586, "sample_time_ms": 1879.44, "load_time_ms": 0.217, "load_throughput": 1660745.095, "learn_time_ms": 6.375, "learn_throughput": 56474.787, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 473520, "num_env_steps_trained": 473520, "num_agent_steps_sampled": 473520, "num_agent_steps_trained": 473520}, "done": false, "episodes_total": 1796, "training_iteration": 343, "trial_id": "6192e_00000", "date": "2023-08-04_10-56-18", "timestamp": 1691135778, "time_this_iter_s": 11.343011856079102, "time_total_s": 3800.7016835212708, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 430.2426598072052, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 19.3, "ram_util_percent": 65.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.09552001953125, "policy_loss": 328468.253125, "vf_loss": 20729245.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1163.0, "diff_num_grad_updates_vs_sampler_policy": 1162.0}}, "num_env_steps_sampled": 475680, "num_env_steps_trained": 475680, "num_agent_steps_sampled": 475680, "num_agent_steps_trained": 475680}, "sampler_results": {"episode_reward_max": -3525.5868404952894, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.538613956692, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341742869747144, "mean_inference_ms": 0.23463648588676023, "mean_action_processing_ms": 0.05719805545320456, "mean_env_wait_ms": 0.5983132529229337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025103092193603516, "StateBufferConnector_ms": 0.0017435550689697266, "ViewRequirementAgentConnector_ms": 0.04354691505432129}}, "episode_reward_max": -3525.5868404952894, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.538613956692, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.1655759478363, -3527.5211221934605, -3527.584141915484, -3526.9554792498075, -3525.816911066103, -3526.8806925612407, -3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341742869747144, "mean_inference_ms": 0.23463648588676023, "mean_action_processing_ms": 0.05719805545320456, "mean_env_wait_ms": 0.5983132529229337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025103092193603516, "StateBufferConnector_ms": 0.0017435550689697266, "ViewRequirementAgentConnector_ms": 0.04354691505432129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 475680, "num_agent_steps_trained": 475680, "num_env_steps_sampled": 475680, "num_env_steps_trained": 475680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.90361520549746, "num_env_steps_trained_throughput_per_sec": 190.90361520549746, "timesteps_total": 475680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 475680, "timers": {"training_iteration_time_ms": 1887.339, "sample_time_ms": 1880.413, "load_time_ms": 0.215, "load_throughput": 1674187.205, "learn_time_ms": 6.161, "learn_throughput": 58428.471, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 475680, "num_env_steps_trained": 475680, "num_agent_steps_sampled": 475680, "num_agent_steps_trained": 475680}, "done": false, "episodes_total": 1802, "training_iteration": 344, "trial_id": "6192e_00000", "date": "2023-08-04_10-56-29", "timestamp": 1691135789, "time_this_iter_s": 11.316807985305786, "time_total_s": 3812.0184915065765, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 441.559467792511, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 20.625, "ram_util_percent": 65.53750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.26995849609375, "policy_loss": -1999595.04375, "vf_loss": 20742830.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 1192.0}}, "num_env_steps_sampled": 477840, "num_env_steps_trained": 477840, "num_agent_steps_sampled": 477840, "num_agent_steps_trained": 477840}, "sampler_results": {"episode_reward_max": -3525.5868404952894, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.509275950336, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341928278772889, "mean_inference_ms": 0.23462166894933748, "mean_action_processing_ms": 0.057194769693919414, "mean_env_wait_ms": 0.5974049725702646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025184154510498047, "StateBufferConnector_ms": 0.0017502307891845703, "ViewRequirementAgentConnector_ms": 0.043566226959228516}}, "episode_reward_max": -3525.5868404952894, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.509275950336, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.243646656736, -3527.0676614163744, -3525.592313927271, -3527.550255444439, -3526.873128547005, -3525.8250568142766, -3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.341928278772889, "mean_inference_ms": 0.23462166894933748, "mean_action_processing_ms": 0.057194769693919414, "mean_env_wait_ms": 0.5974049725702646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025184154510498047, "StateBufferConnector_ms": 0.0017502307891845703, "ViewRequirementAgentConnector_ms": 0.043566226959228516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 477840, "num_agent_steps_trained": 477840, "num_env_steps_sampled": 477840, "num_env_steps_trained": 477840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.7620465734065, "num_env_steps_trained_throughput_per_sec": 191.7620465734065, "timesteps_total": 477840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 477840, "timers": {"training_iteration_time_ms": 1877.635, "sample_time_ms": 1870.598, "load_time_ms": 0.215, "load_throughput": 1672332.972, "learn_time_ms": 6.266, "learn_throughput": 57450.973, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 477840, "num_env_steps_trained": 477840, "num_agent_steps_sampled": 477840, "num_agent_steps_trained": 477840}, "done": false, "episodes_total": 1808, "training_iteration": 345, "trial_id": "6192e_00000", "date": "2023-08-04_10-56-40", "timestamp": 1691135800, "time_this_iter_s": 11.26604413986206, "time_total_s": 3823.2845356464386, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 452.82551193237305, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 21.03125, "ram_util_percent": 65.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.000000000000001e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2658325195313, "policy_loss": -4230903.70625, "vf_loss": 20747324.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1223.0, "diff_num_grad_updates_vs_sampler_policy": 1222.0}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.511706505124, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342076066568621, "mean_inference_ms": 0.234608234846635, "mean_action_processing_ms": 0.05719182828644869, "mean_env_wait_ms": 0.5965576906439314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025064945220947266, "StateBufferConnector_ms": 0.0017540454864501953, "ViewRequirementAgentConnector_ms": 0.043569087982177734}}, "episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.511706505124, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.7435934625796, -3525.8151695981105, -3527.866406085462, -3526.7410642026175, -3526.1340913379404, -3526.7805354370275, -3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342076066568621, "mean_inference_ms": 0.234608234846635, "mean_action_processing_ms": 0.05719182828644869, "mean_env_wait_ms": 0.5965576906439314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025064945220947266, "StateBufferConnector_ms": 0.0017540454864501953, "ViewRequirementAgentConnector_ms": 0.043569087982177734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.17590348357584, "num_env_steps_trained_throughput_per_sec": 191.17590348357584, "timesteps_total": 480000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 1880.131, "sample_time_ms": 1873.031, "load_time_ms": 0.218, "load_throughput": 1651481.396, "learn_time_ms": 6.334, "learn_throughput": 56834.885, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1814, "training_iteration": 346, "trial_id": "6192e_00000", "date": "2023-08-04_10-56-52", "timestamp": 1691135812, "time_this_iter_s": 11.300540208816528, "time_total_s": 3834.585075855255, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 464.1260521411896, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 19.21875, "ram_util_percent": 65.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1853820800781, "policy_loss": -2172288.4796875, "vf_loss": 20730055.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1253.0, "diff_num_grad_updates_vs_sampler_policy": 1252.0}}, "num_env_steps_sampled": 482160, "num_env_steps_trained": 482160, "num_agent_steps_sampled": 482160, "num_agent_steps_trained": 482160}, "sampler_results": {"episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.514429918152, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342196305395457, "mean_inference_ms": 0.23459382896121106, "mean_action_processing_ms": 0.05718895427414027, "mean_env_wait_ms": 0.5957699877379818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017533302307128906, "ViewRequirementAgentConnector_ms": 0.04356575012207031}}, "episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.514429918152, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.173681727843, -3527.6955481194273, -3526.1685364460154, -3535.3868324495397, -3527.9549581214187, -3527.1332822613767, -3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342196305395457, "mean_inference_ms": 0.23459382896121106, "mean_action_processing_ms": 0.05718895427414027, "mean_env_wait_ms": 0.5957699877379818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017533302307128906, "ViewRequirementAgentConnector_ms": 0.04356575012207031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 482160, "num_agent_steps_trained": 482160, "num_env_steps_sampled": 482160, "num_env_steps_trained": 482160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.83210682035303, "num_env_steps_trained_throughput_per_sec": 190.83210682035303, "timesteps_total": 482160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 482160, "timers": {"training_iteration_time_ms": 1882.188, "sample_time_ms": 1875.177, "load_time_ms": 0.216, "load_throughput": 1668636.8, "learn_time_ms": 6.254, "learn_throughput": 57561.354, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 482160, "num_env_steps_trained": 482160, "num_agent_steps_sampled": 482160, "num_agent_steps_trained": 482160}, "done": false, "episodes_total": 1820, "training_iteration": 347, "trial_id": "6192e_00000", "date": "2023-08-04_10-57-03", "timestamp": 1691135823, "time_this_iter_s": 11.321043968200684, "time_total_s": 3845.906119823456, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 475.44709610939026, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.68125, "ram_util_percent": 65.5125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-11, "entropy_coeff": 0.1, "policy_entropy": -322.20917358398435, "policy_loss": -609149.575, "vf_loss": 20730617.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 1282.0}}, "num_env_steps_sampled": 484320, "num_env_steps_trained": 484320, "num_agent_steps_sampled": 484320, "num_agent_steps_trained": 484320}, "sampler_results": {"episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.394381692342, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342295038281195, "mean_inference_ms": 0.2345772329762169, "mean_action_processing_ms": 0.05718605121319629, "mean_env_wait_ms": 0.595016680888452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025010108947753906, "StateBufferConnector_ms": 0.0017566680908203125, "ViewRequirementAgentConnector_ms": 0.043605804443359375}}, "episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.394381692342, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.2181940207624, -3528.089777605016, -3528.0504623375928, -3526.4723941061366, -3529.0621034900287, -3527.6180718061432, -3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342295038281195, "mean_inference_ms": 0.2345772329762169, "mean_action_processing_ms": 0.05718605121319629, "mean_env_wait_ms": 0.595016680888452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025010108947753906, "StateBufferConnector_ms": 0.0017566680908203125, "ViewRequirementAgentConnector_ms": 0.043605804443359375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484320, "num_agent_steps_trained": 484320, "num_env_steps_sampled": 484320, "num_env_steps_trained": 484320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.0879388720853, "num_env_steps_trained_throughput_per_sec": 191.0879388720853, "timesteps_total": 484320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 484320, "timers": {"training_iteration_time_ms": 1885.674, "sample_time_ms": 1878.632, "load_time_ms": 0.218, "load_throughput": 1654014.065, "learn_time_ms": 6.259, "learn_throughput": 57516.844, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 484320, "num_env_steps_trained": 484320, "num_agent_steps_sampled": 484320, "num_agent_steps_trained": 484320}, "done": false, "episodes_total": 1826, "training_iteration": 348, "trial_id": "6192e_00000", "date": "2023-08-04_10-57-14", "timestamp": 1691135834, "time_this_iter_s": 11.305590152740479, "time_total_s": 3857.2117099761963, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 486.75268626213074, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 19.0375, "ram_util_percent": 65.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.2e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2696472167969, "policy_loss": -2487653.60625, "vf_loss": 20751576.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1313.0, "diff_num_grad_updates_vs_sampler_policy": 1312.0}}, "num_env_steps_sampled": 486480, "num_env_steps_trained": 486480, "num_agent_steps_sampled": 486480, "num_agent_steps_trained": 486480}, "sampler_results": {"episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.357636170235, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3423633443137195, "mean_inference_ms": 0.2345608997427467, "mean_action_processing_ms": 0.057183158975921945, "mean_env_wait_ms": 0.5942964603686651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0017669200897216797, "ViewRequirementAgentConnector_ms": 0.04355478286743164}}, "episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.357636170235, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.126235714389, -3526.7761357118634, -3526.238619157268, -3526.7399363117584, -3526.246810203924, -3529.3604118884455, -3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3423633443137195, "mean_inference_ms": 0.2345608997427467, "mean_action_processing_ms": 0.057183158975921945, "mean_env_wait_ms": 0.5942964603686651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0017669200897216797, "ViewRequirementAgentConnector_ms": 0.04355478286743164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486480, "num_agent_steps_trained": 486480, "num_env_steps_sampled": 486480, "num_env_steps_trained": 486480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.10202228147006, "num_env_steps_trained_throughput_per_sec": 191.10202228147006, "timesteps_total": 486480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 486480, "timers": {"training_iteration_time_ms": 1882.671, "sample_time_ms": 1875.612, "load_time_ms": 0.217, "load_throughput": 1657099.912, "learn_time_ms": 6.284, "learn_throughput": 57292.713, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 486480, "num_env_steps_trained": 486480, "num_agent_steps_sampled": 486480, "num_agent_steps_trained": 486480}, "done": false, "episodes_total": 1832, "training_iteration": 349, "trial_id": "6192e_00000", "date": "2023-08-04_10-57-26", "timestamp": 1691135846, "time_this_iter_s": 11.304898023605347, "time_total_s": 3868.5166079998016, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 498.0575842857361, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 18.6125, "ram_util_percent": 65.14375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7999999999999996e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1571838378906, "policy_loss": -3080308.740625, "vf_loss": 20736697.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1343.0, "diff_num_grad_updates_vs_sampler_policy": 1342.0}}, "num_env_steps_sampled": 488640, "num_env_steps_trained": 488640, "num_agent_steps_sampled": 488640, "num_agent_steps_trained": 488640}, "sampler_results": {"episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.340760128438, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342402513348016, "mean_inference_ms": 0.23454403106669855, "mean_action_processing_ms": 0.05717979802421899, "mean_env_wait_ms": 0.5936203931953721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499818801879883, "StateBufferConnector_ms": 0.001771688461303711, "ViewRequirementAgentConnector_ms": 0.04354429244995117}}, "episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.340760128438, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.98008204408, -3526.416874293416, -3526.5335806289895, -3526.820591912545, -3528.0401261450356, -3526.484169581367, -3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342402513348016, "mean_inference_ms": 0.23454403106669855, "mean_action_processing_ms": 0.05717979802421899, "mean_env_wait_ms": 0.5936203931953721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499818801879883, "StateBufferConnector_ms": 0.001771688461303711, "ViewRequirementAgentConnector_ms": 0.04354429244995117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488640, "num_agent_steps_trained": 488640, "num_env_steps_sampled": 488640, "num_env_steps_trained": 488640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.51214768829064, "num_env_steps_trained_throughput_per_sec": 191.51214768829064, "timesteps_total": 488640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 488640, "timers": {"training_iteration_time_ms": 1885.046, "sample_time_ms": 1878.045, "load_time_ms": 0.216, "load_throughput": 1663306.279, "learn_time_ms": 6.226, "learn_throughput": 57821.675, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 488640, "num_env_steps_trained": 488640, "num_agent_steps_sampled": 488640, "num_agent_steps_trained": 488640}, "done": false, "episodes_total": 1838, "training_iteration": 350, "trial_id": "6192e_00000", "date": "2023-08-04_10-57-37", "timestamp": 1691135857, "time_this_iter_s": 11.280871152877808, "time_total_s": 3879.7974791526794, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 509.3384554386139, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 19.9375, "ram_util_percent": 65.25625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.41156005859375, "policy_loss": -9830068.375, "vf_loss": 20773766.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 1372.0}}, "num_env_steps_sampled": 490800, "num_env_steps_trained": 490800, "num_agent_steps_sampled": 490800, "num_agent_steps_trained": 490800}, "sampler_results": {"episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.403988000667, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342415142816024, "mean_inference_ms": 0.23452895919075206, "mean_action_processing_ms": 0.05717692324188345, "mean_env_wait_ms": 0.5929763683290475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505779266357422, "StateBufferConnector_ms": 0.0017778873443603516, "ViewRequirementAgentConnector_ms": 0.04361367225646973}}, "episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.403988000667, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.4740894490174, -3528.3123646653466, -3528.379032328248, -3527.8797608322147, -3526.662346093744, -3527.7548926099366, -3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342415142816024, "mean_inference_ms": 0.23452895919075206, "mean_action_processing_ms": 0.05717692324188345, "mean_env_wait_ms": 0.5929763683290475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505779266357422, "StateBufferConnector_ms": 0.0017778873443603516, "ViewRequirementAgentConnector_ms": 0.04361367225646973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 490800, "num_agent_steps_trained": 490800, "num_env_steps_sampled": 490800, "num_env_steps_trained": 490800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.6411828946775, "num_env_steps_trained_throughput_per_sec": 191.6411828946775, "timesteps_total": 490800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 490800, "timers": {"training_iteration_time_ms": 1880.885, "sample_time_ms": 1873.925, "load_time_ms": 0.217, "load_throughput": 1657645.669, "learn_time_ms": 6.179, "learn_throughput": 58258.942, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 490800, "num_env_steps_trained": 490800, "num_agent_steps_sampled": 490800, "num_agent_steps_trained": 490800}, "done": false, "episodes_total": 1844, "training_iteration": 351, "trial_id": "6192e_00000", "date": "2023-08-04_10-57-48", "timestamp": 1691135868, "time_this_iter_s": 11.273191928863525, "time_total_s": 3891.070671081543, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 520.6116473674774, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 19.43125, "ram_util_percent": 65.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3063720703125, "policy_loss": -6900001.7125, "vf_loss": 20746508.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1403.0, "diff_num_grad_updates_vs_sampler_policy": 1402.0}}, "num_env_steps_sampled": 492960, "num_env_steps_trained": 492960, "num_agent_steps_sampled": 492960, "num_agent_steps_trained": 492960}, "sampler_results": {"episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.3636906355546, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342416001649601, "mean_inference_ms": 0.2345180545473069, "mean_action_processing_ms": 0.057174540240212506, "mean_env_wait_ms": 0.5923866659680013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002501249313354492, "StateBufferConnector_ms": 0.0017747879028320312, "ViewRequirementAgentConnector_ms": 0.04359912872314453}}, "episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.3636906355546, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.5884117665673, -3527.0526167811886, -3527.809868502222, -3526.65289159193, -3528.3241819846853, -3526.3932018140204, -3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342416001649601, "mean_inference_ms": 0.2345180545473069, "mean_action_processing_ms": 0.057174540240212506, "mean_env_wait_ms": 0.5923866659680013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002501249313354492, "StateBufferConnector_ms": 0.0017747879028320312, "ViewRequirementAgentConnector_ms": 0.04359912872314453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492960, "num_agent_steps_trained": 492960, "num_env_steps_sampled": 492960, "num_env_steps_trained": 492960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.27519313736306, "num_env_steps_trained_throughput_per_sec": 190.27519313736306, "timesteps_total": 492960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 492960, "timers": {"training_iteration_time_ms": 1887.156, "sample_time_ms": 1880.138, "load_time_ms": 0.213, "load_throughput": 1694097.88, "learn_time_ms": 6.246, "learn_throughput": 57634.078, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 492960, "num_env_steps_trained": 492960, "num_agent_steps_sampled": 492960, "num_agent_steps_trained": 492960}, "done": false, "episodes_total": 1850, "training_iteration": 352, "trial_id": "6192e_00000", "date": "2023-08-04_10-57-59", "timestamp": 1691135879, "time_this_iter_s": 11.35395097732544, "time_total_s": 3902.4246220588684, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 531.9655983448029, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 21.287499999999998, "ram_util_percent": 65.41875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3313842773438, "policy_loss": -2329030.76875, "vf_loss": 20759065.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1433.0, "diff_num_grad_updates_vs_sampler_policy": 1432.0}}, "num_env_steps_sampled": 495120, "num_env_steps_trained": 495120, "num_agent_steps_sampled": 495120, "num_agent_steps_trained": 495120}, "sampler_results": {"episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.3823824457963, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34241889710294, "mean_inference_ms": 0.23450963950120557, "mean_action_processing_ms": 0.05717269288484549, "mean_env_wait_ms": 0.5918364447526749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024971961975097656, "StateBufferConnector_ms": 0.0017733573913574219, "ViewRequirementAgentConnector_ms": 0.043624162673950195}}, "episode_reward_max": -3525.5868263301604, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.3823824457963, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.020418625259, -3527.585578679152, -3528.3382961719567, -3527.6309695873624, -3527.590056920063, -3528.3591297003045, -3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34241889710294, "mean_inference_ms": 0.23450963950120557, "mean_action_processing_ms": 0.05717269288484549, "mean_env_wait_ms": 0.5918364447526749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024971961975097656, "StateBufferConnector_ms": 0.0017733573913574219, "ViewRequirementAgentConnector_ms": 0.043624162673950195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 495120, "num_agent_steps_trained": 495120, "num_env_steps_sampled": 495120, "num_env_steps_trained": 495120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.28727851032082, "num_env_steps_trained_throughput_per_sec": 190.28727851032082, "timesteps_total": 495120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 495120, "timers": {"training_iteration_time_ms": 1890.066, "sample_time_ms": 1882.976, "load_time_ms": 0.214, "load_throughput": 1685399.531, "learn_time_ms": 6.313, "learn_throughput": 57029.582, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 495120, "num_env_steps_trained": 495120, "num_agent_steps_sampled": 495120, "num_agent_steps_trained": 495120}, "done": false, "episodes_total": 1856, "training_iteration": 353, "trial_id": "6192e_00000", "date": "2023-08-04_10-58-11", "timestamp": 1691135891, "time_this_iter_s": 11.353343963623047, "time_total_s": 3913.7779660224915, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 543.3189423084259, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.14375, "ram_util_percent": 65.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.151708984375, "policy_loss": -2999462.93125, "vf_loss": 20729870.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1463.0, "diff_num_grad_updates_vs_sampler_policy": 1462.0}}, "num_env_steps_sampled": 497280, "num_env_steps_trained": 497280, "num_agent_steps_sampled": 497280, "num_agent_steps_trained": 497280}, "sampler_results": {"episode_reward_max": -3525.5868037826567, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.299370665879, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342415614763383, "mean_inference_ms": 0.23450293777717277, "mean_action_processing_ms": 0.05717127892016252, "mean_env_wait_ms": 0.5912700859541379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024900436401367188, "StateBufferConnector_ms": 0.001766204833984375, "ViewRequirementAgentConnector_ms": 0.04356789588928223}}, "episode_reward_max": -3525.5868037826567, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.299370665879, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.46019564883, -3527.941420419157, -3525.8273122972173, -3528.70231492014, -3527.771351644091, -3526.545375808498, -3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342415614763383, "mean_inference_ms": 0.23450293777717277, "mean_action_processing_ms": 0.05717127892016252, "mean_env_wait_ms": 0.5912700859541379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024900436401367188, "StateBufferConnector_ms": 0.001766204833984375, "ViewRequirementAgentConnector_ms": 0.04356789588928223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 497280, "num_agent_steps_trained": 497280, "num_env_steps_sampled": 497280, "num_env_steps_trained": 497280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.72216369727198, "num_env_steps_trained_throughput_per_sec": 191.72216369727198, "timesteps_total": 497280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 497280, "timers": {"training_iteration_time_ms": 1882.802, "sample_time_ms": 1875.686, "load_time_ms": 0.215, "load_throughput": 1676045.554, "learn_time_ms": 6.319, "learn_throughput": 56974.924, "synch_weights_time_ms": 0.549}, "counters": {"num_env_steps_sampled": 497280, "num_env_steps_trained": 497280, "num_agent_steps_sampled": 497280, "num_agent_steps_trained": 497280}, "done": false, "episodes_total": 1862, "training_iteration": 354, "trial_id": "6192e_00000", "date": "2023-08-04_10-58-22", "timestamp": 1691135902, "time_this_iter_s": 11.26849913597107, "time_total_s": 3925.0464651584625, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 554.587441444397, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 28.26875, "ram_util_percent": 65.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.0954956054687, "policy_loss": 328468.228125, "vf_loss": 20729244.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1493.0, "diff_num_grad_updates_vs_sampler_policy": 1492.0}}, "num_env_steps_sampled": 499440, "num_env_steps_trained": 499440, "num_agent_steps_sampled": 499440, "num_agent_steps_trained": 499440}, "sampler_results": {"episode_reward_max": -3525.586802966863, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.263967073709, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342391702028977, "mean_inference_ms": 0.23449895056648007, "mean_action_processing_ms": 0.057170334120374075, "mean_env_wait_ms": 0.5907223326081387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024890899658203125, "StateBufferConnector_ms": 0.0017466545104980469, "ViewRequirementAgentConnector_ms": 0.0435335636138916}}, "episode_reward_max": -3525.586802966863, "episode_reward_min": -3547.176255696442, "episode_reward_mean": -3527.263967073709, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.4706544984933, -3527.149996309801, -3527.3988155346133, -3547.176255696442, -3526.8205997509885, -3527.225623975618, -3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342391702028977, "mean_inference_ms": 0.23449895056648007, "mean_action_processing_ms": 0.057170334120374075, "mean_env_wait_ms": 0.5907223326081387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024890899658203125, "StateBufferConnector_ms": 0.0017466545104980469, "ViewRequirementAgentConnector_ms": 0.0435335636138916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 499440, "num_agent_steps_trained": 499440, "num_env_steps_sampled": 499440, "num_env_steps_trained": 499440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.55898458696387, "num_env_steps_trained_throughput_per_sec": 190.55898458696387, "timesteps_total": 499440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 499440, "timers": {"training_iteration_time_ms": 1886.028, "sample_time_ms": 1879.001, "load_time_ms": 0.217, "load_throughput": 1657827.668, "learn_time_ms": 6.24, "learn_throughput": 57691.772, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 499440, "num_env_steps_trained": 499440, "num_agent_steps_sampled": 499440, "num_agent_steps_trained": 499440}, "done": false, "episodes_total": 1868, "training_iteration": 355, "trial_id": "6192e_00000", "date": "2023-08-04_10-58-33", "timestamp": 1691135913, "time_this_iter_s": 11.337097883224487, "time_total_s": 3936.383563041687, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 565.9245393276215, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 19.975, "ram_util_percent": 65.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1677185058594, "policy_loss": -1864768.5125, "vf_loss": 20731480.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1523.0, "diff_num_grad_updates_vs_sampler_policy": 1522.0}}, "num_env_steps_sampled": 501600, "num_env_steps_trained": 501600, "num_agent_steps_sampled": 501600, "num_agent_steps_trained": 501600}, "sampler_results": {"episode_reward_max": -3525.586802966863, "episode_reward_min": -3533.623017493639, "episode_reward_mean": -3527.056650097686, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342348703368368, "mean_inference_ms": 0.23449518372622388, "mean_action_processing_ms": 0.05716951311450976, "mean_env_wait_ms": 0.5901959385335783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024819374084472656, "StateBufferConnector_ms": 0.0017542839050292969, "ViewRequirementAgentConnector_ms": 0.043642282485961914}}, "episode_reward_max": -3525.586802966863, "episode_reward_min": -3533.623017493639, "episode_reward_mean": -3527.056650097686, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.9772862476366, -3526.226572837362, -3527.4963370432706, -3526.896366835874, -3527.04761666102, -3533.593056376598, -3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342348703368368, "mean_inference_ms": 0.23449518372622388, "mean_action_processing_ms": 0.05716951311450976, "mean_env_wait_ms": 0.5901959385335783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024819374084472656, "StateBufferConnector_ms": 0.0017542839050292969, "ViewRequirementAgentConnector_ms": 0.043642282485961914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 501600, "num_agent_steps_trained": 501600, "num_env_steps_sampled": 501600, "num_env_steps_trained": 501600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.41063786294777, "num_env_steps_trained_throughput_per_sec": 190.41063786294777, "timesteps_total": 501600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 501600, "timers": {"training_iteration_time_ms": 1889.798, "sample_time_ms": 1882.759, "load_time_ms": 0.217, "load_throughput": 1656372.795, "learn_time_ms": 6.27, "learn_throughput": 57412.09, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 501600, "num_env_steps_trained": 501600, "num_agent_steps_sampled": 501600, "num_agent_steps_trained": 501600}, "done": false, "episodes_total": 1874, "training_iteration": 356, "trial_id": "6192e_00000", "date": "2023-08-04_10-58-45", "timestamp": 1691135925, "time_this_iter_s": 11.345969915390015, "time_total_s": 3947.729532957077, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 577.2705092430115, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 19.55625, "ram_util_percent": 65.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.5039978027344, "policy_loss": -7458141.0125, "vf_loss": 20767457.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 1552.0}}, "num_env_steps_sampled": 503760, "num_env_steps_trained": 503760, "num_agent_steps_sampled": 503760, "num_agent_steps_trained": 503760}, "sampler_results": {"episode_reward_max": -3525.586802966863, "episode_reward_min": -3533.623017493639, "episode_reward_mean": -3527.005793765533, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342311883780923, "mean_inference_ms": 0.23449230705662544, "mean_action_processing_ms": 0.0571690362943915, "mean_env_wait_ms": 0.5896966260125324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002489328384399414, "StateBufferConnector_ms": 0.0017552375793457031, "ViewRequirementAgentConnector_ms": 0.04371833801269531}}, "episode_reward_max": -3525.586802966863, "episode_reward_min": -3533.623017493639, "episode_reward_mean": -3527.005793765533, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.4456466147326, -3525.5870791410653, -3528.097129641622, -3525.8213442847514, -3527.370803826146, -3528.555873447608, -3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342311883780923, "mean_inference_ms": 0.23449230705662544, "mean_action_processing_ms": 0.0571690362943915, "mean_env_wait_ms": 0.5896966260125324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002489328384399414, "StateBufferConnector_ms": 0.0017552375793457031, "ViewRequirementAgentConnector_ms": 0.04371833801269531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 503760, "num_agent_steps_trained": 503760, "num_env_steps_sampled": 503760, "num_env_steps_trained": 503760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.0832162250731, "num_env_steps_trained_throughput_per_sec": 190.0832162250731, "timesteps_total": 503760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 503760, "timers": {"training_iteration_time_ms": 1892.835, "sample_time_ms": 1885.545, "load_time_ms": 0.218, "load_throughput": 1650037.635, "learn_time_ms": 6.514, "learn_throughput": 55262.136, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 503760, "num_env_steps_trained": 503760, "num_agent_steps_sampled": 503760, "num_agent_steps_trained": 503760}, "done": false, "episodes_total": 1880, "training_iteration": 357, "trial_id": "6192e_00000", "date": "2023-08-04_10-58-56", "timestamp": 1691135936, "time_this_iter_s": 11.36548924446106, "time_total_s": 3959.095022201538, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 588.6359984874725, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 19.125, "ram_util_percent": 65.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.33018798828124, "policy_loss": -2663319.91875, "vf_loss": 20759839.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1583.0, "diff_num_grad_updates_vs_sampler_policy": 1582.0}}, "num_env_steps_sampled": 505920, "num_env_steps_trained": 505920, "num_agent_steps_sampled": 505920, "num_agent_steps_trained": 505920}, "sampler_results": {"episode_reward_max": -3525.487116645882, "episode_reward_min": -3533.623017493639, "episode_reward_mean": -3526.9661206897044, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3423104522871485, "mean_inference_ms": 0.23449113006191422, "mean_action_processing_ms": 0.05716884218481828, "mean_env_wait_ms": 0.5892183424813495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024933815002441406, "StateBufferConnector_ms": 0.0017588138580322266, "ViewRequirementAgentConnector_ms": 0.04378342628479004}}, "episode_reward_max": -3525.487116645882, "episode_reward_min": -3533.623017493639, "episode_reward_mean": -3526.9661206897044, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.2590543619344, -3527.109530247675, -3525.586976814355, -3526.214017409833, -3528.2707615618265, -3533.623017493639, -3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3423104522871485, "mean_inference_ms": 0.23449113006191422, "mean_action_processing_ms": 0.05716884218481828, "mean_env_wait_ms": 0.5892183424813495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024933815002441406, "StateBufferConnector_ms": 0.0017588138580322266, "ViewRequirementAgentConnector_ms": 0.04378342628479004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 505920, "num_agent_steps_trained": 505920, "num_env_steps_sampled": 505920, "num_env_steps_trained": 505920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.79759043262416, "num_env_steps_trained_throughput_per_sec": 189.79759043262416, "timesteps_total": 505920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 505920, "timers": {"training_iteration_time_ms": 1895.477, "sample_time_ms": 1888.226, "load_time_ms": 0.219, "load_throughput": 1641427.807, "learn_time_ms": 6.472, "learn_throughput": 55623.89, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 505920, "num_env_steps_trained": 505920, "num_agent_steps_sampled": 505920, "num_agent_steps_trained": 505920}, "done": false, "episodes_total": 1886, "training_iteration": 358, "trial_id": "6192e_00000", "date": "2023-08-04_10-59-08", "timestamp": 1691135948, "time_this_iter_s": 11.382542848587036, "time_total_s": 3970.477565050125, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 600.0185413360596, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 20.8125, "ram_util_percent": 65.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2226196289063, "policy_loss": -606737.328125, "vf_loss": 20734267.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1613.0, "diff_num_grad_updates_vs_sampler_policy": 1612.0}}, "num_env_steps_sampled": 508080, "num_env_steps_trained": 508080, "num_agent_steps_sampled": 508080, "num_agent_steps_trained": 508080}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.884756221583, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342334484689377, "mean_inference_ms": 0.2344890310674286, "mean_action_processing_ms": 0.057168457250900744, "mean_env_wait_ms": 0.588741351427362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024940967559814453, "StateBufferConnector_ms": 0.0017609596252441406, "ViewRequirementAgentConnector_ms": 0.043802738189697266}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.884756221583, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.5868971486966, -3528.717148371277, -3527.2932644389116, -3527.328744301276, -3527.6245735601133, -3525.9532464265612, -3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342334484689377, "mean_inference_ms": 0.2344890310674286, "mean_action_processing_ms": 0.057168457250900744, "mean_env_wait_ms": 0.588741351427362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024940967559814453, "StateBufferConnector_ms": 0.0017609596252441406, "ViewRequirementAgentConnector_ms": 0.043802738189697266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508080, "num_agent_steps_trained": 508080, "num_env_steps_sampled": 508080, "num_env_steps_trained": 508080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.99526750162363, "num_env_steps_trained_throughput_per_sec": 190.99526750162363, "timesteps_total": 508080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 508080, "timers": {"training_iteration_time_ms": 1890.224, "sample_time_ms": 1883.203, "load_time_ms": 0.216, "load_throughput": 1663489.523, "learn_time_ms": 6.262, "learn_throughput": 57493.629, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 508080, "num_env_steps_trained": 508080, "num_agent_steps_sampled": 508080, "num_agent_steps_trained": 508080}, "done": false, "episodes_total": 1892, "training_iteration": 359, "trial_id": "6192e_00000", "date": "2023-08-04_10-59-19", "timestamp": 1691135959, "time_this_iter_s": 11.311187982559204, "time_total_s": 3981.7887530326843, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 611.3297293186188, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 21.10625, "ram_util_percent": 65.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.340283203125, "policy_loss": -8119382.53125, "vf_loss": 20765775.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1643.0, "diff_num_grad_updates_vs_sampler_policy": 1642.0}}, "num_env_steps_sampled": 510240, "num_env_steps_trained": 510240, "num_agent_steps_sampled": 510240, "num_agent_steps_trained": 510240}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.857591752345, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342368638084372, "mean_inference_ms": 0.23448978343282892, "mean_action_processing_ms": 0.05716848711587788, "mean_env_wait_ms": 0.5882794733885339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002492666244506836, "StateBufferConnector_ms": 0.001760721206665039, "ViewRequirementAgentConnector_ms": 0.0438380241394043}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.857591752345, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.9850158558, -3527.5979710383804, -3526.766936630738, -3525.5868404952894, -3526.0142190189536, -3525.58686003152, -3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342368638084372, "mean_inference_ms": 0.23448978343282892, "mean_action_processing_ms": 0.05716848711587788, "mean_env_wait_ms": 0.5882794733885339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002492666244506836, "StateBufferConnector_ms": 0.001760721206665039, "ViewRequirementAgentConnector_ms": 0.0438380241394043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 510240, "num_agent_steps_trained": 510240, "num_env_steps_sampled": 510240, "num_env_steps_trained": 510240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.2135153117559, "num_env_steps_trained_throughput_per_sec": 190.2135153117559, "timesteps_total": 510240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 510240, "timers": {"training_iteration_time_ms": 1888.584, "sample_time_ms": 1881.57, "load_time_ms": 0.217, "load_throughput": 1659649.857, "learn_time_ms": 6.246, "learn_throughput": 57634.078, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 510240, "num_env_steps_trained": 510240, "num_agent_steps_sampled": 510240, "num_agent_steps_trained": 510240}, "done": false, "episodes_total": 1898, "training_iteration": 360, "trial_id": "6192e_00000", "date": "2023-08-04_10-59-30", "timestamp": 1691135970, "time_this_iter_s": 11.35764479637146, "time_total_s": 3993.146397829056, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 622.6873741149902, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 19.025, "ram_util_percent": 65.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.0954956054687, "policy_loss": 328601.71875, "vf_loss": 20742278.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1673.0, "diff_num_grad_updates_vs_sampler_policy": 1672.0}}, "num_env_steps_sampled": 512400, "num_env_steps_trained": 512400, "num_agent_steps_sampled": 512400, "num_agent_steps_trained": 512400}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.8793823537417, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342407051753714, "mean_inference_ms": 0.23449027125422353, "mean_action_processing_ms": 0.057168459967349074, "mean_env_wait_ms": 0.5878319316597004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024912357330322266, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.043807029724121094}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.8793823537417, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.787074896952, -3526.7527747434406, -3526.3112601443418, -3526.537933463125, -3528.2271969782596, -3527.139853097062, -3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342407051753714, "mean_inference_ms": 0.23449027125422353, "mean_action_processing_ms": 0.057168459967349074, "mean_env_wait_ms": 0.5878319316597004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024912357330322266, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.043807029724121094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512400, "num_agent_steps_trained": 512400, "num_env_steps_sampled": 512400, "num_env_steps_trained": 512400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.33349848543693, "num_env_steps_trained_throughput_per_sec": 191.33349848543693, "timesteps_total": 512400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 512400, "timers": {"training_iteration_time_ms": 1886.11, "sample_time_ms": 1879.128, "load_time_ms": 0.218, "load_throughput": 1648236.481, "learn_time_ms": 6.219, "learn_throughput": 57885.071, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 512400, "num_env_steps_trained": 512400, "num_agent_steps_sampled": 512400, "num_agent_steps_trained": 512400}, "done": false, "episodes_total": 1904, "training_iteration": 361, "trial_id": "6192e_00000", "date": "2023-08-04_10-59-42", "timestamp": 1691135982, "time_this_iter_s": 11.291323184967041, "time_total_s": 4004.437721014023, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 633.9786972999573, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 22.81875, "ram_util_percent": 65.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2859252929687, "policy_loss": -3288486.40625, "vf_loss": 20761255.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1703.0, "diff_num_grad_updates_vs_sampler_policy": 1702.0}}, "num_env_steps_sampled": 514560, "num_env_steps_trained": 514560, "num_agent_steps_sampled": 514560, "num_agent_steps_trained": 514560}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.864236918871, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342472639142353, "mean_inference_ms": 0.23448767158025002, "mean_action_processing_ms": 0.057167862585983345, "mean_env_wait_ms": 0.5874106359831555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002492189407348633, "StateBufferConnector_ms": 0.00174713134765625, "ViewRequirementAgentConnector_ms": 0.0437474250793457}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.864236918871, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.168630509653, -3526.370271790122, -3525.5868263301604, -3526.9023395796175, -3526.799272611786, -3526.8192200490494, -3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342472639142353, "mean_inference_ms": 0.23448767158025002, "mean_action_processing_ms": 0.057167862585983345, "mean_env_wait_ms": 0.5874106359831555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002492189407348633, "StateBufferConnector_ms": 0.00174713134765625, "ViewRequirementAgentConnector_ms": 0.0437474250793457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 514560, "num_agent_steps_trained": 514560, "num_env_steps_sampled": 514560, "num_env_steps_trained": 514560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.75647074563136, "num_env_steps_trained_throughput_per_sec": 190.75647074563136, "timesteps_total": 514560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 514560, "timers": {"training_iteration_time_ms": 1883.976, "sample_time_ms": 1876.988, "load_time_ms": 0.219, "load_throughput": 1646798.386, "learn_time_ms": 6.238, "learn_throughput": 57706.765, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 514560, "num_env_steps_trained": 514560, "num_agent_steps_sampled": 514560, "num_agent_steps_trained": 514560}, "done": false, "episodes_total": 1910, "training_iteration": 362, "trial_id": "6192e_00000", "date": "2023-08-04_10-59-53", "timestamp": 1691135993, "time_this_iter_s": 11.325552940368652, "time_total_s": 4015.7632739543915, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 645.3042502403259, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 19.012500000000003, "ram_util_percent": 65.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1987365722656, "policy_loss": -1591829.66875, "vf_loss": 20737892.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1733.0, "diff_num_grad_updates_vs_sampler_policy": 1732.0}}, "num_env_steps_sampled": 516720, "num_env_steps_trained": 516720, "num_agent_steps_sampled": 516720, "num_agent_steps_trained": 516720}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.850231891114, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342554479055139, "mean_inference_ms": 0.23448624787783906, "mean_action_processing_ms": 0.057167520413602214, "mean_env_wait_ms": 0.5870012163079827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002479076385498047, "StateBufferConnector_ms": 0.0017480850219726562, "ViewRequirementAgentConnector_ms": 0.04372358322143555}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.850231891114, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.2236068440943, -3526.437605922514, -3527.2409898146648, -3525.8325061843807, -3527.3978694411758, -3526.060375510228, -3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342554479055139, "mean_inference_ms": 0.23448624787783906, "mean_action_processing_ms": 0.057167520413602214, "mean_env_wait_ms": 0.5870012163079827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002479076385498047, "StateBufferConnector_ms": 0.0017480850219726562, "ViewRequirementAgentConnector_ms": 0.04372358322143555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516720, "num_agent_steps_trained": 516720, "num_env_steps_sampled": 516720, "num_env_steps_trained": 516720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.64939145769955, "num_env_steps_trained_throughput_per_sec": 190.64939145769955, "timesteps_total": 516720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 516720, "timers": {"training_iteration_time_ms": 1888.929, "sample_time_ms": 1881.914, "load_time_ms": 0.219, "load_throughput": 1640179.709, "learn_time_ms": 6.26, "learn_throughput": 57506.329, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 516720, "num_env_steps_trained": 516720, "num_agent_steps_sampled": 516720, "num_agent_steps_trained": 516720}, "done": false, "episodes_total": 1916, "training_iteration": 363, "trial_id": "6192e_00000", "date": "2023-08-04_11-00-04", "timestamp": 1691136004, "time_this_iter_s": 11.331860065460205, "time_total_s": 4027.0951340198517, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 656.6361103057861, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 20.011764705882353, "ram_util_percent": 65.47647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3214965820313, "policy_loss": -2178179.553125, "vf_loss": 20741978.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1763.0, "diff_num_grad_updates_vs_sampler_policy": 1762.0}}, "num_env_steps_sampled": 518880, "num_env_steps_trained": 518880, "num_agent_steps_sampled": 518880, "num_agent_steps_trained": 518880}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.8588994216825, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3426496020706224, "mean_inference_ms": 0.23448795092220415, "mean_action_processing_ms": 0.057167630591238715, "mean_env_wait_ms": 0.5866068653574178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024802684783935547, "StateBufferConnector_ms": 0.0017366409301757812, "ViewRequirementAgentConnector_ms": 0.04372859001159668}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.8588994216825, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.9269150108003, -3527.2049192398426, -3525.7468245255577, -3526.171112817091, -3527.4297625291233, -3526.2057591480925, -3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3426496020706224, "mean_inference_ms": 0.23448795092220415, "mean_action_processing_ms": 0.057167630591238715, "mean_env_wait_ms": 0.5866068653574178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024802684783935547, "StateBufferConnector_ms": 0.0017366409301757812, "ViewRequirementAgentConnector_ms": 0.04372859001159668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 518880, "num_agent_steps_trained": 518880, "num_env_steps_sampled": 518880, "num_env_steps_trained": 518880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.30102828801878, "num_env_steps_trained_throughput_per_sec": 190.30102828801878, "timesteps_total": 518880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 518880, "timers": {"training_iteration_time_ms": 1890.291, "sample_time_ms": 1883.235, "load_time_ms": 0.221, "load_throughput": 1630791.057, "learn_time_ms": 6.263, "learn_throughput": 57476.121, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 518880, "num_env_steps_trained": 518880, "num_agent_steps_sampled": 518880, "num_agent_steps_trained": 518880}, "done": false, "episodes_total": 1922, "training_iteration": 364, "trial_id": "6192e_00000", "date": "2023-08-04_11-00-16", "timestamp": 1691136016, "time_this_iter_s": 11.352751970291138, "time_total_s": 4038.447885990143, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 667.9888622760773, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 23.681250000000002, "ram_util_percent": 65.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.311376953125, "policy_loss": -1807204.603125, "vf_loss": 20750827.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1793.0, "diff_num_grad_updates_vs_sampler_policy": 1792.0}}, "num_env_steps_sampled": 521040, "num_env_steps_trained": 521040, "num_agent_steps_sampled": 521040, "num_agent_steps_trained": 521040}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.894626824923, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342741944727701, "mean_inference_ms": 0.23448985948483952, "mean_action_processing_ms": 0.05716774490185342, "mean_env_wait_ms": 0.5862310878847881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024826526641845703, "StateBufferConnector_ms": 0.0017266273498535156, "ViewRequirementAgentConnector_ms": 0.043759822845458984}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.894626824923, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.247856449169, -3528.1238103385017, -3525.66872400374, -3527.160538686344, -3528.211611202935, -3526.8453151735657, -3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342741944727701, "mean_inference_ms": 0.23448985948483952, "mean_action_processing_ms": 0.05716774490185342, "mean_env_wait_ms": 0.5862310878847881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024826526641845703, "StateBufferConnector_ms": 0.0017266273498535156, "ViewRequirementAgentConnector_ms": 0.043759822845458984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 521040, "num_agent_steps_trained": 521040, "num_env_steps_sampled": 521040, "num_env_steps_trained": 521040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.06249806637643, "num_env_steps_trained_throughput_per_sec": 191.06249806637643, "timesteps_total": 521040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 521040, "timers": {"training_iteration_time_ms": 1887.858, "sample_time_ms": 1880.802, "load_time_ms": 0.22, "load_throughput": 1637689.197, "learn_time_ms": 6.268, "learn_throughput": 57433.927, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 521040, "num_env_steps_trained": 521040, "num_agent_steps_sampled": 521040, "num_agent_steps_trained": 521040}, "done": false, "episodes_total": 1928, "training_iteration": 365, "trial_id": "6192e_00000", "date": "2023-08-04_11-00-27", "timestamp": 1691136027, "time_this_iter_s": 11.307312965393066, "time_total_s": 4049.755198955536, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 679.2961752414703, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 21.525, "ram_util_percent": 65.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2121337890625, "policy_loss": -1532839.15625, "vf_loss": 20745547.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1823.0, "diff_num_grad_updates_vs_sampler_policy": 1822.0}}, "num_env_steps_sampled": 523200, "num_env_steps_trained": 523200, "num_agent_steps_sampled": 523200, "num_agent_steps_trained": 523200}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.8892505363224, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342844194098923, "mean_inference_ms": 0.23449372312871092, "mean_action_processing_ms": 0.057168163633002374, "mean_env_wait_ms": 0.58587945088922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024797916412353516, "StateBufferConnector_ms": 0.0017130374908447266, "ViewRequirementAgentConnector_ms": 0.04377460479736328}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3532.7521736512654, "episode_reward_mean": -3526.8892505363224, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.1742312240863, -3526.112800551196, -3526.1366828955765, -3526.3199037605636, -3532.7521736512654, -3525.9282727817276, -3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342844194098923, "mean_inference_ms": 0.23449372312871092, "mean_action_processing_ms": 0.057168163633002374, "mean_env_wait_ms": 0.58587945088922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024797916412353516, "StateBufferConnector_ms": 0.0017130374908447266, "ViewRequirementAgentConnector_ms": 0.04377460479736328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 523200, "num_agent_steps_trained": 523200, "num_env_steps_sampled": 523200, "num_env_steps_trained": 523200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.50143675695642, "num_env_steps_trained_throughput_per_sec": 190.50143675695642, "timesteps_total": 523200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 523200, "timers": {"training_iteration_time_ms": 1888.09, "sample_time_ms": 1881.076, "load_time_ms": 0.219, "load_throughput": 1640536.115, "learn_time_ms": 6.242, "learn_throughput": 57669.517, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 523200, "num_env_steps_trained": 523200, "num_agent_steps_sampled": 523200, "num_agent_steps_trained": 523200}, "done": false, "episodes_total": 1934, "training_iteration": 366, "trial_id": "6192e_00000", "date": "2023-08-04_11-00-38", "timestamp": 1691136038, "time_this_iter_s": 11.34060287475586, "time_total_s": 4061.0958018302917, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 690.6367781162262, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 24.324999999999996, "ram_util_percent": 65.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.29035034179685, "policy_loss": -5709377.9125, "vf_loss": 20747124.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1853.0, "diff_num_grad_updates_vs_sampler_policy": 1852.0}}, "num_env_steps_sampled": 525360, "num_env_steps_trained": 525360, "num_agent_steps_sampled": 525360, "num_agent_steps_trained": 525360}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.9518053214138, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342966834593065, "mean_inference_ms": 0.23449849802844178, "mean_action_processing_ms": 0.05716874697419562, "mean_env_wait_ms": 0.5855536307017623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002496480941772461, "StateBufferConnector_ms": 0.001708984375, "ViewRequirementAgentConnector_ms": 0.043756961822509766}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.9518053214138, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.7759976307834, -3527.783451613469, -3526.6558535152567, -3528.70246263588, -3527.047613052986, -3525.6001978365293, -3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.342966834593065, "mean_inference_ms": 0.23449849802844178, "mean_action_processing_ms": 0.05716874697419562, "mean_env_wait_ms": 0.5855536307017623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002496480941772461, "StateBufferConnector_ms": 0.001708984375, "ViewRequirementAgentConnector_ms": 0.043756961822509766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 525360, "num_agent_steps_trained": 525360, "num_env_steps_sampled": 525360, "num_env_steps_trained": 525360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.41542028139676, "num_env_steps_trained_throughput_per_sec": 190.41542028139676, "timesteps_total": 525360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 525360, "timers": {"training_iteration_time_ms": 1890.153, "sample_time_ms": 1883.069, "load_time_ms": 0.219, "load_throughput": 1641784.756, "learn_time_ms": 6.305, "learn_throughput": 57094.059, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 525360, "num_env_steps_trained": 525360, "num_agent_steps_sampled": 525360, "num_agent_steps_trained": 525360}, "done": false, "episodes_total": 1940, "training_iteration": 367, "trial_id": "6192e_00000", "date": "2023-08-04_11-00-50", "timestamp": 1691136050, "time_this_iter_s": 11.345690727233887, "time_total_s": 4072.4414925575256, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 701.9824688434601, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 19.456249999999997, "ram_util_percent": 65.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3264953613281, "policy_loss": -7431879.43125, "vf_loss": 20744948.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1883.0, "diff_num_grad_updates_vs_sampler_policy": 1882.0}}, "num_env_steps_sampled": 527520, "num_env_steps_trained": 527520, "num_agent_steps_sampled": 527520, "num_agent_steps_trained": 527520}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.9286689021724, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343091827257541, "mean_inference_ms": 0.23450203458506738, "mean_action_processing_ms": 0.05716911543708539, "mean_env_wait_ms": 0.5852410452260494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002491474151611328, "StateBufferConnector_ms": 0.0017049312591552734, "ViewRequirementAgentConnector_ms": 0.04374241828918457}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.9286689021724, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6598547784392, -3527.3962551728964, -3528.7789792604613, -3526.9498493658107, -3527.763131254402, -3527.2617751232137, -3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343091827257541, "mean_inference_ms": 0.23450203458506738, "mean_action_processing_ms": 0.05716911543708539, "mean_env_wait_ms": 0.5852410452260494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002491474151611328, "StateBufferConnector_ms": 0.0017049312591552734, "ViewRequirementAgentConnector_ms": 0.04374241828918457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 527520, "num_agent_steps_trained": 527520, "num_env_steps_sampled": 527520, "num_env_steps_trained": 527520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.1039692927404, "num_env_steps_trained_throughput_per_sec": 191.1039692927404, "timesteps_total": 527520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 527520, "timers": {"training_iteration_time_ms": 1885.749, "sample_time_ms": 1878.533, "load_time_ms": 0.224, "load_throughput": 1606329.191, "learn_time_ms": 6.404, "learn_throughput": 56212.402, "synch_weights_time_ms": 0.555}, "counters": {"num_env_steps_sampled": 527520, "num_env_steps_trained": 527520, "num_agent_steps_sampled": 527520, "num_agent_steps_trained": 527520}, "done": false, "episodes_total": 1946, "training_iteration": 368, "trial_id": "6192e_00000", "date": "2023-08-04_11-01-01", "timestamp": 1691136061, "time_this_iter_s": 11.304871082305908, "time_total_s": 4083.7463636398315, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 713.287339925766, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 19.375, "ram_util_percent": 65.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.20331420898435, "policy_loss": -2879408.265625, "vf_loss": 20730734.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1913.0, "diff_num_grad_updates_vs_sampler_policy": 1912.0}}, "num_env_steps_sampled": 529680, "num_env_steps_trained": 529680, "num_agent_steps_sampled": 529680, "num_agent_steps_trained": 529680}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.9300127775937, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343213617345397, "mean_inference_ms": 0.2345040286524823, "mean_action_processing_ms": 0.05716947282859499, "mean_env_wait_ms": 0.584931096006621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002485036849975586, "StateBufferConnector_ms": 0.0017006397247314453, "ViewRequirementAgentConnector_ms": 0.04368901252746582}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.9300127775937, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.8523219387735, -3526.379879970326, -3526.779171181778, -3528.6540739963557, -3525.5868037826567, -3526.87643105002, -3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343213617345397, "mean_inference_ms": 0.2345040286524823, "mean_action_processing_ms": 0.05716947282859499, "mean_env_wait_ms": 0.584931096006621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002485036849975586, "StateBufferConnector_ms": 0.0017006397247314453, "ViewRequirementAgentConnector_ms": 0.04368901252746582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 529680, "num_agent_steps_trained": 529680, "num_env_steps_sampled": 529680, "num_env_steps_trained": 529680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.42446951452283, "num_env_steps_trained_throughput_per_sec": 190.42446951452283, "timesteps_total": 529680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 529680, "timers": {"training_iteration_time_ms": 1888.979, "sample_time_ms": 1881.691, "load_time_ms": 0.226, "load_throughput": 1594455.586, "learn_time_ms": 6.48, "learn_throughput": 55555.126, "synch_weights_time_ms": 0.548}, "counters": {"num_env_steps_sampled": 529680, "num_env_steps_trained": 529680, "num_agent_steps_sampled": 529680, "num_agent_steps_trained": 529680}, "done": false, "episodes_total": 1952, "training_iteration": 369, "trial_id": "6192e_00000", "date": "2023-08-04_11-01-12", "timestamp": 1691136072, "time_this_iter_s": 11.345108985900879, "time_total_s": 4095.0914726257324, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 724.6324489116669, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 19.21875, "ram_util_percent": 65.33125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3585510253906, "policy_loss": -10635113.475, "vf_loss": 20750816.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1943.0, "diff_num_grad_updates_vs_sampler_policy": 1942.0}}, "num_env_steps_sampled": 531840, "num_env_steps_trained": 531840, "num_agent_steps_sampled": 531840, "num_agent_steps_trained": 531840}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.9419272046175, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343341311080338, "mean_inference_ms": 0.23450474133653224, "mean_action_processing_ms": 0.05716954034809172, "mean_env_wait_ms": 0.5846343446846497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002477884292602539, "StateBufferConnector_ms": 0.0017020702362060547, "ViewRequirementAgentConnector_ms": 0.043685197830200195}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.9419272046175, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.09595638009, -3526.1830046189893, -3526.7419174705155, -3525.7391583901467, -3526.887391848364, -3526.1949544084096, -3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343341311080338, "mean_inference_ms": 0.23450474133653224, "mean_action_processing_ms": 0.05716954034809172, "mean_env_wait_ms": 0.5846343446846497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002477884292602539, "StateBufferConnector_ms": 0.0017020702362060547, "ViewRequirementAgentConnector_ms": 0.043685197830200195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 531840, "num_agent_steps_trained": 531840, "num_env_steps_sampled": 531840, "num_env_steps_trained": 531840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.3754074480085, "num_env_steps_trained_throughput_per_sec": 190.3754074480085, "timesteps_total": 531840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 531840, "timers": {"training_iteration_time_ms": 1889.726, "sample_time_ms": 1882.505, "load_time_ms": 0.217, "load_throughput": 1661293.256, "learn_time_ms": 6.428, "learn_throughput": 56004.326, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 531840, "num_env_steps_trained": 531840, "num_agent_steps_sampled": 531840, "num_agent_steps_trained": 531840}, "done": false, "episodes_total": 1958, "training_iteration": 370, "trial_id": "6192e_00000", "date": "2023-08-04_11-01-24", "timestamp": 1691136084, "time_this_iter_s": 11.34812307357788, "time_total_s": 4106.43959569931, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 735.9805719852448, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 19.0625, "ram_util_percent": 65.38125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2851928710937, "policy_loss": -3824738.496875, "vf_loss": 20735575.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1973.0, "diff_num_grad_updates_vs_sampler_policy": 1972.0}}, "num_env_steps_sampled": 534000, "num_env_steps_trained": 534000, "num_agent_steps_sampled": 534000, "num_agent_steps_trained": 534000}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.946605506845, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343481183297436, "mean_inference_ms": 0.23450550993163446, "mean_action_processing_ms": 0.05716972866089121, "mean_env_wait_ms": 0.5843701800403663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002476215362548828, "StateBufferConnector_ms": 0.0017082691192626953, "ViewRequirementAgentConnector_ms": 0.0437467098236084}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.946605506845, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.0010932492896, -3526.2160388328007, -3526.8213302151366, -3525.586802966863, -3526.9013141690125, -3526.8365778397274, -3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343481183297436, "mean_inference_ms": 0.23450550993163446, "mean_action_processing_ms": 0.05716972866089121, "mean_env_wait_ms": 0.5843701800403663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002476215362548828, "StateBufferConnector_ms": 0.0017082691192626953, "ViewRequirementAgentConnector_ms": 0.0437467098236084}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 534000, "num_agent_steps_trained": 534000, "num_env_steps_sampled": 534000, "num_env_steps_trained": 534000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.02016420557146, "num_env_steps_trained_throughput_per_sec": 190.02016420557146, "timesteps_total": 534000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 534000, "timers": {"training_iteration_time_ms": 1892.135, "sample_time_ms": 1885.074, "load_time_ms": 0.218, "load_throughput": 1648596.397, "learn_time_ms": 6.291, "learn_throughput": 57226.269, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 534000, "num_env_steps_trained": 534000, "num_agent_steps_sampled": 534000, "num_agent_steps_trained": 534000}, "done": false, "episodes_total": 1964, "training_iteration": 371, "trial_id": "6192e_00000", "date": "2023-08-04_11-01-35", "timestamp": 1691136095, "time_this_iter_s": 11.369310140609741, "time_total_s": 4117.80890583992, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 747.3498821258545, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 20.95, "ram_util_percent": 65.31875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.34990234375, "policy_loss": -10554350.9125, "vf_loss": 20750377.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2003.0, "diff_num_grad_updates_vs_sampler_policy": 2002.0}}, "num_env_steps_sampled": 536160, "num_env_steps_trained": 536160, "num_agent_steps_sampled": 536160, "num_agent_steps_trained": 536160}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.962490430507, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343620660668449, "mean_inference_ms": 0.23450474791007636, "mean_action_processing_ms": 0.05716973605744258, "mean_env_wait_ms": 0.5841146922062493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002483367919921875, "StateBufferConnector_ms": 0.0017273426055908203, "ViewRequirementAgentConnector_ms": 0.0437009334564209}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.962490430507, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.1510785528035, -3526.779892774892, -3528.9778354120817, -3525.8635494151827, -3529.6455082864604, -3526.243105922498, -3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343620660668449, "mean_inference_ms": 0.23450474791007636, "mean_action_processing_ms": 0.05716973605744258, "mean_env_wait_ms": 0.5841146922062493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002483367919921875, "StateBufferConnector_ms": 0.0017273426055908203, "ViewRequirementAgentConnector_ms": 0.0437009334564209}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536160, "num_agent_steps_trained": 536160, "num_env_steps_sampled": 536160, "num_env_steps_trained": 536160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.40674407121114, "num_env_steps_trained_throughput_per_sec": 190.40674407121114, "timesteps_total": 536160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 536160, "timers": {"training_iteration_time_ms": 1892.769, "sample_time_ms": 1885.622, "load_time_ms": 0.229, "load_throughput": 1574175.813, "learn_time_ms": 6.381, "learn_throughput": 56416.76, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 536160, "num_env_steps_trained": 536160, "num_agent_steps_sampled": 536160, "num_agent_steps_trained": 536160}, "done": false, "episodes_total": 1970, "training_iteration": 372, "trial_id": "6192e_00000", "date": "2023-08-04_11-01-47", "timestamp": 1691136107, "time_this_iter_s": 11.346163034439087, "time_total_s": 4129.155068874359, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 758.6960451602936, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 19.03125, "ram_util_percent": 65.56875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.34088745117185, "policy_loss": -5203784.825, "vf_loss": 20761911.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2033.0, "diff_num_grad_updates_vs_sampler_policy": 2032.0}}, "num_env_steps_sampled": 538320, "num_env_steps_trained": 538320, "num_agent_steps_sampled": 538320, "num_agent_steps_trained": 538320}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.9507867209004, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34375235344152, "mean_inference_ms": 0.23450359358446174, "mean_action_processing_ms": 0.057169666189734895, "mean_env_wait_ms": 0.5838694583508522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024776458740234375, "StateBufferConnector_ms": 0.0017268657684326172, "ViewRequirementAgentConnector_ms": 0.0436091423034668}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.9507867209004, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.8578458125758, -3526.365648153543, -3526.6535786911277, -3528.385915920228, -3527.509188587931, -3526.444152684351, -3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34375235344152, "mean_inference_ms": 0.23450359358446174, "mean_action_processing_ms": 0.057169666189734895, "mean_env_wait_ms": 0.5838694583508522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024776458740234375, "StateBufferConnector_ms": 0.0017268657684326172, "ViewRequirementAgentConnector_ms": 0.0436091423034668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 538320, "num_agent_steps_trained": 538320, "num_env_steps_sampled": 538320, "num_env_steps_trained": 538320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.341797664096, "num_env_steps_trained_throughput_per_sec": 190.341797664096, "timesteps_total": 538320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 538320, "timers": {"training_iteration_time_ms": 1890.025, "sample_time_ms": 1882.913, "load_time_ms": 0.225, "load_throughput": 1597661.031, "learn_time_ms": 6.338, "learn_throughput": 56802.387, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 538320, "num_env_steps_trained": 538320, "num_agent_steps_sampled": 538320, "num_agent_steps_trained": 538320}, "done": false, "episodes_total": 1976, "training_iteration": 373, "trial_id": "6192e_00000", "date": "2023-08-04_11-01-58", "timestamp": 1691136118, "time_this_iter_s": 11.350348949432373, "time_total_s": 4140.5054178237915, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 770.046394109726, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 19.3875, "ram_util_percent": 65.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3632751464844, "policy_loss": -5419197.9, "vf_loss": 20742900.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2063.0, "diff_num_grad_updates_vs_sampler_policy": 2062.0}}, "num_env_steps_sampled": 540480, "num_env_steps_trained": 540480, "num_agent_steps_sampled": 540480, "num_agent_steps_trained": 540480}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.972514788919, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343884559528804, "mean_inference_ms": 0.2345026181796155, "mean_action_processing_ms": 0.057169623851427806, "mean_env_wait_ms": 0.5836341289125089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024776458740234375, "StateBufferConnector_ms": 0.001735687255859375, "ViewRequirementAgentConnector_ms": 0.04361414909362793}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3526.972514788919, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.487116645882, -3526.129462574758, -3526.582183351529, -3527.758465528664, -3527.708419174277, -3527.5178205290563, -3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343884559528804, "mean_inference_ms": 0.2345026181796155, "mean_action_processing_ms": 0.057169623851427806, "mean_env_wait_ms": 0.5836341289125089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024776458740234375, "StateBufferConnector_ms": 0.001735687255859375, "ViewRequirementAgentConnector_ms": 0.04361414909362793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540480, "num_agent_steps_trained": 540480, "num_env_steps_sampled": 540480, "num_env_steps_trained": 540480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.5657278294464, "num_env_steps_trained_throughput_per_sec": 189.5657278294464, "timesteps_total": 540480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 540480, "timers": {"training_iteration_time_ms": 1896.631, "sample_time_ms": 1889.571, "load_time_ms": 0.217, "load_throughput": 1658009.707, "learn_time_ms": 6.291, "learn_throughput": 57224.534, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 540480, "num_env_steps_trained": 540480, "num_agent_steps_sampled": 540480, "num_agent_steps_trained": 540480}, "done": false, "episodes_total": 1982, "training_iteration": 374, "trial_id": "6192e_00000", "date": "2023-08-04_11-02-09", "timestamp": 1691136129, "time_this_iter_s": 11.396543025970459, "time_total_s": 4151.901960849762, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 781.4429371356964, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 20.65625, "ram_util_percent": 65.41875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.44440307617185, "policy_loss": -5703428.7671875, "vf_loss": 20768004.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2093.0, "diff_num_grad_updates_vs_sampler_policy": 2092.0}}, "num_env_steps_sampled": 542640, "num_env_steps_trained": 542640, "num_agent_steps_sampled": 542640, "num_agent_steps_trained": 542640}, "sampler_results": {"episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.0053102770553, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343997829700711, "mean_inference_ms": 0.23450473421530055, "mean_action_processing_ms": 0.057170215250266915, "mean_env_wait_ms": 0.5834112944867522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002465486526489258, "StateBufferConnector_ms": 0.001726388931274414, "ViewRequirementAgentConnector_ms": 0.04360532760620117}}, "episode_reward_max": -3525.455757119942, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.0053102770553, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.328242824185, -3525.455757119942, -3526.4350486365292, -3526.4816227931015, -3525.4647792996084, -3526.2521359554876, -3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.343997829700711, "mean_inference_ms": 0.23450473421530055, "mean_action_processing_ms": 0.057170215250266915, "mean_env_wait_ms": 0.5834112944867522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002465486526489258, "StateBufferConnector_ms": 0.001726388931274414, "ViewRequirementAgentConnector_ms": 0.04360532760620117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 542640, "num_agent_steps_trained": 542640, "num_env_steps_sampled": 542640, "num_env_steps_trained": 542640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.32436748798864, "num_env_steps_trained_throughput_per_sec": 190.32436748798864, "timesteps_total": 542640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 542640, "timers": {"training_iteration_time_ms": 1893.567, "sample_time_ms": 1886.489, "load_time_ms": 0.23, "load_throughput": 1563094.658, "learn_time_ms": 6.311, "learn_throughput": 57046.173, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 542640, "num_env_steps_trained": 542640, "num_agent_steps_sampled": 542640, "num_agent_steps_trained": 542640}, "done": false, "episodes_total": 1988, "training_iteration": 375, "trial_id": "6192e_00000", "date": "2023-08-04_11-02-21", "timestamp": 1691136141, "time_this_iter_s": 11.351213932037354, "time_total_s": 4163.253174781799, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 792.7941510677338, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 24.2375, "ram_util_percent": 65.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1682434082031, "policy_loss": -2585013.409375, "vf_loss": 20729236.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2123.0, "diff_num_grad_updates_vs_sampler_policy": 2122.0}}, "num_env_steps_sampled": 544800, "num_env_steps_trained": 544800, "num_agent_steps_sampled": 544800, "num_agent_steps_trained": 544800}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.060463907233, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344113724505564, "mean_inference_ms": 0.23450730671802777, "mean_action_processing_ms": 0.05717099216768215, "mean_env_wait_ms": 0.5832009002974424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024726390838623047, "StateBufferConnector_ms": 0.0017273426055908203, "ViewRequirementAgentConnector_ms": 0.04368734359741211}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.060463907233, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.883845548421, -3527.3467292544624, -3526.2345434635545, -3528.6053938014934, -3525.6687191995284, -3526.7060374898383, -3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344113724505564, "mean_inference_ms": 0.23450730671802777, "mean_action_processing_ms": 0.05717099216768215, "mean_env_wait_ms": 0.5832009002974424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024726390838623047, "StateBufferConnector_ms": 0.0017273426055908203, "ViewRequirementAgentConnector_ms": 0.04368734359741211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544800, "num_agent_steps_trained": 544800, "num_env_steps_sampled": 544800, "num_env_steps_trained": 544800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.26067993001615, "num_env_steps_trained_throughput_per_sec": 190.26067993001615, "timesteps_total": 544800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 544800, "timers": {"training_iteration_time_ms": 1889.5, "sample_time_ms": 1882.347, "load_time_ms": 0.233, "load_throughput": 1548348.482, "learn_time_ms": 6.364, "learn_throughput": 56568.092, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 544800, "num_env_steps_trained": 544800, "num_agent_steps_sampled": 544800, "num_agent_steps_trained": 544800}, "done": false, "episodes_total": 1994, "training_iteration": 376, "trial_id": "6192e_00000", "date": "2023-08-04_11-02-32", "timestamp": 1691136152, "time_this_iter_s": 11.355133771896362, "time_total_s": 4174.608308553696, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 804.1492848396301, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 20.335294117647063, "ram_util_percent": 65.69411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.37200317382815, "policy_loss": -6601567.6203125, "vf_loss": 20751911.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2153.0, "diff_num_grad_updates_vs_sampler_policy": 2152.0}}, "num_env_steps_sampled": 546960, "num_env_steps_trained": 546960, "num_agent_steps_sampled": 546960, "num_agent_steps_trained": 546960}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.0732859859872, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344230521857003, "mean_inference_ms": 0.23450997428227133, "mean_action_processing_ms": 0.05717182120613628, "mean_env_wait_ms": 0.5829995458946988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024766921997070312, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.04366922378540039}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.0732859859872, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.4902824878004, -3526.5041909739934, -3526.444159096909, -3526.903513962212, -3525.586800673, -3526.461562068886, -3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344230521857003, "mean_inference_ms": 0.23450997428227133, "mean_action_processing_ms": 0.05717182120613628, "mean_env_wait_ms": 0.5829995458946988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024766921997070312, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.04366922378540039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 546960, "num_agent_steps_trained": 546960, "num_env_steps_sampled": 546960, "num_env_steps_trained": 546960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.2954721793092, "num_env_steps_trained_throughput_per_sec": 190.2954721793092, "timesteps_total": 546960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 546960, "timers": {"training_iteration_time_ms": 1892.318, "sample_time_ms": 1885.24, "load_time_ms": 0.217, "load_throughput": 1655283.315, "learn_time_ms": 6.309, "learn_throughput": 57061.479, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 546960, "num_env_steps_trained": 546960, "num_agent_steps_sampled": 546960, "num_agent_steps_trained": 546960}, "done": false, "episodes_total": 2000, "training_iteration": 377, "trial_id": "6192e_00000", "date": "2023-08-04_11-02-43", "timestamp": 1691136163, "time_this_iter_s": 11.352871894836426, "time_total_s": 4185.961180448532, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 815.5021567344666, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 18.64375, "ram_util_percent": 65.68125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1534057617188, "policy_loss": -373156.596875, "vf_loss": 20734749.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2183.0, "diff_num_grad_updates_vs_sampler_policy": 2182.0}}, "num_env_steps_sampled": 549120, "num_env_steps_trained": 549120, "num_agent_steps_sampled": 549120, "num_agent_steps_trained": 549120}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.0912674087767, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344343191063209, "mean_inference_ms": 0.23451474570752434, "mean_action_processing_ms": 0.057172948923866526, "mean_env_wait_ms": 0.5828175807306952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024826526641845703, "StateBufferConnector_ms": 0.0017390251159667969, "ViewRequirementAgentConnector_ms": 0.0437166690826416}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.0912674087767, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.8690161132895, -3528.6670716527337, -3526.7309189434836, -3527.9261803847935, -3526.0711209563415, -3526.212173639154, -3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344343191063209, "mean_inference_ms": 0.23451474570752434, "mean_action_processing_ms": 0.057172948923866526, "mean_env_wait_ms": 0.5828175807306952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024826526641845703, "StateBufferConnector_ms": 0.0017390251159667969, "ViewRequirementAgentConnector_ms": 0.0437166690826416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 549120, "num_agent_steps_trained": 549120, "num_env_steps_sampled": 549120, "num_env_steps_trained": 549120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.6542701326024, "num_env_steps_trained_throughput_per_sec": 190.6542701326024, "timesteps_total": 549120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 549120, "timers": {"training_iteration_time_ms": 1889.633, "sample_time_ms": 1882.614, "load_time_ms": 0.215, "load_throughput": 1672332.972, "learn_time_ms": 6.278, "learn_throughput": 57344.933, "synch_weights_time_ms": 0.495}, "counters": {"num_env_steps_sampled": 549120, "num_env_steps_trained": 549120, "num_agent_steps_sampled": 549120, "num_agent_steps_trained": 549120}, "done": false, "episodes_total": 2006, "training_iteration": 378, "trial_id": "6192e_00000", "date": "2023-08-04_11-02-55", "timestamp": 1691136175, "time_this_iter_s": 11.331395149230957, "time_total_s": 4197.292575597763, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 826.8335518836975, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 18.5625, "ram_util_percent": 65.82499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.188525390625, "policy_loss": -3506297.41875, "vf_loss": 20745179.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2213.0, "diff_num_grad_updates_vs_sampler_policy": 2212.0}}, "num_env_steps_sampled": 551280, "num_env_steps_trained": 551280, "num_agent_steps_sampled": 551280, "num_agent_steps_trained": 551280}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.160951735841, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344447393959942, "mean_inference_ms": 0.23451997936366278, "mean_action_processing_ms": 0.05717421495409218, "mean_env_wait_ms": 0.5826466565818259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002489805221557617, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.04377269744873047}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.160951735841, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.0113326839282, -3526.873720844708, -3526.8852983263114, -3526.1924116442906, -3526.3602101503525, -3526.6605799857916, -3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344447393959942, "mean_inference_ms": 0.23451997936366278, "mean_action_processing_ms": 0.05717421495409218, "mean_env_wait_ms": 0.5826466565818259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002489805221557617, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.04377269744873047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 551280, "num_agent_steps_trained": 551280, "num_env_steps_sampled": 551280, "num_env_steps_trained": 551280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.7403379362455, "num_env_steps_trained_throughput_per_sec": 190.7403379362455, "timesteps_total": 551280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 551280, "timers": {"training_iteration_time_ms": 1886.142, "sample_time_ms": 1879.089, "load_time_ms": 0.216, "load_throughput": 1667162.902, "learn_time_ms": 6.301, "learn_throughput": 57132.512, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 551280, "num_env_steps_trained": 551280, "num_agent_steps_sampled": 551280, "num_agent_steps_trained": 551280}, "done": false, "episodes_total": 2012, "training_iteration": 379, "trial_id": "6192e_00000", "date": "2023-08-04_11-03-06", "timestamp": 1691136186, "time_this_iter_s": 11.32640790939331, "time_total_s": 4208.618983507156, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 838.1599597930908, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 20.237499999999997, "ram_util_percent": 65.73750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.39454345703126, "policy_loss": -3421454.18125, "vf_loss": 20756640.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2243.0, "diff_num_grad_updates_vs_sampler_policy": 2242.0}}, "num_env_steps_sampled": 553440, "num_env_steps_trained": 553440, "num_agent_steps_sampled": 553440, "num_agent_steps_trained": 553440}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.210901674522, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344537093563319, "mean_inference_ms": 0.23452493113103606, "mean_action_processing_ms": 0.057175527422220006, "mean_env_wait_ms": 0.5824935001263692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025005340576171875, "StateBufferConnector_ms": 0.0017366409301757812, "ViewRequirementAgentConnector_ms": 0.04384469985961914}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.210901674522, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.2343999307577, -3525.7670958571443, -3527.1162889771526, -3526.92113187272, -3526.2320309487286, -3526.628271680084, -3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344537093563319, "mean_inference_ms": 0.23452493113103606, "mean_action_processing_ms": 0.057175527422220006, "mean_env_wait_ms": 0.5824935001263692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025005340576171875, "StateBufferConnector_ms": 0.0017366409301757812, "ViewRequirementAgentConnector_ms": 0.04384469985961914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 553440, "num_agent_steps_trained": 553440, "num_env_steps_sampled": 553440, "num_env_steps_trained": 553440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.48882751924864, "num_env_steps_trained_throughput_per_sec": 190.48882751924864, "timesteps_total": 553440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 553440, "timers": {"training_iteration_time_ms": 1889.104, "sample_time_ms": 1882.017, "load_time_ms": 0.216, "load_throughput": 1662939.912, "learn_time_ms": 6.314, "learn_throughput": 57012.571, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 553440, "num_env_steps_trained": 553440, "num_agent_steps_sampled": 553440, "num_agent_steps_trained": 553440}, "done": false, "episodes_total": 2018, "training_iteration": 380, "trial_id": "6192e_00000", "date": "2023-08-04_11-03-17", "timestamp": 1691136197, "time_this_iter_s": 11.341381788253784, "time_total_s": 4219.96036529541, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 849.5013415813446, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 19.581249999999997, "ram_util_percent": 65.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1508850097656, "policy_loss": -875649.25625, "vf_loss": 20738234.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2273.0, "diff_num_grad_updates_vs_sampler_policy": 2272.0}}, "num_env_steps_sampled": 555600, "num_env_steps_trained": 555600, "num_agent_steps_sampled": 555600, "num_agent_steps_trained": 555600}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.2338008334914, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344624016162742, "mean_inference_ms": 0.23452845055536853, "mean_action_processing_ms": 0.05717654938946393, "mean_env_wait_ms": 0.5823397309048315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024933815002441406, "StateBufferConnector_ms": 0.001737356185913086, "ViewRequirementAgentConnector_ms": 0.04376673698425293}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.2338008334914, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.0284578077008, -3527.6678744022734, -3527.5668281417024, -3527.134570614039, -3527.890100135797, -3527.015205612843, -3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344624016162742, "mean_inference_ms": 0.23452845055536853, "mean_action_processing_ms": 0.05717654938946393, "mean_env_wait_ms": 0.5823397309048315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024933815002441406, "StateBufferConnector_ms": 0.001737356185913086, "ViewRequirementAgentConnector_ms": 0.04376673698425293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 555600, "num_agent_steps_trained": 555600, "num_env_steps_sampled": 555600, "num_env_steps_trained": 555600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.8853982613761, "num_env_steps_trained_throughput_per_sec": 190.8853982613761, "timesteps_total": 555600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 555600, "timers": {"training_iteration_time_ms": 1887.146, "sample_time_ms": 1880.038, "load_time_ms": 0.22, "load_throughput": 1633790.781, "learn_time_ms": 6.344, "learn_throughput": 56744.751, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 555600, "num_env_steps_trained": 555600, "num_agent_steps_sampled": 555600, "num_agent_steps_trained": 555600}, "done": false, "episodes_total": 2024, "training_iteration": 381, "trial_id": "6192e_00000", "date": "2023-08-04_11-03-29", "timestamp": 1691136209, "time_this_iter_s": 11.317734956741333, "time_total_s": 4231.2781002521515, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 860.8190765380859, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 20.55625, "ram_util_percent": 65.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.21763916015624, "policy_loss": -2282735.296875, "vf_loss": 20732895.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2303.0, "diff_num_grad_updates_vs_sampler_policy": 2302.0}}, "num_env_steps_sampled": 557760, "num_env_steps_trained": 557760, "num_agent_steps_sampled": 557760, "num_agent_steps_trained": 557760}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.2275204946695, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3447161013864966, "mean_inference_ms": 0.23453294117364973, "mean_action_processing_ms": 0.05717771423711232, "mean_env_wait_ms": 0.5821994355192444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002494335174560547, "StateBufferConnector_ms": 0.0017497539520263672, "ViewRequirementAgentConnector_ms": 0.043819427490234375}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.2275204946695, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.3591273189236, -3526.9680838881745, -3526.5920659328926, -3526.8956441055575, -3526.659685833519, -3528.1360295747586, -3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3447161013864966, "mean_inference_ms": 0.23453294117364973, "mean_action_processing_ms": 0.05717771423711232, "mean_env_wait_ms": 0.5821994355192444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002494335174560547, "StateBufferConnector_ms": 0.0017497539520263672, "ViewRequirementAgentConnector_ms": 0.043819427490234375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 557760, "num_agent_steps_trained": 557760, "num_env_steps_sampled": 557760, "num_env_steps_trained": 557760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.15032096077232, "num_env_steps_trained_throughput_per_sec": 190.15032096077232, "timesteps_total": 557760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 557760, "timers": {"training_iteration_time_ms": 1890.805, "sample_time_ms": 1883.743, "load_time_ms": 0.218, "load_throughput": 1650939.689, "learn_time_ms": 6.288, "learn_throughput": 57254.261, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 557760, "num_env_steps_trained": 557760, "num_agent_steps_sampled": 557760, "num_agent_steps_trained": 557760}, "done": false, "episodes_total": 2030, "training_iteration": 382, "trial_id": "6192e_00000", "date": "2023-08-04_11-03-40", "timestamp": 1691136220, "time_this_iter_s": 11.361630916595459, "time_total_s": 4242.639731168747, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 872.1807074546814, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 19.900000000000002, "ram_util_percent": 65.41875000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2547302246094, "policy_loss": -1687752.4875, "vf_loss": 20735348.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2333.0, "diff_num_grad_updates_vs_sampler_policy": 2332.0}}, "num_env_steps_sampled": 559920, "num_env_steps_trained": 559920, "num_agent_steps_sampled": 559920, "num_agent_steps_trained": 559920}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.200256707476, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344813851608684, "mean_inference_ms": 0.2345351873313293, "mean_action_processing_ms": 0.05717856093122709, "mean_env_wait_ms": 0.5820587601350516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024900436401367188, "StateBufferConnector_ms": 0.0017473697662353516, "ViewRequirementAgentConnector_ms": 0.04378104209899902}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.673986834873, "episode_reward_mean": -3527.200256707476, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3533.673986834873, -3527.9188128349856, -3527.0611154251237, -3527.229912870194, -3525.961274419047, -3526.549104937588, -3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.344813851608684, "mean_inference_ms": 0.2345351873313293, "mean_action_processing_ms": 0.05717856093122709, "mean_env_wait_ms": 0.5820587601350516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024900436401367188, "StateBufferConnector_ms": 0.0017473697662353516, "ViewRequirementAgentConnector_ms": 0.04378104209899902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 559920, "num_agent_steps_trained": 559920, "num_env_steps_sampled": 559920, "num_env_steps_trained": 559920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.4142916890269, "num_env_steps_trained_throughput_per_sec": 190.4142916890269, "timesteps_total": 559920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 559920, "timers": {"training_iteration_time_ms": 1890.777, "sample_time_ms": 1883.781, "load_time_ms": 0.214, "load_throughput": 1684647.373, "learn_time_ms": 6.221, "learn_throughput": 57869.098, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 559920, "num_env_steps_trained": 559920, "num_agent_steps_sampled": 559920, "num_agent_steps_trained": 559920}, "done": false, "episodes_total": 2036, "training_iteration": 383, "trial_id": "6192e_00000", "date": "2023-08-04_11-03-52", "timestamp": 1691136232, "time_this_iter_s": 11.345870971679688, "time_total_s": 4253.985602140427, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 883.5265784263611, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 17.85, "ram_util_percent": 65.48750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.47223510742185, "policy_loss": -11357953.64375, "vf_loss": 20759596.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 2362.0}}, "num_env_steps_sampled": 562080, "num_env_steps_trained": 562080, "num_agent_steps_sampled": 562080, "num_agent_steps_trained": 562080}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1456921803856, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34491818046429, "mean_inference_ms": 0.23453719126222972, "mean_action_processing_ms": 0.05717943946919549, "mean_env_wait_ms": 0.581922106222314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024764537811279297, "StateBufferConnector_ms": 0.0017518997192382812, "ViewRequirementAgentConnector_ms": 0.04374241828918457}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1456921803856, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.14928049751, -3526.513148714797, -3528.3368444221232, -3526.742281369815, -3530.0017258086036, -3527.3553996776373, -3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34491818046429, "mean_inference_ms": 0.23453719126222972, "mean_action_processing_ms": 0.05717943946919549, "mean_env_wait_ms": 0.581922106222314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024764537811279297, "StateBufferConnector_ms": 0.0017518997192382812, "ViewRequirementAgentConnector_ms": 0.04374241828918457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 562080, "num_agent_steps_trained": 562080, "num_env_steps_sampled": 562080, "num_env_steps_trained": 562080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.28119167061348, "num_env_steps_trained_throughput_per_sec": 190.28119167061348, "timesteps_total": 562080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 562080, "timers": {"training_iteration_time_ms": 1891.927, "sample_time_ms": 1884.882, "load_time_ms": 0.215, "load_throughput": 1675487.617, "learn_time_ms": 6.272, "learn_throughput": 57396.377, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 562080, "num_env_steps_trained": 562080, "num_agent_steps_sampled": 562080, "num_agent_steps_trained": 562080}, "done": false, "episodes_total": 2042, "training_iteration": 384, "trial_id": "6192e_00000", "date": "2023-08-04_11-04-03", "timestamp": 1691136243, "time_this_iter_s": 11.353734970092773, "time_total_s": 4265.339337110519, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 894.8803133964539, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 18.55625, "ram_util_percent": 65.53125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.379443359375, "policy_loss": -11498251.95625, "vf_loss": 20764445.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2393.0, "diff_num_grad_updates_vs_sampler_policy": 2392.0}}, "num_env_steps_sampled": 564240, "num_env_steps_trained": 564240, "num_agent_steps_sampled": 564240, "num_agent_steps_trained": 564240}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.116739778453, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3450323537802475, "mean_inference_ms": 0.23453949258363052, "mean_action_processing_ms": 0.05718049736846874, "mean_env_wait_ms": 0.5817861725632474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024747848510742188, "StateBufferConnector_ms": 0.0017538070678710938, "ViewRequirementAgentConnector_ms": 0.043740034103393555}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.116739778453, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.2629133910814, -3526.6405366070358, -3526.757351977615, -3525.926305035284, -3528.700171564422, -3525.9774560695087, -3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3450323537802475, "mean_inference_ms": 0.23453949258363052, "mean_action_processing_ms": 0.05718049736846874, "mean_env_wait_ms": 0.5817861725632474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024747848510742188, "StateBufferConnector_ms": 0.0017538070678710938, "ViewRequirementAgentConnector_ms": 0.043740034103393555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564240, "num_agent_steps_trained": 564240, "num_env_steps_sampled": 564240, "num_env_steps_trained": 564240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.56310907434067, "num_env_steps_trained_throughput_per_sec": 190.56310907434067, "timesteps_total": 564240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 564240, "timers": {"training_iteration_time_ms": 1891.721, "sample_time_ms": 1884.744, "load_time_ms": 0.214, "load_throughput": 1681458.174, "learn_time_ms": 6.227, "learn_throughput": 57814.59, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 564240, "num_env_steps_trained": 564240, "num_agent_steps_sampled": 564240, "num_agent_steps_trained": 564240}, "done": false, "episodes_total": 2048, "training_iteration": 385, "trial_id": "6192e_00000", "date": "2023-08-04_11-04-14", "timestamp": 1691136254, "time_this_iter_s": 11.336990356445312, "time_total_s": 4276.676327466965, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 906.2173037528992, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 22.9125, "ram_util_percent": 65.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2253723144531, "policy_loss": -1592541.040625, "vf_loss": 20746360.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2423.0, "diff_num_grad_updates_vs_sampler_policy": 2422.0}}, "num_env_steps_sampled": 566400, "num_env_steps_trained": 566400, "num_agent_steps_sampled": 566400, "num_agent_steps_trained": 566400}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.109958520564, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345157797843088, "mean_inference_ms": 0.23454284489478516, "mean_action_processing_ms": 0.057181798373770104, "mean_env_wait_ms": 0.5816540146357079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002476215362548828, "StateBufferConnector_ms": 0.0017609596252441406, "ViewRequirementAgentConnector_ms": 0.04373478889465332}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.109958520564, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.2552154103655, -3526.3188320046493, -3527.425441039949, -3527.643008533371, -3526.7456193614285, -3526.8028402699324, -3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345157797843088, "mean_inference_ms": 0.23454284489478516, "mean_action_processing_ms": 0.057181798373770104, "mean_env_wait_ms": 0.5816540146357079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002476215362548828, "StateBufferConnector_ms": 0.0017609596252441406, "ViewRequirementAgentConnector_ms": 0.04373478889465332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 566400, "num_agent_steps_trained": 566400, "num_env_steps_sampled": 566400, "num_env_steps_trained": 566400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.72392422775852, "num_env_steps_trained_throughput_per_sec": 189.72392422775852, "timesteps_total": 566400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 566400, "timers": {"training_iteration_time_ms": 1893.499, "sample_time_ms": 1886.507, "load_time_ms": 0.214, "load_throughput": 1682020.096, "learn_time_ms": 6.245, "learn_throughput": 57647.28, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 566400, "num_env_steps_trained": 566400, "num_agent_steps_sampled": 566400, "num_agent_steps_trained": 566400}, "done": false, "episodes_total": 2054, "training_iteration": 386, "trial_id": "6192e_00000", "date": "2023-08-04_11-04-26", "timestamp": 1691136266, "time_this_iter_s": 11.386940002441406, "time_total_s": 4288.063267469406, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 917.6042437553406, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 21.30625, "ram_util_percent": 65.6375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3287292480469, "policy_loss": -771196.190625, "vf_loss": 20733713.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2453.0, "diff_num_grad_updates_vs_sampler_policy": 2452.0}}, "num_env_steps_sampled": 568560, "num_env_steps_trained": 568560, "num_agent_steps_sampled": 568560, "num_agent_steps_trained": 568560}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1164141976, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345272559120201, "mean_inference_ms": 0.23454609149365951, "mean_action_processing_ms": 0.057183087269035704, "mean_env_wait_ms": 0.5815307943149343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002488851547241211, "StateBufferConnector_ms": 0.0017528533935546875, "ViewRequirementAgentConnector_ms": 0.043733835220336914}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1164141976, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.6778317795997, -3526.158757796181, -3527.448940310216, -3526.4762238219705, -3526.497242661845, -3526.8457526958987, -3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345272559120201, "mean_inference_ms": 0.23454609149365951, "mean_action_processing_ms": 0.057183087269035704, "mean_env_wait_ms": 0.5815307943149343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002488851547241211, "StateBufferConnector_ms": 0.0017528533935546875, "ViewRequirementAgentConnector_ms": 0.043733835220336914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568560, "num_agent_steps_trained": 568560, "num_env_steps_sampled": 568560, "num_env_steps_trained": 568560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.3368429947257, "num_env_steps_trained_throughput_per_sec": 190.3368429947257, "timesteps_total": 568560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 568560, "timers": {"training_iteration_time_ms": 1895.039, "sample_time_ms": 1888.011, "load_time_ms": 0.215, "load_throughput": 1676790.05, "learn_time_ms": 6.267, "learn_throughput": 57447.038, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 568560, "num_env_steps_trained": 568560, "num_agent_steps_sampled": 568560, "num_agent_steps_trained": 568560}, "done": false, "episodes_total": 2060, "training_iteration": 387, "trial_id": "6192e_00000", "date": "2023-08-04_11-04-37", "timestamp": 1691136277, "time_this_iter_s": 11.350482940673828, "time_total_s": 4299.41375041008, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 928.9547266960144, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 19.756249999999998, "ram_util_percent": 65.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2233459472656, "policy_loss": -4478550.025, "vf_loss": 20740594.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2483.0, "diff_num_grad_updates_vs_sampler_policy": 2482.0}}, "num_env_steps_sampled": 570720, "num_env_steps_trained": 570720, "num_agent_steps_sampled": 570720, "num_agent_steps_trained": 570720}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1336384116626, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34538016002547, "mean_inference_ms": 0.23454841438826612, "mean_action_processing_ms": 0.05718417676463417, "mean_env_wait_ms": 0.5814028922523675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024836063385009766, "StateBufferConnector_ms": 0.001753091812133789, "ViewRequirementAgentConnector_ms": 0.04365682601928711}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1336384116626, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.6026683432256, -3528.317516991322, -3527.2847891064444, -3527.40367984027, -3527.3693829105064, -3526.7535318438117, -3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34538016002547, "mean_inference_ms": 0.23454841438826612, "mean_action_processing_ms": 0.05718417676463417, "mean_env_wait_ms": 0.5814028922523675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024836063385009766, "StateBufferConnector_ms": 0.001753091812133789, "ViewRequirementAgentConnector_ms": 0.04365682601928711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 570720, "num_agent_steps_trained": 570720, "num_env_steps_sampled": 570720, "num_env_steps_trained": 570720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.7659902627757, "num_env_steps_trained_throughput_per_sec": 190.7659902627757, "timesteps_total": 570720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 570720, "timers": {"training_iteration_time_ms": 1889.96, "sample_time_ms": 1882.98, "load_time_ms": 0.217, "load_throughput": 1658009.707, "learn_time_ms": 6.234, "learn_throughput": 57751.128, "synch_weights_time_ms": 0.498}, "counters": {"num_env_steps_sampled": 570720, "num_env_steps_trained": 570720, "num_agent_steps_sampled": 570720, "num_agent_steps_trained": 570720}, "done": false, "episodes_total": 2066, "training_iteration": 388, "trial_id": "6192e_00000", "date": "2023-08-04_11-04-48", "timestamp": 1691136288, "time_this_iter_s": 11.324985027313232, "time_total_s": 4310.738735437393, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 940.2797117233276, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 17.464705882352945, "ram_util_percent": 65.72941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.34600219726565, "policy_loss": -7145142.68125, "vf_loss": 20742669.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2513.0, "diff_num_grad_updates_vs_sampler_policy": 2512.0}}, "num_env_steps_sampled": 572880, "num_env_steps_trained": 572880, "num_agent_steps_sampled": 572880, "num_agent_steps_trained": 572880}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.161415210758, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345486195507908, "mean_inference_ms": 0.23455041769931093, "mean_action_processing_ms": 0.0571852361463146, "mean_env_wait_ms": 0.5812769766428603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024971961975097656, "StateBufferConnector_ms": 0.001741170883178711, "ViewRequirementAgentConnector_ms": 0.04372215270996094}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.161415210758, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3228646992957, -3527.2422827243317, -3525.873237402279, -3527.9292998230653, -3528.075378797136, -3527.356257336915, -3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345486195507908, "mean_inference_ms": 0.23455041769931093, "mean_action_processing_ms": 0.0571852361463146, "mean_env_wait_ms": 0.5812769766428603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024971961975097656, "StateBufferConnector_ms": 0.001741170883178711, "ViewRequirementAgentConnector_ms": 0.04372215270996094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572880, "num_agent_steps_trained": 572880, "num_env_steps_sampled": 572880, "num_env_steps_trained": 572880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.4095653535463, "num_env_steps_trained_throughput_per_sec": 190.4095653535463, "timesteps_total": 572880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 572880, "timers": {"training_iteration_time_ms": 1890.697, "sample_time_ms": 1883.616, "load_time_ms": 0.22, "load_throughput": 1637156.5, "learn_time_ms": 6.301, "learn_throughput": 57129.269, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 572880, "num_env_steps_trained": 572880, "num_agent_steps_sampled": 572880, "num_agent_steps_trained": 572880}, "done": false, "episodes_total": 2072, "training_iteration": 389, "trial_id": "6192e_00000", "date": "2023-08-04_11-05-00", "timestamp": 1691136300, "time_this_iter_s": 11.34618616104126, "time_total_s": 4322.084921598434, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 951.6258978843689, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 20.01875, "ram_util_percent": 65.75625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.33887939453126, "policy_loss": -5013290.559375, "vf_loss": 20745632.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2543.0, "diff_num_grad_updates_vs_sampler_policy": 2542.0}}, "num_env_steps_sampled": 575040, "num_env_steps_trained": 575040, "num_agent_steps_sampled": 575040, "num_agent_steps_trained": 575040}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1509926004087, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345596620821657, "mean_inference_ms": 0.2345531379909663, "mean_action_processing_ms": 0.05718652481089219, "mean_env_wait_ms": 0.5811493318022162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025022029876708984, "StateBufferConnector_ms": 0.001739501953125, "ViewRequirementAgentConnector_ms": 0.04378318786621094}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1509926004087, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.169581831749, -3526.587575327551, -3526.3604029007424, -3526.839940457531, -3529.0860793697357, -3526.831508794106, -3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345596620821657, "mean_inference_ms": 0.2345531379909663, "mean_action_processing_ms": 0.05718652481089219, "mean_env_wait_ms": 0.5811493318022162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025022029876708984, "StateBufferConnector_ms": 0.001739501953125, "ViewRequirementAgentConnector_ms": 0.04378318786621094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 575040, "num_agent_steps_trained": 575040, "num_env_steps_sampled": 575040, "num_env_steps_trained": 575040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.84768383309023, "num_env_steps_trained_throughput_per_sec": 189.84768383309023, "timesteps_total": 575040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 575040, "timers": {"training_iteration_time_ms": 1893.902, "sample_time_ms": 1886.783, "load_time_ms": 0.227, "load_throughput": 1583752.297, "learn_time_ms": 6.327, "learn_throughput": 56899.779, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 575040, "num_env_steps_trained": 575040, "num_agent_steps_sampled": 575040, "num_agent_steps_trained": 575040}, "done": false, "episodes_total": 2078, "training_iteration": 390, "trial_id": "6192e_00000", "date": "2023-08-04_11-05-11", "timestamp": 1691136311, "time_this_iter_s": 11.379514217376709, "time_total_s": 4333.464435815811, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 963.0054121017456, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 24.34375, "ram_util_percent": 65.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.32964477539065, "policy_loss": -5568647.134375, "vf_loss": 20755527.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2573.0, "diff_num_grad_updates_vs_sampler_policy": 2572.0}}, "num_env_steps_sampled": 577200, "num_env_steps_trained": 577200, "num_agent_steps_sampled": 577200, "num_agent_steps_trained": 577200}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1474576422333, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345698386443651, "mean_inference_ms": 0.23455560824238064, "mean_action_processing_ms": 0.057187811180539436, "mean_env_wait_ms": 0.5810239764995739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513885498046875, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.04368782043457031}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1474576422333, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.1714866298844, -3526.8485021690003, -3525.7837808702675, -3528.74165878481, -3526.9286008033473, -3526.7341476348756, -3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345698386443651, "mean_inference_ms": 0.23455560824238064, "mean_action_processing_ms": 0.057187811180539436, "mean_env_wait_ms": 0.5810239764995739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513885498046875, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.04368782043457031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 577200, "num_agent_steps_trained": 577200, "num_env_steps_sampled": 577200, "num_env_steps_trained": 577200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.0726641075931, "num_env_steps_trained_throughput_per_sec": 190.0726641075931, "timesteps_total": 577200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 577200, "timers": {"training_iteration_time_ms": 1895.121, "sample_time_ms": 1888.218, "load_time_ms": 0.217, "load_throughput": 1660745.095, "learn_time_ms": 6.152, "learn_throughput": 58515.873, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 577200, "num_env_steps_trained": 577200, "num_agent_steps_sampled": 577200, "num_agent_steps_trained": 577200}, "done": false, "episodes_total": 2084, "training_iteration": 391, "trial_id": "6192e_00000", "date": "2023-08-04_11-05-23", "timestamp": 1691136323, "time_this_iter_s": 11.366156101226807, "time_total_s": 4344.830591917038, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 974.3715682029724, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 19.225, "ram_util_percent": 65.54374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2561401367187, "policy_loss": -1607903.00625, "vf_loss": 20741754.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2603.0, "diff_num_grad_updates_vs_sampler_policy": 2602.0}}, "num_env_steps_sampled": 579360, "num_env_steps_trained": 579360, "num_agent_steps_sampled": 579360, "num_agent_steps_trained": 579360}, "sampler_results": {"episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1613046174525, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345803648720697, "mean_inference_ms": 0.23455616053985903, "mean_action_processing_ms": 0.05718870093238508, "mean_env_wait_ms": 0.5809013240622957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025212764739990234, "StateBufferConnector_ms": 0.0017285346984863281, "ViewRequirementAgentConnector_ms": 0.04365372657775879}}, "episode_reward_max": -3525.5867577936974, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1613046174525, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.5867577936974, -3530.338110369239, -3526.461514464645, -3525.8838185809072, -3527.8831091734555, -3526.897847808125, -3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345803648720697, "mean_inference_ms": 0.23455616053985903, "mean_action_processing_ms": 0.05718870093238508, "mean_env_wait_ms": 0.5809013240622957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025212764739990234, "StateBufferConnector_ms": 0.0017285346984863281, "ViewRequirementAgentConnector_ms": 0.04365372657775879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 579360, "num_agent_steps_trained": 579360, "num_env_steps_sampled": 579360, "num_env_steps_trained": 579360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.1235252499421, "num_env_steps_trained_throughput_per_sec": 190.1235252499421, "timesteps_total": 579360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 579360, "timers": {"training_iteration_time_ms": 1895.756, "sample_time_ms": 1888.819, "load_time_ms": 0.218, "load_throughput": 1648056.582, "learn_time_ms": 6.187, "learn_throughput": 58185.755, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 579360, "num_env_steps_trained": 579360, "num_agent_steps_sampled": 579360, "num_agent_steps_trained": 579360}, "done": false, "episodes_total": 2090, "training_iteration": 392, "trial_id": "6192e_00000", "date": "2023-08-04_11-05-34", "timestamp": 1691136334, "time_this_iter_s": 11.363272190093994, "time_total_s": 4356.193864107132, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 985.7348403930664, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 19.950000000000003, "ram_util_percent": 65.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3808654785156, "policy_loss": -7542130.0875, "vf_loss": 20752836.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2633.0, "diff_num_grad_updates_vs_sampler_policy": 2632.0}}, "num_env_steps_sampled": 581520, "num_env_steps_trained": 581520, "num_agent_steps_sampled": 581520, "num_agent_steps_trained": 581520}, "sampler_results": {"episode_reward_max": -3525.586761561823, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.168448250732, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345898886800197, "mean_inference_ms": 0.23455665626845534, "mean_action_processing_ms": 0.05718953255775129, "mean_env_wait_ms": 0.5807887142411038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025196075439453125, "StateBufferConnector_ms": 0.0017185211181640625, "ViewRequirementAgentConnector_ms": 0.0435788631439209}}, "episode_reward_max": -3525.586761561823, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.168448250732, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.805529318352, -3525.8825692090636, -3528.041071532647, -3527.2173495909447, -3527.2764539821264, -3528.0208836282045, -3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345898886800197, "mean_inference_ms": 0.23455665626845534, "mean_action_processing_ms": 0.05718953255775129, "mean_env_wait_ms": 0.5807887142411038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025196075439453125, "StateBufferConnector_ms": 0.0017185211181640625, "ViewRequirementAgentConnector_ms": 0.0435788631439209}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 581520, "num_agent_steps_trained": 581520, "num_env_steps_sampled": 581520, "num_env_steps_trained": 581520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.29780250770492, "num_env_steps_trained_throughput_per_sec": 190.29780250770492, "timesteps_total": 581520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 581520, "timers": {"training_iteration_time_ms": 1892.08, "sample_time_ms": 1885.121, "load_time_ms": 0.216, "load_throughput": 1662939.912, "learn_time_ms": 6.222, "learn_throughput": 57859.563, "synch_weights_time_ms": 0.488}, "counters": {"num_env_steps_sampled": 581520, "num_env_steps_trained": 581520, "num_agent_steps_sampled": 581520, "num_agent_steps_trained": 581520}, "done": false, "episodes_total": 2096, "training_iteration": 393, "trial_id": "6192e_00000", "date": "2023-08-04_11-05-45", "timestamp": 1691136345, "time_this_iter_s": 11.352699995040894, "time_total_s": 4367.546564102173, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 997.0875403881073, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 19.450000000000003, "ram_util_percent": 65.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3901062011719, "policy_loss": -2106463.63125, "vf_loss": 20748396.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2663.0, "diff_num_grad_updates_vs_sampler_policy": 2662.0}}, "num_env_steps_sampled": 583680, "num_env_steps_trained": 583680, "num_agent_steps_sampled": 583680, "num_agent_steps_trained": 583680}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1623586482006, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345990137211893, "mean_inference_ms": 0.23455595258212952, "mean_action_processing_ms": 0.05719014200961363, "mean_env_wait_ms": 0.5806843201568163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025289058685302734, "StateBufferConnector_ms": 0.001722097396850586, "ViewRequirementAgentConnector_ms": 0.0435638427734375}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.1623586482006, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.586769633125, -3527.222897931398, -3527.1320748181506, -3525.949571548822, -3527.2609184993744, -3526.019087608161, -3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.345990137211893, "mean_inference_ms": 0.23455595258212952, "mean_action_processing_ms": 0.05719014200961363, "mean_env_wait_ms": 0.5806843201568163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025289058685302734, "StateBufferConnector_ms": 0.001722097396850586, "ViewRequirementAgentConnector_ms": 0.0435638427734375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 583680, "num_agent_steps_trained": 583680, "num_env_steps_sampled": 583680, "num_env_steps_trained": 583680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.29402124895032, "num_env_steps_trained_throughput_per_sec": 190.29402124895032, "timesteps_total": 583680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 583680, "timers": {"training_iteration_time_ms": 1891.599, "sample_time_ms": 1884.618, "load_time_ms": 0.216, "load_throughput": 1667899.525, "learn_time_ms": 6.221, "learn_throughput": 57866.658, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 583680, "num_env_steps_trained": 583680, "num_agent_steps_sampled": 583680, "num_agent_steps_trained": 583680}, "done": false, "episodes_total": 2102, "training_iteration": 394, "trial_id": "6192e_00000", "date": "2023-08-04_11-05-57", "timestamp": 1691136357, "time_this_iter_s": 11.352917909622192, "time_total_s": 4378.899482011795, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1008.4404582977295, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 18.993750000000002, "ram_util_percent": 65.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.22276611328124, "policy_loss": -4840568.621875, "vf_loss": 20748954.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2693.0, "diff_num_grad_updates_vs_sampler_policy": 2692.0}}, "num_env_steps_sampled": 585840, "num_env_steps_trained": 585840, "num_agent_steps_sampled": 585840, "num_agent_steps_trained": 585840}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.20015947918, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3460975454262565, "mean_inference_ms": 0.23455430453970727, "mean_action_processing_ms": 0.05719062676053138, "mean_env_wait_ms": 0.5805788359759855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025224685668945312, "StateBufferConnector_ms": 0.0017244815826416016, "ViewRequirementAgentConnector_ms": 0.043547868728637695}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.377610309874, "episode_reward_mean": -3527.20015947918, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.813483321944, -3528.213907534993, -3533.377610309874, -3526.759907121881, -3525.9054398880585, -3527.691445194916, -3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3460975454262565, "mean_inference_ms": 0.23455430453970727, "mean_action_processing_ms": 0.05719062676053138, "mean_env_wait_ms": 0.5805788359759855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025224685668945312, "StateBufferConnector_ms": 0.0017244815826416016, "ViewRequirementAgentConnector_ms": 0.043547868728637695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 585840, "num_agent_steps_trained": 585840, "num_env_steps_sampled": 585840, "num_env_steps_trained": 585840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.02519008766055, "num_env_steps_trained_throughput_per_sec": 190.02519008766055, "timesteps_total": 585840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 585840, "timers": {"training_iteration_time_ms": 1893.597, "sample_time_ms": 1886.534, "load_time_ms": 0.217, "load_throughput": 1657463.71, "learn_time_ms": 6.287, "learn_throughput": 57263.38, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 585840, "num_env_steps_trained": 585840, "num_agent_steps_sampled": 585840, "num_agent_steps_trained": 585840}, "done": false, "episodes_total": 2108, "training_iteration": 395, "trial_id": "6192e_00000", "date": "2023-08-04_11-06-08", "timestamp": 1691136368, "time_this_iter_s": 11.369188785552979, "time_total_s": 4390.268670797348, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1019.8096470832825, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 26.65625, "ram_util_percent": 65.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1453002929687, "policy_loss": 20227.36875, "vf_loss": 20735520.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2723.0, "diff_num_grad_updates_vs_sampler_policy": 2722.0}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.391579064508, "episode_reward_mean": -3527.1117664810818, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346210275621868, "mean_inference_ms": 0.2345519107176405, "mean_action_processing_ms": 0.057190895134870454, "mean_env_wait_ms": 0.5804710764306753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025358200073242188, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.04352259635925293}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.391579064508, "episode_reward_mean": -3527.1117664810818, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.288692955602, -3525.586763012409, -3528.518201192502, -3527.9880052599938, -3528.16359075288, -3526.159275533913, -3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346210275621868, "mean_inference_ms": 0.2345519107176405, "mean_action_processing_ms": 0.057190895134870454, "mean_env_wait_ms": 0.5804710764306753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025358200073242188, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.04352259635925293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.63177253358256, "num_env_steps_trained_throughput_per_sec": 190.63177253358256, "timesteps_total": 588000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 1888.886, "sample_time_ms": 1881.843, "load_time_ms": 0.216, "load_throughput": 1668268.081, "learn_time_ms": 6.28, "learn_throughput": 57327.081, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2114, "training_iteration": 396, "trial_id": "6192e_00000", "date": "2023-08-04_11-06-19", "timestamp": 1691136379, "time_this_iter_s": 11.33284306526184, "time_total_s": 4401.60151386261, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1031.1424901485443, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 23.106250000000003, "ram_util_percent": 65.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.21465454101565, "policy_loss": -447375.215625, "vf_loss": 20729106.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2753.0, "diff_num_grad_updates_vs_sampler_policy": 2752.0}}, "num_env_steps_sampled": 590160, "num_env_steps_trained": 590160, "num_agent_steps_sampled": 590160, "num_agent_steps_trained": 590160}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.391579064508, "episode_reward_mean": -3527.034670436482, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3463271501239324, "mean_inference_ms": 0.2345490993407412, "mean_action_processing_ms": 0.05719105899043285, "mean_env_wait_ms": 0.5803561345117556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025339126586914062, "StateBufferConnector_ms": 0.0017261505126953125, "ViewRequirementAgentConnector_ms": 0.04351329803466797}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.391579064508, "episode_reward_mean": -3527.034670436482, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.9763776454975, -3529.391579064508, -3527.292616337853, -3526.205695828868, -3527.103172161543, -3526.950472325221, -3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3463271501239324, "mean_inference_ms": 0.2345490993407412, "mean_action_processing_ms": 0.05719105899043285, "mean_env_wait_ms": 0.5803561345117556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025339126586914062, "StateBufferConnector_ms": 0.0017261505126953125, "ViewRequirementAgentConnector_ms": 0.04351329803466797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 590160, "num_agent_steps_trained": 590160, "num_env_steps_sampled": 590160, "num_env_steps_trained": 590160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.89540126218955, "num_env_steps_trained_throughput_per_sec": 190.89540126218955, "timesteps_total": 590160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 590160, "timers": {"training_iteration_time_ms": 1889.018, "sample_time_ms": 1881.931, "load_time_ms": 0.214, "load_throughput": 1681832.747, "learn_time_ms": 6.327, "learn_throughput": 56898.707, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 590160, "num_env_steps_trained": 590160, "num_agent_steps_sampled": 590160, "num_agent_steps_trained": 590160}, "done": false, "episodes_total": 2120, "training_iteration": 397, "trial_id": "6192e_00000", "date": "2023-08-04_11-06-31", "timestamp": 1691136391, "time_this_iter_s": 11.317154169082642, "time_total_s": 4412.9186680316925, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1042.459644317627, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 19.96875, "ram_util_percent": 65.78125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.363330078125, "policy_loss": -4732720.05, "vf_loss": 20755665.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2783.0, "diff_num_grad_updates_vs_sampler_policy": 2782.0}}, "num_env_steps_sampled": 592320, "num_env_steps_trained": 592320, "num_agent_steps_sampled": 592320, "num_agent_steps_trained": 592320}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.3061059565275, "episode_reward_mean": -3527.022739428656, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34643385947567, "mean_inference_ms": 0.23454657965369816, "mean_action_processing_ms": 0.05719126928398143, "mean_env_wait_ms": 0.5802463134445583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025358200073242188, "StateBufferConnector_ms": 0.0017268657684326172, "ViewRequirementAgentConnector_ms": 0.04356217384338379}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.3061059565275, "episode_reward_mean": -3527.022739428656, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.540136575184, -3527.332832860939, -3528.455280800585, -3526.2931081086645, -3526.3119972703985, -3526.3907521102374, -3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34643385947567, "mean_inference_ms": 0.23454657965369816, "mean_action_processing_ms": 0.05719126928398143, "mean_env_wait_ms": 0.5802463134445583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025358200073242188, "StateBufferConnector_ms": 0.0017268657684326172, "ViewRequirementAgentConnector_ms": 0.04356217384338379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592320, "num_agent_steps_trained": 592320, "num_env_steps_sampled": 592320, "num_env_steps_trained": 592320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.99991021017038, "num_env_steps_trained_throughput_per_sec": 190.99991021017038, "timesteps_total": 592320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 592320, "timers": {"training_iteration_time_ms": 1885.381, "sample_time_ms": 1878.348, "load_time_ms": 0.216, "load_throughput": 1665507.876, "learn_time_ms": 6.277, "learn_throughput": 57350.596, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 592320, "num_env_steps_trained": 592320, "num_agent_steps_sampled": 592320, "num_agent_steps_trained": 592320}, "done": false, "episodes_total": 2126, "training_iteration": 398, "trial_id": "6192e_00000", "date": "2023-08-04_11-06-42", "timestamp": 1691136402, "time_this_iter_s": 11.310922145843506, "time_total_s": 4424.229590177536, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1053.7705664634705, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 19.3125, "ram_util_percent": 65.69375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1845336914063, "policy_loss": -4097136.825, "vf_loss": 20732972.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2813.0, "diff_num_grad_updates_vs_sampler_policy": 2812.0}}, "num_env_steps_sampled": 594480, "num_env_steps_trained": 594480, "num_agent_steps_sampled": 594480, "num_agent_steps_trained": 594480}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.3061059565275, "episode_reward_mean": -3526.992344457637, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346537641678609, "mean_inference_ms": 0.23454475959007529, "mean_action_processing_ms": 0.05719165123889773, "mean_env_wait_ms": 0.5801337177938177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002538442611694336, "StateBufferConnector_ms": 0.0017426013946533203, "ViewRequirementAgentConnector_ms": 0.043518781661987305}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.3061059565275, "episode_reward_mean": -3526.992344457637, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.22240586936, -3526.090689683674, -3527.837900950228, -3526.030512050619, -3525.7833678994352, -3525.9566183450856, -3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346537641678609, "mean_inference_ms": 0.23454475959007529, "mean_action_processing_ms": 0.05719165123889773, "mean_env_wait_ms": 0.5801337177938177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002538442611694336, "StateBufferConnector_ms": 0.0017426013946533203, "ViewRequirementAgentConnector_ms": 0.043518781661987305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594480, "num_agent_steps_trained": 594480, "num_env_steps_sampled": 594480, "num_env_steps_trained": 594480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.50224592005594, "num_env_steps_trained_throughput_per_sec": 190.50224592005594, "timesteps_total": 594480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 594480, "timers": {"training_iteration_time_ms": 1887.679, "sample_time_ms": 1880.686, "load_time_ms": 0.218, "load_throughput": 1649677.089, "learn_time_ms": 6.252, "learn_throughput": 57585.282, "synch_weights_time_ms": 0.492}, "counters": {"num_env_steps_sampled": 594480, "num_env_steps_trained": 594480, "num_agent_steps_sampled": 594480, "num_agent_steps_trained": 594480}, "done": false, "episodes_total": 2132, "training_iteration": 399, "trial_id": "6192e_00000", "date": "2023-08-04_11-06-53", "timestamp": 1691136413, "time_this_iter_s": 11.340622901916504, "time_total_s": 4435.5702130794525, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1065.111189365387, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 19.575, "ram_util_percent": 65.80625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2058837890625, "policy_loss": 274306.8375, "vf_loss": 20731674.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2843.0, "diff_num_grad_updates_vs_sampler_policy": 2842.0}}, "num_env_steps_sampled": 596640, "num_env_steps_trained": 596640, "num_agent_steps_sampled": 596640, "num_agent_steps_trained": 596640}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.3061059565275, "episode_reward_mean": -3527.0225662562925, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346641250704559, "mean_inference_ms": 0.23454348346155918, "mean_action_processing_ms": 0.05719212754570525, "mean_env_wait_ms": 0.5800272183712376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025451183319091797, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.04358816146850586}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.3061059565275, "episode_reward_mean": -3527.0225662562925, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.5161506574714, -3527.5611100727997, -3527.983232493545, -3528.137275144295, -3526.7317068484626, -3527.0250114754685, -3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346641250704559, "mean_inference_ms": 0.23454348346155918, "mean_action_processing_ms": 0.05719212754570525, "mean_env_wait_ms": 0.5800272183712376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025451183319091797, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.04358816146850586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596640, "num_agent_steps_trained": 596640, "num_env_steps_sampled": 596640, "num_env_steps_trained": 596640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.98457613304902, "num_env_steps_trained_throughput_per_sec": 189.98457613304902, "timesteps_total": 596640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 596640, "timers": {"training_iteration_time_ms": 1892.826, "sample_time_ms": 1885.662, "load_time_ms": 0.22, "load_throughput": 1633437.3, "learn_time_ms": 6.394, "learn_throughput": 56301.482, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 596640, "num_env_steps_trained": 596640, "num_agent_steps_sampled": 596640, "num_agent_steps_trained": 596640}, "done": false, "episodes_total": 2138, "training_iteration": 400, "trial_id": "6192e_00000", "date": "2023-08-04_11-07-05", "timestamp": 1691136425, "time_this_iter_s": 11.371354818344116, "time_total_s": 4446.941567897797, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1076.482544183731, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 21.31875, "ram_util_percent": 65.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2432434082031, "policy_loss": -2759519.73125, "vf_loss": 20736235.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2873.0, "diff_num_grad_updates_vs_sampler_policy": 2872.0}}, "num_env_steps_sampled": 598800, "num_env_steps_trained": 598800, "num_agent_steps_sampled": 598800, "num_agent_steps_trained": 598800}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.3061059565275, "episode_reward_mean": -3526.972436780621, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346739262949254, "mean_inference_ms": 0.2345416370641634, "mean_action_processing_ms": 0.05719251816050992, "mean_env_wait_ms": 0.5799178470955952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025386810302734375, "StateBufferConnector_ms": 0.0017359256744384766, "ViewRequirementAgentConnector_ms": 0.04355192184448242}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.3061059565275, "episode_reward_mean": -3526.972436780621, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6700505501917, -3526.2530113127245, -3526.616283014114, -3528.907377096292, -3526.56086200168, -3527.4633342635475, -3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346739262949254, "mean_inference_ms": 0.2345416370641634, "mean_action_processing_ms": 0.05719251816050992, "mean_env_wait_ms": 0.5799178470955952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025386810302734375, "StateBufferConnector_ms": 0.0017359256744384766, "ViewRequirementAgentConnector_ms": 0.04355192184448242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 598800, "num_agent_steps_trained": 598800, "num_env_steps_sampled": 598800, "num_env_steps_trained": 598800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.92229832371984, "num_env_steps_trained_throughput_per_sec": 190.92229832371984, "timesteps_total": 598800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 598800, "timers": {"training_iteration_time_ms": 1889.433, "sample_time_ms": 1882.264, "load_time_ms": 0.219, "load_throughput": 1643035.299, "learn_time_ms": 6.398, "learn_throughput": 56265.397, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 598800, "num_env_steps_trained": 598800, "num_agent_steps_sampled": 598800, "num_agent_steps_trained": 598800}, "done": false, "episodes_total": 2144, "training_iteration": 401, "trial_id": "6192e_00000", "date": "2023-08-04_11-07-16", "timestamp": 1691136436, "time_this_iter_s": 11.31553602218628, "time_total_s": 4458.257103919983, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1087.7980802059174, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 18.994117647058825, "ram_util_percent": 65.44117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.31804809570315, "policy_loss": -1306193.95, "vf_loss": 20762859.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2903.0, "diff_num_grad_updates_vs_sampler_policy": 2902.0}}, "num_env_steps_sampled": 600960, "num_env_steps_trained": 600960, "num_agent_steps_sampled": 600960, "num_agent_steps_trained": 600960}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.3061059565275, "episode_reward_mean": -3526.9872679271257, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346829489085717, "mean_inference_ms": 0.23454000958823262, "mean_action_processing_ms": 0.05719288163294802, "mean_env_wait_ms": 0.5798193678784687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002550363540649414, "StateBufferConnector_ms": 0.0017392635345458984, "ViewRequirementAgentConnector_ms": 0.043649911880493164}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3529.3061059565275, "episode_reward_mean": -3526.9872679271257, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.262320279471, -3527.4964703795026, -3526.546344948346, -3527.257276983539, -3528.783007528562, -3525.586761561823, -3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346829489085717, "mean_inference_ms": 0.23454000958823262, "mean_action_processing_ms": 0.05719288163294802, "mean_env_wait_ms": 0.5798193678784687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002550363540649414, "StateBufferConnector_ms": 0.0017392635345458984, "ViewRequirementAgentConnector_ms": 0.043649911880493164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600960, "num_agent_steps_trained": 600960, "num_env_steps_sampled": 600960, "num_env_steps_trained": 600960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.076679835827, "num_env_steps_trained_throughput_per_sec": 190.076679835827, "timesteps_total": 600960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 600960, "timers": {"training_iteration_time_ms": 1892.561, "sample_time_ms": 1885.538, "load_time_ms": 0.217, "load_throughput": 1656736.274, "learn_time_ms": 6.266, "learn_throughput": 57455.782, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 600960, "num_env_steps_trained": 600960, "num_agent_steps_sampled": 600960, "num_agent_steps_trained": 600960}, "done": false, "episodes_total": 2150, "training_iteration": 402, "trial_id": "6192e_00000", "date": "2023-08-04_11-07-27", "timestamp": 1691136447, "time_this_iter_s": 11.366017818450928, "time_total_s": 4469.623121738434, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1099.1640980243683, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 19.025, "ram_util_percent": 65.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.31476440429685, "policy_loss": -3678792.825, "vf_loss": 20754369.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2933.0, "diff_num_grad_updates_vs_sampler_policy": 2932.0}}, "num_env_steps_sampled": 603120, "num_env_steps_trained": 603120, "num_agent_steps_sampled": 603120, "num_agent_steps_trained": 603120}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3527.07207727289, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346908309609482, "mean_inference_ms": 0.23453792245592855, "mean_action_processing_ms": 0.057193093462755897, "mean_env_wait_ms": 0.5797216236904127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025606155395507812, "StateBufferConnector_ms": 0.0017445087432861328, "ViewRequirementAgentConnector_ms": 0.04367256164550781}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3527.07207727289, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.0470146750035, -3527.9954648868966, -3526.38323453799, -3526.041041133132, -3527.4862554317347, -3526.9872663679716, -3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346908309609482, "mean_inference_ms": 0.23453792245592855, "mean_action_processing_ms": 0.057193093462755897, "mean_env_wait_ms": 0.5797216236904127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025606155395507812, "StateBufferConnector_ms": 0.0017445087432861328, "ViewRequirementAgentConnector_ms": 0.04367256164550781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 603120, "num_agent_steps_trained": 603120, "num_env_steps_sampled": 603120, "num_env_steps_trained": 603120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.51940019288108, "num_env_steps_trained_throughput_per_sec": 190.51940019288108, "timesteps_total": 603120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 603120, "timers": {"training_iteration_time_ms": 1892.443, "sample_time_ms": 1885.454, "load_time_ms": 0.218, "load_throughput": 1649496.876, "learn_time_ms": 6.223, "learn_throughput": 57850.031, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 603120, "num_env_steps_trained": 603120, "num_agent_steps_sampled": 603120, "num_agent_steps_trained": 603120}, "done": false, "episodes_total": 2156, "training_iteration": 403, "trial_id": "6192e_00000", "date": "2023-08-04_11-07-39", "timestamp": 1691136459, "time_this_iter_s": 11.33952283859253, "time_total_s": 4480.962644577026, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1110.5036208629608, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 19.24375, "ram_util_percent": 65.54374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1509948730469, "policy_loss": -283609.25625, "vf_loss": 20738300.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2963.0, "diff_num_grad_updates_vs_sampler_policy": 2962.0}}, "num_env_steps_sampled": 605280, "num_env_steps_trained": 605280, "num_agent_steps_sampled": 605280, "num_agent_steps_trained": 605280}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3527.070386808482, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346991498643906, "mean_inference_ms": 0.23453559574418534, "mean_action_processing_ms": 0.057193318907102594, "mean_env_wait_ms": 0.5796255432041498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025627613067626953, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.043692588806152344}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3527.070386808482, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.8036183740815, -3526.6117797578613, -3526.5014475405437, -3526.436802999704, -3528.03037096124, -3526.5682747222945, -3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.346991498643906, "mean_inference_ms": 0.23453559574418534, "mean_action_processing_ms": 0.057193318907102594, "mean_env_wait_ms": 0.5796255432041498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025627613067626953, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.043692588806152344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 605280, "num_agent_steps_trained": 605280, "num_env_steps_sampled": 605280, "num_env_steps_trained": 605280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.1885064229502, "num_env_steps_trained_throughput_per_sec": 190.1885064229502, "timesteps_total": 605280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 605280, "timers": {"training_iteration_time_ms": 1890.35, "sample_time_ms": 1883.392, "load_time_ms": 0.213, "load_throughput": 1689359.409, "learn_time_ms": 6.216, "learn_throughput": 57919.043, "synch_weights_time_ms": 0.498}, "counters": {"num_env_steps_sampled": 605280, "num_env_steps_trained": 605280, "num_agent_steps_sampled": 605280, "num_agent_steps_trained": 605280}, "done": false, "episodes_total": 2162, "training_iteration": 404, "trial_id": "6192e_00000", "date": "2023-08-04_11-07-50", "timestamp": 1691136470, "time_this_iter_s": 11.35912013053894, "time_total_s": 4492.321764707565, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1121.8627409934998, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 19.03125, "ram_util_percent": 65.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3314453125, "policy_loss": -4712788.765625, "vf_loss": 20756857.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2993.0, "diff_num_grad_updates_vs_sampler_policy": 2992.0}}, "num_env_steps_sampled": 607440, "num_env_steps_trained": 607440, "num_agent_steps_sampled": 607440, "num_agent_steps_trained": 607440}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3527.0517930867736, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347091475374584, "mean_inference_ms": 0.2345352487650657, "mean_action_processing_ms": 0.0571938226647249, "mean_env_wait_ms": 0.5795257076716802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025632381439208984, "StateBufferConnector_ms": 0.0017592906951904297, "ViewRequirementAgentConnector_ms": 0.0437006950378418}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3527.0517930867736, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.4831844564387, -3526.266314769582, -3529.2233899402477, -3526.9377140954084, -3526.1638723800615, -3527.5774082657827, -3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347091475374584, "mean_inference_ms": 0.2345352487650657, "mean_action_processing_ms": 0.0571938226647249, "mean_env_wait_ms": 0.5795257076716802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025632381439208984, "StateBufferConnector_ms": 0.0017592906951904297, "ViewRequirementAgentConnector_ms": 0.0437006950378418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 607440, "num_agent_steps_trained": 607440, "num_env_steps_sampled": 607440, "num_env_steps_trained": 607440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.79077150227567, "num_env_steps_trained_throughput_per_sec": 189.79077150227567, "timesteps_total": 607440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 607440, "timers": {"training_iteration_time_ms": 1894.737, "sample_time_ms": 1887.717, "load_time_ms": 0.214, "load_throughput": 1678654.186, "learn_time_ms": 6.258, "learn_throughput": 57528.239, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 607440, "num_env_steps_trained": 607440, "num_agent_steps_sampled": 607440, "num_agent_steps_trained": 607440}, "done": false, "episodes_total": 2168, "training_iteration": 405, "trial_id": "6192e_00000", "date": "2023-08-04_11-08-02", "timestamp": 1691136482, "time_this_iter_s": 11.383010864257812, "time_total_s": 4503.704775571823, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1133.2457518577576, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 22.88125, "ram_util_percent": 65.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.0954956054687, "policy_loss": 328522.765625, "vf_loss": 20734569.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3023.0, "diff_num_grad_updates_vs_sampler_policy": 3022.0}}, "num_env_steps_sampled": 609600, "num_env_steps_trained": 609600, "num_agent_steps_sampled": 609600, "num_agent_steps_trained": 609600}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.999681714401, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347190240644179, "mean_inference_ms": 0.23453541988102536, "mean_action_processing_ms": 0.05719437532576539, "mean_env_wait_ms": 0.579420598775335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002550840377807617, "StateBufferConnector_ms": 0.0017628669738769531, "ViewRequirementAgentConnector_ms": 0.043666839599609375}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.999681714401, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.12365095455, -3527.6027809589623, -3527.1162448827304, -3527.173102305797, -3527.2448114593194, -3527.452356291654, -3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347190240644179, "mean_inference_ms": 0.23453541988102536, "mean_action_processing_ms": 0.05719437532576539, "mean_env_wait_ms": 0.579420598775335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002550840377807617, "StateBufferConnector_ms": 0.0017628669738769531, "ViewRequirementAgentConnector_ms": 0.043666839599609375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 609600, "num_agent_steps_trained": 609600, "num_env_steps_sampled": 609600, "num_env_steps_trained": 609600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.58518152279166, "num_env_steps_trained_throughput_per_sec": 190.58518152279166, "timesteps_total": 609600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 609600, "timers": {"training_iteration_time_ms": 1890.841, "sample_time_ms": 1883.837, "load_time_ms": 0.219, "load_throughput": 1642856.534, "learn_time_ms": 6.247, "learn_throughput": 57627.699, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 609600, "num_env_steps_trained": 609600, "num_agent_steps_sampled": 609600, "num_agent_steps_trained": 609600}, "done": false, "episodes_total": 2174, "training_iteration": 406, "trial_id": "6192e_00000", "date": "2023-08-04_11-08-13", "timestamp": 1691136493, "time_this_iter_s": 11.335588216781616, "time_total_s": 4515.040363788605, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1144.5813400745392, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 19.875, "ram_util_percent": 65.50625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.420263671875, "policy_loss": -13903531.0125, "vf_loss": 20765295.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3053.0, "diff_num_grad_updates_vs_sampler_policy": 3052.0}}, "num_env_steps_sampled": 611760, "num_env_steps_trained": 611760, "num_agent_steps_sampled": 611760, "num_agent_steps_trained": 611760}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.9969932268, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3472839605332325, "mean_inference_ms": 0.2345350201886791, "mean_action_processing_ms": 0.057194763705621064, "mean_env_wait_ms": 0.5793194257781612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002534627914428711, "StateBufferConnector_ms": 0.0017695426940917969, "ViewRequirementAgentConnector_ms": 0.043624162673950195}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.9969932268, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.64327824719, -3528.068030157566, -3527.4301277427103, -3527.6829889654773, -3528.152960890512, -3526.1488251913765, -3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3472839605332325, "mean_inference_ms": 0.2345350201886791, "mean_action_processing_ms": 0.057194763705621064, "mean_env_wait_ms": 0.5793194257781612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002534627914428711, "StateBufferConnector_ms": 0.0017695426940917969, "ViewRequirementAgentConnector_ms": 0.043624162673950195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 611760, "num_agent_steps_trained": 611760, "num_env_steps_sampled": 611760, "num_env_steps_trained": 611760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.93207311069906, "num_env_steps_trained_throughput_per_sec": 189.93207311069906, "timesteps_total": 611760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 611760, "timers": {"training_iteration_time_ms": 1892.414, "sample_time_ms": 1885.265, "load_time_ms": 0.233, "load_throughput": 1543915.583, "learn_time_ms": 6.365, "learn_throughput": 56556.226, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 611760, "num_env_steps_trained": 611760, "num_agent_steps_sampled": 611760, "num_agent_steps_trained": 611760}, "done": false, "episodes_total": 2180, "training_iteration": 407, "trial_id": "6192e_00000", "date": "2023-08-04_11-08-24", "timestamp": 1691136504, "time_this_iter_s": 11.374502897262573, "time_total_s": 4526.414866685867, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1155.9558429718018, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 20.91875, "ram_util_percent": 65.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.20326538085936, "policy_loss": -2971173.9625, "vf_loss": 20740035.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3083.0, "diff_num_grad_updates_vs_sampler_policy": 3082.0}}, "num_env_steps_sampled": 613920, "num_env_steps_trained": 613920, "num_agent_steps_sampled": 613920, "num_agent_steps_trained": 613920}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.9805318516346, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347371112643217, "mean_inference_ms": 0.23453473024596191, "mean_action_processing_ms": 0.05719513697354172, "mean_env_wait_ms": 0.5792216770868573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002530813217163086, "StateBufferConnector_ms": 0.0017597675323486328, "ViewRequirementAgentConnector_ms": 0.04359030723571777}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.9805318516346, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.7253689591303, -3527.385259059711, -3527.2500707140985, -3526.930389599315, -3528.1885714228324, -3525.7853848243917, -3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347371112643217, "mean_inference_ms": 0.23453473024596191, "mean_action_processing_ms": 0.05719513697354172, "mean_env_wait_ms": 0.5792216770868573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002530813217163086, "StateBufferConnector_ms": 0.0017597675323486328, "ViewRequirementAgentConnector_ms": 0.04359030723571777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 613920, "num_agent_steps_trained": 613920, "num_env_steps_sampled": 613920, "num_env_steps_trained": 613920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.22368366682244, "num_env_steps_trained_throughput_per_sec": 190.22368366682244, "timesteps_total": 613920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 613920, "timers": {"training_iteration_time_ms": 1896.021, "sample_time_ms": 1888.86, "load_time_ms": 0.23, "load_throughput": 1568289.821, "learn_time_ms": 6.38, "learn_throughput": 56428.777, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 613920, "num_env_steps_trained": 613920, "num_agent_steps_sampled": 613920, "num_agent_steps_trained": 613920}, "done": false, "episodes_total": 2186, "training_iteration": 408, "trial_id": "6192e_00000", "date": "2023-08-04_11-08-36", "timestamp": 1691136516, "time_this_iter_s": 11.357224225997925, "time_total_s": 4537.772090911865, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1167.3130671977997, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 19.525, "ram_util_percent": 65.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.4529296875, "policy_loss": -7622127.61875, "vf_loss": 20770971.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3113.0, "diff_num_grad_updates_vs_sampler_policy": 3112.0}}, "num_env_steps_sampled": 616080, "num_env_steps_trained": 616080, "num_agent_steps_sampled": 616080, "num_agent_steps_trained": 616080}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.989342079126, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3474560626715375, "mean_inference_ms": 0.23453473009849063, "mean_action_processing_ms": 0.05719554814823489, "mean_env_wait_ms": 0.5791279305111374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532958984375, "StateBufferConnector_ms": 0.0017583370208740234, "ViewRequirementAgentConnector_ms": 0.04358220100402832}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.989342079126, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3529.25094168272, -3526.9879347565898, -3526.2841057237474, -3527.268583107748, -3526.8028455111635, -3527.9034533236063, -3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3474560626715375, "mean_inference_ms": 0.23453473009849063, "mean_action_processing_ms": 0.05719554814823489, "mean_env_wait_ms": 0.5791279305111374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532958984375, "StateBufferConnector_ms": 0.0017583370208740234, "ViewRequirementAgentConnector_ms": 0.04358220100402832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616080, "num_agent_steps_trained": 616080, "num_env_steps_sampled": 616080, "num_env_steps_trained": 616080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.0287693473751, "num_env_steps_trained_throughput_per_sec": 190.0287693473751, "timesteps_total": 616080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 616080, "timers": {"training_iteration_time_ms": 1895.475, "sample_time_ms": 1888.451, "load_time_ms": 0.216, "load_throughput": 1669190.184, "learn_time_ms": 6.273, "learn_throughput": 57385.034, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 616080, "num_env_steps_trained": 616080, "num_agent_steps_sampled": 616080, "num_agent_steps_trained": 616080}, "done": false, "episodes_total": 2192, "training_iteration": 409, "trial_id": "6192e_00000", "date": "2023-08-04_11-08-47", "timestamp": 1691136527, "time_this_iter_s": 11.368791818618774, "time_total_s": 4549.140882730484, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1178.6818590164185, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 19.6, "ram_util_percent": 65.69375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.16376953125, "policy_loss": -2432116.5125, "vf_loss": 20742656.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3143.0, "diff_num_grad_updates_vs_sampler_policy": 3142.0}}, "num_env_steps_sampled": 618240, "num_env_steps_trained": 618240, "num_agent_steps_sampled": 618240, "num_agent_steps_trained": 618240}, "sampler_results": {"episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.9550508790535, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347553496534669, "mean_inference_ms": 0.23453513540744564, "mean_action_processing_ms": 0.05719596386992649, "mean_env_wait_ms": 0.5790275148321872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518177032470703, "StateBufferConnector_ms": 0.0017659664154052734, "ViewRequirementAgentConnector_ms": 0.043593406677246094}}, "episode_reward_max": -3525.58676062814, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.9550508790535, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.693611428078, -3526.7532605418614, -3525.58676062814, -3526.89496557531, -3528.0662952920165, -3529.3061059565275, -3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347553496534669, "mean_inference_ms": 0.23453513540744564, "mean_action_processing_ms": 0.05719596386992649, "mean_env_wait_ms": 0.5790275148321872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518177032470703, "StateBufferConnector_ms": 0.0017659664154052734, "ViewRequirementAgentConnector_ms": 0.043593406677246094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 618240, "num_agent_steps_trained": 618240, "num_env_steps_sampled": 618240, "num_env_steps_trained": 618240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.87497089953365, "num_env_steps_trained_throughput_per_sec": 189.87497089953365, "timesteps_total": 618240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 618240, "timers": {"training_iteration_time_ms": 1894.44, "sample_time_ms": 1887.302, "load_time_ms": 0.217, "load_throughput": 1657827.668, "learn_time_ms": 6.38, "learn_throughput": 56428.356, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 618240, "num_env_steps_trained": 618240, "num_agent_steps_sampled": 618240, "num_agent_steps_trained": 618240}, "done": false, "episodes_total": 2198, "training_iteration": 410, "trial_id": "6192e_00000", "date": "2023-08-04_11-08-59", "timestamp": 1691136539, "time_this_iter_s": 11.377975940704346, "time_total_s": 4560.518858671188, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1190.0598349571228, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 20.7, "ram_util_percent": 65.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1519409179688, "policy_loss": -2422790.64375, "vf_loss": 20738580.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3173.0, "diff_num_grad_updates_vs_sampler_policy": 3172.0}}, "num_env_steps_sampled": 620400, "num_env_steps_trained": 620400, "num_agent_steps_sampled": 620400, "num_agent_steps_trained": 620400}, "sampler_results": {"episode_reward_max": -3525.623913896086, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.923375097621, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347653646122511, "mean_inference_ms": 0.23453515761439941, "mean_action_processing_ms": 0.05719628658147782, "mean_env_wait_ms": 0.5789247136659477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025153160095214844, "StateBufferConnector_ms": 0.0017685890197753906, "ViewRequirementAgentConnector_ms": 0.04356122016906738}}, "episode_reward_max": -3525.623913896086, "episode_reward_min": -3533.580037975176, "episode_reward_mean": -3526.923375097621, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.7533183677515, -3525.6709160145424, -3527.173640169045, -3526.9811273372147, -3526.697040056238, -3525.999464131207, -3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347653646122511, "mean_inference_ms": 0.23453515761439941, "mean_action_processing_ms": 0.05719628658147782, "mean_env_wait_ms": 0.5789247136659477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025153160095214844, "StateBufferConnector_ms": 0.0017685890197753906, "ViewRequirementAgentConnector_ms": 0.04356122016906738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620400, "num_agent_steps_trained": 620400, "num_env_steps_sampled": 620400, "num_env_steps_trained": 620400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.2043383661211, "num_env_steps_trained_throughput_per_sec": 190.2043383661211, "timesteps_total": 620400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 620400, "timers": {"training_iteration_time_ms": 1894.336, "sample_time_ms": 1887.192, "load_time_ms": 0.224, "load_throughput": 1603940.344, "learn_time_ms": 6.362, "learn_throughput": 56582.082, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 620400, "num_env_steps_trained": 620400, "num_agent_steps_sampled": 620400, "num_agent_steps_trained": 620400}, "done": false, "episodes_total": 2204, "training_iteration": 411, "trial_id": "6192e_00000", "date": "2023-08-04_11-09-10", "timestamp": 1691136550, "time_this_iter_s": 11.358244180679321, "time_total_s": 4571.877102851868, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1201.4180791378021, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 19.931250000000002, "ram_util_percent": 65.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1930725097656, "policy_loss": -1716785.25, "vf_loss": 20736791.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3203.0, "diff_num_grad_updates_vs_sampler_policy": 3202.0}}, "num_env_steps_sampled": 622560, "num_env_steps_trained": 622560, "num_agent_steps_sampled": 622560, "num_agent_steps_trained": 622560}, "sampler_results": {"episode_reward_max": -3525.623913896086, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.002952301501, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347754866097574, "mean_inference_ms": 0.23453495036056793, "mean_action_processing_ms": 0.05719647557080181, "mean_env_wait_ms": 0.578827564771505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025055408477783203, "StateBufferConnector_ms": 0.0017704963684082031, "ViewRequirementAgentConnector_ms": 0.04357171058654785}}, "episode_reward_max": -3525.623913896086, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.002952301501, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.1169629358033, -3526.0589570770026, -3527.918999600113, -3526.131069761454, -3526.3359127109625, -3526.5213821292655, -3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347754866097574, "mean_inference_ms": 0.23453495036056793, "mean_action_processing_ms": 0.05719647557080181, "mean_env_wait_ms": 0.578827564771505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025055408477783203, "StateBufferConnector_ms": 0.0017704963684082031, "ViewRequirementAgentConnector_ms": 0.04357171058654785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 622560, "num_agent_steps_trained": 622560, "num_env_steps_sampled": 622560, "num_env_steps_trained": 622560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.80209556909978, "num_env_steps_trained_throughput_per_sec": 189.80209556909978, "timesteps_total": 622560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 622560, "timers": {"training_iteration_time_ms": 1894.041, "sample_time_ms": 1887.04, "load_time_ms": 0.223, "load_throughput": 1617514.13, "learn_time_ms": 6.242, "learn_throughput": 57671.72, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 622560, "num_env_steps_trained": 622560, "num_agent_steps_sampled": 622560, "num_agent_steps_trained": 622560}, "done": false, "episodes_total": 2210, "training_iteration": 412, "trial_id": "6192e_00000", "date": "2023-08-04_11-09-21", "timestamp": 1691136561, "time_this_iter_s": 11.38233494758606, "time_total_s": 4583.259437799454, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1212.8004140853882, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 20.99411764705882, "ram_util_percent": 65.56470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.0954956054687, "policy_loss": 328468.228125, "vf_loss": 20729244.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3233.0, "diff_num_grad_updates_vs_sampler_policy": 3232.0}}, "num_env_steps_sampled": 624720, "num_env_steps_trained": 624720, "num_agent_steps_sampled": 624720, "num_agent_steps_trained": 624720}, "sampler_results": {"episode_reward_max": -3525.5867919048137, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.0097281838403, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347861623021851, "mean_inference_ms": 0.23453646819448448, "mean_action_processing_ms": 0.0571968822384226, "mean_env_wait_ms": 0.578735277467951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024976730346679688, "StateBufferConnector_ms": 0.0017673969268798828, "ViewRequirementAgentConnector_ms": 0.043592214584350586}}, "episode_reward_max": -3525.5867919048137, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.0097281838403, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.217888824645, -3526.122759049341, -3526.0939979023547, -3525.702983630712, -3527.3827567874273, -3526.9506138896886, -3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347861623021851, "mean_inference_ms": 0.23453646819448448, "mean_action_processing_ms": 0.0571968822384226, "mean_env_wait_ms": 0.578735277467951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024976730346679688, "StateBufferConnector_ms": 0.0017673969268798828, "ViewRequirementAgentConnector_ms": 0.043592214584350586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624720, "num_agent_steps_trained": 624720, "num_env_steps_sampled": 624720, "num_env_steps_trained": 624720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.97750473596645, "num_env_steps_trained_throughput_per_sec": 189.97750473596645, "timesteps_total": 624720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 624720, "timers": {"training_iteration_time_ms": 1894.797, "sample_time_ms": 1887.741, "load_time_ms": 0.222, "load_throughput": 1623426.986, "learn_time_ms": 6.291, "learn_throughput": 57220.197, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 624720, "num_env_steps_trained": 624720, "num_agent_steps_sampled": 624720, "num_agent_steps_trained": 624720}, "done": false, "episodes_total": 2216, "training_iteration": 413, "trial_id": "6192e_00000", "date": "2023-08-04_11-09-33", "timestamp": 1691136573, "time_this_iter_s": 11.372052907943726, "time_total_s": 4594.6314907073975, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1224.172466993332, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 21.012500000000003, "ram_util_percent": 65.61250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2272644042969, "policy_loss": -2202080.709375, "vf_loss": 20751571.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3263.0, "diff_num_grad_updates_vs_sampler_policy": 3262.0}}, "num_env_steps_sampled": 626880, "num_env_steps_trained": 626880, "num_agent_steps_sampled": 626880, "num_agent_steps_trained": 626880}, "sampler_results": {"episode_reward_max": -3525.5867919048137, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.0599143332865, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347978275968447, "mean_inference_ms": 0.2345383599711368, "mean_action_processing_ms": 0.057197309094647666, "mean_env_wait_ms": 0.5786479146809989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017638206481933594, "ViewRequirementAgentConnector_ms": 0.043530941009521484}}, "episode_reward_max": -3525.5867919048137, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.0599143332865, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.840477774078, -3527.6434160427584, -3525.918398623754, -3527.99114946318, -3527.594599954388, -3526.910180507439, -3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.347978275968447, "mean_inference_ms": 0.2345383599711368, "mean_action_processing_ms": 0.057197309094647666, "mean_env_wait_ms": 0.5786479146809989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017638206481933594, "ViewRequirementAgentConnector_ms": 0.043530941009521484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 626880, "num_agent_steps_trained": 626880, "num_env_steps_sampled": 626880, "num_env_steps_trained": 626880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.0185899355696, "num_env_steps_trained_throughput_per_sec": 190.0185899355696, "timesteps_total": 626880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 626880, "timers": {"training_iteration_time_ms": 1895.489, "sample_time_ms": 1888.494, "load_time_ms": 0.213, "load_throughput": 1691630.562, "learn_time_ms": 6.24, "learn_throughput": 57692.433, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 626880, "num_env_steps_trained": 626880, "num_agent_steps_sampled": 626880, "num_agent_steps_trained": 626880}, "done": false, "episodes_total": 2222, "training_iteration": 414, "trial_id": "6192e_00000", "date": "2023-08-04_11-09-44", "timestamp": 1691136584, "time_this_iter_s": 11.36950397491455, "time_total_s": 4606.000994682312, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1235.5419709682465, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 21.5375, "ram_util_percent": 65.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.0954956054687, "policy_loss": 328535.575, "vf_loss": 20735819.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3293.0, "diff_num_grad_updates_vs_sampler_policy": 3292.0}}, "num_env_steps_sampled": 629040, "num_env_steps_trained": 629040, "num_agent_steps_sampled": 629040, "num_agent_steps_trained": 629040}, "sampler_results": {"episode_reward_max": -3525.5867919048137, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.039715706874, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348108232783565, "mean_inference_ms": 0.23454055110471994, "mean_action_processing_ms": 0.057197732108025354, "mean_env_wait_ms": 0.5785529914950105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0017554759979248047, "ViewRequirementAgentConnector_ms": 0.043581485748291016}}, "episode_reward_max": -3525.5867919048137, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.039715706874, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.623913896086, -3526.739788408167, -3526.3962489502223, -3526.0198789078013, -3527.4684684348294, -3526.5811606658817, -3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348108232783565, "mean_inference_ms": 0.23454055110471994, "mean_action_processing_ms": 0.057197732108025354, "mean_env_wait_ms": 0.5785529914950105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0017554759979248047, "ViewRequirementAgentConnector_ms": 0.043581485748291016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 629040, "num_agent_steps_trained": 629040, "num_env_steps_sampled": 629040, "num_env_steps_trained": 629040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.50402850658114, "num_env_steps_trained_throughput_per_sec": 190.50402850658114, "timesteps_total": 629040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 629040, "timers": {"training_iteration_time_ms": 1892.448, "sample_time_ms": 1885.452, "load_time_ms": 0.212, "load_throughput": 1694858.503, "learn_time_ms": 6.254, "learn_throughput": 57567.279, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 629040, "num_env_steps_trained": 629040, "num_agent_steps_sampled": 629040, "num_agent_steps_trained": 629040}, "done": false, "episodes_total": 2228, "training_iteration": 415, "trial_id": "6192e_00000", "date": "2023-08-04_11-09-55", "timestamp": 1691136595, "time_this_iter_s": 11.340460777282715, "time_total_s": 4617.341455459595, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1246.8824317455292, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 21.137500000000003, "ram_util_percent": 65.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.30006103515626, "policy_loss": -1417273.034375, "vf_loss": 20741220.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3323.0, "diff_num_grad_updates_vs_sampler_policy": 3322.0}}, "num_env_steps_sampled": 631200, "num_env_steps_trained": 631200, "num_agent_steps_sampled": 631200, "num_agent_steps_trained": 631200}, "sampler_results": {"episode_reward_max": -3525.5867919048137, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.0824266693958, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348233770722989, "mean_inference_ms": 0.23454190175144818, "mean_action_processing_ms": 0.057197823675345746, "mean_env_wait_ms": 0.5784584492846665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024940967559814453, "StateBufferConnector_ms": 0.0017457008361816406, "ViewRequirementAgentConnector_ms": 0.043526649475097656}}, "episode_reward_max": -3525.5867919048137, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.0824266693958, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.991425304102, -3527.2817666210262, -3527.63406035391, -3525.9867932841776, -3526.2750726689806, -3525.752534922577, -3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348233770722989, "mean_inference_ms": 0.23454190175144818, "mean_action_processing_ms": 0.057197823675345746, "mean_env_wait_ms": 0.5784584492846665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024940967559814453, "StateBufferConnector_ms": 0.0017457008361816406, "ViewRequirementAgentConnector_ms": 0.043526649475097656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 631200, "num_agent_steps_trained": 631200, "num_env_steps_sampled": 631200, "num_env_steps_trained": 631200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.63631334732236, "num_env_steps_trained_throughput_per_sec": 190.63631334732236, "timesteps_total": 631200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 631200, "timers": {"training_iteration_time_ms": 1891.693, "sample_time_ms": 1884.606, "load_time_ms": 0.216, "load_throughput": 1665875.375, "learn_time_ms": 6.322, "learn_throughput": 56943.339, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 631200, "num_env_steps_trained": 631200, "num_agent_steps_sampled": 631200, "num_agent_steps_trained": 631200}, "done": false, "episodes_total": 2234, "training_iteration": 416, "trial_id": "6192e_00000", "date": "2023-08-04_11-10-07", "timestamp": 1691136607, "time_this_iter_s": 11.332496166229248, "time_total_s": 4628.673951625824, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1258.2149279117584, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 20.1875, "ram_util_percent": 65.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2029296875, "policy_loss": -2109224.24375, "vf_loss": 20730679.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3353.0, "diff_num_grad_updates_vs_sampler_policy": 3352.0}}, "num_env_steps_sampled": 633360, "num_env_steps_trained": 633360, "num_agent_steps_sampled": 633360, "num_agent_steps_trained": 633360}, "sampler_results": {"episode_reward_max": -3525.578462713374, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.0760337769766, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348363159097448, "mean_inference_ms": 0.2345429785228671, "mean_action_processing_ms": 0.05719782223302466, "mean_env_wait_ms": 0.5783612497474319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490520477294922, "StateBufferConnector_ms": 0.0017418861389160156, "ViewRequirementAgentConnector_ms": 0.043489694595336914}}, "episode_reward_max": -3525.578462713374, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.0760337769766, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.587693131324, -3526.842657686871, -3527.428573603499, -3526.0550071116695, -3526.6943708826198, -3526.8519313017737, -3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348363159097448, "mean_inference_ms": 0.2345429785228671, "mean_action_processing_ms": 0.05719782223302466, "mean_env_wait_ms": 0.5783612497474319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490520477294922, "StateBufferConnector_ms": 0.0017418861389160156, "ViewRequirementAgentConnector_ms": 0.043489694595336914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 633360, "num_agent_steps_trained": 633360, "num_env_steps_sampled": 633360, "num_env_steps_trained": 633360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.23040192746384, "num_env_steps_trained_throughput_per_sec": 190.23040192746384, "timesteps_total": 633360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 633360, "timers": {"training_iteration_time_ms": 1892.824, "sample_time_ms": 1885.723, "load_time_ms": 0.219, "load_throughput": 1642856.534, "learn_time_ms": 6.338, "learn_throughput": 56797.9, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 633360, "num_env_steps_trained": 633360, "num_agent_steps_sampled": 633360, "num_agent_steps_trained": 633360}, "done": false, "episodes_total": 2240, "training_iteration": 417, "trial_id": "6192e_00000", "date": "2023-08-04_11-10-18", "timestamp": 1691136618, "time_this_iter_s": 11.356763124465942, "time_total_s": 4640.03071475029, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1269.5716910362244, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 18.987500000000004, "ram_util_percent": 65.54375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.17265625, "policy_loss": 270390.771875, "vf_loss": 20727791.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3383.0, "diff_num_grad_updates_vs_sampler_policy": 3382.0}}, "num_env_steps_sampled": 635520, "num_env_steps_trained": 635520, "num_agent_steps_sampled": 635520, "num_agent_steps_trained": 635520}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.0708738711332, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348500866829718, "mean_inference_ms": 0.23454502975652985, "mean_action_processing_ms": 0.05719793024545502, "mean_env_wait_ms": 0.5782630056945731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024988651275634766, "StateBufferConnector_ms": 0.0017423629760742188, "ViewRequirementAgentConnector_ms": 0.04358530044555664}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3527.0708738711332, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.418521375449, -3527.749830902735, -3526.9752408929453, -3528.264137533476, -3527.430257502918, -3533.580037975176, -3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348500866829718, "mean_inference_ms": 0.23454502975652985, "mean_action_processing_ms": 0.05719793024545502, "mean_env_wait_ms": 0.5782630056945731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024988651275634766, "StateBufferConnector_ms": 0.0017423629760742188, "ViewRequirementAgentConnector_ms": 0.04358530044555664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 635520, "num_agent_steps_trained": 635520, "num_env_steps_sampled": 635520, "num_env_steps_trained": 635520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.1097811630949, "num_env_steps_trained_throughput_per_sec": 190.1097811630949, "timesteps_total": 635520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 635520, "timers": {"training_iteration_time_ms": 1893.147, "sample_time_ms": 1886.148, "load_time_ms": 0.216, "load_throughput": 1664956.93, "learn_time_ms": 6.231, "learn_throughput": 57773.003, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 635520, "num_env_steps_trained": 635520, "num_agent_steps_sampled": 635520, "num_agent_steps_trained": 635520}, "done": false, "episodes_total": 2246, "training_iteration": 418, "trial_id": "6192e_00000", "date": "2023-08-04_11-10-30", "timestamp": 1691136630, "time_this_iter_s": 11.363884210586548, "time_total_s": 4651.3945989608765, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1280.935575246811, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 21.71875, "ram_util_percent": 65.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.21904907226565, "policy_loss": -6050691.6875, "vf_loss": 20731621.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3413.0, "diff_num_grad_updates_vs_sampler_policy": 3412.0}}, "num_env_steps_sampled": 637680, "num_env_steps_trained": 637680, "num_agent_steps_sampled": 637680, "num_agent_steps_trained": 637680}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3526.957810868715, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348643782494255, "mean_inference_ms": 0.23454756542863137, "mean_action_processing_ms": 0.05719803516994431, "mean_env_wait_ms": 0.5781609933000348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002483367919921875, "StateBufferConnector_ms": 0.0017266273498535156, "ViewRequirementAgentConnector_ms": 0.04354977607727051}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3526.957810868715, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.412594553709, -3526.607659872494, -3526.9050093636674, -3527.47755698971, -3528.2014016927646, -3527.349640162434, -3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348643782494255, "mean_inference_ms": 0.23454756542863137, "mean_action_processing_ms": 0.05719803516994431, "mean_env_wait_ms": 0.5781609933000348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002483367919921875, "StateBufferConnector_ms": 0.0017266273498535156, "ViewRequirementAgentConnector_ms": 0.04354977607727051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 637680, "num_agent_steps_trained": 637680, "num_env_steps_sampled": 637680, "num_env_steps_trained": 637680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.03980292506222, "num_env_steps_trained_throughput_per_sec": 190.03980292506222, "timesteps_total": 637680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 637680, "timers": {"training_iteration_time_ms": 1892.96, "sample_time_ms": 1885.987, "load_time_ms": 0.216, "load_throughput": 1667899.525, "learn_time_ms": 6.209, "learn_throughput": 57980.203, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 637680, "num_env_steps_trained": 637680, "num_agent_steps_sampled": 637680, "num_agent_steps_trained": 637680}, "done": false, "episodes_total": 2252, "training_iteration": 419, "trial_id": "6192e_00000", "date": "2023-08-04_11-10-41", "timestamp": 1691136641, "time_this_iter_s": 11.368025064468384, "time_total_s": 4662.762624025345, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1292.3036003112793, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 19.45625, "ram_util_percent": 65.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.166064453125, "policy_loss": -4214728.51875, "vf_loss": 20744891.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3443.0, "diff_num_grad_updates_vs_sampler_policy": 3442.0}}, "num_env_steps_sampled": 639840, "num_env_steps_trained": 639840, "num_agent_steps_sampled": 639840, "num_agent_steps_trained": 639840}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3526.9887981915604, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348796987008329, "mean_inference_ms": 0.23455009357541934, "mean_action_processing_ms": 0.05719809616906147, "mean_env_wait_ms": 0.5780589728436482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002482175827026367, "StateBufferConnector_ms": 0.0017261505126953125, "ViewRequirementAgentConnector_ms": 0.04356503486633301}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.01674956823, "episode_reward_mean": -3526.9887981915604, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.7177989692473, -3526.485261579243, -3526.806087466523, -3526.2110407217433, -3526.9218211431526, -3526.1795114659635, -3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348796987008329, "mean_inference_ms": 0.23455009357541934, "mean_action_processing_ms": 0.05719809616906147, "mean_env_wait_ms": 0.5780589728436482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002482175827026367, "StateBufferConnector_ms": 0.0017261505126953125, "ViewRequirementAgentConnector_ms": 0.04356503486633301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 639840, "num_agent_steps_trained": 639840, "num_env_steps_sampled": 639840, "num_env_steps_trained": 639840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.662067193575, "num_env_steps_trained_throughput_per_sec": 189.662067193575, "timesteps_total": 639840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 639840, "timers": {"training_iteration_time_ms": 1893.302, "sample_time_ms": 1886.212, "load_time_ms": 0.216, "load_throughput": 1665875.375, "learn_time_ms": 6.311, "learn_throughput": 57044.018, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 639840, "num_env_steps_trained": 639840, "num_agent_steps_sampled": 639840, "num_agent_steps_trained": 639840}, "done": false, "episodes_total": 2258, "training_iteration": 420, "trial_id": "6192e_00000", "date": "2023-08-04_11-10-52", "timestamp": 1691136652, "time_this_iter_s": 11.390830993652344, "time_total_s": 4674.153455018997, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1303.6944313049316, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 26.01875, "ram_util_percent": 65.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.22828369140626, "policy_loss": -5385724.603125, "vf_loss": 20746579.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3473.0, "diff_num_grad_updates_vs_sampler_policy": 3472.0}}, "num_env_steps_sampled": 642000, "num_env_steps_trained": 642000, "num_agent_steps_sampled": 642000, "num_agent_steps_trained": 642000}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.064871304521, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348945299712796, "mean_inference_ms": 0.2345526031568162, "mean_action_processing_ms": 0.05719805664637288, "mean_env_wait_ms": 0.5779572131819866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490520477294922, "StateBufferConnector_ms": 0.0017228126525878906, "ViewRequirementAgentConnector_ms": 0.04358816146850586}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.064871304521, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.7431108663695, -3525.9998229373964, -3525.7871263025436, -3527.4615294695127, -3527.4115398142276, -3525.7161737759384, -3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.348945299712796, "mean_inference_ms": 0.2345526031568162, "mean_action_processing_ms": 0.05719805664637288, "mean_env_wait_ms": 0.5779572131819866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490520477294922, "StateBufferConnector_ms": 0.0017228126525878906, "ViewRequirementAgentConnector_ms": 0.04358816146850586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 642000, "num_agent_steps_trained": 642000, "num_env_steps_sampled": 642000, "num_env_steps_trained": 642000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.29621963691693, "num_env_steps_trained_throughput_per_sec": 190.29621963691693, "timesteps_total": 642000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 642000, "timers": {"training_iteration_time_ms": 1892.734, "sample_time_ms": 1885.579, "load_time_ms": 0.214, "load_throughput": 1681645.439, "learn_time_ms": 6.378, "learn_throughput": 56444.176, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 642000, "num_env_steps_trained": 642000, "num_agent_steps_sampled": 642000, "num_agent_steps_trained": 642000}, "done": false, "episodes_total": 2264, "training_iteration": 421, "trial_id": "6192e_00000", "date": "2023-08-04_11-11-04", "timestamp": 1691136664, "time_this_iter_s": 11.352885961532593, "time_total_s": 4685.50634098053, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1315.0473172664642, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 20.58125, "ram_util_percent": 65.61250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.0954956054687, "policy_loss": 328468.221875, "vf_loss": 20729244.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3503.0, "diff_num_grad_updates_vs_sampler_policy": 3502.0}}, "num_env_steps_sampled": 644160, "num_env_steps_trained": 644160, "num_agent_steps_sampled": 644160, "num_agent_steps_trained": 644160}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.069512887582, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349083398154759, "mean_inference_ms": 0.23455416728017353, "mean_action_processing_ms": 0.0571978561091143, "mean_env_wait_ms": 0.5778629477826375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024862289428710938, "StateBufferConnector_ms": 0.001722574234008789, "ViewRequirementAgentConnector_ms": 0.0435640811920166}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.069512887582, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.103441564471, -3526.8588193909677, -3527.1196779968895, -3526.2310941277224, -3526.6820933654326, -3528.128162676099, -3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349083398154759, "mean_inference_ms": 0.23455416728017353, "mean_action_processing_ms": 0.0571978561091143, "mean_env_wait_ms": 0.5778629477826375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024862289428710938, "StateBufferConnector_ms": 0.001722574234008789, "ViewRequirementAgentConnector_ms": 0.0435640811920166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 644160, "num_agent_steps_trained": 644160, "num_env_steps_sampled": 644160, "num_env_steps_trained": 644160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.259437299583, "num_env_steps_trained_throughput_per_sec": 190.259437299583, "timesteps_total": 644160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 644160, "timers": {"training_iteration_time_ms": 1893.016, "sample_time_ms": 1885.919, "load_time_ms": 0.216, "load_throughput": 1666426.929, "learn_time_ms": 6.343, "learn_throughput": 56756.482, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 644160, "num_env_steps_trained": 644160, "num_agent_steps_sampled": 644160, "num_agent_steps_trained": 644160}, "done": false, "episodes_total": 2270, "training_iteration": 422, "trial_id": "6192e_00000", "date": "2023-08-04_11-11-15", "timestamp": 1691136675, "time_this_iter_s": 11.354919910430908, "time_total_s": 4696.861260890961, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1326.4022371768951, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 19.225, "ram_util_percent": 65.36875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.34824829101564, "policy_loss": -2386405.328125, "vf_loss": 20756874.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 3532.0}}, "num_env_steps_sampled": 646320, "num_env_steps_trained": 646320, "num_agent_steps_sampled": 646320, "num_agent_steps_trained": 646320}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0975062478865, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349215719203098, "mean_inference_ms": 0.23455549471280646, "mean_action_processing_ms": 0.057197605887655704, "mean_env_wait_ms": 0.5777737098205263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024924278259277344, "StateBufferConnector_ms": 0.0017251968383789062, "ViewRequirementAgentConnector_ms": 0.04355049133300781}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0975062478865, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.0278945727787, -3527.7008870424024, -3526.2179211822686, -3528.6871392539656, -3525.9566484902402, -3526.6433346793906, -3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349215719203098, "mean_inference_ms": 0.23455549471280646, "mean_action_processing_ms": 0.057197605887655704, "mean_env_wait_ms": 0.5777737098205263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024924278259277344, "StateBufferConnector_ms": 0.0017251968383789062, "ViewRequirementAgentConnector_ms": 0.04355049133300781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 646320, "num_agent_steps_trained": 646320, "num_env_steps_sampled": 646320, "num_env_steps_trained": 646320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.4198147153163, "num_env_steps_trained_throughput_per_sec": 190.4198147153163, "timesteps_total": 646320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 646320, "timers": {"training_iteration_time_ms": 1891.875, "sample_time_ms": 1884.771, "load_time_ms": 0.215, "load_throughput": 1678281.027, "learn_time_ms": 6.342, "learn_throughput": 56765.443, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 646320, "num_env_steps_trained": 646320, "num_agent_steps_sampled": 646320, "num_agent_steps_trained": 646320}, "done": false, "episodes_total": 2276, "training_iteration": 423, "trial_id": "6192e_00000", "date": "2023-08-04_11-11-26", "timestamp": 1691136686, "time_this_iter_s": 11.345671892166138, "time_total_s": 4708.206932783127, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1337.7479090690613, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 19.376470588235293, "ram_util_percent": 65.3941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3355346679688, "policy_loss": -8649656.05625, "vf_loss": 20737162.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3563.0, "diff_num_grad_updates_vs_sampler_policy": 3562.0}}, "num_env_steps_sampled": 648480, "num_env_steps_trained": 648480, "num_agent_steps_sampled": 648480, "num_agent_steps_trained": 648480}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0764502437005, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349347201034604, "mean_inference_ms": 0.23455635096040375, "mean_action_processing_ms": 0.05719724347398816, "mean_env_wait_ms": 0.5776831804933376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024979114532470703, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.0435178279876709}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0764502437005, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.247469229865, -3526.85359417167, -3527.0493998589513, -3526.7296272481867, -3526.6303318725986, -3527.7065732753927, -3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349347201034604, "mean_inference_ms": 0.23455635096040375, "mean_action_processing_ms": 0.05719724347398816, "mean_env_wait_ms": 0.5776831804933376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024979114532470703, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.0435178279876709}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648480, "num_agent_steps_trained": 648480, "num_env_steps_sampled": 648480, "num_env_steps_trained": 648480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.1693000049286, "num_env_steps_trained_throughput_per_sec": 190.1693000049286, "timesteps_total": 648480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 648480, "timers": {"training_iteration_time_ms": 1893.359, "sample_time_ms": 1886.251, "load_time_ms": 0.216, "load_throughput": 1665875.375, "learn_time_ms": 6.336, "learn_throughput": 56814.142, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 648480, "num_env_steps_trained": 648480, "num_agent_steps_sampled": 648480, "num_agent_steps_trained": 648480}, "done": false, "episodes_total": 2282, "training_iteration": 424, "trial_id": "6192e_00000", "date": "2023-08-04_11-11-38", "timestamp": 1691136698, "time_this_iter_s": 11.360371351242065, "time_total_s": 4719.567304134369, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1349.1082804203033, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 20.293750000000003, "ram_util_percent": 65.44375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.0954956054687, "policy_loss": 328514.134375, "vf_loss": 20733726.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3593.0, "diff_num_grad_updates_vs_sampler_policy": 3592.0}}, "num_env_steps_sampled": 650640, "num_env_steps_trained": 650640, "num_agent_steps_sampled": 650640, "num_agent_steps_trained": 650640}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.030848183218, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349474537533594, "mean_inference_ms": 0.23455651408343958, "mean_action_processing_ms": 0.057196722511369646, "mean_env_wait_ms": 0.577584746633027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00249481201171875, "StateBufferConnector_ms": 0.0017237663269042969, "ViewRequirementAgentConnector_ms": 0.043561458587646484}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.030848183218, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.2707208282563, -3526.9855668868217, -3525.758791301368, -3528.79408316413, -3527.4960669058164, -3526.986642673977, -3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349474537533594, "mean_inference_ms": 0.23455651408343958, "mean_action_processing_ms": 0.057196722511369646, "mean_env_wait_ms": 0.577584746633027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00249481201171875, "StateBufferConnector_ms": 0.0017237663269042969, "ViewRequirementAgentConnector_ms": 0.043561458587646484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 650640, "num_agent_steps_trained": 650640, "num_env_steps_sampled": 650640, "num_env_steps_trained": 650640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.0295716931421, "num_env_steps_trained_throughput_per_sec": 191.0295716931421, "timesteps_total": 650640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 650640, "timers": {"training_iteration_time_ms": 1888.947, "sample_time_ms": 1881.823, "load_time_ms": 0.216, "load_throughput": 1669190.184, "learn_time_ms": 6.382, "learn_throughput": 56405.379, "synch_weights_time_ms": 0.493}, "counters": {"num_env_steps_sampled": 650640, "num_env_steps_trained": 650640, "num_agent_steps_sampled": 650640, "num_agent_steps_trained": 650640}, "done": false, "episodes_total": 2288, "training_iteration": 425, "trial_id": "6192e_00000", "date": "2023-08-04_11-11-49", "timestamp": 1691136709, "time_this_iter_s": 11.309414863586426, "time_total_s": 4730.876718997955, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1360.4176952838898, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 19.081249999999997, "ram_util_percent": 65.50625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.20958251953124, "policy_loss": -2884599.1, "vf_loss": 20741717.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3623.0, "diff_num_grad_updates_vs_sampler_policy": 3622.0}}, "num_env_steps_sampled": 652800, "num_env_steps_trained": 652800, "num_agent_steps_sampled": 652800, "num_agent_steps_trained": 652800}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3526.995716914869, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349599453235711, "mean_inference_ms": 0.23455606725997682, "mean_action_processing_ms": 0.05719607505915082, "mean_env_wait_ms": 0.577486840107847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024962425231933594, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.04356551170349121}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3526.995716914869, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.976955891301, -3526.253543784469, -3527.8021287522884, -3526.5534060904024, -3527.379199755187, -3526.705379295594, -3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349599453235711, "mean_inference_ms": 0.23455606725997682, "mean_action_processing_ms": 0.05719607505915082, "mean_env_wait_ms": 0.577486840107847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024962425231933594, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.04356551170349121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652800, "num_agent_steps_trained": 652800, "num_env_steps_sampled": 652800, "num_env_steps_trained": 652800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.07453835884021, "num_env_steps_trained_throughput_per_sec": 190.07453835884021, "timesteps_total": 652800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 652800, "timers": {"training_iteration_time_ms": 1889.606, "sample_time_ms": 1882.357, "load_time_ms": 0.215, "load_throughput": 1675115.864, "learn_time_ms": 6.478, "learn_throughput": 55573.528, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 652800, "num_env_steps_trained": 652800, "num_agent_steps_sampled": 652800, "num_agent_steps_trained": 652800}, "done": false, "episodes_total": 2294, "training_iteration": 426, "trial_id": "6192e_00000", "date": "2023-08-04_11-12-00", "timestamp": 1691136720, "time_this_iter_s": 11.366054058074951, "time_total_s": 4742.24277305603, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1371.7837493419647, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 19.56875, "ram_util_percent": 65.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.4198852539063, "policy_loss": -4562285.403125, "vf_loss": 20752520.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3653.0, "diff_num_grad_updates_vs_sampler_policy": 3652.0}}, "num_env_steps_sampled": 654960, "num_env_steps_trained": 654960, "num_agent_steps_sampled": 654960, "num_agent_steps_trained": 654960}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3526.9965849938726, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349710064025292, "mean_inference_ms": 0.2345553029936619, "mean_action_processing_ms": 0.057195419770917744, "mean_env_wait_ms": 0.5773942800628202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024929046630859375, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.04364800453186035}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3526.9965849938726, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.4982296147837, -3528.4779843375427, -3525.8290406852248, -3526.243587590428, -3534.01674956823, -3526.478994967875, -3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349710064025292, "mean_inference_ms": 0.2345553029936619, "mean_action_processing_ms": 0.057195419770917744, "mean_env_wait_ms": 0.5773942800628202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024929046630859375, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.04364800453186035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 654960, "num_agent_steps_trained": 654960, "num_env_steps_sampled": 654960, "num_env_steps_trained": 654960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.607547819323, "num_env_steps_trained_throughput_per_sec": 190.607547819323, "timesteps_total": 654960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 654960, "timers": {"training_iteration_time_ms": 1890.726, "sample_time_ms": 1883.532, "load_time_ms": 0.214, "load_throughput": 1681832.747, "learn_time_ms": 6.42, "learn_throughput": 56076.915, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 654960, "num_env_steps_trained": 654960, "num_agent_steps_sampled": 654960, "num_agent_steps_trained": 654960}, "done": false, "episodes_total": 2300, "training_iteration": 427, "trial_id": "6192e_00000", "date": "2023-08-04_11-12-12", "timestamp": 1691136732, "time_this_iter_s": 11.334172010421753, "time_total_s": 4753.576945066452, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1383.1179213523865, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 19.318749999999998, "ram_util_percent": 65.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.37302856445314, "policy_loss": -6029848.0375, "vf_loss": 20745302.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3683.0, "diff_num_grad_updates_vs_sampler_policy": 3682.0}}, "num_env_steps_sampled": 657120, "num_env_steps_trained": 657120, "num_agent_steps_sampled": 657120, "num_agent_steps_trained": 657120}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3526.9745990129068, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349811712467568, "mean_inference_ms": 0.2345546082617269, "mean_action_processing_ms": 0.05719471171436005, "mean_env_wait_ms": 0.5773098598774559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499103546142578, "StateBufferConnector_ms": 0.0017197132110595703, "ViewRequirementAgentConnector_ms": 0.04373359680175781}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3526.9745990129068, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.076755835596, -3525.7934940160403, -3526.76973045665, -3526.0975016195657, -3527.809715900875, -3527.3821653618893, -3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.349811712467568, "mean_inference_ms": 0.2345546082617269, "mean_action_processing_ms": 0.05719471171436005, "mean_env_wait_ms": 0.5773098598774559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499103546142578, "StateBufferConnector_ms": 0.0017197132110595703, "ViewRequirementAgentConnector_ms": 0.04373359680175781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 657120, "num_agent_steps_trained": 657120, "num_env_steps_sampled": 657120, "num_env_steps_trained": 657120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.07340184037497, "num_env_steps_trained_throughput_per_sec": 190.07340184037497, "timesteps_total": 657120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 657120, "timers": {"training_iteration_time_ms": 1891.589, "sample_time_ms": 1884.483, "load_time_ms": 0.214, "load_throughput": 1679774.658, "learn_time_ms": 6.358, "learn_throughput": 56621.972, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 657120, "num_env_steps_trained": 657120, "num_agent_steps_sampled": 657120, "num_agent_steps_trained": 657120}, "done": false, "episodes_total": 2306, "training_iteration": 428, "trial_id": "6192e_00000", "date": "2023-08-04_11-12-23", "timestamp": 1691136743, "time_this_iter_s": 11.366241931915283, "time_total_s": 4764.943186998367, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1394.4841632843018, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 19.125, "ram_util_percent": 65.50625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.380419921875, "policy_loss": -11283441.41875, "vf_loss": 20762862.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3713.0, "diff_num_grad_updates_vs_sampler_policy": 3712.0}}, "num_env_steps_sampled": 659280, "num_env_steps_trained": 659280, "num_agent_steps_sampled": 659280, "num_agent_steps_trained": 659280}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0092604680817, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3499010367237485, "mean_inference_ms": 0.2345545393614379, "mean_action_processing_ms": 0.057194151391266004, "mean_env_wait_ms": 0.5772343965603974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002515554428100586, "StateBufferConnector_ms": 0.0017247200012207031, "ViewRequirementAgentConnector_ms": 0.043795108795166016}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0092604680817, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.0728535285025, -3526.9307416017455, -3525.978604150677, -3525.5867919048137, -3528.6431858986193, -3527.610458559056, -3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3499010367237485, "mean_inference_ms": 0.2345545393614379, "mean_action_processing_ms": 0.057194151391266004, "mean_env_wait_ms": 0.5772343965603974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002515554428100586, "StateBufferConnector_ms": 0.0017247200012207031, "ViewRequirementAgentConnector_ms": 0.043795108795166016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 659280, "num_agent_steps_trained": 659280, "num_env_steps_sampled": 659280, "num_env_steps_trained": 659280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.96531129846457, "num_env_steps_trained_throughput_per_sec": 189.96531129846457, "timesteps_total": 659280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 659280, "timers": {"training_iteration_time_ms": 1896.915, "sample_time_ms": 1889.835, "load_time_ms": 0.214, "load_throughput": 1679961.549, "learn_time_ms": 6.317, "learn_throughput": 56991.698, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 659280, "num_env_steps_trained": 659280, "num_agent_steps_sampled": 659280, "num_agent_steps_trained": 659280}, "done": false, "episodes_total": 2312, "training_iteration": 429, "trial_id": "6192e_00000", "date": "2023-08-04_11-12-35", "timestamp": 1691136755, "time_this_iter_s": 11.372545003890991, "time_total_s": 4776.315732002258, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1405.8567082881927, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 19.475, "ram_util_percent": 65.76875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2647277832031, "policy_loss": -5207435.2125, "vf_loss": 20744128.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3743.0, "diff_num_grad_updates_vs_sampler_policy": 3742.0}}, "num_env_steps_sampled": 661440, "num_env_steps_trained": 661440, "num_agent_steps_sampled": 661440, "num_agent_steps_trained": 661440}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.042706227263, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34998527783469, "mean_inference_ms": 0.2345538720274378, "mean_action_processing_ms": 0.05719346847688115, "mean_env_wait_ms": 0.5771654914691056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025091171264648438, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.043776750564575195}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.042706227263, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.505903470342, -3527.534233527311, -3526.0803893372513, -3527.1154442363254, -3526.194349896345, -3525.9603473404068, -3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.34998527783469, "mean_inference_ms": 0.2345538720274378, "mean_action_processing_ms": 0.05719346847688115, "mean_env_wait_ms": 0.5771654914691056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025091171264648438, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.043776750564575195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 661440, "num_agent_steps_trained": 661440, "num_env_steps_sampled": 661440, "num_env_steps_trained": 661440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.89025715292448, "num_env_steps_trained_throughput_per_sec": 189.89025715292448, "timesteps_total": 661440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 661440, "timers": {"training_iteration_time_ms": 1895.521, "sample_time_ms": 1888.431, "load_time_ms": 0.215, "load_throughput": 1674372.854, "learn_time_ms": 6.325, "learn_throughput": 56918.01, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 661440, "num_env_steps_trained": 661440, "num_agent_steps_sampled": 661440, "num_agent_steps_trained": 661440}, "done": false, "episodes_total": 2318, "training_iteration": 430, "trial_id": "6192e_00000", "date": "2023-08-04_11-12-46", "timestamp": 1691136766, "time_this_iter_s": 11.3771390914917, "time_total_s": 4787.69287109375, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1417.2338473796844, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 19.11875, "ram_util_percent": 65.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2865051269531, "policy_loss": -5673959.959375, "vf_loss": 20752105.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.0, "diff_num_grad_updates_vs_sampler_policy": 3772.0}}, "num_env_steps_sampled": 663600, "num_env_steps_trained": 663600, "num_agent_steps_sampled": 663600, "num_agent_steps_trained": 663600}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.07912486898, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350066810527499, "mean_inference_ms": 0.23455301605697104, "mean_action_processing_ms": 0.057192711038166213, "mean_env_wait_ms": 0.5770981914984977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024976730346679688, "StateBufferConnector_ms": 0.0017244815826416016, "ViewRequirementAgentConnector_ms": 0.04372739791870117}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.07912486898, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.4320267755443, -3527.105848602241, -3525.9390211372415, -3526.2467659725335, -3526.502700771317, -3528.181235756889, -3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350066810527499, "mean_inference_ms": 0.23455301605697104, "mean_action_processing_ms": 0.057192711038166213, "mean_env_wait_ms": 0.5770981914984977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024976730346679688, "StateBufferConnector_ms": 0.0017244815826416016, "ViewRequirementAgentConnector_ms": 0.04372739791870117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 663600, "num_agent_steps_trained": 663600, "num_env_steps_sampled": 663600, "num_env_steps_trained": 663600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.2430888314202, "num_env_steps_trained_throughput_per_sec": 190.2430888314202, "timesteps_total": 663600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 663600, "timers": {"training_iteration_time_ms": 1892.447, "sample_time_ms": 1885.373, "load_time_ms": 0.222, "load_throughput": 1620639.09, "learn_time_ms": 6.31, "learn_throughput": 57052.855, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 663600, "num_env_steps_trained": 663600, "num_agent_steps_sampled": 663600, "num_agent_steps_trained": 663600}, "done": false, "episodes_total": 2324, "training_iteration": 431, "trial_id": "6192e_00000", "date": "2023-08-04_11-12-57", "timestamp": 1691136777, "time_this_iter_s": 11.356100082397461, "time_total_s": 4799.0489711761475, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1428.589947462082, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 19.41875, "ram_util_percent": 65.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.17429809570314, "policy_loss": -3646824.815625, "vf_loss": 20746000.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3803.0, "diff_num_grad_updates_vs_sampler_policy": 3802.0}}, "num_env_steps_sampled": 665760, "num_env_steps_trained": 665760, "num_agent_steps_sampled": 665760, "num_agent_steps_trained": 665760}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.066071433951, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350146001567836, "mean_inference_ms": 0.23455226747194888, "mean_action_processing_ms": 0.0571920099410322, "mean_env_wait_ms": 0.57703147904643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498626708984375, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.04366135597229004}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.066071433951, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.489122241123, -3526.883810294544, -3527.232045673453, -3526.8116407778193, -3527.0575029463766, -3525.578462713374, -3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350146001567836, "mean_inference_ms": 0.23455226747194888, "mean_action_processing_ms": 0.0571920099410322, "mean_env_wait_ms": 0.57703147904643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498626708984375, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.04366135597229004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 665760, "num_agent_steps_trained": 665760, "num_env_steps_sampled": 665760, "num_env_steps_trained": 665760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.6884559447138, "num_env_steps_trained_throughput_per_sec": 190.6884559447138, "timesteps_total": 665760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 665760, "timers": {"training_iteration_time_ms": 1892.262, "sample_time_ms": 1885.168, "load_time_ms": 0.223, "load_throughput": 1617340.874, "learn_time_ms": 6.332, "learn_throughput": 56853.075, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 665760, "num_env_steps_trained": 665760, "num_agent_steps_sampled": 665760, "num_agent_steps_trained": 665760}, "done": false, "episodes_total": 2330, "training_iteration": 432, "trial_id": "6192e_00000", "date": "2023-08-04_11-13-09", "timestamp": 1691136789, "time_this_iter_s": 11.32939100265503, "time_total_s": 4810.3783621788025, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1439.919338464737, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 27.9375, "ram_util_percent": 65.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3472900390625, "policy_loss": -4539582.009375, "vf_loss": 20747492.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3833.0, "diff_num_grad_updates_vs_sampler_policy": 3832.0}}, "num_env_steps_sampled": 667920, "num_env_steps_trained": 667920, "num_agent_steps_sampled": 667920, "num_agent_steps_trained": 667920}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.095529661216, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350227969852555, "mean_inference_ms": 0.23455208341317305, "mean_action_processing_ms": 0.05719143411647071, "mean_env_wait_ms": 0.576967493653311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024988651275634766, "StateBufferConnector_ms": 0.0017299652099609375, "ViewRequirementAgentConnector_ms": 0.04364490509033203}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.095529661216, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6651552981534, -3527.933686591927, -3526.0807404129214, -3525.966815950101, -3527.7229002874515, -3526.2666914681813, -3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350227969852555, "mean_inference_ms": 0.23455208341317305, "mean_action_processing_ms": 0.05719143411647071, "mean_env_wait_ms": 0.576967493653311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024988651275634766, "StateBufferConnector_ms": 0.0017299652099609375, "ViewRequirementAgentConnector_ms": 0.04364490509033203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 667920, "num_agent_steps_trained": 667920, "num_env_steps_sampled": 667920, "num_env_steps_trained": 667920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.0780636464349, "num_env_steps_trained_throughput_per_sec": 190.0780636464349, "timesteps_total": 667920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 667920, "timers": {"training_iteration_time_ms": 1889.89, "sample_time_ms": 1882.831, "load_time_ms": 0.219, "load_throughput": 1643929.711, "learn_time_ms": 6.304, "learn_throughput": 57103.127, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 667920, "num_env_steps_trained": 667920, "num_agent_steps_sampled": 667920, "num_agent_steps_trained": 667920}, "done": false, "episodes_total": 2336, "training_iteration": 433, "trial_id": "6192e_00000", "date": "2023-08-04_11-13-20", "timestamp": 1691136800, "time_this_iter_s": 11.366097927093506, "time_total_s": 4821.744460105896, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1451.2854363918304, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 21.38125, "ram_util_percent": 65.26875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.20888061523436, "policy_loss": -1062343.86875, "vf_loss": 20732581.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3863.0, "diff_num_grad_updates_vs_sampler_policy": 3862.0}}, "num_env_steps_sampled": 670080, "num_env_steps_trained": 670080, "num_agent_steps_sampled": 670080, "num_agent_steps_trained": 670080}, "sampler_results": {"episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0724338526175, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350302224138483, "mean_inference_ms": 0.23455313188275206, "mean_action_processing_ms": 0.057191028939791, "mean_env_wait_ms": 0.5769058062348793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107860565185547, "StateBufferConnector_ms": 0.001741170883178711, "ViewRequirementAgentConnector_ms": 0.04371237754821777}}, "episode_reward_max": -3525.529256213293, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0724338526175, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5808010714013, -3527.1265369016155, -3527.718057191341, -3525.529256213293, -3525.9565189707405, -3526.9490724314624, -3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350302224138483, "mean_inference_ms": 0.23455313188275206, "mean_action_processing_ms": 0.057191028939791, "mean_env_wait_ms": 0.5769058062348793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107860565185547, "StateBufferConnector_ms": 0.001741170883178711, "ViewRequirementAgentConnector_ms": 0.04371237754821777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 670080, "num_agent_steps_trained": 670080, "num_env_steps_sampled": 670080, "num_env_steps_trained": 670080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.44159777274245, "num_env_steps_trained_throughput_per_sec": 190.44159777274245, "timesteps_total": 670080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 670080, "timers": {"training_iteration_time_ms": 1891.695, "sample_time_ms": 1884.543, "load_time_ms": 0.221, "load_throughput": 1625874.276, "learn_time_ms": 6.37, "learn_throughput": 56514.737, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 670080, "num_env_steps_trained": 670080, "num_agent_steps_sampled": 670080, "num_agent_steps_trained": 670080}, "done": false, "episodes_total": 2342, "training_iteration": 434, "trial_id": "6192e_00000", "date": "2023-08-04_11-13-31", "timestamp": 1691136811, "time_this_iter_s": 11.344259262084961, "time_total_s": 4833.088719367981, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1462.6296956539154, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 18.082352941176474, "ram_util_percent": 65.16470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3393249511719, "policy_loss": -5936988.8375, "vf_loss": 20769026.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3893.0, "diff_num_grad_updates_vs_sampler_policy": 3892.0}}, "num_env_steps_sampled": 672240, "num_env_steps_trained": 672240, "num_agent_steps_sampled": 672240, "num_agent_steps_trained": 672240}, "sampler_results": {"episode_reward_max": -3525.5867813616414, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0697867806134, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350371525976588, "mean_inference_ms": 0.23455380237926918, "mean_action_processing_ms": 0.057190498311412895, "mean_env_wait_ms": 0.5768444921288554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107860565185547, "StateBufferConnector_ms": 0.001749277114868164, "ViewRequirementAgentConnector_ms": 0.04366946220397949}}, "episode_reward_max": -3525.5867813616414, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0697867806134, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.2443075119677, -3527.514850520096, -3527.2230939138844, -3526.2238825928425, -3526.255176739946, -3528.4374347638213, -3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350371525976588, "mean_inference_ms": 0.23455380237926918, "mean_action_processing_ms": 0.057190498311412895, "mean_env_wait_ms": 0.5768444921288554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107860565185547, "StateBufferConnector_ms": 0.001749277114868164, "ViewRequirementAgentConnector_ms": 0.04366946220397949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672240, "num_agent_steps_trained": 672240, "num_env_steps_sampled": 672240, "num_env_steps_trained": 672240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.44505662177878, "num_env_steps_trained_throughput_per_sec": 190.44505662177878, "timesteps_total": 672240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 672240, "timers": {"training_iteration_time_ms": 1890.623, "sample_time_ms": 1883.522, "load_time_ms": 0.216, "load_throughput": 1662939.912, "learn_time_ms": 6.341, "learn_throughput": 56770.139, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 672240, "num_env_steps_trained": 672240, "num_agent_steps_sampled": 672240, "num_agent_steps_trained": 672240}, "done": false, "episodes_total": 2348, "training_iteration": 435, "trial_id": "6192e_00000", "date": "2023-08-04_11-13-43", "timestamp": 1691136823, "time_this_iter_s": 11.343955039978027, "time_total_s": 4844.432674407959, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1473.9736506938934, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 19.381249999999998, "ram_util_percent": 65.15625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.138427734375, "policy_loss": 314907.478125, "vf_loss": 20728546.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3923.0, "diff_num_grad_updates_vs_sampler_policy": 3922.0}}, "num_env_steps_sampled": 674400, "num_env_steps_trained": 674400, "num_agent_steps_sampled": 674400, "num_agent_steps_trained": 674400}, "sampler_results": {"episode_reward_max": -3525.5359111078847, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.053324975216, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350440918842934, "mean_inference_ms": 0.23455511343681143, "mean_action_processing_ms": 0.05719006011440433, "mean_env_wait_ms": 0.5767786502178133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505779266357422, "StateBufferConnector_ms": 0.0017592906951904297, "ViewRequirementAgentConnector_ms": 0.0437159538269043}}, "episode_reward_max": -3525.5359111078847, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.053324975216, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3533.950027510046, -3526.0474492719895, -3526.637669001329, -3526.724837632136, -3526.5671719516567, -3526.828020656456, -3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350440918842934, "mean_inference_ms": 0.23455511343681143, "mean_action_processing_ms": 0.05719006011440433, "mean_env_wait_ms": 0.5767786502178133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505779266357422, "StateBufferConnector_ms": 0.0017592906951904297, "ViewRequirementAgentConnector_ms": 0.0437159538269043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 674400, "num_agent_steps_trained": 674400, "num_env_steps_sampled": 674400, "num_env_steps_trained": 674400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.15579675459512, "num_env_steps_trained_throughput_per_sec": 190.15579675459512, "timesteps_total": 674400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 674400, "timers": {"training_iteration_time_ms": 1892.814, "sample_time_ms": 1885.763, "load_time_ms": 0.218, "load_throughput": 1651120.219, "learn_time_ms": 6.298, "learn_throughput": 57158.464, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 674400, "num_env_steps_trained": 674400, "num_agent_steps_sampled": 674400, "num_agent_steps_trained": 674400}, "done": false, "episodes_total": 2354, "training_iteration": 436, "trial_id": "6192e_00000", "date": "2023-08-04_11-13-54", "timestamp": 1691136834, "time_this_iter_s": 11.361464977264404, "time_total_s": 4855.794139385223, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1485.3351156711578, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 19.225, "ram_util_percent": 65.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2219970703125, "policy_loss": -2158469.78125, "vf_loss": 20743140.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3953.0, "diff_num_grad_updates_vs_sampler_policy": 3952.0}}, "num_env_steps_sampled": 676560, "num_env_steps_trained": 676560, "num_agent_steps_sampled": 676560, "num_agent_steps_trained": 676560}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0148462627126, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35050537076813, "mean_inference_ms": 0.23455637029134244, "mean_action_processing_ms": 0.057189577592712926, "mean_env_wait_ms": 0.5767161790020388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002501249313354492, "StateBufferConnector_ms": 0.0017559528350830078, "ViewRequirementAgentConnector_ms": 0.043738365173339844}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3534.138203342418, "episode_reward_mean": -3527.0148462627126, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.7531469376736, -3534.138203342418, -3525.5867831200094, -3527.055506633768, -3526.916751965038, -3526.7249634734135, -3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35050537076813, "mean_inference_ms": 0.23455637029134244, "mean_action_processing_ms": 0.057189577592712926, "mean_env_wait_ms": 0.5767161790020388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002501249313354492, "StateBufferConnector_ms": 0.0017559528350830078, "ViewRequirementAgentConnector_ms": 0.043738365173339844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 676560, "num_agent_steps_trained": 676560, "num_env_steps_sampled": 676560, "num_env_steps_trained": 676560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.9435813031979, "num_env_steps_trained_throughput_per_sec": 189.9435813031979, "timesteps_total": 676560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 676560, "timers": {"training_iteration_time_ms": 1896.161, "sample_time_ms": 1889.1, "load_time_ms": 0.217, "load_throughput": 1658556.063, "learn_time_ms": 6.304, "learn_throughput": 57108.958, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 676560, "num_env_steps_trained": 676560, "num_agent_steps_sampled": 676560, "num_agent_steps_trained": 676560}, "done": false, "episodes_total": 2360, "training_iteration": 437, "trial_id": "6192e_00000", "date": "2023-08-04_11-14-06", "timestamp": 1691136846, "time_this_iter_s": 11.37386965751648, "time_total_s": 4867.16800904274, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1496.7089853286743, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 19.73125, "ram_util_percent": 65.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.246630859375, "policy_loss": -6838031.84375, "vf_loss": 20750337.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3983.0, "diff_num_grad_updates_vs_sampler_policy": 3982.0}}, "num_env_steps_sampled": 678720, "num_env_steps_trained": 678720, "num_agent_steps_sampled": 678720, "num_agent_steps_trained": 678720}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.1050029701432, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350563364433197, "mean_inference_ms": 0.23455764177597324, "mean_action_processing_ms": 0.05718913219140866, "mean_env_wait_ms": 0.5766619584677306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024979114532470703, "StateBufferConnector_ms": 0.0017561912536621094, "ViewRequirementAgentConnector_ms": 0.0438077449798584}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.1050029701432, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.626781860541, -3527.794474171176, -3525.933706888063, -3525.586783113894, -3527.644962341077, -3528.901761105585, -3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350563364433197, "mean_inference_ms": 0.23455764177597324, "mean_action_processing_ms": 0.05718913219140866, "mean_env_wait_ms": 0.5766619584677306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024979114532470703, "StateBufferConnector_ms": 0.0017561912536621094, "ViewRequirementAgentConnector_ms": 0.0438077449798584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 678720, "num_agent_steps_trained": 678720, "num_env_steps_sampled": 678720, "num_env_steps_trained": 678720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.12571172040023, "num_env_steps_trained_throughput_per_sec": 190.12571172040023, "timesteps_total": 678720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 678720, "timers": {"training_iteration_time_ms": 1892.888, "sample_time_ms": 1885.787, "load_time_ms": 0.217, "load_throughput": 1657463.71, "learn_time_ms": 6.337, "learn_throughput": 56806.019, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 678720, "num_env_steps_trained": 678720, "num_agent_steps_sampled": 678720, "num_agent_steps_trained": 678720}, "done": false, "episodes_total": 2366, "training_iteration": 438, "trial_id": "6192e_00000", "date": "2023-08-04_11-14-17", "timestamp": 1691136857, "time_this_iter_s": 11.362937211990356, "time_total_s": 4878.53094625473, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1508.0719225406647, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 19.8125, "ram_util_percent": 65.24375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2788818359375, "policy_loss": -1284819.753125, "vf_loss": 20728058.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4013.0, "diff_num_grad_updates_vs_sampler_policy": 4012.0}}, "num_env_steps_sampled": 680880, "num_env_steps_trained": 680880, "num_agent_steps_sampled": 680880, "num_agent_steps_trained": 680880}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.097756350981, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35061707129093, "mean_inference_ms": 0.23455978695113622, "mean_action_processing_ms": 0.05718879801849141, "mean_env_wait_ms": 0.5766086578213734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024967193603515625, "StateBufferConnector_ms": 0.0017464160919189453, "ViewRequirementAgentConnector_ms": 0.043747901916503906}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.097756350981, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.645505962205, -3527.0448569988257, -3526.0212640776526, -3527.6642746666835, -3527.0944407534625, -3526.726836053135, -3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35061707129093, "mean_inference_ms": 0.23455978695113622, "mean_action_processing_ms": 0.05718879801849141, "mean_env_wait_ms": 0.5766086578213734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024967193603515625, "StateBufferConnector_ms": 0.0017464160919189453, "ViewRequirementAgentConnector_ms": 0.043747901916503906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680880, "num_agent_steps_trained": 680880, "num_env_steps_sampled": 680880, "num_env_steps_trained": 680880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.48205895377444, "num_env_steps_trained_throughput_per_sec": 190.48205895377444, "timesteps_total": 680880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 680880, "timers": {"training_iteration_time_ms": 1893.254, "sample_time_ms": 1886.138, "load_time_ms": 0.218, "load_throughput": 1651662.043, "learn_time_ms": 6.354, "learn_throughput": 56654.689, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 680880, "num_env_steps_trained": 680880, "num_agent_steps_sampled": 680880, "num_agent_steps_trained": 680880}, "done": false, "episodes_total": 2372, "training_iteration": 439, "trial_id": "6192e_00000", "date": "2023-08-04_11-14-28", "timestamp": 1691136868, "time_this_iter_s": 11.34170913696289, "time_total_s": 4889.872655391693, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1519.4136316776276, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 21.45625, "ram_util_percent": 65.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.28724365234376, "policy_loss": -1469159.934375, "vf_loss": 20740508.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4043.0, "diff_num_grad_updates_vs_sampler_policy": 4042.0}}, "num_env_steps_sampled": 683040, "num_env_steps_trained": 683040, "num_agent_steps_sampled": 683040, "num_agent_steps_trained": 683040}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.10780285637, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350667486471731, "mean_inference_ms": 0.23456193990923882, "mean_action_processing_ms": 0.057188419629603526, "mean_env_wait_ms": 0.5765555331903418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025093555450439453, "StateBufferConnector_ms": 0.0017409324645996094, "ViewRequirementAgentConnector_ms": 0.04372811317443848}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.10780285637, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.9893767029102, -3526.42922545785, -3526.2098970856873, -3526.678448749475, -3525.9835926726096, -3526.505551959264, -3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350667486471731, "mean_inference_ms": 0.23456193990923882, "mean_action_processing_ms": 0.057188419629603526, "mean_env_wait_ms": 0.5765555331903418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025093555450439453, "StateBufferConnector_ms": 0.0017409324645996094, "ViewRequirementAgentConnector_ms": 0.04372811317443848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 683040, "num_agent_steps_trained": 683040, "num_env_steps_sampled": 683040, "num_env_steps_trained": 683040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.59446742956516, "num_env_steps_trained_throughput_per_sec": 190.59446742956516, "timesteps_total": 683040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 683040, "timers": {"training_iteration_time_ms": 1888.744, "sample_time_ms": 1881.689, "load_time_ms": 0.215, "load_throughput": 1671407.394, "learn_time_ms": 6.304, "learn_throughput": 57108.526, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 683040, "num_env_steps_trained": 683040, "num_agent_steps_sampled": 683040, "num_agent_steps_trained": 683040}, "done": false, "episodes_total": 2378, "training_iteration": 440, "trial_id": "6192e_00000", "date": "2023-08-04_11-14-40", "timestamp": 1691136880, "time_this_iter_s": 11.335108995437622, "time_total_s": 4901.207764387131, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1530.7487406730652, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 19.425, "ram_util_percent": 65.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.19549560546875, "policy_loss": -4502927.8875, "vf_loss": 20741231.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4073.0, "diff_num_grad_updates_vs_sampler_policy": 4072.0}}, "num_env_steps_sampled": 685200, "num_env_steps_trained": 685200, "num_agent_steps_sampled": 685200, "num_agent_steps_trained": 685200}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.154859226427, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350712987950547, "mean_inference_ms": 0.2345644339047358, "mean_action_processing_ms": 0.057188111402579865, "mean_env_wait_ms": 0.5765075282338162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025136470794677734, "StateBufferConnector_ms": 0.0017466545104980469, "ViewRequirementAgentConnector_ms": 0.04373669624328613}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.154859226427, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.808732734233, -3525.8873235277174, -3526.487019937211, -3525.9845687773213, -3526.721795528271, -3526.481275860637, -3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350712987950547, "mean_inference_ms": 0.2345644339047358, "mean_action_processing_ms": 0.057188111402579865, "mean_env_wait_ms": 0.5765075282338162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025136470794677734, "StateBufferConnector_ms": 0.0017466545104980469, "ViewRequirementAgentConnector_ms": 0.04373669624328613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 685200, "num_agent_steps_trained": 685200, "num_env_steps_sampled": 685200, "num_env_steps_trained": 685200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.42661888381926, "num_env_steps_trained_throughput_per_sec": 190.42661888381926, "timesteps_total": 685200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 685200, "timers": {"training_iteration_time_ms": 1889.298, "sample_time_ms": 1882.308, "load_time_ms": 0.217, "load_throughput": 1660562.455, "learn_time_ms": 6.246, "learn_throughput": 57638.918, "synch_weights_time_ms": 0.496}, "counters": {"num_env_steps_sampled": 685200, "num_env_steps_trained": 685200, "num_agent_steps_sampled": 685200, "num_agent_steps_trained": 685200}, "done": false, "episodes_total": 2384, "training_iteration": 441, "trial_id": "6192e_00000", "date": "2023-08-04_11-14-51", "timestamp": 1691136891, "time_this_iter_s": 11.34504508972168, "time_total_s": 4912.552809476852, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1542.0937857627869, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 19.7, "ram_util_percent": 65.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.40810546875, "policy_loss": -7610340.05, "vf_loss": 20765907.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4103.0, "diff_num_grad_updates_vs_sampler_policy": 4102.0}}, "num_env_steps_sampled": 687360, "num_env_steps_trained": 687360, "num_agent_steps_sampled": 687360, "num_agent_steps_trained": 687360}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.253599870025, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350761815121853, "mean_inference_ms": 0.2345670104151506, "mean_action_processing_ms": 0.05718779214945892, "mean_env_wait_ms": 0.5764634227880261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519845962524414, "StateBufferConnector_ms": 0.0017533302307128906, "ViewRequirementAgentConnector_ms": 0.043740034103393555}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.253599870025, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5187783196475, -3526.2943829593323, -3528.3048134758023, -3526.457698781749, -3526.4880907185143, -3526.4540851647757, -3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350761815121853, "mean_inference_ms": 0.2345670104151506, "mean_action_processing_ms": 0.05718779214945892, "mean_env_wait_ms": 0.5764634227880261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519845962524414, "StateBufferConnector_ms": 0.0017533302307128906, "ViewRequirementAgentConnector_ms": 0.043740034103393555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 687360, "num_agent_steps_trained": 687360, "num_env_steps_sampled": 687360, "num_env_steps_trained": 687360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.15803585442777, "num_env_steps_trained_throughput_per_sec": 190.15803585442777, "timesteps_total": 687360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 687360, "timers": {"training_iteration_time_ms": 1891.666, "sample_time_ms": 1884.552, "load_time_ms": 0.219, "load_throughput": 1641963.288, "learn_time_ms": 6.342, "learn_throughput": 56766.937, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 687360, "num_env_steps_trained": 687360, "num_agent_steps_sampled": 687360, "num_agent_steps_trained": 687360}, "done": false, "episodes_total": 2390, "training_iteration": 442, "trial_id": "6192e_00000", "date": "2023-08-04_11-15-02", "timestamp": 1691136902, "time_this_iter_s": 11.361071109771729, "time_total_s": 4923.913880586624, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1553.4548568725586, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 20.4375, "ram_util_percent": 65.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.27056884765625, "policy_loss": -2689965.990625, "vf_loss": 20758409.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4133.0, "diff_num_grad_updates_vs_sampler_policy": 4132.0}}, "num_env_steps_sampled": 689520, "num_env_steps_trained": 689520, "num_agent_steps_sampled": 689520, "num_agent_steps_trained": 689520}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.3007662161817, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350816876085213, "mean_inference_ms": 0.2345696823002971, "mean_action_processing_ms": 0.05718750924258389, "mean_env_wait_ms": 0.5764247237461921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025224685668945312, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.04373908042907715}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.3007662161817, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.2371523512443, -3526.2062458777987, -3528.1747090798413, -3527.1971382774464, -3527.1280707583883, -3526.307380081209, -3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350816876085213, "mean_inference_ms": 0.2345696823002971, "mean_action_processing_ms": 0.05718750924258389, "mean_env_wait_ms": 0.5764247237461921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025224685668945312, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.04373908042907715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 689520, "num_agent_steps_trained": 689520, "num_env_steps_sampled": 689520, "num_env_steps_trained": 689520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.25338668368585, "num_env_steps_trained_throughput_per_sec": 189.25338668368585, "timesteps_total": 689520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 689520, "timers": {"training_iteration_time_ms": 1897.873, "sample_time_ms": 1890.655, "load_time_ms": 0.222, "load_throughput": 1621857.615, "learn_time_ms": 6.441, "learn_throughput": 55889.071, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 689520, "num_env_steps_trained": 689520, "num_agent_steps_sampled": 689520, "num_agent_steps_trained": 689520}, "done": false, "episodes_total": 2396, "training_iteration": 443, "trial_id": "6192e_00000", "date": "2023-08-04_11-15-14", "timestamp": 1691136914, "time_this_iter_s": 11.415544986724854, "time_total_s": 4935.329425573349, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1564.8704018592834, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 19.0125, "ram_util_percent": 65.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1456604003906, "policy_loss": 39956.1, "vf_loss": 20729393.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4163.0, "diff_num_grad_updates_vs_sampler_policy": 4162.0}}, "num_env_steps_sampled": 691680, "num_env_steps_trained": 691680, "num_agent_steps_sampled": 691680, "num_agent_steps_trained": 691680}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.3238519592915, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350880911897449, "mean_inference_ms": 0.23457261033559604, "mean_action_processing_ms": 0.05718725948978258, "mean_env_wait_ms": 0.5763848096825105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002515077590942383, "StateBufferConnector_ms": 0.0017440319061279297, "ViewRequirementAgentConnector_ms": 0.04368305206298828}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.3238519592915, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.7482069227985, -3527.937347149603, -3527.98336999293, -3527.2416137624928, -3527.3610026850065, -3527.2431052286674, -3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350880911897449, "mean_inference_ms": 0.23457261033559604, "mean_action_processing_ms": 0.05718725948978258, "mean_env_wait_ms": 0.5763848096825105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002515077590942383, "StateBufferConnector_ms": 0.0017440319061279297, "ViewRequirementAgentConnector_ms": 0.04368305206298828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 691680, "num_agent_steps_trained": 691680, "num_env_steps_sampled": 691680, "num_env_steps_trained": 691680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.77154595004745, "num_env_steps_trained_throughput_per_sec": 189.77154595004745, "timesteps_total": 691680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 691680, "timers": {"training_iteration_time_ms": 1900.143, "sample_time_ms": 1892.951, "load_time_ms": 0.223, "load_throughput": 1616302.119, "learn_time_ms": 6.416, "learn_throughput": 56108.171, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 691680, "num_env_steps_trained": 691680, "num_agent_steps_sampled": 691680, "num_agent_steps_trained": 691680}, "done": false, "episodes_total": 2402, "training_iteration": 444, "trial_id": "6192e_00000", "date": "2023-08-04_11-15-25", "timestamp": 1691136925, "time_this_iter_s": 11.384168863296509, "time_total_s": 4946.7135944366455, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1576.25457072258, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 22.3875, "ram_util_percent": 65.34375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2947082519531, "policy_loss": -3468579.671875, "vf_loss": 20764249.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4193.0, "diff_num_grad_updates_vs_sampler_policy": 4192.0}}, "num_env_steps_sampled": 693840, "num_env_steps_trained": 693840, "num_agent_steps_sampled": 693840, "num_agent_steps_trained": 693840}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.2734182932054, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350947972185487, "mean_inference_ms": 0.2345761855341245, "mean_action_processing_ms": 0.057187079720419705, "mean_env_wait_ms": 0.5763394642824156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002512216567993164, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.04360556602478027}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.2734182932054, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.957667846164, -3527.147719738362, -3526.9867927839337, -3528.699220426069, -3527.084606805753, -3527.8649287214007, -3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350947972185487, "mean_inference_ms": 0.2345761855341245, "mean_action_processing_ms": 0.057187079720419705, "mean_env_wait_ms": 0.5763394642824156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002512216567993164, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.04360556602478027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 693840, "num_agent_steps_trained": 693840, "num_env_steps_sampled": 693840, "num_env_steps_trained": 693840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.09539289438237, "num_env_steps_trained_throughput_per_sec": 190.09539289438237, "timesteps_total": 693840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 693840, "timers": {"training_iteration_time_ms": 1895.597, "sample_time_ms": 1888.445, "load_time_ms": 0.219, "load_throughput": 1647157.674, "learn_time_ms": 6.381, "learn_throughput": 56414.863, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 693840, "num_env_steps_trained": 693840, "num_agent_steps_sampled": 693840, "num_agent_steps_trained": 693840}, "done": false, "episodes_total": 2408, "training_iteration": 445, "trial_id": "6192e_00000", "date": "2023-08-04_11-15-37", "timestamp": 1691136937, "time_this_iter_s": 11.36481785774231, "time_total_s": 4958.078412294388, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1587.6193885803223, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 19.258823529411764, "ram_util_percent": 65.33529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.24781494140626, "policy_loss": -4066855.1625, "vf_loss": 20736759.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4223.0, "diff_num_grad_updates_vs_sampler_policy": 4222.0}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.2599921192236, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351015781664345, "mean_inference_ms": 0.23457933680114496, "mean_action_processing_ms": 0.05718687055036369, "mean_env_wait_ms": 0.5762904582540298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025055408477783203, "StateBufferConnector_ms": 0.0017397403717041016, "ViewRequirementAgentConnector_ms": 0.04354214668273926}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.2599921192236, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.338027813851, -3527.6285218368116, -3527.495780459481, -3526.7553459241244, -3526.051808318472, -3525.586781673787, -3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351015781664345, "mean_inference_ms": 0.23457933680114496, "mean_action_processing_ms": 0.05718687055036369, "mean_env_wait_ms": 0.5762904582540298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025055408477783203, "StateBufferConnector_ms": 0.0017397403717041016, "ViewRequirementAgentConnector_ms": 0.04354214668273926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.14588308520388, "num_env_steps_trained_throughput_per_sec": 190.14588308520388, "timesteps_total": 696000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 1892.582, "sample_time_ms": 1885.443, "load_time_ms": 0.222, "load_throughput": 1619422.394, "learn_time_ms": 6.364, "learn_throughput": 56567.032, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2414, "training_iteration": 446, "trial_id": "6192e_00000", "date": "2023-08-04_11-15-48", "timestamp": 1691136948, "time_this_iter_s": 11.361696720123291, "time_total_s": 4969.440109014511, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1598.9810853004456, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 19.55625, "ram_util_percent": 65.29375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2359130859375, "policy_loss": -3378797.203125, "vf_loss": 20732640.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4253.0, "diff_num_grad_updates_vs_sampler_policy": 4252.0}}, "num_env_steps_sampled": 698160, "num_env_steps_trained": 698160, "num_agent_steps_sampled": 698160, "num_agent_steps_trained": 698160}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.2296210033805, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351084873903115, "mean_inference_ms": 0.2345820501343326, "mean_action_processing_ms": 0.05718667022617682, "mean_env_wait_ms": 0.5762359151542982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025224685668945312, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.043526649475097656}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.2296210033805, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.360025177412, -3526.5857619538892, -3528.7243069497217, -3527.723847906529, -3526.1543655956525, -3527.3498932131106, -3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351084873903115, "mean_inference_ms": 0.2345820501343326, "mean_action_processing_ms": 0.05718667022617682, "mean_env_wait_ms": 0.5762359151542982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025224685668945312, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.043526649475097656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 698160, "num_agent_steps_trained": 698160, "num_env_steps_sampled": 698160, "num_env_steps_trained": 698160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.33927830845323, "num_env_steps_trained_throughput_per_sec": 190.33927830845323, "timesteps_total": 698160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 698160, "timers": {"training_iteration_time_ms": 1893.837, "sample_time_ms": 1886.78, "load_time_ms": 0.224, "load_throughput": 1605987.492, "learn_time_ms": 6.301, "learn_throughput": 57134.89, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 698160, "num_env_steps_trained": 698160, "num_agent_steps_sampled": 698160, "num_agent_steps_trained": 698160}, "done": false, "episodes_total": 2420, "training_iteration": 447, "trial_id": "6192e_00000", "date": "2023-08-04_11-15-59", "timestamp": 1691136959, "time_this_iter_s": 11.350280046463013, "time_total_s": 4980.790389060974, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1610.3313653469086, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 20.299999999999997, "ram_util_percent": 65.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3860595703125, "policy_loss": -4267992.96875, "vf_loss": 20765838.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4283.0, "diff_num_grad_updates_vs_sampler_policy": 4282.0}}, "num_env_steps_sampled": 700320, "num_env_steps_trained": 700320, "num_agent_steps_sampled": 700320, "num_agent_steps_trained": 700320}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.203296825852, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351147035381578, "mean_inference_ms": 0.23458451338691405, "mean_action_processing_ms": 0.05718640095980529, "mean_env_wait_ms": 0.5761861025386625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002524852752685547, "StateBufferConnector_ms": 0.0017304420471191406, "ViewRequirementAgentConnector_ms": 0.04352068901062012}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.203296825852, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.0883032830397, -3526.917908161154, -3526.8075908444557, -3526.7841944154525, -3526.866547229611, -3526.701127373232, -3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351147035381578, "mean_inference_ms": 0.23458451338691405, "mean_action_processing_ms": 0.05718640095980529, "mean_env_wait_ms": 0.5761861025386625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002524852752685547, "StateBufferConnector_ms": 0.0017304420471191406, "ViewRequirementAgentConnector_ms": 0.04352068901062012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700320, "num_agent_steps_trained": 700320, "num_env_steps_sampled": 700320, "num_env_steps_trained": 700320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.60063848723496, "num_env_steps_trained_throughput_per_sec": 190.60063848723496, "timesteps_total": 700320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 700320, "timers": {"training_iteration_time_ms": 1890.48, "sample_time_ms": 1883.295, "load_time_ms": 0.231, "load_throughput": 1561155.335, "learn_time_ms": 6.392, "learn_throughput": 56323.533, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 700320, "num_env_steps_trained": 700320, "num_agent_steps_sampled": 700320, "num_agent_steps_trained": 700320}, "done": false, "episodes_total": 2426, "training_iteration": 448, "trial_id": "6192e_00000", "date": "2023-08-04_11-16-11", "timestamp": 1691136971, "time_this_iter_s": 11.334580183029175, "time_total_s": 4992.124969244003, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1621.6659455299377, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 19.7875, "ram_util_percent": 65.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.30352172851565, "policy_loss": -3533718.2828125, "vf_loss": 20749313.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4313.0, "diff_num_grad_updates_vs_sampler_policy": 4312.0}}, "num_env_steps_sampled": 702480, "num_env_steps_trained": 702480, "num_agent_steps_sampled": 702480, "num_agent_steps_trained": 702480}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.199483981753, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351205173546171, "mean_inference_ms": 0.2345863514991067, "mean_action_processing_ms": 0.057185996730356, "mean_env_wait_ms": 0.576142564275407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532482147216797, "StateBufferConnector_ms": 0.001728057861328125, "ViewRequirementAgentConnector_ms": 0.043520212173461914}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.199483981753, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.8464616919237, -3528.18754883121, -3527.9472934411883, -3527.4494288059022, -3527.73843970739, -3526.058535967346, -3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351205173546171, "mean_inference_ms": 0.2345863514991067, "mean_action_processing_ms": 0.057185996730356, "mean_env_wait_ms": 0.576142564275407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532482147216797, "StateBufferConnector_ms": 0.001728057861328125, "ViewRequirementAgentConnector_ms": 0.043520212173461914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702480, "num_agent_steps_trained": 702480, "num_env_steps_sampled": 702480, "num_env_steps_trained": 702480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.35957901304877, "num_env_steps_trained_throughput_per_sec": 190.35957901304877, "timesteps_total": 702480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 702480, "timers": {"training_iteration_time_ms": 1891.588, "sample_time_ms": 1884.463, "load_time_ms": 0.227, "load_throughput": 1583254.105, "learn_time_ms": 6.349, "learn_throughput": 56699.365, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 702480, "num_env_steps_trained": 702480, "num_agent_steps_sampled": 702480, "num_agent_steps_trained": 702480}, "done": false, "episodes_total": 2432, "training_iteration": 449, "trial_id": "6192e_00000", "date": "2023-08-04_11-16-22", "timestamp": 1691136982, "time_this_iter_s": 11.349165916442871, "time_total_s": 5003.474135160446, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1633.0151114463806, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 19.3375, "ram_util_percent": 65.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.24559326171874, "policy_loss": -3350612.075, "vf_loss": 20743043.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4343.0, "diff_num_grad_updates_vs_sampler_policy": 4342.0}}, "num_env_steps_sampled": 704640, "num_env_steps_trained": 704640, "num_agent_steps_sampled": 704640, "num_agent_steps_trained": 704640}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.152346282417, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3512680708094145, "mean_inference_ms": 0.23458806785058406, "mean_action_processing_ms": 0.05718556529034343, "mean_env_wait_ms": 0.5760970207200896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002534151077270508, "StateBufferConnector_ms": 0.0017228126525878906, "ViewRequirementAgentConnector_ms": 0.043492794036865234}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.152346282417, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6272483334765, -3525.793483184656, -3525.891242847678, -3526.21745910842, -3526.6245627650633, -3525.5867813616414, -3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3512680708094145, "mean_inference_ms": 0.23458806785058406, "mean_action_processing_ms": 0.05718556529034343, "mean_env_wait_ms": 0.5760970207200896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002534151077270508, "StateBufferConnector_ms": 0.0017228126525878906, "ViewRequirementAgentConnector_ms": 0.043492794036865234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704640, "num_agent_steps_trained": 704640, "num_env_steps_sampled": 704640, "num_env_steps_trained": 704640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.93888627009508, "num_env_steps_trained_throughput_per_sec": 189.93888627009508, "timesteps_total": 704640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 704640, "timers": {"training_iteration_time_ms": 1893.751, "sample_time_ms": 1886.636, "load_time_ms": 0.223, "load_throughput": 1611644.188, "learn_time_ms": 6.337, "learn_throughput": 56810.508, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 704640, "num_env_steps_trained": 704640, "num_agent_steps_sampled": 704640, "num_agent_steps_trained": 704640}, "done": false, "episodes_total": 2438, "training_iteration": 450, "trial_id": "6192e_00000", "date": "2023-08-04_11-16-33", "timestamp": 1691136993, "time_this_iter_s": 11.374215841293335, "time_total_s": 5014.8483510017395, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1644.389327287674, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 19.7625, "ram_util_percent": 65.54375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.52387084960935, "policy_loss": -13689358.60625, "vf_loss": 20779624.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4373.0, "diff_num_grad_updates_vs_sampler_policy": 4372.0}}, "num_env_steps_sampled": 706800, "num_env_steps_trained": 706800, "num_agent_steps_sampled": 706800, "num_agent_steps_trained": 706800}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.220486482662, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351327655146268, "mean_inference_ms": 0.23458881074038768, "mean_action_processing_ms": 0.05718497824488724, "mean_env_wait_ms": 0.5760544013754497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002533435821533203, "StateBufferConnector_ms": 0.0017158985137939453, "ViewRequirementAgentConnector_ms": 0.04341268539428711}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.220486482662, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.9524296894956, -3526.3698157605263, -3526.5622488517733, -3528.499697150963, -3526.420500375869, -3527.4470463796647, -3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351327655146268, "mean_inference_ms": 0.23458881074038768, "mean_action_processing_ms": 0.05718497824488724, "mean_env_wait_ms": 0.5760544013754497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002533435821533203, "StateBufferConnector_ms": 0.0017158985137939453, "ViewRequirementAgentConnector_ms": 0.04341268539428711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 706800, "num_agent_steps_trained": 706800, "num_env_steps_sampled": 706800, "num_env_steps_trained": 706800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.58887813547346, "num_env_steps_trained_throughput_per_sec": 190.58887813547346, "timesteps_total": 706800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 706800, "timers": {"training_iteration_time_ms": 1889.537, "sample_time_ms": 1882.378, "load_time_ms": 0.22, "load_throughput": 1640001.564, "learn_time_ms": 6.373, "learn_throughput": 56492.113, "synch_weights_time_ms": 0.534}, "counters": {"num_env_steps_sampled": 706800, "num_env_steps_trained": 706800, "num_agent_steps_sampled": 706800, "num_agent_steps_trained": 706800}, "done": false, "episodes_total": 2444, "training_iteration": 451, "trial_id": "6192e_00000", "date": "2023-08-04_11-16-45", "timestamp": 1691137005, "time_this_iter_s": 11.335620164871216, "time_total_s": 5026.183971166611, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1655.7249474525452, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 19.799999999999997, "ram_util_percent": 65.68125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.39784545898436, "policy_loss": -3899799.30625, "vf_loss": 20755194.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4403.0, "diff_num_grad_updates_vs_sampler_policy": 4402.0}}, "num_env_steps_sampled": 708960, "num_env_steps_trained": 708960, "num_agent_steps_sampled": 708960, "num_agent_steps_trained": 708960}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.2324281163806, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351391975963952, "mean_inference_ms": 0.23458910577522155, "mean_action_processing_ms": 0.05718438929626652, "mean_env_wait_ms": 0.5760112738417641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025339126586914062, "StateBufferConnector_ms": 0.0017123222351074219, "ViewRequirementAgentConnector_ms": 0.043381452560424805}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.2324281163806, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.9072368433094, -3527.0810166171054, -3526.8608541788963, -3525.5359111078847, -3528.6173306896026, -3527.494041263493, -3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351391975963952, "mean_inference_ms": 0.23458910577522155, "mean_action_processing_ms": 0.05718438929626652, "mean_env_wait_ms": 0.5760112738417641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025339126586914062, "StateBufferConnector_ms": 0.0017123222351074219, "ViewRequirementAgentConnector_ms": 0.043381452560424805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708960, "num_agent_steps_trained": 708960, "num_env_steps_sampled": 708960, "num_env_steps_trained": 708960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.99331750575888, "num_env_steps_trained_throughput_per_sec": 189.99331750575888, "timesteps_total": 708960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 708960, "timers": {"training_iteration_time_ms": 1892.937, "sample_time_ms": 1885.759, "load_time_ms": 0.217, "load_throughput": 1660014.776, "learn_time_ms": 6.404, "learn_throughput": 56211.356, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 708960, "num_env_steps_trained": 708960, "num_agent_steps_sampled": 708960, "num_agent_steps_trained": 708960}, "done": false, "episodes_total": 2450, "training_iteration": 452, "trial_id": "6192e_00000", "date": "2023-08-04_11-16-56", "timestamp": 1691137016, "time_this_iter_s": 11.370885848999023, "time_total_s": 5037.55485701561, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1667.0958333015442, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 22.53125, "ram_util_percent": 65.64375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1504638671875, "policy_loss": -399467.2375, "vf_loss": 20737684.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4433.0, "diff_num_grad_updates_vs_sampler_policy": 4432.0}}, "num_env_steps_sampled": 711120, "num_env_steps_trained": 711120, "num_agent_steps_sampled": 711120, "num_agent_steps_trained": 711120}, "sampler_results": {"episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.248694573874, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35145806140144, "mean_inference_ms": 0.23458844909170792, "mean_action_processing_ms": 0.05718366657825938, "mean_env_wait_ms": 0.5759749044688697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025246143341064453, "StateBufferConnector_ms": 0.0016994476318359375, "ViewRequirementAgentConnector_ms": 0.043227195739746094}}, "episode_reward_max": -3525.5061145297136, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.248694573874, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.920522431542, -3526.8109323572307, -3525.5061145297136, -3526.558363501726, -3526.9516142659013, -3533.3380003100515, -3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35145806140144, "mean_inference_ms": 0.23458844909170792, "mean_action_processing_ms": 0.05718366657825938, "mean_env_wait_ms": 0.5759749044688697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025246143341064453, "StateBufferConnector_ms": 0.0016994476318359375, "ViewRequirementAgentConnector_ms": 0.043227195739746094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 711120, "num_agent_steps_trained": 711120, "num_env_steps_sampled": 711120, "num_env_steps_trained": 711120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.38388828886283, "num_env_steps_trained_throughput_per_sec": 189.38388828886283, "timesteps_total": 711120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 711120, "timers": {"training_iteration_time_ms": 1898.92, "sample_time_ms": 1891.773, "load_time_ms": 0.218, "load_throughput": 1650217.967, "learn_time_ms": 6.386, "learn_throughput": 56368.95, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 711120, "num_env_steps_trained": 711120, "num_agent_steps_sampled": 711120, "num_agent_steps_trained": 711120}, "done": false, "episodes_total": 2456, "training_iteration": 453, "trial_id": "6192e_00000", "date": "2023-08-04_11-17-08", "timestamp": 1691137028, "time_this_iter_s": 11.407423973083496, "time_total_s": 5048.962280988693, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1678.5032572746277, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 18.6875, "ram_util_percent": 65.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2820129394531, "policy_loss": -6363522.5125, "vf_loss": 20746124.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4463.0, "diff_num_grad_updates_vs_sampler_policy": 4462.0}}, "num_env_steps_sampled": 713280, "num_env_steps_trained": 713280, "num_agent_steps_sampled": 713280, "num_agent_steps_trained": 713280}, "sampler_results": {"episode_reward_max": -3525.5336117911984, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.1912531313224, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351516669617499, "mean_inference_ms": 0.23458788912478593, "mean_action_processing_ms": 0.05718287926845813, "mean_env_wait_ms": 0.5759344420785564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002530336380004883, "StateBufferConnector_ms": 0.0016927719116210938, "ViewRequirementAgentConnector_ms": 0.043196916580200195}}, "episode_reward_max": -3525.5336117911984, "episode_reward_min": -3535.1640643196897, "episode_reward_mean": -3527.1912531313224, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.97215717468, -3527.565709517985, -3535.1640643196897, -3527.1994806271396, -3527.7140341838913, -3529.210767088522, -3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351516669617499, "mean_inference_ms": 0.23458788912478593, "mean_action_processing_ms": 0.05718287926845813, "mean_env_wait_ms": 0.5759344420785564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002530336380004883, "StateBufferConnector_ms": 0.0016927719116210938, "ViewRequirementAgentConnector_ms": 0.043196916580200195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 713280, "num_agent_steps_trained": 713280, "num_env_steps_sampled": 713280, "num_env_steps_trained": 713280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.98573314099204, "num_env_steps_trained_throughput_per_sec": 190.98573314099204, "timesteps_total": 713280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 713280, "timers": {"training_iteration_time_ms": 1890.753, "sample_time_ms": 1883.637, "load_time_ms": 0.221, "load_throughput": 1625349.236, "learn_time_ms": 6.356, "learn_throughput": 56643.425, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 713280, "num_env_steps_trained": 713280, "num_agent_steps_sampled": 713280, "num_agent_steps_trained": 713280}, "done": false, "episodes_total": 2462, "training_iteration": 454, "trial_id": "6192e_00000", "date": "2023-08-04_11-17-19", "timestamp": 1691137039, "time_this_iter_s": 11.311815738677979, "time_total_s": 5060.274096727371, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1689.8150730133057, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 18.68125, "ram_util_percent": 65.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.23113403320315, "policy_loss": -675833.59375, "vf_loss": 20747390.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4493.0, "diff_num_grad_updates_vs_sampler_policy": 4492.0}}, "num_env_steps_sampled": 715440, "num_env_steps_trained": 715440, "num_agent_steps_sampled": 715440, "num_agent_steps_trained": 715440}, "sampler_results": {"episode_reward_max": -3525.5336117911984, "episode_reward_min": -3533.2289860066735, "episode_reward_mean": -3527.0828076482685, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35157639327474, "mean_inference_ms": 0.23458784311626274, "mean_action_processing_ms": 0.057182099951696805, "mean_env_wait_ms": 0.5758957237023542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025284290313720703, "StateBufferConnector_ms": 0.001695394515991211, "ViewRequirementAgentConnector_ms": 0.04318571090698242}}, "episode_reward_max": -3525.5336117911984, "episode_reward_min": -3533.2289860066735, "episode_reward_mean": -3527.0828076482685, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.022767117502, -3525.9217422128127, -3525.7805057772016, -3526.113991184215, -3528.8133604502145, -3526.869663852006, -3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35157639327474, "mean_inference_ms": 0.23458784311626274, "mean_action_processing_ms": 0.057182099951696805, "mean_env_wait_ms": 0.5758957237023542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025284290313720703, "StateBufferConnector_ms": 0.001695394515991211, "ViewRequirementAgentConnector_ms": 0.04318571090698242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 715440, "num_agent_steps_trained": 715440, "num_env_steps_sampled": 715440, "num_env_steps_trained": 715440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.9328216981154, "num_env_steps_trained_throughput_per_sec": 189.9328216981154, "timesteps_total": 715440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 715440, "timers": {"training_iteration_time_ms": 1889.528, "sample_time_ms": 1882.407, "load_time_ms": 0.216, "load_throughput": 1666059.186, "learn_time_ms": 6.365, "learn_throughput": 56563.43, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 715440, "num_env_steps_trained": 715440, "num_agent_steps_sampled": 715440, "num_agent_steps_trained": 715440}, "done": false, "episodes_total": 2468, "training_iteration": 455, "trial_id": "6192e_00000", "date": "2023-08-04_11-17-30", "timestamp": 1691137050, "time_this_iter_s": 11.374482870101929, "time_total_s": 5071.648579597473, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1701.1895558834076, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 19.85, "ram_util_percent": 65.26875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.23402099609376, "policy_loss": -8112871.265625, "vf_loss": 20752840.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4523.0, "diff_num_grad_updates_vs_sampler_policy": 4522.0}}, "num_env_steps_sampled": 717600, "num_env_steps_trained": 717600, "num_agent_steps_sampled": 717600, "num_agent_steps_trained": 717600}, "sampler_results": {"episode_reward_max": -3525.5336117911984, "episode_reward_min": -3533.2289860066735, "episode_reward_mean": -3527.1221453567787, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351640014895713, "mean_inference_ms": 0.23458852678940623, "mean_action_processing_ms": 0.05718133896538701, "mean_env_wait_ms": 0.5758595077087566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025162696838378906, "StateBufferConnector_ms": 0.0016980171203613281, "ViewRequirementAgentConnector_ms": 0.043215274810791016}}, "episode_reward_max": -3525.5336117911984, "episode_reward_min": -3533.2289860066735, "episode_reward_mean": -3527.1221453567787, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.841473988761, -3526.6730219097412, -3525.977986071917, -3527.026322778181, -3526.5869938038763, -3527.8985715542062, -3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351640014895713, "mean_inference_ms": 0.23458852678940623, "mean_action_processing_ms": 0.05718133896538701, "mean_env_wait_ms": 0.5758595077087566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025162696838378906, "StateBufferConnector_ms": 0.0016980171203613281, "ViewRequirementAgentConnector_ms": 0.043215274810791016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 717600, "num_agent_steps_trained": 717600, "num_env_steps_sampled": 717600, "num_env_steps_trained": 717600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.88620153888428, "num_env_steps_trained_throughput_per_sec": 189.88620153888428, "timesteps_total": 717600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 717600, "timers": {"training_iteration_time_ms": 1896.614, "sample_time_ms": 1889.487, "load_time_ms": 0.215, "load_throughput": 1672332.972, "learn_time_ms": 6.347, "learn_throughput": 56722.368, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 717600, "num_env_steps_trained": 717600, "num_agent_steps_sampled": 717600, "num_agent_steps_trained": 717600}, "done": false, "episodes_total": 2474, "training_iteration": 456, "trial_id": "6192e_00000", "date": "2023-08-04_11-17-42", "timestamp": 1691137062, "time_this_iter_s": 11.377225875854492, "time_total_s": 5083.025805473328, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1712.566781759262, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 19.376470588235293, "ram_util_percent": 65.21764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.36908569335935, "policy_loss": -5244194.50625, "vf_loss": 20755669.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4553.0, "diff_num_grad_updates_vs_sampler_policy": 4552.0}}, "num_env_steps_sampled": 719760, "num_env_steps_trained": 719760, "num_agent_steps_sampled": 719760, "num_agent_steps_trained": 719760}, "sampler_results": {"episode_reward_max": -3525.5336117911984, "episode_reward_min": -3533.2289860066735, "episode_reward_mean": -3527.1263399339387, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351707435417738, "mean_inference_ms": 0.2345901418061904, "mean_action_processing_ms": 0.057180684370777286, "mean_env_wait_ms": 0.5758250743556502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002511262893676758, "StateBufferConnector_ms": 0.0017099380493164062, "ViewRequirementAgentConnector_ms": 0.04328656196594238}}, "episode_reward_max": -3525.5336117911984, "episode_reward_min": -3533.2289860066735, "episode_reward_mean": -3527.1263399339387, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.811348301138, -3528.6110198513197, -3527.172457013336, -3526.4213391096723, -3526.614934600463, -3526.9232632975386, -3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351707435417738, "mean_inference_ms": 0.2345901418061904, "mean_action_processing_ms": 0.057180684370777286, "mean_env_wait_ms": 0.5758250743556502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002511262893676758, "StateBufferConnector_ms": 0.0017099380493164062, "ViewRequirementAgentConnector_ms": 0.04328656196594238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 719760, "num_agent_steps_trained": 719760, "num_env_steps_sampled": 719760, "num_env_steps_trained": 719760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.9468309276754, "num_env_steps_trained_throughput_per_sec": 189.9468309276754, "timesteps_total": 719760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 719760, "timers": {"training_iteration_time_ms": 1895.754, "sample_time_ms": 1888.653, "load_time_ms": 0.216, "load_throughput": 1666243.037, "learn_time_ms": 6.34, "learn_throughput": 56781.24, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 719760, "num_env_steps_trained": 719760, "num_agent_steps_sampled": 719760, "num_agent_steps_trained": 719760}, "done": false, "episodes_total": 2480, "training_iteration": 457, "trial_id": "6192e_00000", "date": "2023-08-04_11-17-53", "timestamp": 1691137073, "time_this_iter_s": 11.373732089996338, "time_total_s": 5094.399537563324, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1723.9405138492584, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 18.88125, "ram_util_percent": 65.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3463500976562, "policy_loss": -3469278.28125, "vf_loss": 20762090.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4583.0, "diff_num_grad_updates_vs_sampler_policy": 4582.0}}, "num_env_steps_sampled": 721920, "num_env_steps_trained": 721920, "num_agent_steps_sampled": 721920, "num_agent_steps_trained": 721920}, "sampler_results": {"episode_reward_max": -3525.5336117911984, "episode_reward_min": -3533.2289860066735, "episode_reward_mean": -3527.1240580999224, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351776287020503, "mean_inference_ms": 0.23459326826195503, "mean_action_processing_ms": 0.05718028249015697, "mean_env_wait_ms": 0.5757933035465798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025038719177246094, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.043398141860961914}}, "episode_reward_max": -3525.5336117911984, "episode_reward_min": -3533.2289860066735, "episode_reward_mean": -3527.1240580999224, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3533.2289860066735, -3528.285641776303, -3526.10103643304, -3528.090918611094, -3527.435837614937, -3527.8969476065727, -3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351776287020503, "mean_inference_ms": 0.23459326826195503, "mean_action_processing_ms": 0.05718028249015697, "mean_env_wait_ms": 0.5757933035465798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025038719177246094, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.043398141860961914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 721920, "num_agent_steps_trained": 721920, "num_env_steps_sampled": 721920, "num_env_steps_trained": 721920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.78811960747234, "num_env_steps_trained_throughput_per_sec": 189.78811960747234, "timesteps_total": 721920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 721920, "timers": {"training_iteration_time_ms": 1894.975, "sample_time_ms": 1887.92, "load_time_ms": 0.216, "load_throughput": 1664773.363, "learn_time_ms": 6.296, "learn_throughput": 57177.944, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 721920, "num_env_steps_trained": 721920, "num_agent_steps_sampled": 721920, "num_agent_steps_trained": 721920}, "done": false, "episodes_total": 2486, "training_iteration": 458, "trial_id": "6192e_00000", "date": "2023-08-04_11-18-05", "timestamp": 1691137085, "time_this_iter_s": 11.383442878723145, "time_total_s": 5105.782980442047, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1735.3239567279816, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 20.049999999999997, "ram_util_percent": 65.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.309033203125, "policy_loss": -5266807.928125, "vf_loss": 20743183.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4613.0, "diff_num_grad_updates_vs_sampler_policy": 4612.0}}, "num_env_steps_sampled": 724080, "num_env_steps_trained": 724080, "num_agent_steps_sampled": 724080, "num_agent_steps_trained": 724080}, "sampler_results": {"episode_reward_max": -3525.5336117911984, "episode_reward_min": -3529.3647762870924, "episode_reward_mean": -3527.015787402478, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351834553304714, "mean_inference_ms": 0.23459621872806935, "mean_action_processing_ms": 0.05717986634104595, "mean_env_wait_ms": 0.5757595864077472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002497434616088867, "StateBufferConnector_ms": 0.001714468002319336, "ViewRequirementAgentConnector_ms": 0.04338860511779785}}, "episode_reward_max": -3525.5336117911984, "episode_reward_min": -3529.3647762870924, "episode_reward_mean": -3527.015787402478, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.3401763292213, -3527.329561654806, -3527.4605901739583, -3527.7713706559775, -3527.909732933039, -3526.2119526843167, -3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351834553304714, "mean_inference_ms": 0.23459621872806935, "mean_action_processing_ms": 0.05717986634104595, "mean_env_wait_ms": 0.5757595864077472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002497434616088867, "StateBufferConnector_ms": 0.001714468002319336, "ViewRequirementAgentConnector_ms": 0.04338860511779785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 724080, "num_agent_steps_trained": 724080, "num_env_steps_sampled": 724080, "num_env_steps_trained": 724080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.9844045261025, "num_env_steps_trained_throughput_per_sec": 190.9844045261025, "timesteps_total": 724080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 724080, "timers": {"training_iteration_time_ms": 1889.933, "sample_time_ms": 1882.889, "load_time_ms": 0.216, "load_throughput": 1668452.42, "learn_time_ms": 6.309, "learn_throughput": 57064.498, "synch_weights_time_ms": 0.488}, "counters": {"num_env_steps_sampled": 724080, "num_env_steps_trained": 724080, "num_agent_steps_sampled": 724080, "num_agent_steps_trained": 724080}, "done": false, "episodes_total": 2492, "training_iteration": 459, "trial_id": "6192e_00000", "date": "2023-08-04_11-18-16", "timestamp": 1691137096, "time_this_iter_s": 11.312041997909546, "time_total_s": 5117.095022439957, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1746.635998725891, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 18.9625, "ram_util_percent": 65.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2626098632812, "policy_loss": -4868737.39375, "vf_loss": 20740874.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4643.0, "diff_num_grad_updates_vs_sampler_policy": 4642.0}}, "num_env_steps_sampled": 726240, "num_env_steps_trained": 726240, "num_agent_steps_sampled": 726240, "num_agent_steps_trained": 726240}, "sampler_results": {"episode_reward_max": -3525.5336117911984, "episode_reward_min": -3529.446242455198, "episode_reward_mean": -3527.020224724705, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351887600334501, "mean_inference_ms": 0.23459977847250527, "mean_action_processing_ms": 0.05717959401344077, "mean_env_wait_ms": 0.575723136280657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025053024291992188, "StateBufferConnector_ms": 0.0017175674438476562, "ViewRequirementAgentConnector_ms": 0.04346489906311035}}, "episode_reward_max": -3525.5336117911984, "episode_reward_min": -3529.446242455198, "episode_reward_mean": -3527.020224724705, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.11463395283, -3529.217240011932, -3528.350311148239, -3525.755400006535, -3526.7232570272304, -3527.7061674870474, -3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351887600334501, "mean_inference_ms": 0.23459977847250527, "mean_action_processing_ms": 0.05717959401344077, "mean_env_wait_ms": 0.575723136280657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025053024291992188, "StateBufferConnector_ms": 0.0017175674438476562, "ViewRequirementAgentConnector_ms": 0.04346489906311035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 726240, "num_agent_steps_trained": 726240, "num_env_steps_sampled": 726240, "num_env_steps_trained": 726240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.97625385066033, "num_env_steps_trained_throughput_per_sec": 189.97625385066033, "timesteps_total": 726240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 726240, "timers": {"training_iteration_time_ms": 1889.941, "sample_time_ms": 1882.865, "load_time_ms": 0.216, "load_throughput": 1663306.279, "learn_time_ms": 6.327, "learn_throughput": 56895.062, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 726240, "num_env_steps_trained": 726240, "num_agent_steps_sampled": 726240, "num_agent_steps_trained": 726240}, "done": false, "episodes_total": 2498, "training_iteration": 460, "trial_id": "6192e_00000", "date": "2023-08-04_11-18-27", "timestamp": 1691137107, "time_this_iter_s": 11.371966123580933, "time_total_s": 5128.466988563538, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1758.007964849472, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 23.424999999999997, "ram_util_percent": 65.41875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3868835449219, "policy_loss": -9523365.9375, "vf_loss": 20741784.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4673.0, "diff_num_grad_updates_vs_sampler_policy": 4672.0}}, "num_env_steps_sampled": 728400, "num_env_steps_trained": 728400, "num_agent_steps_sampled": 728400, "num_agent_steps_trained": 728400}, "sampler_results": {"episode_reward_max": -3525.5336117911984, "episode_reward_min": -3529.446242455198, "episode_reward_mean": -3526.998302444853, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351934364428484, "mean_inference_ms": 0.23460290228034633, "mean_action_processing_ms": 0.057179294778576965, "mean_env_wait_ms": 0.5756887593038839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025069713592529297, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.04350733757019043}}, "episode_reward_max": -3525.5336117911984, "episode_reward_min": -3529.446242455198, "episode_reward_mean": -3526.998302444853, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.198529066438, -3526.096436721106, -3526.506375259239, -3528.2405135718514, -3527.213105654895, -3525.8387964615276, -3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351934364428484, "mean_inference_ms": 0.23460290228034633, "mean_action_processing_ms": 0.057179294778576965, "mean_env_wait_ms": 0.5756887593038839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025069713592529297, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.04350733757019043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728400, "num_agent_steps_trained": 728400, "num_env_steps_sampled": 728400, "num_env_steps_trained": 728400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.24554571651697, "num_env_steps_trained_throughput_per_sec": 190.24554571651697, "timesteps_total": 728400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 728400, "timers": {"training_iteration_time_ms": 1891.492, "sample_time_ms": 1884.373, "load_time_ms": 0.219, "load_throughput": 1641963.288, "learn_time_ms": 6.355, "learn_throughput": 56647.25, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 728400, "num_env_steps_trained": 728400, "num_agent_steps_sampled": 728400, "num_agent_steps_trained": 728400}, "done": false, "episodes_total": 2504, "training_iteration": 461, "trial_id": "6192e_00000", "date": "2023-08-04_11-18-39", "timestamp": 1691137119, "time_this_iter_s": 11.355762958526611, "time_total_s": 5139.822751522064, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1769.3637278079987, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 19.38125, "ram_util_percent": 65.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2146362304687, "policy_loss": -2214485.8625, "vf_loss": 20738605.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4703.0, "diff_num_grad_updates_vs_sampler_policy": 4702.0}}, "num_env_steps_sampled": 730560, "num_env_steps_trained": 730560, "num_agent_steps_sampled": 730560, "num_agent_steps_trained": 730560}, "sampler_results": {"episode_reward_max": -3525.5336117911984, "episode_reward_min": -3529.446242455198, "episode_reward_mean": -3527.0144124007197, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3519824264789815, "mean_inference_ms": 0.2346053308008849, "mean_action_processing_ms": 0.05717893025217898, "mean_env_wait_ms": 0.5756553251710746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025131702423095703, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.043570518493652344}}, "episode_reward_max": -3525.5336117911984, "episode_reward_min": -3529.446242455198, "episode_reward_mean": -3527.0144124007197, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.1826649556037, -3528.301418686505, -3528.620590298358, -3526.241742866573, -3526.541992548926, -3525.689331424509, -3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3519824264789815, "mean_inference_ms": 0.2346053308008849, "mean_action_processing_ms": 0.05717893025217898, "mean_env_wait_ms": 0.5756553251710746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025131702423095703, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.043570518493652344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 730560, "num_agent_steps_trained": 730560, "num_env_steps_sampled": 730560, "num_env_steps_trained": 730560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.97802262323978, "num_env_steps_trained_throughput_per_sec": 189.97802262323978, "timesteps_total": 730560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 730560, "timers": {"training_iteration_time_ms": 1893.339, "sample_time_ms": 1886.268, "load_time_ms": 0.215, "load_throughput": 1673630.503, "learn_time_ms": 6.32, "learn_throughput": 56958.805, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 730560, "num_env_steps_trained": 730560, "num_agent_steps_sampled": 730560, "num_agent_steps_trained": 730560}, "done": false, "episodes_total": 2510, "training_iteration": 462, "trial_id": "6192e_00000", "date": "2023-08-04_11-18-50", "timestamp": 1691137130, "time_this_iter_s": 11.371906995773315, "time_total_s": 5151.1946585178375, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1780.735634803772, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 19.325000000000003, "ram_util_percent": 65.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.0954895019531, "policy_loss": 328468.221875, "vf_loss": 20729244.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4733.0, "diff_num_grad_updates_vs_sampler_policy": 4732.0}}, "num_env_steps_sampled": 732720, "num_env_steps_trained": 732720, "num_agent_steps_sampled": 732720, "num_agent_steps_trained": 732720}, "sampler_results": {"episode_reward_max": -3525.5336117911984, "episode_reward_min": -3529.446242455198, "episode_reward_mean": -3526.978788209537, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352027255569978, "mean_inference_ms": 0.23460775750285168, "mean_action_processing_ms": 0.05717855312618586, "mean_env_wait_ms": 0.5756216660465538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024995803833007812, "StateBufferConnector_ms": 0.0017163753509521484, "ViewRequirementAgentConnector_ms": 0.04357314109802246}}, "episode_reward_max": -3525.5336117911984, "episode_reward_min": -3529.446242455198, "episode_reward_mean": -3526.978788209537, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6016911565166, -3525.930794707439, -3526.795916316118, -3526.2594282888354, -3525.5336117911984, -3526.7762420509684, -3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352027255569978, "mean_inference_ms": 0.23460775750285168, "mean_action_processing_ms": 0.05717855312618586, "mean_env_wait_ms": 0.5756216660465538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024995803833007812, "StateBufferConnector_ms": 0.0017163753509521484, "ViewRequirementAgentConnector_ms": 0.04357314109802246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732720, "num_agent_steps_trained": 732720, "num_env_steps_sampled": 732720, "num_env_steps_trained": 732720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.53503482470336, "num_env_steps_trained_throughput_per_sec": 190.53503482470336, "timesteps_total": 732720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 732720, "timers": {"training_iteration_time_ms": 1892.181, "sample_time_ms": 1885.087, "load_time_ms": 0.215, "load_throughput": 1677908.034, "learn_time_ms": 6.338, "learn_throughput": 56796.19, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 732720, "num_env_steps_trained": 732720, "num_agent_steps_sampled": 732720, "num_agent_steps_trained": 732720}, "done": false, "episodes_total": 2516, "training_iteration": 463, "trial_id": "6192e_00000", "date": "2023-08-04_11-19-01", "timestamp": 1691137141, "time_this_iter_s": 11.338672876358032, "time_total_s": 5162.533331394196, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1792.07430768013, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 19.8625, "ram_util_percent": 65.51875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3277221679688, "policy_loss": -3061658.45, "vf_loss": 20736908.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4763.0, "diff_num_grad_updates_vs_sampler_policy": 4762.0}}, "num_env_steps_sampled": 734880, "num_env_steps_trained": 734880, "num_agent_steps_sampled": 734880, "num_agent_steps_trained": 734880}, "sampler_results": {"episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3527.0121111996823, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352067810533238, "mean_inference_ms": 0.23460988829641544, "mean_action_processing_ms": 0.057178138615957025, "mean_env_wait_ms": 0.575607824523453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002496957778930664, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.04356884956359863}}, "episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3527.0121111996823, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.9298627397066, -3528.0656668846627, -3526.790139790477, -3528.170259786444, -3526.139858162829, -3528.3748341177834, -3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352067810533238, "mean_inference_ms": 0.23460988829641544, "mean_action_processing_ms": 0.057178138615957025, "mean_env_wait_ms": 0.575607824523453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002496957778930664, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.04356884956359863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 734880, "num_agent_steps_trained": 734880, "num_env_steps_sampled": 734880, "num_env_steps_trained": 734880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 188.9979728349917, "num_env_steps_trained_throughput_per_sec": 188.9979728349917, "timesteps_total": 734880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 734880, "timers": {"training_iteration_time_ms": 1898.804, "sample_time_ms": 1891.678, "load_time_ms": 0.215, "load_throughput": 1671037.45, "learn_time_ms": 6.356, "learn_throughput": 56643.637, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 734880, "num_env_steps_trained": 734880, "num_agent_steps_sampled": 734880, "num_agent_steps_trained": 734880}, "done": false, "episodes_total": 2522, "training_iteration": 464, "trial_id": "6192e_00000", "date": "2023-08-04_11-19-13", "timestamp": 1691137153, "time_this_iter_s": 11.430888891220093, "time_total_s": 5173.964220285416, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1803.50519657135, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 19.40625, "ram_util_percent": 65.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3368408203125, "policy_loss": -4141061.8125, "vf_loss": 20754060.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4793.0, "diff_num_grad_updates_vs_sampler_policy": 4792.0}}, "num_env_steps_sampled": 737040, "num_env_steps_trained": 737040, "num_agent_steps_sampled": 737040, "num_agent_steps_trained": 737040}, "sampler_results": {"episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.993777065631, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352108893345566, "mean_inference_ms": 0.23461229297134842, "mean_action_processing_ms": 0.05717781538757895, "mean_env_wait_ms": 0.5755967719707773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024988651275634766, "StateBufferConnector_ms": 0.0017242431640625, "ViewRequirementAgentConnector_ms": 0.04363274574279785}}, "episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.993777065631, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.933348068508, -3525.996636991403, -3526.3754353006875, -3526.9642742557276, -3527.365070773559, -3526.159622246239, -3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352108893345566, "mean_inference_ms": 0.23461229297134842, "mean_action_processing_ms": 0.05717781538757895, "mean_env_wait_ms": 0.5755967719707773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024988651275634766, "StateBufferConnector_ms": 0.0017242431640625, "ViewRequirementAgentConnector_ms": 0.04363274574279785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 737040, "num_agent_steps_trained": 737040, "num_env_steps_sampled": 737040, "num_env_steps_trained": 737040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.19359711339433, "num_env_steps_trained_throughput_per_sec": 190.19359711339433, "timesteps_total": 737040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 737040, "timers": {"training_iteration_time_ms": 1890.593, "sample_time_ms": 1883.528, "load_time_ms": 0.215, "load_throughput": 1673630.503, "learn_time_ms": 6.311, "learn_throughput": 57045.311, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 737040, "num_env_steps_trained": 737040, "num_agent_steps_sampled": 737040, "num_agent_steps_trained": 737040}, "done": false, "episodes_total": 2528, "training_iteration": 465, "trial_id": "6192e_00000", "date": "2023-08-04_11-19-24", "timestamp": 1691137164, "time_this_iter_s": 11.358937740325928, "time_total_s": 5185.323158025742, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1814.864134311676, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 19.71875, "ram_util_percent": 65.33125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2731140136719, "policy_loss": -2374413.6125, "vf_loss": 20730304.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4823.0, "diff_num_grad_updates_vs_sampler_policy": 4822.0}}, "num_env_steps_sampled": 739200, "num_env_steps_trained": 739200, "num_agent_steps_sampled": 739200, "num_agent_steps_trained": 739200}, "sampler_results": {"episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.99050280838, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352145216424693, "mean_inference_ms": 0.2346145322276171, "mean_action_processing_ms": 0.05717751431689468, "mean_env_wait_ms": 0.5755860889830695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024962425231933594, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.043630123138427734}}, "episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.99050280838, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6659856258484, -3526.2988813881307, -3526.4853563849238, -3526.539022092726, -3526.4839616477243, -3528.102443740391, -3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352145216424693, "mean_inference_ms": 0.2346145322276171, "mean_action_processing_ms": 0.05717751431689468, "mean_env_wait_ms": 0.5755860889830695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024962425231933594, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.043630123138427734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 739200, "num_agent_steps_trained": 739200, "num_env_steps_sampled": 739200, "num_env_steps_trained": 739200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.65485189915006, "num_env_steps_trained_throughput_per_sec": 190.65485189915006, "timesteps_total": 739200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 739200, "timers": {"training_iteration_time_ms": 1891.203, "sample_time_ms": 1884.183, "load_time_ms": 0.216, "load_throughput": 1669743.935, "learn_time_ms": 6.268, "learn_throughput": 57433.927, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 739200, "num_env_steps_trained": 739200, "num_agent_steps_sampled": 739200, "num_agent_steps_trained": 739200}, "done": false, "episodes_total": 2534, "training_iteration": 466, "trial_id": "6192e_00000", "date": "2023-08-04_11-19-36", "timestamp": 1691137176, "time_this_iter_s": 11.331642866134644, "time_total_s": 5196.654800891876, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1826.1957771778107, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 20.4375, "ram_util_percent": 65.36875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.28074340820314, "policy_loss": -3380957.4625, "vf_loss": 20744016.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4853.0, "diff_num_grad_updates_vs_sampler_policy": 4852.0}}, "num_env_steps_sampled": 741360, "num_env_steps_trained": 741360, "num_agent_steps_sampled": 741360, "num_agent_steps_trained": 741360}, "sampler_results": {"episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.9884390661555, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352177443572639, "mean_inference_ms": 0.23461646043305595, "mean_action_processing_ms": 0.05717722984530374, "mean_env_wait_ms": 0.575576007185849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024924278259277344, "StateBufferConnector_ms": 0.0017232894897460938, "ViewRequirementAgentConnector_ms": 0.04364728927612305}}, "episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.9884390661555, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.844402523081, -3526.80051592093, -3526.958697506231, -3529.3647762870924, -3527.3341721034085, -3527.434456971718, -3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352177443572639, "mean_inference_ms": 0.23461646043305595, "mean_action_processing_ms": 0.05717722984530374, "mean_env_wait_ms": 0.575576007185849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024924278259277344, "StateBufferConnector_ms": 0.0017232894897460938, "ViewRequirementAgentConnector_ms": 0.04364728927612305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 741360, "num_agent_steps_trained": 741360, "num_env_steps_sampled": 741360, "num_env_steps_trained": 741360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.48235531876082, "num_env_steps_trained_throughput_per_sec": 190.48235531876082, "timesteps_total": 741360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 741360, "timers": {"training_iteration_time_ms": 1888.711, "sample_time_ms": 1881.633, "load_time_ms": 0.215, "load_throughput": 1676231.616, "learn_time_ms": 6.339, "learn_throughput": 56790.85, "synch_weights_time_ms": 0.492}, "counters": {"num_env_steps_sampled": 741360, "num_env_steps_trained": 741360, "num_agent_steps_sampled": 741360, "num_agent_steps_trained": 741360}, "done": false, "episodes_total": 2540, "training_iteration": 467, "trial_id": "6192e_00000", "date": "2023-08-04_11-19-47", "timestamp": 1691137187, "time_this_iter_s": 11.341711282730103, "time_total_s": 5207.996512174606, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1837.5374884605408, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 19.05625, "ram_util_percent": 65.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2043151855469, "policy_loss": -6619.9875, "vf_loss": 20740981.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4883.0, "diff_num_grad_updates_vs_sampler_policy": 4882.0}}, "num_env_steps_sampled": 743520, "num_env_steps_trained": 743520, "num_agent_steps_sampled": 743520, "num_agent_steps_trained": 743520}, "sampler_results": {"episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.976051584007, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352210056015118, "mean_inference_ms": 0.2346186124629885, "mean_action_processing_ms": 0.057176967900476015, "mean_env_wait_ms": 0.5755669218828864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002483844757080078, "StateBufferConnector_ms": 0.0017092227935791016, "ViewRequirementAgentConnector_ms": 0.04358172416687012}}, "episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.976051584007, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.769452944377, -3526.1439576311955, -3526.660127929884, -3528.1037339995323, -3527.477915994922, -3526.906754958457, -3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352210056015118, "mean_inference_ms": 0.2346186124629885, "mean_action_processing_ms": 0.057176967900476015, "mean_env_wait_ms": 0.5755669218828864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002483844757080078, "StateBufferConnector_ms": 0.0017092227935791016, "ViewRequirementAgentConnector_ms": 0.04358172416687012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 743520, "num_agent_steps_trained": 743520, "num_env_steps_sampled": 743520, "num_env_steps_trained": 743520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.23887831737528, "num_env_steps_trained_throughput_per_sec": 190.23887831737528, "timesteps_total": 743520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 743520, "timers": {"training_iteration_time_ms": 1891.51, "sample_time_ms": 1884.369, "load_time_ms": 0.22, "load_throughput": 1639111.42, "learn_time_ms": 6.391, "learn_throughput": 56329.837, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 743520, "num_env_steps_trained": 743520, "num_agent_steps_sampled": 743520, "num_agent_steps_trained": 743520}, "done": false, "episodes_total": 2546, "training_iteration": 468, "trial_id": "6192e_00000", "date": "2023-08-04_11-19-58", "timestamp": 1691137198, "time_this_iter_s": 11.356168270111084, "time_total_s": 5219.352680444717, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1848.8936567306519, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 18.925, "ram_util_percent": 65.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.31817626953125, "policy_loss": -4810443.525, "vf_loss": 20747429.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4913.0, "diff_num_grad_updates_vs_sampler_policy": 4912.0}}, "num_env_steps_sampled": 745680, "num_env_steps_trained": 745680, "num_agent_steps_sampled": 745680, "num_agent_steps_trained": 745680}, "sampler_results": {"episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.971806735836, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352230457922371, "mean_inference_ms": 0.23462138490688042, "mean_action_processing_ms": 0.057176810526549604, "mean_env_wait_ms": 0.5755558611330495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.001722097396850586, "ViewRequirementAgentConnector_ms": 0.0435945987701416}}, "episode_reward_max": -3525.586750913195, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.971806735836, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.8262520863796, -3528.030280574871, -3527.4452109033678, -3526.4366219316944, -3527.5183005170184, -3528.0806136476963, -3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352230457922371, "mean_inference_ms": 0.23462138490688042, "mean_action_processing_ms": 0.057176810526549604, "mean_env_wait_ms": 0.5755558611330495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.001722097396850586, "ViewRequirementAgentConnector_ms": 0.0435945987701416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 745680, "num_agent_steps_trained": 745680, "num_env_steps_sampled": 745680, "num_env_steps_trained": 745680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.0503019391749, "num_env_steps_trained_throughput_per_sec": 191.0503019391749, "timesteps_total": 745680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 745680, "timers": {"training_iteration_time_ms": 1884.965, "sample_time_ms": 1877.891, "load_time_ms": 0.22, "load_throughput": 1639111.42, "learn_time_ms": 6.325, "learn_throughput": 56913.934, "synch_weights_time_ms": 0.497}, "counters": {"num_env_steps_sampled": 745680, "num_env_steps_trained": 745680, "num_agent_steps_sampled": 745680, "num_agent_steps_trained": 745680}, "done": false, "episodes_total": 2552, "training_iteration": 469, "trial_id": "6192e_00000", "date": "2023-08-04_11-20-10", "timestamp": 1691137210, "time_this_iter_s": 11.30797004699707, "time_total_s": 5230.6606504917145, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1860.201626777649, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 23.91764705882353, "ram_util_percent": 65.35882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.14069213867185, "policy_loss": 295864.578125, "vf_loss": 20725416.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4943.0, "diff_num_grad_updates_vs_sampler_policy": 4942.0}}, "num_env_steps_sampled": 747840, "num_env_steps_trained": 747840, "num_agent_steps_sampled": 747840, "num_agent_steps_trained": 747840}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.9216583925363, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352245415512088, "mean_inference_ms": 0.23462399902712405, "mean_action_processing_ms": 0.057176680480268194, "mean_env_wait_ms": 0.5755361545748654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025017261505126953, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.043601274490356445}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.9216583925363, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.8328171775743, -3526.1817181724978, -3525.971636775612, -3526.756316850605, -3527.04719754342, -3526.837090113674, -3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352245415512088, "mean_inference_ms": 0.23462399902712405, "mean_action_processing_ms": 0.057176680480268194, "mean_env_wait_ms": 0.5755361545748654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025017261505126953, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.043601274490356445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 747840, "num_agent_steps_trained": 747840, "num_env_steps_sampled": 747840, "num_env_steps_trained": 747840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.2903725673664, "num_env_steps_trained_throughput_per_sec": 191.2903725673664, "timesteps_total": 747840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 747840, "timers": {"training_iteration_time_ms": 1881.514, "sample_time_ms": 1874.451, "load_time_ms": 0.217, "load_throughput": 1656191.115, "learn_time_ms": 6.31, "learn_throughput": 57054.579, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 747840, "num_env_steps_trained": 747840, "num_agent_steps_sampled": 747840, "num_agent_steps_trained": 747840}, "done": false, "episodes_total": 2558, "training_iteration": 470, "trial_id": "6192e_00000", "date": "2023-08-04_11-20-21", "timestamp": 1691137221, "time_this_iter_s": 11.293866872787476, "time_total_s": 5241.954517364502, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1871.4954936504364, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 24.08125, "ram_util_percent": 65.40625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.33543090820314, "policy_loss": -1813148.10625, "vf_loss": 20745259.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4973.0, "diff_num_grad_updates_vs_sampler_policy": 4972.0}}, "num_env_steps_sampled": 750000, "num_env_steps_trained": 750000, "num_agent_steps_sampled": 750000, "num_agent_steps_trained": 750000}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.932951861932, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3522680368802416, "mean_inference_ms": 0.23462612109628533, "mean_action_processing_ms": 0.057176598216190255, "mean_env_wait_ms": 0.5755166895885364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017099380493164062, "ViewRequirementAgentConnector_ms": 0.04360604286193848}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.932951861932, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.591243622489, -3527.075268124094, -3527.620595235849, -3526.8102699669685, -3526.99101035461, -3526.9236967928487, -3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3522680368802416, "mean_inference_ms": 0.23462612109628533, "mean_action_processing_ms": 0.057176598216190255, "mean_env_wait_ms": 0.5755166895885364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017099380493164062, "ViewRequirementAgentConnector_ms": 0.04360604286193848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 750000, "num_agent_steps_trained": 750000, "num_env_steps_sampled": 750000, "num_env_steps_trained": 750000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.93871503917805, "num_env_steps_trained_throughput_per_sec": 189.93871503917805, "timesteps_total": 750000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 750000, "timers": {"training_iteration_time_ms": 1890.853, "sample_time_ms": 1883.752, "load_time_ms": 0.232, "load_throughput": 1553286.123, "learn_time_ms": 6.325, "learn_throughput": 56919.083, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 750000, "num_env_steps_trained": 750000, "num_agent_steps_sampled": 750000, "num_agent_steps_trained": 750000}, "done": false, "episodes_total": 2564, "training_iteration": 471, "trial_id": "6192e_00000", "date": "2023-08-04_11-20-32", "timestamp": 1691137232, "time_this_iter_s": 11.374116659164429, "time_total_s": 5253.328634023666, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1882.8696103096008, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 20.856250000000003, "ram_util_percent": 65.50625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.62275390625, "policy_loss": -12938649.3, "vf_loss": 20759731.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5003.0, "diff_num_grad_updates_vs_sampler_policy": 5002.0}}, "num_env_steps_sampled": 752160, "num_env_steps_trained": 752160, "num_agent_steps_sampled": 752160, "num_agent_steps_trained": 752160}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.9222150737037, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352290975809302, "mean_inference_ms": 0.23462745394717488, "mean_action_processing_ms": 0.05717648882161571, "mean_env_wait_ms": 0.5754948865935163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.0017120838165283203, "ViewRequirementAgentConnector_ms": 0.04355120658874512}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.9222150737037, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3529.0484900733622, -3526.899376028086, -3527.344452133221, -3527.248776062802, -3527.6072222451735, -3526.9923240960657, -3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352290975809302, "mean_inference_ms": 0.23462745394717488, "mean_action_processing_ms": 0.05717648882161571, "mean_env_wait_ms": 0.5754948865935163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.0017120838165283203, "ViewRequirementAgentConnector_ms": 0.04355120658874512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752160, "num_agent_steps_trained": 752160, "num_env_steps_sampled": 752160, "num_env_steps_trained": 752160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.1699546599496, "num_env_steps_trained_throughput_per_sec": 190.1699546599496, "timesteps_total": 752160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 752160, "timers": {"training_iteration_time_ms": 1894.458, "sample_time_ms": 1887.382, "load_time_ms": 0.217, "load_throughput": 1656372.795, "learn_time_ms": 6.318, "learn_throughput": 56977.289, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 752160, "num_env_steps_trained": 752160, "num_agent_steps_sampled": 752160, "num_agent_steps_trained": 752160}, "done": false, "episodes_total": 2570, "training_iteration": 472, "trial_id": "6192e_00000", "date": "2023-08-04_11-20-44", "timestamp": 1691137244, "time_this_iter_s": 11.36028504371643, "time_total_s": 5264.688919067383, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1894.2298953533173, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 22.075, "ram_util_percent": 65.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3056335449219, "policy_loss": -9582180.91875, "vf_loss": 20751783.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5033.0, "diff_num_grad_updates_vs_sampler_policy": 5032.0}}, "num_env_steps_sampled": 754320, "num_env_steps_trained": 754320, "num_agent_steps_sampled": 754320, "num_agent_steps_trained": 754320}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.902896405346, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35231894914092, "mean_inference_ms": 0.23462740994899833, "mean_action_processing_ms": 0.057176298739097804, "mean_env_wait_ms": 0.575470769731142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025017261505126953, "StateBufferConnector_ms": 0.0017085075378417969, "ViewRequirementAgentConnector_ms": 0.043520212173461914}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.902896405346, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.5867679802236, -3527.344762247783, -3526.3264565479453, -3527.5662947054825, -3526.433661739806, -3527.1476971625602, -3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35231894914092, "mean_inference_ms": 0.23462740994899833, "mean_action_processing_ms": 0.057176298739097804, "mean_env_wait_ms": 0.575470769731142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025017261505126953, "StateBufferConnector_ms": 0.0017085075378417969, "ViewRequirementAgentConnector_ms": 0.043520212173461914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 754320, "num_agent_steps_trained": 754320, "num_env_steps_sampled": 754320, "num_env_steps_trained": 754320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.75245147012808, "num_env_steps_trained_throughput_per_sec": 189.75245147012808, "timesteps_total": 754320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 754320, "timers": {"training_iteration_time_ms": 1897.31, "sample_time_ms": 1890.236, "load_time_ms": 0.221, "load_throughput": 1630791.057, "learn_time_ms": 6.311, "learn_throughput": 57044.449, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 754320, "num_env_steps_trained": 754320, "num_agent_steps_sampled": 754320, "num_agent_steps_trained": 754320}, "done": false, "episodes_total": 2576, "training_iteration": 473, "trial_id": "6192e_00000", "date": "2023-08-04_11-20-55", "timestamp": 1691137255, "time_this_iter_s": 11.385522365570068, "time_total_s": 5276.074441432953, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1905.6154177188873, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 20.34375, "ram_util_percent": 65.61250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3132080078125, "policy_loss": -878575.7875, "vf_loss": 20746728.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5063.0, "diff_num_grad_updates_vs_sampler_policy": 5062.0}}, "num_env_steps_sampled": 756480, "num_env_steps_trained": 756480, "num_agent_steps_sampled": 756480, "num_agent_steps_trained": 756480}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.953880276443, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352342165284143, "mean_inference_ms": 0.23462644973955574, "mean_action_processing_ms": 0.05717604880935781, "mean_env_wait_ms": 0.5754479368811914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025026798248291016, "StateBufferConnector_ms": 0.0017101764678955078, "ViewRequirementAgentConnector_ms": 0.04344797134399414}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.953880276443, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.8912687576967, -3527.0189048548264, -3526.550309825494, -3528.2843364314067, -3526.669385634947, -3527.301090954117, -3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352342165284143, "mean_inference_ms": 0.23462644973955574, "mean_action_processing_ms": 0.05717604880935781, "mean_env_wait_ms": 0.5754479368811914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025026798248291016, "StateBufferConnector_ms": 0.0017101764678955078, "ViewRequirementAgentConnector_ms": 0.04344797134399414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756480, "num_agent_steps_trained": 756480, "num_env_steps_sampled": 756480, "num_env_steps_trained": 756480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.3046019567203, "num_env_steps_trained_throughput_per_sec": 190.3046019567203, "timesteps_total": 756480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 756480, "timers": {"training_iteration_time_ms": 1890.428, "sample_time_ms": 1883.352, "load_time_ms": 0.222, "load_throughput": 1618380.965, "learn_time_ms": 6.306, "learn_throughput": 57089.094, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 756480, "num_env_steps_trained": 756480, "num_agent_steps_sampled": 756480, "num_agent_steps_trained": 756480}, "done": false, "episodes_total": 2582, "training_iteration": 474, "trial_id": "6192e_00000", "date": "2023-08-04_11-21-06", "timestamp": 1691137266, "time_this_iter_s": 11.352550983428955, "time_total_s": 5287.426992416382, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1916.9679687023163, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 19.825, "ram_util_percent": 65.33125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.31809692382814, "policy_loss": -6008161.596875, "vf_loss": 20745861.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5093.0, "diff_num_grad_updates_vs_sampler_policy": 5092.0}}, "num_env_steps_sampled": 758640, "num_env_steps_trained": 758640, "num_agent_steps_sampled": 758640, "num_agent_steps_trained": 758640}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.937262271258, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352366461401528, "mean_inference_ms": 0.23462457935872572, "mean_action_processing_ms": 0.05717570915980412, "mean_env_wait_ms": 0.5754212859968931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.001707315444946289, "ViewRequirementAgentConnector_ms": 0.04342842102050781}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.937262271258, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.776410898373, -3525.9912170808952, -3526.5126804185475, -3526.961513317373, -3527.8749722039543, -3529.446242455198, -3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352366461401528, "mean_inference_ms": 0.23462457935872572, "mean_action_processing_ms": 0.05717570915980412, "mean_env_wait_ms": 0.5754212859968931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.001707315444946289, "ViewRequirementAgentConnector_ms": 0.04342842102050781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 758640, "num_agent_steps_trained": 758640, "num_env_steps_sampled": 758640, "num_env_steps_trained": 758640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.55781020290354, "num_env_steps_trained_throughput_per_sec": 190.55781020290354, "timesteps_total": 758640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 758640, "timers": {"training_iteration_time_ms": 1890.28, "sample_time_ms": 1883.218, "load_time_ms": 0.214, "load_throughput": 1684835.349, "learn_time_ms": 6.299, "learn_throughput": 57150.46, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 758640, "num_env_steps_trained": 758640, "num_agent_steps_sampled": 758640, "num_agent_steps_trained": 758640}, "done": false, "episodes_total": 2588, "training_iteration": 475, "trial_id": "6192e_00000", "date": "2023-08-04_11-21-18", "timestamp": 1691137278, "time_this_iter_s": 11.33749508857727, "time_total_s": 5298.764487504959, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1928.3054637908936, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 20.018749999999997, "ram_util_percent": 65.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.38037109375, "policy_loss": -1565621.90625, "vf_loss": 20744527.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5123.0, "diff_num_grad_updates_vs_sampler_policy": 5122.0}}, "num_env_steps_sampled": 760800, "num_env_steps_trained": 760800, "num_agent_steps_sampled": 760800, "num_agent_steps_trained": 760800}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.922674592223, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352386828602517, "mean_inference_ms": 0.23462334195519083, "mean_action_processing_ms": 0.05717547465113359, "mean_env_wait_ms": 0.57540103465854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025141239166259766, "StateBufferConnector_ms": 0.0017061233520507812, "ViewRequirementAgentConnector_ms": 0.043443918228149414}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.922674592223, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.9800493744883, -3527.728096125806, -3526.7200910395627, -3526.7176654549753, -3526.74465714775, -3527.104407263999, -3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352386828602517, "mean_inference_ms": 0.23462334195519083, "mean_action_processing_ms": 0.05717547465113359, "mean_env_wait_ms": 0.57540103465854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025141239166259766, "StateBufferConnector_ms": 0.0017061233520507812, "ViewRequirementAgentConnector_ms": 0.043443918228149414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760800, "num_agent_steps_trained": 760800, "num_env_steps_sampled": 760800, "num_env_steps_trained": 760800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.3662868760092, "num_env_steps_trained_throughput_per_sec": 190.3662868760092, "timesteps_total": 760800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 760800, "timers": {"training_iteration_time_ms": 1891.399, "sample_time_ms": 1884.317, "load_time_ms": 0.215, "load_throughput": 1676603.864, "learn_time_ms": 6.318, "learn_throughput": 56979.224, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 760800, "num_env_steps_trained": 760800, "num_agent_steps_sampled": 760800, "num_agent_steps_trained": 760800}, "done": false, "episodes_total": 2594, "training_iteration": 476, "trial_id": "6192e_00000", "date": "2023-08-04_11-21-29", "timestamp": 1691137289, "time_this_iter_s": 11.348645210266113, "time_total_s": 5310.113132715225, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1939.6541090011597, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 24.03125, "ram_util_percent": 65.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.250048828125, "policy_loss": -901794.253125, "vf_loss": 20728947.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5153.0, "diff_num_grad_updates_vs_sampler_policy": 5152.0}}, "num_env_steps_sampled": 762960, "num_env_steps_trained": 762960, "num_agent_steps_sampled": 762960, "num_agent_steps_trained": 762960}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.9380146326102, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352403642703347, "mean_inference_ms": 0.2346215622650725, "mean_action_processing_ms": 0.057175149348839355, "mean_env_wait_ms": 0.5753779728166345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0016965866088867188, "ViewRequirementAgentConnector_ms": 0.04338192939758301}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.9380146326102, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.237872330624, -3527.579877031105, -3527.128369844822, -3526.879598030286, -3526.3776495182487, -3526.752497990512, -3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352403642703347, "mean_inference_ms": 0.2346215622650725, "mean_action_processing_ms": 0.057175149348839355, "mean_env_wait_ms": 0.5753779728166345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0016965866088867188, "ViewRequirementAgentConnector_ms": 0.04338192939758301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 762960, "num_agent_steps_trained": 762960, "num_env_steps_sampled": 762960, "num_env_steps_trained": 762960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.7831639465362, "num_env_steps_trained_throughput_per_sec": 190.7831639465362, "timesteps_total": 762960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 762960, "timers": {"training_iteration_time_ms": 1887.98, "sample_time_ms": 1880.888, "load_time_ms": 0.217, "load_throughput": 1662024.7, "learn_time_ms": 6.309, "learn_throughput": 57058.676, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 762960, "num_env_steps_trained": 762960, "num_agent_steps_sampled": 762960, "num_agent_steps_trained": 762960}, "done": false, "episodes_total": 2600, "training_iteration": 477, "trial_id": "6192e_00000", "date": "2023-08-04_11-21-41", "timestamp": 1691137301, "time_this_iter_s": 11.323791027069092, "time_total_s": 5321.436923742294, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1950.9779000282288, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 23.33125, "ram_util_percent": 65.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2352294921875, "policy_loss": -1241186.765625, "vf_loss": 20737548.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5183.0, "diff_num_grad_updates_vs_sampler_policy": 5182.0}}, "num_env_steps_sampled": 765120, "num_env_steps_trained": 765120, "num_agent_steps_sampled": 765120, "num_agent_steps_trained": 765120}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.965112941154, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352419771281365, "mean_inference_ms": 0.23461994160780178, "mean_action_processing_ms": 0.057174843964167776, "mean_env_wait_ms": 0.5753534715410435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.001691579818725586, "ViewRequirementAgentConnector_ms": 0.04333806037902832}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3529.5078509417344, "episode_reward_mean": -3526.965112941154, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.4085255822233, -3527.9744780244173, -3527.8080779027746, -3526.383523303534, -3526.059164923787, -3526.8487205168226, -3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352419771281365, "mean_inference_ms": 0.23461994160780178, "mean_action_processing_ms": 0.057174843964167776, "mean_env_wait_ms": 0.5753534715410435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.001691579818725586, "ViewRequirementAgentConnector_ms": 0.04333806037902832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 765120, "num_agent_steps_trained": 765120, "num_env_steps_sampled": 765120, "num_env_steps_trained": 765120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.35828309401316, "num_env_steps_trained_throughput_per_sec": 190.35828309401316, "timesteps_total": 765120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 765120, "timers": {"training_iteration_time_ms": 1889.943, "sample_time_ms": 1882.817, "load_time_ms": 0.219, "load_throughput": 1643035.299, "learn_time_ms": 6.347, "learn_throughput": 56719.172, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 765120, "num_env_steps_trained": 765120, "num_agent_steps_sampled": 765120, "num_agent_steps_trained": 765120}, "done": false, "episodes_total": 2606, "training_iteration": 478, "trial_id": "6192e_00000", "date": "2023-08-04_11-21-52", "timestamp": 1691137312, "time_this_iter_s": 11.349065065383911, "time_total_s": 5332.785988807678, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1962.3269650936127, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 19.862499999999997, "ram_util_percent": 65.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.30224609375, "policy_loss": -1656156.11875, "vf_loss": 20734961.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5213.0, "diff_num_grad_updates_vs_sampler_policy": 5212.0}}, "num_env_steps_sampled": 767280, "num_env_steps_trained": 767280, "num_agent_steps_sampled": 767280, "num_agent_steps_trained": 767280}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.218643676347, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352432949601742, "mean_inference_ms": 0.23461863693250012, "mean_action_processing_ms": 0.05717462545505411, "mean_env_wait_ms": 0.5753279238562296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025055408477783203, "StateBufferConnector_ms": 0.0016987323760986328, "ViewRequirementAgentConnector_ms": 0.043332815170288086}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.218643676347, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.9176026587797, -3525.7470446177113, -3526.8560379175346, -3525.5867510276303, -3527.2929602638164, -3529.5078509417344, -3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352432949601742, "mean_inference_ms": 0.23461863693250012, "mean_action_processing_ms": 0.05717462545505411, "mean_env_wait_ms": 0.5753279238562296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025055408477783203, "StateBufferConnector_ms": 0.0016987323760986328, "ViewRequirementAgentConnector_ms": 0.043332815170288086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 767280, "num_agent_steps_trained": 767280, "num_env_steps_sampled": 767280, "num_env_steps_trained": 767280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.4750826281665, "num_env_steps_trained_throughput_per_sec": 190.4750826281665, "timesteps_total": 767280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 767280, "timers": {"training_iteration_time_ms": 1890.793, "sample_time_ms": 1883.487, "load_time_ms": 0.227, "load_throughput": 1585748.204, "learn_time_ms": 6.501, "learn_throughput": 55376.848, "synch_weights_time_ms": 0.546}, "counters": {"num_env_steps_sampled": 767280, "num_env_steps_trained": 767280, "num_agent_steps_sampled": 767280, "num_agent_steps_trained": 767280}, "done": false, "episodes_total": 2612, "training_iteration": 479, "trial_id": "6192e_00000", "date": "2023-08-04_11-22-03", "timestamp": 1691137323, "time_this_iter_s": 11.34213399887085, "time_total_s": 5344.128122806549, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1973.6690990924835, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 26.23125, "ram_util_percent": 65.44375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2044250488281, "policy_loss": -2657454.0375, "vf_loss": 20739861.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5243.0, "diff_num_grad_updates_vs_sampler_policy": 5242.0}}, "num_env_steps_sampled": 769440, "num_env_steps_trained": 769440, "num_agent_steps_sampled": 769440, "num_agent_steps_trained": 769440}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.216732038936, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352450402391721, "mean_inference_ms": 0.23461736456334598, "mean_action_processing_ms": 0.057174422238794737, "mean_env_wait_ms": 0.5752991673872415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002516508102416992, "StateBufferConnector_ms": 0.0017094612121582031, "ViewRequirementAgentConnector_ms": 0.043398141860961914}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.216732038936, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.7286025632006, -3525.586750913195, -3526.5026592845875, -3526.611159359101, -3526.488189259329, -3527.0772433979405, -3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352450402391721, "mean_inference_ms": 0.23461736456334598, "mean_action_processing_ms": 0.057174422238794737, "mean_env_wait_ms": 0.5752991673872415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002516508102416992, "StateBufferConnector_ms": 0.0017094612121582031, "ViewRequirementAgentConnector_ms": 0.043398141860961914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 769440, "num_agent_steps_trained": 769440, "num_env_steps_sampled": 769440, "num_env_steps_trained": 769440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.90353562545073, "num_env_steps_trained_throughput_per_sec": 189.90353562545073, "timesteps_total": 769440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 769440, "timers": {"training_iteration_time_ms": 1890.671, "sample_time_ms": 1883.632, "load_time_ms": 0.222, "load_throughput": 1620987.053, "learn_time_ms": 6.28, "learn_throughput": 57321.205, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 769440, "num_env_steps_trained": 769440, "num_agent_steps_sampled": 769440, "num_agent_steps_trained": 769440}, "done": false, "episodes_total": 2618, "training_iteration": 480, "trial_id": "6192e_00000", "date": "2023-08-04_11-22-15", "timestamp": 1691137335, "time_this_iter_s": 11.376147985458374, "time_total_s": 5355.504270792007, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1985.045247077942, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 19.799999999999997, "ram_util_percent": 65.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.26593017578125, "policy_loss": -5343418.275, "vf_loss": 20742261.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5273.0, "diff_num_grad_updates_vs_sampler_policy": 5272.0}}, "num_env_steps_sampled": 771600, "num_env_steps_trained": 771600, "num_agent_steps_sampled": 771600, "num_agent_steps_trained": 771600}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.2102849627013, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352475546161878, "mean_inference_ms": 0.23461591417404043, "mean_action_processing_ms": 0.057174232658809644, "mean_env_wait_ms": 0.5752522606257504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002512693405151367, "StateBufferConnector_ms": 0.0017092227935791016, "ViewRequirementAgentConnector_ms": 0.04343843460083008}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.2102849627013, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.2808382937387, -3526.852074017278, -3528.3849859778306, -3527.5538771306938, -3526.0168609570874, -3526.306120961058, -3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352475546161878, "mean_inference_ms": 0.23461591417404043, "mean_action_processing_ms": 0.057174232658809644, "mean_env_wait_ms": 0.5752522606257504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002512693405151367, "StateBufferConnector_ms": 0.0017092227935791016, "ViewRequirementAgentConnector_ms": 0.04343843460083008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 771600, "num_agent_steps_trained": 771600, "num_env_steps_sampled": 771600, "num_env_steps_trained": 771600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.42905249272724, "num_env_steps_trained_throughput_per_sec": 190.42905249272724, "timesteps_total": 771600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 771600, "timers": {"training_iteration_time_ms": 1891.709, "sample_time_ms": 1884.662, "load_time_ms": 0.215, "load_throughput": 1674001.596, "learn_time_ms": 6.31, "learn_throughput": 57055.657, "synch_weights_time_ms": 0.49}, "counters": {"num_env_steps_sampled": 771600, "num_env_steps_trained": 771600, "num_agent_steps_sampled": 771600, "num_agent_steps_trained": 771600}, "done": false, "episodes_total": 2624, "training_iteration": 481, "trial_id": "6192e_00000", "date": "2023-08-04_11-22-26", "timestamp": 1691137346, "time_this_iter_s": 11.344830989837646, "time_total_s": 5366.849101781845, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1996.3900780677795, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 22.556250000000002, "ram_util_percent": 65.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.45261840820314, "policy_loss": -6221050.8375, "vf_loss": 20781059.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5303.0, "diff_num_grad_updates_vs_sampler_policy": 5302.0}}, "num_env_steps_sampled": 773760, "num_env_steps_trained": 773760, "num_agent_steps_sampled": 773760, "num_agent_steps_trained": 773760}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.257173015981, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352499068512916, "mean_inference_ms": 0.23461412036915058, "mean_action_processing_ms": 0.05717397730329872, "mean_env_wait_ms": 0.575207416504297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025131702423095703, "StateBufferConnector_ms": 0.0017044544219970703, "ViewRequirementAgentConnector_ms": 0.043395042419433594}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.257173015981, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.7096341156807, -3527.292402567908, -3526.021195268911, -3526.1207480402495, -3525.819070681285, -3527.638953024722, -3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352499068512916, "mean_inference_ms": 0.23461412036915058, "mean_action_processing_ms": 0.05717397730329872, "mean_env_wait_ms": 0.575207416504297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025131702423095703, "StateBufferConnector_ms": 0.0017044544219970703, "ViewRequirementAgentConnector_ms": 0.043395042419433594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 773760, "num_agent_steps_trained": 773760, "num_env_steps_sampled": 773760, "num_env_steps_trained": 773760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.36803091781204, "num_env_steps_trained_throughput_per_sec": 190.36803091781204, "timesteps_total": 773760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 773760, "timers": {"training_iteration_time_ms": 1893.317, "sample_time_ms": 1886.289, "load_time_ms": 0.216, "load_throughput": 1668636.8, "learn_time_ms": 6.288, "learn_throughput": 57247.531, "synch_weights_time_ms": 0.494}, "counters": {"num_env_steps_sampled": 773760, "num_env_steps_trained": 773760, "num_agent_steps_sampled": 773760, "num_agent_steps_trained": 773760}, "done": false, "episodes_total": 2630, "training_iteration": 482, "trial_id": "6192e_00000", "date": "2023-08-04_11-22-37", "timestamp": 1691137357, "time_this_iter_s": 11.348540782928467, "time_total_s": 5378.197642564774, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2007.738618850708, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 18.98125, "ram_util_percent": 64.89375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2967834472656, "policy_loss": -5626201.8625, "vf_loss": 20748465.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5333.0, "diff_num_grad_updates_vs_sampler_policy": 5332.0}}, "num_env_steps_sampled": 775920, "num_env_steps_trained": 775920, "num_agent_steps_sampled": 775920, "num_agent_steps_trained": 775920}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.3182103048234, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35252464171517, "mean_inference_ms": 0.2346126982099669, "mean_action_processing_ms": 0.05717385277474319, "mean_env_wait_ms": 0.5751596246749373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002531766891479492, "StateBufferConnector_ms": 0.0017137527465820312, "ViewRequirementAgentConnector_ms": 0.043407440185546875}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.3182103048234, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.3517925407104, -3527.147065357244, -3526.5710455265503, -3526.8413495268956, -3526.5568921517875, -3527.2351490652964, -3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35252464171517, "mean_inference_ms": 0.2346126982099669, "mean_action_processing_ms": 0.05717385277474319, "mean_env_wait_ms": 0.5751596246749373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002531766891479492, "StateBufferConnector_ms": 0.0017137527465820312, "ViewRequirementAgentConnector_ms": 0.043407440185546875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 775920, "num_agent_steps_trained": 775920, "num_env_steps_sampled": 775920, "num_env_steps_trained": 775920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.62852750859656, "num_env_steps_trained_throughput_per_sec": 190.62852750859656, "timesteps_total": 775920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 775920, "timers": {"training_iteration_time_ms": 1887.948, "sample_time_ms": 1880.686, "load_time_ms": 0.219, "load_throughput": 1646080.279, "learn_time_ms": 6.468, "learn_throughput": 55660.183, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 775920, "num_env_steps_trained": 775920, "num_agent_steps_sampled": 775920, "num_agent_steps_trained": 775920}, "done": false, "episodes_total": 2636, "training_iteration": 483, "trial_id": "6192e_00000", "date": "2023-08-04_11-22-49", "timestamp": 1691137369, "time_this_iter_s": 11.333107948303223, "time_total_s": 5389.530750513077, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2019.0717267990112, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 18.376470588235296, "ram_util_percent": 64.81764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.32359619140624, "policy_loss": -6943887.16875, "vf_loss": 20767560.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5363.0, "diff_num_grad_updates_vs_sampler_policy": 5362.0}}, "num_env_steps_sampled": 778080, "num_env_steps_trained": 778080, "num_agent_steps_sampled": 778080, "num_agent_steps_trained": 778080}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.3218638393055, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352553683728684, "mean_inference_ms": 0.23461191013919702, "mean_action_processing_ms": 0.057173824087354094, "mean_env_wait_ms": 0.575113235912307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002544879913330078, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.043442726135253906}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.3218638393055, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.972335165757, -3528.23851761741, -3527.1245651943545, -3526.3708139030778, -3526.798128291465, -3525.959501869124, -3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352553683728684, "mean_inference_ms": 0.23461191013919702, "mean_action_processing_ms": 0.057173824087354094, "mean_env_wait_ms": 0.575113235912307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002544879913330078, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.043442726135253906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 778080, "num_agent_steps_trained": 778080, "num_env_steps_sampled": 778080, "num_env_steps_trained": 778080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.840992577262, "num_env_steps_trained_throughput_per_sec": 189.840992577262, "timesteps_total": 778080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 778080, "timers": {"training_iteration_time_ms": 1893.976, "sample_time_ms": 1886.754, "load_time_ms": 0.218, "load_throughput": 1647696.901, "learn_time_ms": 6.428, "learn_throughput": 56006.196, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 778080, "num_env_steps_trained": 778080, "num_agent_steps_sampled": 778080, "num_agent_steps_trained": 778080}, "done": false, "episodes_total": 2642, "training_iteration": 484, "trial_id": "6192e_00000", "date": "2023-08-04_11-23-00", "timestamp": 1691137380, "time_this_iter_s": 11.379954814910889, "time_total_s": 5400.910705327988, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2030.4516816139221, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 19.08125, "ram_util_percent": 64.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.13901977539064, "policy_loss": 311454.14375, "vf_loss": 20729351.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5393.0, "diff_num_grad_updates_vs_sampler_policy": 5392.0}}, "num_env_steps_sampled": 780240, "num_env_steps_trained": 780240, "num_agent_steps_sampled": 780240, "num_agent_steps_trained": 780240}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.3259738212696, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35258364853288, "mean_inference_ms": 0.23461096463110442, "mean_action_processing_ms": 0.057173801789888214, "mean_env_wait_ms": 0.5750691638582865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002543210983276367, "StateBufferConnector_ms": 0.0017178058624267578, "ViewRequirementAgentConnector_ms": 0.0434727668762207}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.3259738212696, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5706200220084, -3528.2512131813196, -3527.105310390619, -3526.9526848866176, -3527.1245027737946, -3526.1466678004604, -3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35258364853288, "mean_inference_ms": 0.23461096463110442, "mean_action_processing_ms": 0.057173801789888214, "mean_env_wait_ms": 0.5750691638582865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002543210983276367, "StateBufferConnector_ms": 0.0017178058624267578, "ViewRequirementAgentConnector_ms": 0.0434727668762207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780240, "num_agent_steps_trained": 780240, "num_env_steps_sampled": 780240, "num_env_steps_trained": 780240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.22050044742159, "num_env_steps_trained_throughput_per_sec": 190.22050044742159, "timesteps_total": 780240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 780240, "timers": {"training_iteration_time_ms": 1892.545, "sample_time_ms": 1885.552, "load_time_ms": 0.217, "load_throughput": 1659102.78, "learn_time_ms": 6.236, "learn_throughput": 57731.918, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 780240, "num_env_steps_trained": 780240, "num_agent_steps_sampled": 780240, "num_agent_steps_trained": 780240}, "done": false, "episodes_total": 2648, "training_iteration": 485, "trial_id": "6192e_00000", "date": "2023-08-04_11-23-11", "timestamp": 1691137391, "time_this_iter_s": 11.357491970062256, "time_total_s": 5412.26819729805, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2041.8091735839844, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 18.756249999999998, "ram_util_percent": 64.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2059387207031, "policy_loss": -414478.0125, "vf_loss": 20742511.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5423.0, "diff_num_grad_updates_vs_sampler_policy": 5422.0}}, "num_env_steps_sampled": 782400, "num_env_steps_trained": 782400, "num_agent_steps_sampled": 782400, "num_agent_steps_trained": 782400}, "sampler_results": {"episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.2945843335497, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352619990915939, "mean_inference_ms": 0.2346097529939649, "mean_action_processing_ms": 0.05717370399487875, "mean_env_wait_ms": 0.5750271754332208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025300979614257812, "StateBufferConnector_ms": 0.0017232894897460938, "ViewRequirementAgentConnector_ms": 0.04344797134399414}}, "episode_reward_max": -3525.167084151661, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.2945843335497, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.754799659346, -3527.4711479295624, -3526.6582430162766, -3525.167084151661, -3525.98495986844, -3526.952534573536, -3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352619990915939, "mean_inference_ms": 0.2346097529939649, "mean_action_processing_ms": 0.05717370399487875, "mean_env_wait_ms": 0.5750271754332208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025300979614257812, "StateBufferConnector_ms": 0.0017232894897460938, "ViewRequirementAgentConnector_ms": 0.04344797134399414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 782400, "num_agent_steps_trained": 782400, "num_env_steps_sampled": 782400, "num_env_steps_trained": 782400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.34618470127245, "num_env_steps_trained_throughput_per_sec": 190.34618470127245, "timesteps_total": 782400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 782400, "timers": {"training_iteration_time_ms": 1890.506, "sample_time_ms": 1883.494, "load_time_ms": 0.216, "load_throughput": 1668452.42, "learn_time_ms": 6.27, "learn_throughput": 57417.766, "synch_weights_time_ms": 0.495}, "counters": {"num_env_steps_sampled": 782400, "num_env_steps_trained": 782400, "num_agent_steps_sampled": 782400, "num_agent_steps_trained": 782400}, "done": false, "episodes_total": 2654, "training_iteration": 486, "trial_id": "6192e_00000", "date": "2023-08-04_11-23-23", "timestamp": 1691137403, "time_this_iter_s": 11.349756002426147, "time_total_s": 5423.617953300476, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2053.1589295864105, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 19.3375, "ram_util_percent": 64.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.39161987304686, "policy_loss": -5540230.125, "vf_loss": 20762836.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5453.0, "diff_num_grad_updates_vs_sampler_policy": 5452.0}}, "num_env_steps_sampled": 784560, "num_env_steps_trained": 784560, "num_agent_steps_sampled": 784560, "num_agent_steps_trained": 784560}, "sampler_results": {"episode_reward_max": -3525.5609396367972, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.283765197487, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352658864984792, "mean_inference_ms": 0.23460977591874524, "mean_action_processing_ms": 0.05717374664519042, "mean_env_wait_ms": 0.5749879192620427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025250911712646484, "StateBufferConnector_ms": 0.0017361640930175781, "ViewRequirementAgentConnector_ms": 0.04347634315490723}}, "episode_reward_max": -3525.5609396367972, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.283765197487, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.2670595490927, -3527.8188638463885, -3526.992003239707, -3526.7407024957924, -3526.2021715532414, -3527.036627348, -3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352658864984792, "mean_inference_ms": 0.23460977591874524, "mean_action_processing_ms": 0.05717374664519042, "mean_env_wait_ms": 0.5749879192620427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025250911712646484, "StateBufferConnector_ms": 0.0017361640930175781, "ViewRequirementAgentConnector_ms": 0.04347634315490723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784560, "num_agent_steps_trained": 784560, "num_env_steps_sampled": 784560, "num_env_steps_trained": 784560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.1577404977766, "num_env_steps_trained_throughput_per_sec": 190.1577404977766, "timesteps_total": 784560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 784560, "timers": {"training_iteration_time_ms": 1892.112, "sample_time_ms": 1885.004, "load_time_ms": 0.217, "load_throughput": 1657463.71, "learn_time_ms": 6.35, "learn_throughput": 56694.042, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 784560, "num_env_steps_trained": 784560, "num_agent_steps_sampled": 784560, "num_agent_steps_trained": 784560}, "done": false, "episodes_total": 2660, "training_iteration": 487, "trial_id": "6192e_00000", "date": "2023-08-04_11-23-34", "timestamp": 1691137414, "time_this_iter_s": 11.36128306388855, "time_total_s": 5434.979236364365, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2064.520212650299, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 21.16875, "ram_util_percent": 64.46875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.31434326171876, "policy_loss": -3555421.215625, "vf_loss": 20733801.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5483.0, "diff_num_grad_updates_vs_sampler_policy": 5482.0}}, "num_env_steps_sampled": 786720, "num_env_steps_trained": 786720, "num_agent_steps_sampled": 786720, "num_agent_steps_trained": 786720}, "sampler_results": {"episode_reward_max": -3525.5609396367972, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.3095010726774, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352695075649568, "mean_inference_ms": 0.2346098349419855, "mean_action_processing_ms": 0.05717381847151904, "mean_env_wait_ms": 0.5749499207531986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025267601013183594, "StateBufferConnector_ms": 0.001741647720336914, "ViewRequirementAgentConnector_ms": 0.04349017143249512}}, "episode_reward_max": -3525.5609396367972, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.3095010726774, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5773619256734, -3526.455008141271, -3526.2815460387715, -3528.385690266998, -3527.77014184636, -3526.138493248046, -3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352695075649568, "mean_inference_ms": 0.2346098349419855, "mean_action_processing_ms": 0.05717381847151904, "mean_env_wait_ms": 0.5749499207531986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025267601013183594, "StateBufferConnector_ms": 0.001741647720336914, "ViewRequirementAgentConnector_ms": 0.04349017143249512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 786720, "num_agent_steps_trained": 786720, "num_env_steps_sampled": 786720, "num_env_steps_trained": 786720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.12648976490283, "num_env_steps_trained_throughput_per_sec": 190.12648976490283, "timesteps_total": 786720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 786720, "timers": {"training_iteration_time_ms": 1892.51, "sample_time_ms": 1885.413, "load_time_ms": 0.216, "load_throughput": 1665324.187, "learn_time_ms": 6.354, "learn_throughput": 56653.414, "synch_weights_time_ms": 0.495}, "counters": {"num_env_steps_sampled": 786720, "num_env_steps_trained": 786720, "num_agent_steps_sampled": 786720, "num_agent_steps_trained": 786720}, "done": false, "episodes_total": 2666, "training_iteration": 488, "trial_id": "6192e_00000", "date": "2023-08-04_11-23-46", "timestamp": 1691137426, "time_this_iter_s": 11.362895011901855, "time_total_s": 5446.3421313762665, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2075.883107662201, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 18.05625, "ram_util_percent": 64.45624999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.27984619140625, "policy_loss": -3352928.74375, "vf_loss": 20740926.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5513.0, "diff_num_grad_updates_vs_sampler_policy": 5512.0}}, "num_env_steps_sampled": 788880, "num_env_steps_trained": 788880, "num_agent_steps_sampled": 788880, "num_agent_steps_trained": 788880}, "sampler_results": {"episode_reward_max": -3525.5609396367972, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.4490056096524, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352728052741253, "mean_inference_ms": 0.23461064169536228, "mean_action_processing_ms": 0.05717403737828541, "mean_env_wait_ms": 0.5749205141111786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002531766891479492, "StateBufferConnector_ms": 0.001737356185913086, "ViewRequirementAgentConnector_ms": 0.04350996017456055}}, "episode_reward_max": -3525.5609396367972, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.4490056096524, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.1961454973484, -3526.810725701034, -3527.515116888697, -3527.778150621582, -3527.1398504418785, -3527.497184480295, -3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352728052741253, "mean_inference_ms": 0.23461064169536228, "mean_action_processing_ms": 0.05717403737828541, "mean_env_wait_ms": 0.5749205141111786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002531766891479492, "StateBufferConnector_ms": 0.001737356185913086, "ViewRequirementAgentConnector_ms": 0.04350996017456055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 788880, "num_agent_steps_trained": 788880, "num_env_steps_sampled": 788880, "num_env_steps_trained": 788880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.29727198453244, "num_env_steps_trained_throughput_per_sec": 189.29727198453244, "timesteps_total": 788880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 788880, "timers": {"training_iteration_time_ms": 1898.104, "sample_time_ms": 1890.937, "load_time_ms": 0.223, "load_throughput": 1615091.924, "learn_time_ms": 6.404, "learn_throughput": 56217.216, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 788880, "num_env_steps_trained": 788880, "num_agent_steps_sampled": 788880, "num_agent_steps_trained": 788880}, "done": false, "episodes_total": 2672, "training_iteration": 489, "trial_id": "6192e_00000", "date": "2023-08-04_11-23-57", "timestamp": 1691137437, "time_this_iter_s": 11.412665843963623, "time_total_s": 5457.75479722023, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2087.2957735061646, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 20.21875, "ram_util_percent": 64.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.31467895507814, "policy_loss": -3879032.409375, "vf_loss": 20743822.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5543.0, "diff_num_grad_updates_vs_sampler_policy": 5542.0}}, "num_env_steps_sampled": 791040, "num_env_steps_trained": 791040, "num_agent_steps_sampled": 791040, "num_agent_steps_trained": 791040}, "sampler_results": {"episode_reward_max": -3525.5609396367972, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.4271974918024, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352753250468641, "mean_inference_ms": 0.23461152219278858, "mean_action_processing_ms": 0.05717421162366585, "mean_env_wait_ms": 0.5748914506599277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542734146118164, "StateBufferConnector_ms": 0.001743316650390625, "ViewRequirementAgentConnector_ms": 0.04351091384887695}}, "episode_reward_max": -3525.5609396367972, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.4271974918024, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5438648495146, -3529.4341185186317, -3528.0795709292647, -3526.8094382738223, -3526.648658091222, -3525.5609396367972, -3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352753250468641, "mean_inference_ms": 0.23461152219278858, "mean_action_processing_ms": 0.05717421162366585, "mean_env_wait_ms": 0.5748914506599277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542734146118164, "StateBufferConnector_ms": 0.001743316650390625, "ViewRequirementAgentConnector_ms": 0.04351091384887695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 791040, "num_agent_steps_trained": 791040, "num_env_steps_sampled": 791040, "num_env_steps_trained": 791040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.7210038475146, "num_env_steps_trained_throughput_per_sec": 190.7210038475146, "timesteps_total": 791040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 791040, "timers": {"training_iteration_time_ms": 1891.517, "sample_time_ms": 1884.387, "load_time_ms": 0.225, "load_throughput": 1600879.389, "learn_time_ms": 6.356, "learn_throughput": 56636.838, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 791040, "num_env_steps_trained": 791040, "num_agent_steps_sampled": 791040, "num_agent_steps_trained": 791040}, "done": false, "episodes_total": 2678, "training_iteration": 490, "trial_id": "6192e_00000", "date": "2023-08-04_11-24-08", "timestamp": 1691137448, "time_this_iter_s": 11.32753610610962, "time_total_s": 5469.08233332634, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2098.623309612274, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 20.4625, "ram_util_percent": 64.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.5179382324219, "policy_loss": -11776334.05, "vf_loss": 20776776.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5573.0, "diff_num_grad_updates_vs_sampler_policy": 5572.0}}, "num_env_steps_sampled": 793200, "num_env_steps_trained": 793200, "num_agent_steps_sampled": 793200, "num_agent_steps_trained": 793200}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.520116067369, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352778707848837, "mean_inference_ms": 0.2346125516046196, "mean_action_processing_ms": 0.05717439950382542, "mean_env_wait_ms": 0.5748621119455593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002543926239013672, "StateBufferConnector_ms": 0.001737833023071289, "ViewRequirementAgentConnector_ms": 0.04355430603027344}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.520116067369, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.663984730915, -3528.8846757519036, -3526.2385273810896, -3527.0567103481285, -3526.3933436556613, -3528.4773596638765, -3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352778707848837, "mean_inference_ms": 0.2346125516046196, "mean_action_processing_ms": 0.05717439950382542, "mean_env_wait_ms": 0.5748621119455593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002543926239013672, "StateBufferConnector_ms": 0.001737833023071289, "ViewRequirementAgentConnector_ms": 0.04355430603027344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 793200, "num_agent_steps_trained": 793200, "num_env_steps_sampled": 793200, "num_env_steps_trained": 793200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.3791199310729, "num_env_steps_trained_throughput_per_sec": 190.3791199310729, "timesteps_total": 793200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 793200, "timers": {"training_iteration_time_ms": 1889.548, "sample_time_ms": 1882.468, "load_time_ms": 0.218, "load_throughput": 1649136.566, "learn_time_ms": 6.332, "learn_throughput": 56853.717, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 793200, "num_env_steps_trained": 793200, "num_agent_steps_sampled": 793200, "num_agent_steps_trained": 793200}, "done": false, "episodes_total": 2684, "training_iteration": 491, "trial_id": "6192e_00000", "date": "2023-08-04_11-24-20", "timestamp": 1691137460, "time_this_iter_s": 11.347807884216309, "time_total_s": 5480.430141210556, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2109.9711174964905, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 25.09375, "ram_util_percent": 64.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3416381835938, "policy_loss": -3290171.384375, "vf_loss": 20741248.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5603.0, "diff_num_grad_updates_vs_sampler_policy": 5602.0}}, "num_env_steps_sampled": 795360, "num_env_steps_trained": 795360, "num_agent_steps_sampled": 795360, "num_agent_steps_trained": 795360}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.527384644591, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352803665836306, "mean_inference_ms": 0.23461335215107468, "mean_action_processing_ms": 0.05717450517733167, "mean_env_wait_ms": 0.574835363939429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025370121002197266, "StateBufferConnector_ms": 0.0017347335815429688, "ViewRequirementAgentConnector_ms": 0.04343390464782715}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.527384644591, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6618486071734, -3527.1943703133793, -3526.7613885885366, -3526.6159576421965, -3527.817772763763, -3527.623807808695, -3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352803665836306, "mean_inference_ms": 0.23461335215107468, "mean_action_processing_ms": 0.05717450517733167, "mean_env_wait_ms": 0.574835363939429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025370121002197266, "StateBufferConnector_ms": 0.0017347335815429688, "ViewRequirementAgentConnector_ms": 0.04343390464782715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 795360, "num_agent_steps_trained": 795360, "num_env_steps_sampled": 795360, "num_env_steps_trained": 795360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.32124486866448, "num_env_steps_trained_throughput_per_sec": 190.32124486866448, "timesteps_total": 795360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 795360, "timers": {"training_iteration_time_ms": 1892.122, "sample_time_ms": 1885.109, "load_time_ms": 0.216, "load_throughput": 1667162.902, "learn_time_ms": 6.273, "learn_throughput": 57386.342, "synch_weights_time_ms": 0.494}, "counters": {"num_env_steps_sampled": 795360, "num_env_steps_trained": 795360, "num_agent_steps_sampled": 795360, "num_agent_steps_trained": 795360}, "done": false, "episodes_total": 2690, "training_iteration": 492, "trial_id": "6192e_00000", "date": "2023-08-04_11-24-31", "timestamp": 1691137471, "time_this_iter_s": 11.351267099380493, "time_total_s": 5491.7814083099365, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2121.322384595871, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 20.6125, "ram_util_percent": 64.94375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1674377441406, "policy_loss": -2411066.090625, "vf_loss": 20742417.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5633.0, "diff_num_grad_updates_vs_sampler_policy": 5632.0}}, "num_env_steps_sampled": 797520, "num_env_steps_trained": 797520, "num_agent_steps_sampled": 797520, "num_agent_steps_trained": 797520}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.5224347036497, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3528332588244405, "mean_inference_ms": 0.23461385027407033, "mean_action_processing_ms": 0.057174565945820675, "mean_env_wait_ms": 0.5748085059275537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025403499603271484, "StateBufferConnector_ms": 0.0017380714416503906, "ViewRequirementAgentConnector_ms": 0.04351997375488281}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.5224347036497, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.8721309177645, -3526.7492609001342, -3527.1144799725093, -3526.3515180823806, -3527.478213383283, -3527.102837649, -3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3528332588244405, "mean_inference_ms": 0.23461385027407033, "mean_action_processing_ms": 0.057174565945820675, "mean_env_wait_ms": 0.5748085059275537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025403499603271484, "StateBufferConnector_ms": 0.0017380714416503906, "ViewRequirementAgentConnector_ms": 0.04351997375488281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 797520, "num_agent_steps_trained": 797520, "num_env_steps_sampled": 797520, "num_env_steps_trained": 797520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.05476487655235, "num_env_steps_trained_throughput_per_sec": 190.05476487655235, "timesteps_total": 797520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 797520, "timers": {"training_iteration_time_ms": 1892.462, "sample_time_ms": 1885.373, "load_time_ms": 0.218, "load_throughput": 1653108.649, "learn_time_ms": 6.333, "learn_throughput": 56846.867, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 797520, "num_env_steps_trained": 797520, "num_agent_steps_sampled": 797520, "num_agent_steps_trained": 797520}, "done": false, "episodes_total": 2696, "training_iteration": 493, "trial_id": "6192e_00000", "date": "2023-08-04_11-24-42", "timestamp": 1691137482, "time_this_iter_s": 11.36720609664917, "time_total_s": 5503.148614406586, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2132.68959069252, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 18.535294117647055, "ram_util_percent": 64.94117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.352880859375, "policy_loss": -5540303.0125, "vf_loss": 20773016.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5663.0, "diff_num_grad_updates_vs_sampler_policy": 5662.0}}, "num_env_steps_sampled": 799680, "num_env_steps_trained": 799680, "num_agent_steps_sampled": 799680, "num_agent_steps_trained": 799680}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.5478524619784, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352860612892607, "mean_inference_ms": 0.2346144710741722, "mean_action_processing_ms": 0.0571746472685873, "mean_env_wait_ms": 0.5747851429214813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542257308959961, "StateBufferConnector_ms": 0.0017383098602294922, "ViewRequirementAgentConnector_ms": 0.043482065200805664}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3547.9038849815515, "episode_reward_mean": -3527.5478524619784, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.8878046960012, -3527.347469123545, -3527.293046036374, -3526.5563247117743, -3528.985148358042, -3547.9038849815515, -3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352860612892607, "mean_inference_ms": 0.2346144710741722, "mean_action_processing_ms": 0.0571746472685873, "mean_env_wait_ms": 0.5747851429214813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542257308959961, "StateBufferConnector_ms": 0.0017383098602294922, "ViewRequirementAgentConnector_ms": 0.043482065200805664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 799680, "num_agent_steps_trained": 799680, "num_env_steps_sampled": 799680, "num_env_steps_trained": 799680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.51052621673486, "num_env_steps_trained_throughput_per_sec": 190.51052621673486, "timesteps_total": 799680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 799680, "timers": {"training_iteration_time_ms": 1891.258, "sample_time_ms": 1884.179, "load_time_ms": 0.216, "load_throughput": 1668821.22, "learn_time_ms": 6.336, "learn_throughput": 56817.776, "synch_weights_time_ms": 0.496}, "counters": {"num_env_steps_sampled": 799680, "num_env_steps_trained": 799680, "num_agent_steps_sampled": 799680, "num_agent_steps_trained": 799680}, "done": false, "episodes_total": 2702, "training_iteration": 494, "trial_id": "6192e_00000", "date": "2023-08-04_11-24-54", "timestamp": 1691137494, "time_this_iter_s": 11.340250015258789, "time_total_s": 5514.4888644218445, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2144.029840707779, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 18.975, "ram_util_percent": 64.96875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2719421386719, "policy_loss": -4036937.434375, "vf_loss": 20739633.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5693.0, "diff_num_grad_updates_vs_sampler_policy": 5692.0}}, "num_env_steps_sampled": 801840, "num_env_steps_trained": 801840, "num_agent_steps_sampled": 801840, "num_agent_steps_trained": 801840}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3708420574635, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35289102515825, "mean_inference_ms": 0.234614869088756, "mean_action_processing_ms": 0.05717469518780671, "mean_env_wait_ms": 0.5747658433424219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025358200073242188, "StateBufferConnector_ms": 0.0017342567443847656, "ViewRequirementAgentConnector_ms": 0.04344058036804199}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3708420574635, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.853885538419, -3527.28241484322, -3528.256954083023, -3526.553275968514, -3526.547316770414, -3527.8462577414075, -3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35289102515825, "mean_inference_ms": 0.234614869088756, "mean_action_processing_ms": 0.05717469518780671, "mean_env_wait_ms": 0.5747658433424219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025358200073242188, "StateBufferConnector_ms": 0.0017342567443847656, "ViewRequirementAgentConnector_ms": 0.04344058036804199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 801840, "num_agent_steps_trained": 801840, "num_env_steps_sampled": 801840, "num_env_steps_trained": 801840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.63770721674553, "num_env_steps_trained_throughput_per_sec": 189.63770721674553, "timesteps_total": 801840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 801840, "timers": {"training_iteration_time_ms": 1894.967, "sample_time_ms": 1887.826, "load_time_ms": 0.217, "load_throughput": 1658009.707, "learn_time_ms": 6.382, "learn_throughput": 56408.119, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 801840, "num_env_steps_trained": 801840, "num_agent_steps_sampled": 801840, "num_agent_steps_trained": 801840}, "done": false, "episodes_total": 2708, "training_iteration": 495, "trial_id": "6192e_00000", "date": "2023-08-04_11-25-05", "timestamp": 1691137505, "time_this_iter_s": 11.392341136932373, "time_total_s": 5525.881205558777, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2155.4221818447113, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 20.549999999999997, "ram_util_percent": 64.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2345703125, "policy_loss": -6311011.7375, "vf_loss": 20733733.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5723.0, "diff_num_grad_updates_vs_sampler_policy": 5722.0}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3548218568812, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3529214926557955, "mean_inference_ms": 0.23461488418498067, "mean_action_processing_ms": 0.05717465851894761, "mean_env_wait_ms": 0.5747471560713536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025267601013183594, "StateBufferConnector_ms": 0.0017230510711669922, "ViewRequirementAgentConnector_ms": 0.04333233833312988}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3548218568812, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.4328567678463, -3527.442185255464, -3527.0222259276557, -3526.4262412233757, -3526.811705488247, -3526.9145691492963, -3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3529214926557955, "mean_inference_ms": 0.23461488418498067, "mean_action_processing_ms": 0.05717465851894761, "mean_env_wait_ms": 0.5747471560713536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025267601013183594, "StateBufferConnector_ms": 0.0017230510711669922, "ViewRequirementAgentConnector_ms": 0.04333233833312988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.29992103759193, "num_env_steps_trained_throughput_per_sec": 190.29992103759193, "timesteps_total": 804000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 1897.581, "sample_time_ms": 1890.492, "load_time_ms": 0.219, "load_throughput": 1647517.119, "learn_time_ms": 6.341, "learn_throughput": 56772.273, "synch_weights_time_ms": 0.498}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 2714, "training_iteration": 496, "trial_id": "6192e_00000", "date": "2023-08-04_11-25-17", "timestamp": 1691137517, "time_this_iter_s": 11.3524911403656, "time_total_s": 5537.2336966991425, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2166.774672985077, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 19.331249999999997, "ram_util_percent": 64.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.20997924804686, "policy_loss": -665967.275, "vf_loss": 20742716.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5753.0, "diff_num_grad_updates_vs_sampler_policy": 5752.0}}, "num_env_steps_sampled": 806160, "num_env_steps_trained": 806160, "num_agent_steps_sampled": 806160, "num_agent_steps_trained": 806160}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3398295236693, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352949526172513, "mean_inference_ms": 0.23461556900126748, "mean_action_processing_ms": 0.05717473409258373, "mean_env_wait_ms": 0.5747280892522396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519369125366211, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.043401241302490234}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3398295236693, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.209468369229, -3525.700587536385, -3526.2216477764973, -3526.4919188341896, -3528.717443194779, -3527.8333889230903, -3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352949526172513, "mean_inference_ms": 0.23461556900126748, "mean_action_processing_ms": 0.05717473409258373, "mean_env_wait_ms": 0.5747280892522396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519369125366211, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.043401241302490234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 806160, "num_agent_steps_trained": 806160, "num_env_steps_sampled": 806160, "num_env_steps_trained": 806160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.2765039104706, "num_env_steps_trained_throughput_per_sec": 190.2765039104706, "timesteps_total": 806160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 806160, "timers": {"training_iteration_time_ms": 1893.082, "sample_time_ms": 1886.027, "load_time_ms": 0.216, "load_throughput": 1670298.053, "learn_time_ms": 6.294, "learn_throughput": 57196.788, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 806160, "num_env_steps_trained": 806160, "num_agent_steps_sampled": 806160, "num_agent_steps_trained": 806160}, "done": false, "episodes_total": 2720, "training_iteration": 497, "trial_id": "6192e_00000", "date": "2023-08-04_11-25-28", "timestamp": 1691137528, "time_this_iter_s": 11.35393500328064, "time_total_s": 5548.587631702423, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2178.1286079883575, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 19.012500000000003, "ram_util_percent": 64.76249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2395935058594, "policy_loss": -537143.15, "vf_loss": 20738018.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5783.0, "diff_num_grad_updates_vs_sampler_policy": 5782.0}}, "num_env_steps_sampled": 808320, "num_env_steps_trained": 808320, "num_agent_steps_sampled": 808320, "num_agent_steps_trained": 808320}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3491150187356, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3529743461998125, "mean_inference_ms": 0.23461658176022002, "mean_action_processing_ms": 0.05717484812594426, "mean_env_wait_ms": 0.5747127339887759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002523660659790039, "StateBufferConnector_ms": 0.0017247200012207031, "ViewRequirementAgentConnector_ms": 0.04339003562927246}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3491150187356, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5621590517267, -3526.7221891155245, -3527.017704321551, -3529.2306780591093, -3525.9089616456886, -3525.9550944011107, -3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3529743461998125, "mean_inference_ms": 0.23461658176022002, "mean_action_processing_ms": 0.05717484812594426, "mean_env_wait_ms": 0.5747127339887759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002523660659790039, "StateBufferConnector_ms": 0.0017247200012207031, "ViewRequirementAgentConnector_ms": 0.04339003562927246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808320, "num_agent_steps_trained": 808320, "num_env_steps_sampled": 808320, "num_env_steps_trained": 808320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.33852251476534, "num_env_steps_trained_throughput_per_sec": 190.33852251476534, "timesteps_total": 808320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 808320, "timers": {"training_iteration_time_ms": 1891.639, "sample_time_ms": 1884.615, "load_time_ms": 0.216, "load_throughput": 1670482.841, "learn_time_ms": 6.269, "learn_throughput": 57428.03, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 808320, "num_env_steps_trained": 808320, "num_agent_steps_sampled": 808320, "num_agent_steps_trained": 808320}, "done": false, "episodes_total": 2726, "training_iteration": 498, "trial_id": "6192e_00000", "date": "2023-08-04_11-25-39", "timestamp": 1691137539, "time_this_iter_s": 11.350275039672852, "time_total_s": 5559.937906742096, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2189.4788830280304, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 19.6125, "ram_util_percent": 64.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.45331420898435, "policy_loss": -5815612.45, "vf_loss": 20755600.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5813.0, "diff_num_grad_updates_vs_sampler_policy": 5812.0}}, "num_env_steps_sampled": 810480, "num_env_steps_trained": 810480, "num_agent_steps_sampled": 810480, "num_agent_steps_trained": 810480}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3510825383073, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352998855849012, "mean_inference_ms": 0.23461827067724714, "mean_action_processing_ms": 0.05717504145623046, "mean_env_wait_ms": 0.5746984135847409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002523660659790039, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.04343700408935547}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3510825383073, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.0606405450735, -3526.1904320103013, -3534.35869617563, -3527.2319078051805, -3527.146645549169, -3526.507620083852, -3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352998855849012, "mean_inference_ms": 0.23461827067724714, "mean_action_processing_ms": 0.05717504145623046, "mean_env_wait_ms": 0.5746984135847409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002523660659790039, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.04343700408935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810480, "num_agent_steps_trained": 810480, "num_env_steps_sampled": 810480, "num_env_steps_trained": 810480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.31554365392367, "num_env_steps_trained_throughput_per_sec": 190.31554365392367, "timesteps_total": 810480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 810480, "timers": {"training_iteration_time_ms": 1891.169, "sample_time_ms": 1884.139, "load_time_ms": 0.215, "load_throughput": 1673816.029, "learn_time_ms": 6.293, "learn_throughput": 57210.874, "synch_weights_time_ms": 0.491}, "counters": {"num_env_steps_sampled": 810480, "num_env_steps_trained": 810480, "num_agent_steps_sampled": 810480, "num_agent_steps_trained": 810480}, "done": false, "episodes_total": 2732, "training_iteration": 499, "trial_id": "6192e_00000", "date": "2023-08-04_11-25-51", "timestamp": 1691137551, "time_this_iter_s": 11.351611137390137, "time_total_s": 5571.289517879486, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2200.8304941654205, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 20.15, "ram_util_percent": 64.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3682067871094, "policy_loss": -6475568.3375, "vf_loss": 20746940.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5843.0, "diff_num_grad_updates_vs_sampler_policy": 5842.0}}, "num_env_steps_sampled": 812640, "num_env_steps_trained": 812640, "num_agent_steps_sampled": 812640, "num_agent_steps_trained": 812640}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.2976013177263, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353022775857861, "mean_inference_ms": 0.23461979200873848, "mean_action_processing_ms": 0.057175167323308795, "mean_env_wait_ms": 0.5746858339737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025014877319335938, "StateBufferConnector_ms": 0.0017418861389160156, "ViewRequirementAgentConnector_ms": 0.04350161552429199}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.2976013177263, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.252722864011, -3525.7488632388886, -3525.9234991149237, -3528.4892967657843, -3526.304285047067, -3527.488383149684, -3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353022775857861, "mean_inference_ms": 0.23461979200873848, "mean_action_processing_ms": 0.057175167323308795, "mean_env_wait_ms": 0.5746858339737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025014877319335938, "StateBufferConnector_ms": 0.0017418861389160156, "ViewRequirementAgentConnector_ms": 0.04350161552429199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 812640, "num_agent_steps_trained": 812640, "num_env_steps_sampled": 812640, "num_env_steps_trained": 812640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.289444767847, "num_env_steps_trained_throughput_per_sec": 190.289444767847, "timesteps_total": 812640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 812640, "timers": {"training_iteration_time_ms": 1892.432, "sample_time_ms": 1885.291, "load_time_ms": 0.22, "load_throughput": 1636446.776, "learn_time_ms": 6.375, "learn_throughput": 56472.675, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 812640, "num_env_steps_trained": 812640, "num_agent_steps_sampled": 812640, "num_agent_steps_trained": 812640}, "done": false, "episodes_total": 2738, "training_iteration": 500, "trial_id": "6192e_00000", "date": "2023-08-04_11-26-02", "timestamp": 1691137562, "time_this_iter_s": 11.353275060653687, "time_total_s": 5582.64279294014, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2212.183769226074, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 23.487499999999997, "ram_util_percent": 64.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.402197265625, "policy_loss": -2006257.890625, "vf_loss": 20752270.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5873.0, "diff_num_grad_updates_vs_sampler_policy": 5872.0}}, "num_env_steps_sampled": 814800, "num_env_steps_trained": 814800, "num_agent_steps_sampled": 814800, "num_agent_steps_trained": 814800}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3012805439193, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353040695116839, "mean_inference_ms": 0.23462072020319197, "mean_action_processing_ms": 0.0571752348249763, "mean_env_wait_ms": 0.5746745440265629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024929046630859375, "StateBufferConnector_ms": 0.0017423629760742188, "ViewRequirementAgentConnector_ms": 0.04349541664123535}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.3012805439193, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.609831706813, -3528.1087904030874, -3528.7635182304307, -3525.600051700557, -3526.0927837099616, -3526.882396245765, -3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353040695116839, "mean_inference_ms": 0.23462072020319197, "mean_action_processing_ms": 0.0571752348249763, "mean_env_wait_ms": 0.5746745440265629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024929046630859375, "StateBufferConnector_ms": 0.0017423629760742188, "ViewRequirementAgentConnector_ms": 0.04349541664123535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 814800, "num_agent_steps_trained": 814800, "num_env_steps_sampled": 814800, "num_env_steps_trained": 814800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.56576262901717, "num_env_steps_trained_throughput_per_sec": 190.56576262901717, "timesteps_total": 814800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 814800, "timers": {"training_iteration_time_ms": 1890.408, "sample_time_ms": 1883.309, "load_time_ms": 0.22, "load_throughput": 1638577.797, "learn_time_ms": 6.345, "learn_throughput": 56738.567, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 814800, "num_env_steps_trained": 814800, "num_agent_steps_sampled": 814800, "num_agent_steps_trained": 814800}, "done": false, "episodes_total": 2744, "training_iteration": 501, "trial_id": "6192e_00000", "date": "2023-08-04_11-26-13", "timestamp": 1691137573, "time_this_iter_s": 11.33662724494934, "time_total_s": 5593.979420185089, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2223.5203964710236, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 20.15, "ram_util_percent": 64.91874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.436767578125, "policy_loss": -12324604.584375, "vf_loss": 20762698.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5903.0, "diff_num_grad_updates_vs_sampler_policy": 5902.0}}, "num_env_steps_sampled": 816960, "num_env_steps_trained": 816960, "num_agent_steps_sampled": 816960, "num_agent_steps_trained": 816960}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.2975838132943, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3530599664532215, "mean_inference_ms": 0.23462148641926625, "mean_action_processing_ms": 0.057175237286924696, "mean_env_wait_ms": 0.5746648107318023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024955272674560547, "StateBufferConnector_ms": 0.0017390251159667969, "ViewRequirementAgentConnector_ms": 0.04352521896362305}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.2975838132943, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.605013286406, -3526.0532908607906, -3526.6164298672657, -3526.7621363126655, -3526.0176355816625, -3526.7524745399337, -3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3530599664532215, "mean_inference_ms": 0.23462148641926625, "mean_action_processing_ms": 0.057175237286924696, "mean_env_wait_ms": 0.5746648107318023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024955272674560547, "StateBufferConnector_ms": 0.0017390251159667969, "ViewRequirementAgentConnector_ms": 0.04352521896362305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816960, "num_agent_steps_trained": 816960, "num_env_steps_sampled": 816960, "num_env_steps_trained": 816960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.94730484053517, "num_env_steps_trained_throughput_per_sec": 189.94730484053517, "timesteps_total": 816960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 816960, "timers": {"training_iteration_time_ms": 1893.201, "sample_time_ms": 1886.189, "load_time_ms": 0.214, "load_throughput": 1679027.51, "learn_time_ms": 6.276, "learn_throughput": 57361.926, "synch_weights_time_ms": 0.49}, "counters": {"num_env_steps_sampled": 816960, "num_env_steps_trained": 816960, "num_agent_steps_sampled": 816960, "num_agent_steps_trained": 816960}, "done": false, "episodes_total": 2750, "training_iteration": 502, "trial_id": "6192e_00000", "date": "2023-08-04_11-26-25", "timestamp": 1691137585, "time_this_iter_s": 11.373602151870728, "time_total_s": 5605.35302233696, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2234.8939986228943, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 20.7875, "ram_util_percent": 65.18125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1775329589844, "policy_loss": -1232034.665625, "vf_loss": 20734608.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5933.0, "diff_num_grad_updates_vs_sampler_policy": 5932.0}}, "num_env_steps_sampled": 819120, "num_env_steps_trained": 819120, "num_agent_steps_sampled": 819120, "num_agent_steps_trained": 819120}, "sampler_results": {"episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.304360509372, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353070852952942, "mean_inference_ms": 0.23462195262730623, "mean_action_processing_ms": 0.05717520770259551, "mean_env_wait_ms": 0.5746562176586331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.04353451728820801}}, "episode_reward_max": -3525.586742566332, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.304360509372, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.586742566332, -3525.586742566332, -3526.5482767737526, -3528.41498356454, -3526.577917434722, -3527.5006608930826, -3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353070852952942, "mean_inference_ms": 0.23462195262730623, "mean_action_processing_ms": 0.05717520770259551, "mean_env_wait_ms": 0.5746562176586331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.04353451728820801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 819120, "num_agent_steps_trained": 819120, "num_env_steps_sampled": 819120, "num_env_steps_trained": 819120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.17884846254034, "num_env_steps_trained_throughput_per_sec": 191.17884846254034, "timesteps_total": 819120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 819120, "timers": {"training_iteration_time_ms": 1888.388, "sample_time_ms": 1881.361, "load_time_ms": 0.213, "load_throughput": 1686529.029, "learn_time_ms": 6.28, "learn_throughput": 57320.987, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 819120, "num_env_steps_trained": 819120, "num_agent_steps_sampled": 819120, "num_agent_steps_trained": 819120}, "done": false, "episodes_total": 2756, "training_iteration": 503, "trial_id": "6192e_00000", "date": "2023-08-04_11-26-36", "timestamp": 1691137596, "time_this_iter_s": 11.300381898880005, "time_total_s": 5616.65340423584, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2246.1943805217743, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 18.987499999999997, "ram_util_percent": 65.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2016845703125, "policy_loss": -5081393.896875, "vf_loss": 20742271.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5963.0, "diff_num_grad_updates_vs_sampler_policy": 5962.0}}, "num_env_steps_sampled": 821280, "num_env_steps_trained": 821280, "num_agent_steps_sampled": 821280, "num_agent_steps_trained": 821280}, "sampler_results": {"episode_reward_max": -3525.813133061021, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.378997579687, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353078774579037, "mean_inference_ms": 0.23462139275105728, "mean_action_processing_ms": 0.057175037537304456, "mean_env_wait_ms": 0.5746496371456218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.0017292499542236328, "ViewRequirementAgentConnector_ms": 0.04355883598327637}}, "episode_reward_max": -3525.813133061021, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.378997579687, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.469301787223, -3527.536495968565, -3528.7168744104183, -3526.829765057251, -3527.4050092338293, -3535.10666786188, -3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353078774579037, "mean_inference_ms": 0.23462139275105728, "mean_action_processing_ms": 0.057175037537304456, "mean_env_wait_ms": 0.5746496371456218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025081634521484375, "StateBufferConnector_ms": 0.0017292499542236328, "ViewRequirementAgentConnector_ms": 0.04355883598327637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 821280, "num_agent_steps_trained": 821280, "num_env_steps_sampled": 821280, "num_env_steps_trained": 821280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.400701605945, "num_env_steps_trained_throughput_per_sec": 190.400701605945, "timesteps_total": 821280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 821280, "timers": {"training_iteration_time_ms": 1886.58, "sample_time_ms": 1879.532, "load_time_ms": 0.214, "load_throughput": 1681645.439, "learn_time_ms": 6.297, "learn_throughput": 57169.718, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 821280, "num_env_steps_trained": 821280, "num_agent_steps_sampled": 821280, "num_agent_steps_trained": 821280}, "done": false, "episodes_total": 2762, "training_iteration": 504, "trial_id": "6192e_00000", "date": "2023-08-04_11-26-48", "timestamp": 1691137608, "time_this_iter_s": 11.346745252609253, "time_total_s": 5628.000149488449, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2257.5411257743835, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 18.81875, "ram_util_percent": 65.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1394409179687, "policy_loss": -2410940.43125, "vf_loss": 20736284.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5993.0, "diff_num_grad_updates_vs_sampler_policy": 5992.0}}, "num_env_steps_sampled": 823440, "num_env_steps_trained": 823440, "num_agent_steps_sampled": 823440, "num_agent_steps_trained": 823440}, "sampler_results": {"episode_reward_max": -3525.5867742712453, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.2847561903786, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353087018214397, "mean_inference_ms": 0.23462127118916043, "mean_action_processing_ms": 0.05717486632180692, "mean_env_wait_ms": 0.5746410003713016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025110244750976562, "StateBufferConnector_ms": 0.0017304420471191406, "ViewRequirementAgentConnector_ms": 0.04362201690673828}}, "episode_reward_max": -3525.5867742712453, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.2847561903786, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.071105047049, -3530.1896188419646, -3529.8453598322853, -3526.940934347598, -3527.2366665782715, -3526.229317449053, -3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353087018214397, "mean_inference_ms": 0.23462127118916043, "mean_action_processing_ms": 0.05717486632180692, "mean_env_wait_ms": 0.5746410003713016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025110244750976562, "StateBufferConnector_ms": 0.0017304420471191406, "ViewRequirementAgentConnector_ms": 0.04362201690673828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 823440, "num_agent_steps_trained": 823440, "num_env_steps_sampled": 823440, "num_env_steps_trained": 823440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.9780624608393, "num_env_steps_trained_throughput_per_sec": 189.9780624608393, "timesteps_total": 823440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 823440, "timers": {"training_iteration_time_ms": 1893.562, "sample_time_ms": 1886.528, "load_time_ms": 0.215, "load_throughput": 1673259.574, "learn_time_ms": 6.29, "learn_throughput": 57233.861, "synch_weights_time_ms": 0.498}, "counters": {"num_env_steps_sampled": 823440, "num_env_steps_trained": 823440, "num_agent_steps_sampled": 823440, "num_agent_steps_trained": 823440}, "done": false, "episodes_total": 2768, "training_iteration": 505, "trial_id": "6192e_00000", "date": "2023-08-04_11-26-59", "timestamp": 1691137619, "time_this_iter_s": 11.371800899505615, "time_total_s": 5639.371950387955, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2268.912926673889, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 20.023529411764706, "ram_util_percent": 65.18235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.0954833984375, "policy_loss": 328468.209375, "vf_loss": 20729244.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6023.0, "diff_num_grad_updates_vs_sampler_policy": 6022.0}}, "num_env_steps_sampled": 825600, "num_env_steps_trained": 825600, "num_agent_steps_sampled": 825600, "num_agent_steps_trained": 825600}, "sampler_results": {"episode_reward_max": -3525.586773770158, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.2164611145654, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353095583669043, "mean_inference_ms": 0.23462052489539953, "mean_action_processing_ms": 0.057174611463665134, "mean_env_wait_ms": 0.5746245691779106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.001730203628540039, "ViewRequirementAgentConnector_ms": 0.04362034797668457}}, "episode_reward_max": -3525.586773770158, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.2164611145654, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.4713221111315, -3526.559293111678, -3527.7159470972415, -3526.5438154984936, -3526.143800751609, -3533.7307260711887, -3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353095583669043, "mean_inference_ms": 0.23462052489539953, "mean_action_processing_ms": 0.057174611463665134, "mean_env_wait_ms": 0.5746245691779106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.001730203628540039, "ViewRequirementAgentConnector_ms": 0.04362034797668457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 825600, "num_agent_steps_trained": 825600, "num_env_steps_sampled": 825600, "num_env_steps_trained": 825600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.72511126056656, "num_env_steps_trained_throughput_per_sec": 190.72511126056656, "timesteps_total": 825600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 825600, "timers": {"training_iteration_time_ms": 1889.175, "sample_time_ms": 1882.097, "load_time_ms": 0.216, "load_throughput": 1664039.497, "learn_time_ms": 6.325, "learn_throughput": 56918.01, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 825600, "num_env_steps_trained": 825600, "num_agent_steps_sampled": 825600, "num_agent_steps_trained": 825600}, "done": false, "episodes_total": 2774, "training_iteration": 506, "trial_id": "6192e_00000", "date": "2023-08-04_11-27-10", "timestamp": 1691137630, "time_this_iter_s": 11.327329158782959, "time_total_s": 5650.699279546738, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2280.240255832672, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 19.393749999999997, "ram_util_percent": 64.86875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.22905883789065, "policy_loss": -2279607.15625, "vf_loss": 20735164.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6053.0, "diff_num_grad_updates_vs_sampler_policy": 6052.0}}, "num_env_steps_sampled": 827760, "num_env_steps_trained": 827760, "num_agent_steps_sampled": 827760, "num_agent_steps_trained": 827760}, "sampler_results": {"episode_reward_max": -3525.586773770158, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.1547773487623, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353108236908156, "mean_inference_ms": 0.23461947767947447, "mean_action_processing_ms": 0.05717428359215738, "mean_env_wait_ms": 0.5746081817196214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025010108947753906, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.043628692626953125}}, "episode_reward_max": -3525.586773770158, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.1547773487623, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.178842934267, -3528.9082445015165, -3527.0767192807994, -3529.330114316524, -3527.9216161062564, -3527.0567208569105, -3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353108236908156, "mean_inference_ms": 0.23461947767947447, "mean_action_processing_ms": 0.05717428359215738, "mean_env_wait_ms": 0.5746081817196214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025010108947753906, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.043628692626953125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 827760, "num_agent_steps_trained": 827760, "num_env_steps_sampled": 827760, "num_env_steps_trained": 827760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.16876909898357, "num_env_steps_trained_throughput_per_sec": 190.16876909898357, "timesteps_total": 827760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 827760, "timers": {"training_iteration_time_ms": 1889.543, "sample_time_ms": 1882.39, "load_time_ms": 0.222, "load_throughput": 1623601.548, "learn_time_ms": 6.393, "learn_throughput": 56313.66, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 827760, "num_env_steps_trained": 827760, "num_agent_steps_sampled": 827760, "num_agent_steps_trained": 827760}, "done": false, "episodes_total": 2780, "training_iteration": 507, "trial_id": "6192e_00000", "date": "2023-08-04_11-27-22", "timestamp": 1691137642, "time_this_iter_s": 11.360573053359985, "time_total_s": 5662.059852600098, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2291.600828886032, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 17.99375, "ram_util_percent": 64.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1380920410156, "policy_loss": 313948.33125, "vf_loss": 20727757.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6083.0, "diff_num_grad_updates_vs_sampler_policy": 6082.0}}, "num_env_steps_sampled": 829920, "num_env_steps_trained": 829920, "num_agent_steps_sampled": 829920, "num_agent_steps_trained": 829920}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.0647170823677, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353125487178768, "mean_inference_ms": 0.23461833235818244, "mean_action_processing_ms": 0.05717388821099781, "mean_env_wait_ms": 0.5745880296801715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024957656860351562, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.04359555244445801}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.0647170823677, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.7737989005586, -3527.067775898431, -3527.787050373618, -3527.834497118038, -3528.3444387715513, -3526.866805241903, -3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353125487178768, "mean_inference_ms": 0.23461833235818244, "mean_action_processing_ms": 0.05717388821099781, "mean_env_wait_ms": 0.5745880296801715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024957656860351562, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.04359555244445801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 829920, "num_agent_steps_trained": 829920, "num_env_steps_sampled": 829920, "num_env_steps_trained": 829920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.28131556169555, "num_env_steps_trained_throughput_per_sec": 190.28131556169555, "timesteps_total": 829920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 829920, "timers": {"training_iteration_time_ms": 1894.16, "sample_time_ms": 1887.006, "load_time_ms": 0.221, "load_throughput": 1631848.525, "learn_time_ms": 6.366, "learn_throughput": 56554.108, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 829920, "num_env_steps_trained": 829920, "num_agent_steps_sampled": 829920, "num_agent_steps_trained": 829920}, "done": false, "episodes_total": 2786, "training_iteration": 508, "trial_id": "6192e_00000", "date": "2023-08-04_11-27-33", "timestamp": 1691137653, "time_this_iter_s": 11.353860855102539, "time_total_s": 5673.4137134552, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2302.9546897411346, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 19.8375, "ram_util_percent": 64.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.148779296875, "policy_loss": 59887.44375, "vf_loss": 20739871.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6113.0, "diff_num_grad_updates_vs_sampler_policy": 6112.0}}, "num_env_steps_sampled": 832080, "num_env_steps_trained": 832080, "num_agent_steps_sampled": 832080, "num_agent_steps_trained": 832080}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.0462419221385, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353140861259627, "mean_inference_ms": 0.2346181000175376, "mean_action_processing_ms": 0.05717360450963611, "mean_env_wait_ms": 0.5745685845160332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017175674438476562, "ViewRequirementAgentConnector_ms": 0.04360604286193848}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.0462419221385, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6418439111467, -3525.813133061021, -3527.997653870382, -3526.5162767734996, -3527.445002997945, -3526.614109646411, -3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353140861259627, "mean_inference_ms": 0.2346181000175376, "mean_action_processing_ms": 0.05717360450963611, "mean_env_wait_ms": 0.5745685845160332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017175674438476562, "ViewRequirementAgentConnector_ms": 0.04360604286193848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832080, "num_agent_steps_trained": 832080, "num_env_steps_sampled": 832080, "num_env_steps_trained": 832080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.251862000202, "num_env_steps_trained_throughput_per_sec": 190.251862000202, "timesteps_total": 832080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 832080, "timers": {"training_iteration_time_ms": 1890.822, "sample_time_ms": 1883.756, "load_time_ms": 0.216, "load_throughput": 1669928.6, "learn_time_ms": 6.298, "learn_throughput": 57159.114, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 832080, "num_env_steps_trained": 832080, "num_agent_steps_sampled": 832080, "num_agent_steps_trained": 832080}, "done": false, "episodes_total": 2792, "training_iteration": 509, "trial_id": "6192e_00000", "date": "2023-08-04_11-27-44", "timestamp": 1691137664, "time_this_iter_s": 11.355415105819702, "time_total_s": 5684.76912856102, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2314.3101048469543, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 20.4375, "ram_util_percent": 64.8875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.152001953125, "policy_loss": 123893.33125, "vf_loss": 20745046.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6143.0, "diff_num_grad_updates_vs_sampler_policy": 6142.0}}, "num_env_steps_sampled": 834240, "num_env_steps_trained": 834240, "num_agent_steps_sampled": 834240, "num_agent_steps_trained": 834240}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.021365350628, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353151461843697, "mean_inference_ms": 0.23461779311881237, "mean_action_processing_ms": 0.057173276606699304, "mean_env_wait_ms": 0.5745459619647799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025053024291992188, "StateBufferConnector_ms": 0.0017113685607910156, "ViewRequirementAgentConnector_ms": 0.04352211952209473}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.021365350628, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.882972689857, -3527.576770476131, -3526.5735264644827, -3529.117834463172, -3526.6948571978055, -3525.971626269731, -3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353151461843697, "mean_inference_ms": 0.23461779311881237, "mean_action_processing_ms": 0.057173276606699304, "mean_env_wait_ms": 0.5745459619647799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025053024291992188, "StateBufferConnector_ms": 0.0017113685607910156, "ViewRequirementAgentConnector_ms": 0.04352211952209473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 834240, "num_agent_steps_trained": 834240, "num_env_steps_sampled": 834240, "num_env_steps_trained": 834240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.2125244935933, "num_env_steps_trained_throughput_per_sec": 191.2125244935933, "timesteps_total": 834240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 834240, "timers": {"training_iteration_time_ms": 1887.792, "sample_time_ms": 1880.788, "load_time_ms": 0.216, "load_throughput": 1668268.081, "learn_time_ms": 6.257, "learn_throughput": 57534.596, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 834240, "num_env_steps_trained": 834240, "num_agent_steps_sampled": 834240, "num_agent_steps_trained": 834240}, "done": false, "episodes_total": 2798, "training_iteration": 510, "trial_id": "6192e_00000", "date": "2023-08-04_11-27-56", "timestamp": 1691137676, "time_this_iter_s": 11.29843521118164, "time_total_s": 5696.0675637722015, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2325.608540058136, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 19.4, "ram_util_percent": 64.76875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2281860351562, "policy_loss": -2476640.2, "vf_loss": 20745309.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6173.0, "diff_num_grad_updates_vs_sampler_policy": 6172.0}}, "num_env_steps_sampled": 836400, "num_env_steps_trained": 836400, "num_agent_steps_sampled": 836400, "num_agent_steps_trained": 836400}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.0127114651814, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353161284242478, "mean_inference_ms": 0.23461754636416182, "mean_action_processing_ms": 0.057172938439803825, "mean_env_wait_ms": 0.5745211297277403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025110244750976562, "StateBufferConnector_ms": 0.0017137527465820312, "ViewRequirementAgentConnector_ms": 0.04358959197998047}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3535.3723122855436, "episode_reward_mean": -3527.0127114651814, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.779282544565, -3526.8860038446933, -3535.3723122855436, -3526.568555313451, -3527.6724468411876, -3526.3906964883276, -3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353161284242478, "mean_inference_ms": 0.23461754636416182, "mean_action_processing_ms": 0.057172938439803825, "mean_env_wait_ms": 0.5745211297277403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025110244750976562, "StateBufferConnector_ms": 0.0017137527465820312, "ViewRequirementAgentConnector_ms": 0.04358959197998047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 836400, "num_agent_steps_trained": 836400, "num_env_steps_sampled": 836400, "num_env_steps_trained": 836400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.5870137738439, "num_env_steps_trained_throughput_per_sec": 190.5870137738439, "timesteps_total": 836400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 836400, "timers": {"training_iteration_time_ms": 1885.115, "sample_time_ms": 1878.03, "load_time_ms": 0.216, "load_throughput": 1666610.861, "learn_time_ms": 6.319, "learn_throughput": 56972.559, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 836400, "num_env_steps_trained": 836400, "num_agent_steps_sampled": 836400, "num_agent_steps_trained": 836400}, "done": false, "episodes_total": 2804, "training_iteration": 511, "trial_id": "6192e_00000", "date": "2023-08-04_11-28-07", "timestamp": 1691137687, "time_this_iter_s": 11.335691213607788, "time_total_s": 5707.403254985809, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2336.944231271744, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 18.3625, "ram_util_percent": 64.91875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.0954833984375, "policy_loss": 328468.215625, "vf_loss": 20729244.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6203.0, "diff_num_grad_updates_vs_sampler_policy": 6202.0}}, "num_env_steps_sampled": 838560, "num_env_steps_trained": 838560, "num_agent_steps_sampled": 838560, "num_agent_steps_trained": 838560}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.9234307355464, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353163588145874, "mean_inference_ms": 0.23461728645585492, "mean_action_processing_ms": 0.05717255545046165, "mean_env_wait_ms": 0.57449595191555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025076866149902344, "StateBufferConnector_ms": 0.0017173290252685547, "ViewRequirementAgentConnector_ms": 0.043585777282714844}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.9234307355464, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.1592978250333, -3528.957085676578, -3526.2253790031064, -3526.3331790525426, -3526.246749148399, -3526.6728343804934, -3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353163588145874, "mean_inference_ms": 0.23461728645585492, "mean_action_processing_ms": 0.05717255545046165, "mean_env_wait_ms": 0.57449595191555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025076866149902344, "StateBufferConnector_ms": 0.0017173290252685547, "ViewRequirementAgentConnector_ms": 0.043585777282714844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 838560, "num_agent_steps_trained": 838560, "num_env_steps_sampled": 838560, "num_env_steps_trained": 838560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.82026965828948, "num_env_steps_trained_throughput_per_sec": 190.82026965828948, "timesteps_total": 838560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 838560, "timers": {"training_iteration_time_ms": 1888.996, "sample_time_ms": 1881.901, "load_time_ms": 0.214, "load_throughput": 1684083.694, "learn_time_ms": 6.336, "learn_throughput": 56816.066, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 838560, "num_env_steps_trained": 838560, "num_agent_steps_sampled": 838560, "num_agent_steps_trained": 838560}, "done": false, "episodes_total": 2810, "training_iteration": 512, "trial_id": "6192e_00000", "date": "2023-08-04_11-28-18", "timestamp": 1691137698, "time_this_iter_s": 11.321579933166504, "time_total_s": 5718.724834918976, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2348.2658112049103, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 19.4, "ram_util_percent": 64.89375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1785949707031, "policy_loss": -4043757.65625, "vf_loss": 20734116.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6233.0, "diff_num_grad_updates_vs_sampler_policy": 6232.0}}, "num_env_steps_sampled": 840720, "num_env_steps_trained": 840720, "num_agent_steps_sampled": 840720, "num_agent_steps_trained": 840720}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.8999296192965, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353163227677475, "mean_inference_ms": 0.23461683277936793, "mean_action_processing_ms": 0.05717209305842729, "mean_env_wait_ms": 0.5744695973151334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025076866149902344, "StateBufferConnector_ms": 0.0017206668853759766, "ViewRequirementAgentConnector_ms": 0.04355263710021973}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.8999296192965, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.109001343745, -3525.823646104745, -3527.193761172419, -3526.504558340875, -3528.6419784305103, -3526.3051874063754, -3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353163227677475, "mean_inference_ms": 0.23461683277936793, "mean_action_processing_ms": 0.05717209305842729, "mean_env_wait_ms": 0.5744695973151334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025076866149902344, "StateBufferConnector_ms": 0.0017206668853759766, "ViewRequirementAgentConnector_ms": 0.04355263710021973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840720, "num_agent_steps_trained": 840720, "num_env_steps_sampled": 840720, "num_env_steps_trained": 840720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.82243199116712, "num_env_steps_trained_throughput_per_sec": 190.82243199116712, "timesteps_total": 840720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 840720, "timers": {"training_iteration_time_ms": 1887.66, "sample_time_ms": 1880.609, "load_time_ms": 0.215, "load_throughput": 1676231.616, "learn_time_ms": 6.297, "learn_throughput": 57167.77, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 840720, "num_env_steps_trained": 840720, "num_agent_steps_sampled": 840720, "num_agent_steps_trained": 840720}, "done": false, "episodes_total": 2816, "training_iteration": 513, "trial_id": "6192e_00000", "date": "2023-08-04_11-28-30", "timestamp": 1691137710, "time_this_iter_s": 11.321526050567627, "time_total_s": 5730.0463609695435, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2359.587337255478, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 21.456249999999997, "ram_util_percent": 65.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3694213867187, "policy_loss": -8589829.63125, "vf_loss": 20771499.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6263.0, "diff_num_grad_updates_vs_sampler_policy": 6262.0}}, "num_env_steps_sampled": 842880, "num_env_steps_trained": 842880, "num_agent_steps_sampled": 842880, "num_agent_steps_trained": 842880}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.8858397826516, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353161624676802, "mean_inference_ms": 0.2346157334668958, "mean_action_processing_ms": 0.057171506896598674, "mean_env_wait_ms": 0.5744436916162418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.043526649475097656}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.8858397826516, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.853435503609, -3526.4011511524245, -3526.651103853897, -3526.2501477939754, -3527.3033817308556, -3526.743108805559, -3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353161624676802, "mean_inference_ms": 0.2346157334668958, "mean_action_processing_ms": 0.057171506896598674, "mean_env_wait_ms": 0.5744436916162418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.043526649475097656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 842880, "num_agent_steps_trained": 842880, "num_env_steps_sampled": 842880, "num_env_steps_trained": 842880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.51548993266462, "num_env_steps_trained_throughput_per_sec": 190.51548993266462, "timesteps_total": 842880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 842880, "timers": {"training_iteration_time_ms": 1892.856, "sample_time_ms": 1885.791, "load_time_ms": 0.215, "load_throughput": 1678094.51, "learn_time_ms": 6.306, "learn_throughput": 57092.763, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 842880, "num_env_steps_trained": 842880, "num_agent_steps_sampled": 842880, "num_agent_steps_trained": 842880}, "done": false, "episodes_total": 2822, "training_iteration": 514, "trial_id": "6192e_00000", "date": "2023-08-04_11-28-41", "timestamp": 1691137721, "time_this_iter_s": 11.339816093444824, "time_total_s": 5741.386177062988, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2370.9271533489227, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 21.125, "ram_util_percent": 65.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.22706909179686, "policy_loss": -2560023.6625, "vf_loss": 20748883.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6293.0, "diff_num_grad_updates_vs_sampler_policy": 6292.0}}, "num_env_steps_sampled": 845040, "num_env_steps_trained": 845040, "num_agent_steps_sampled": 845040, "num_agent_steps_trained": 845040}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.945870404641, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353164099503154, "mean_inference_ms": 0.23461527594665849, "mean_action_processing_ms": 0.05717098884579776, "mean_env_wait_ms": 0.5744236703126853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513408660888672, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.043518781661987305}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.945870404641, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.533615354198, -3526.268147611535, -3527.1061102099748, -3527.6391748398237, -3527.621145520999, -3526.4838223601755, -3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353164099503154, "mean_inference_ms": 0.23461527594665849, "mean_action_processing_ms": 0.05717098884579776, "mean_env_wait_ms": 0.5744236703126853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513408660888672, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.043518781661987305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 845040, "num_agent_steps_trained": 845040, "num_env_steps_sampled": 845040, "num_env_steps_trained": 845040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 188.99498032550613, "num_env_steps_trained_throughput_per_sec": 188.99498032550613, "timesteps_total": 845040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 845040, "timers": {"training_iteration_time_ms": 1898.888, "sample_time_ms": 1891.835, "load_time_ms": 0.215, "load_throughput": 1672703.49, "learn_time_ms": 6.299, "learn_throughput": 57149.811, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 845040, "num_env_steps_trained": 845040, "num_agent_steps_sampled": 845040, "num_agent_steps_trained": 845040}, "done": false, "episodes_total": 2828, "training_iteration": 515, "trial_id": "6192e_00000", "date": "2023-08-04_11-28-52", "timestamp": 1691137732, "time_this_iter_s": 11.431047916412354, "time_total_s": 5752.817224979401, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2382.358201265335, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 21.0375, "ram_util_percent": 65.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.14959716796875, "policy_loss": -3210893.353125, "vf_loss": 20735090.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6323.0, "diff_num_grad_updates_vs_sampler_policy": 6322.0}}, "num_env_steps_sampled": 847200, "num_env_steps_trained": 847200, "num_agent_steps_sampled": 847200, "num_agent_steps_trained": 847200}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.956479809838, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353168746418472, "mean_inference_ms": 0.2346142882665233, "mean_action_processing_ms": 0.05717037757990587, "mean_env_wait_ms": 0.574404369402156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002508401870727539, "StateBufferConnector_ms": 0.0017213821411132812, "ViewRequirementAgentConnector_ms": 0.04363679885864258}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.956479809838, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.402756369393, -3527.5899712560717, -3527.12207296165, -3526.9280516427048, -3526.9307798280925, -3527.6383966018952, -3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353168746418472, "mean_inference_ms": 0.2346142882665233, "mean_action_processing_ms": 0.05717037757990587, "mean_env_wait_ms": 0.574404369402156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002508401870727539, "StateBufferConnector_ms": 0.0017213821411132812, "ViewRequirementAgentConnector_ms": 0.04363679885864258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 847200, "num_agent_steps_trained": 847200, "num_env_steps_sampled": 847200, "num_env_steps_trained": 847200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.04803110884174, "num_env_steps_trained_throughput_per_sec": 190.04803110884174, "timesteps_total": 847200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 847200, "timers": {"training_iteration_time_ms": 1896.661, "sample_time_ms": 1889.639, "load_time_ms": 0.219, "load_throughput": 1643035.299, "learn_time_ms": 6.272, "learn_throughput": 57393.541, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 847200, "num_env_steps_trained": 847200, "num_agent_steps_sampled": 847200, "num_agent_steps_trained": 847200}, "done": false, "episodes_total": 2834, "training_iteration": 516, "trial_id": "6192e_00000", "date": "2023-08-04_11-29-04", "timestamp": 1691137744, "time_this_iter_s": 11.367769718170166, "time_total_s": 5764.184994697571, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2393.7259709835052, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 19.93125, "ram_util_percent": 65.14375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3441162109375, "policy_loss": -4192435.034375, "vf_loss": 20747030.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6353.0, "diff_num_grad_updates_vs_sampler_policy": 6352.0}}, "num_env_steps_sampled": 849360, "num_env_steps_trained": 849360, "num_agent_steps_sampled": 849360, "num_agent_steps_trained": 849360}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.9368872218747, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353174058070202, "mean_inference_ms": 0.23461312740657625, "mean_action_processing_ms": 0.057169721138296534, "mean_env_wait_ms": 0.5743865404005828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.001725912094116211, "ViewRequirementAgentConnector_ms": 0.04361867904663086}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.9368872218747, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5188054875825, -3526.6734170355185, -3526.4367369810343, -3527.3768368656038, -3526.095500121613, -3526.7244854627916, -3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353174058070202, "mean_inference_ms": 0.23461312740657625, "mean_action_processing_ms": 0.057169721138296534, "mean_env_wait_ms": 0.5743865404005828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.001725912094116211, "ViewRequirementAgentConnector_ms": 0.04361867904663086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 849360, "num_agent_steps_trained": 849360, "num_env_steps_sampled": 849360, "num_env_steps_trained": 849360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.17188272500746, "num_env_steps_trained_throughput_per_sec": 190.17188272500746, "timesteps_total": 849360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 849360, "timers": {"training_iteration_time_ms": 1893.706, "sample_time_ms": 1886.669, "load_time_ms": 0.216, "load_throughput": 1669374.726, "learn_time_ms": 6.296, "learn_throughput": 57178.811, "synch_weights_time_ms": 0.494}, "counters": {"num_env_steps_sampled": 849360, "num_env_steps_trained": 849360, "num_agent_steps_sampled": 849360, "num_agent_steps_trained": 849360}, "done": false, "episodes_total": 2840, "training_iteration": 517, "trial_id": "6192e_00000", "date": "2023-08-04_11-29-15", "timestamp": 1691137755, "time_this_iter_s": 11.360126256942749, "time_total_s": 5775.545120954514, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2405.086097240448, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 19.08125, "ram_util_percent": 65.11875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.450244140625, "policy_loss": -4679539.175, "vf_loss": 20769428.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6383.0, "diff_num_grad_updates_vs_sampler_policy": 6382.0}}, "num_env_steps_sampled": 851520, "num_env_steps_trained": 851520, "num_agent_steps_sampled": 851520, "num_agent_steps_trained": 851520}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.9861374606753, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353183033837986, "mean_inference_ms": 0.23461283198837868, "mean_action_processing_ms": 0.057169146000814006, "mean_env_wait_ms": 0.5743711316813875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025026798248291016, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.043592214584350586}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.9861374606753, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.88439993079, -3527.1074318206192, -3526.346741541051, -3528.5291400572833, -3526.3868215563894, -3527.8711504115176, -3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353183033837986, "mean_inference_ms": 0.23461283198837868, "mean_action_processing_ms": 0.057169146000814006, "mean_env_wait_ms": 0.5743711316813875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025026798248291016, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.043592214584350586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 851520, "num_agent_steps_trained": 851520, "num_env_steps_sampled": 851520, "num_env_steps_trained": 851520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.45450541036195, "num_env_steps_trained_throughput_per_sec": 189.45450541036195, "timesteps_total": 851520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 851520, "timers": {"training_iteration_time_ms": 1899.123, "sample_time_ms": 1891.948, "load_time_ms": 0.213, "load_throughput": 1688981.477, "learn_time_ms": 6.418, "learn_throughput": 56090.038, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 851520, "num_env_steps_trained": 851520, "num_agent_steps_sampled": 851520, "num_agent_steps_trained": 851520}, "done": false, "episodes_total": 2846, "training_iteration": 518, "trial_id": "6192e_00000", "date": "2023-08-04_11-29-27", "timestamp": 1691137767, "time_this_iter_s": 11.403195142745972, "time_total_s": 5786.9483160972595, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2416.489292383194, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 19.799999999999997, "ram_util_percent": 65.02941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.38292236328124, "policy_loss": -4610204.8125, "vf_loss": 20760942.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6413.0, "diff_num_grad_updates_vs_sampler_policy": 6412.0}}, "num_env_steps_sampled": 853680, "num_env_steps_trained": 853680, "num_agent_steps_sampled": 853680, "num_agent_steps_trained": 853680}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.975562059125, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353193618703176, "mean_inference_ms": 0.2346123760736648, "mean_action_processing_ms": 0.05716857005029789, "mean_env_wait_ms": 0.574351780454291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024809837341308594, "StateBufferConnector_ms": 0.0017120838165283203, "ViewRequirementAgentConnector_ms": 0.043541669845581055}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3533.1545679548267, "episode_reward_mean": -3526.975562059125, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.2308067065915, -3526.7960136207457, -3526.0625403783156, -3526.137317382891, -3527.512872934322, -3533.1545679548267, -3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353193618703176, "mean_inference_ms": 0.2346123760736648, "mean_action_processing_ms": 0.05716857005029789, "mean_env_wait_ms": 0.574351780454291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024809837341308594, "StateBufferConnector_ms": 0.0017120838165283203, "ViewRequirementAgentConnector_ms": 0.043541669845581055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 853680, "num_agent_steps_trained": 853680, "num_env_steps_sampled": 853680, "num_env_steps_trained": 853680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.69247365277414, "num_env_steps_trained_throughput_per_sec": 190.69247365277414, "timesteps_total": 853680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 853680, "timers": {"training_iteration_time_ms": 1893.369, "sample_time_ms": 1886.286, "load_time_ms": 0.214, "load_throughput": 1680522.471, "learn_time_ms": 6.333, "learn_throughput": 56843.443, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 853680, "num_env_steps_trained": 853680, "num_agent_steps_sampled": 853680, "num_agent_steps_trained": 853680}, "done": false, "episodes_total": 2852, "training_iteration": 519, "trial_id": "6192e_00000", "date": "2023-08-04_11-29-38", "timestamp": 1691137778, "time_this_iter_s": 11.329056024551392, "time_total_s": 5798.277372121811, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2427.8183484077454, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 28.862500000000004, "ram_util_percent": 65.11875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.41356201171874, "policy_loss": -9583536.7875, "vf_loss": 20745720.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6443.0, "diff_num_grad_updates_vs_sampler_policy": 6442.0}}, "num_env_steps_sampled": 855840, "num_env_steps_trained": 855840, "num_agent_steps_sampled": 855840, "num_agent_steps_trained": 855840}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0129104138014, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3532067335396185, "mean_inference_ms": 0.23461276157325803, "mean_action_processing_ms": 0.057168112148795774, "mean_env_wait_ms": 0.5743374940419066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490997314453125, "StateBufferConnector_ms": 0.0017151832580566406, "ViewRequirementAgentConnector_ms": 0.04357504844665527}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0129104138014, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.3476852768313, -3527.5751493536613, -3526.59194272908, -3526.496812581529, -3527.986216031718, -3527.291950053266, -3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3532067335396185, "mean_inference_ms": 0.23461276157325803, "mean_action_processing_ms": 0.057168112148795774, "mean_env_wait_ms": 0.5743374940419066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490997314453125, "StateBufferConnector_ms": 0.0017151832580566406, "ViewRequirementAgentConnector_ms": 0.04357504844665527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 855840, "num_agent_steps_trained": 855840, "num_env_steps_sampled": 855840, "num_env_steps_trained": 855840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.88035921201455, "num_env_steps_trained_throughput_per_sec": 189.88035921201455, "timesteps_total": 855840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 855840, "timers": {"training_iteration_time_ms": 1890.865, "sample_time_ms": 1883.855, "load_time_ms": 0.214, "load_throughput": 1682020.096, "learn_time_ms": 6.274, "learn_throughput": 57383.725, "synch_weights_time_ms": 0.492}, "counters": {"num_env_steps_sampled": 855840, "num_env_steps_trained": 855840, "num_agent_steps_sampled": 855840, "num_agent_steps_trained": 855840}, "done": false, "episodes_total": 2858, "training_iteration": 520, "trial_id": "6192e_00000", "date": "2023-08-04_11-29-49", "timestamp": 1691137789, "time_this_iter_s": 11.377689838409424, "time_total_s": 5809.65506196022, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2439.196038246155, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 20.025, "ram_util_percent": 64.75625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.25030517578125, "policy_loss": -1151180.6625, "vf_loss": 20742034.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6473.0, "diff_num_grad_updates_vs_sampler_policy": 6472.0}}, "num_env_steps_sampled": 858000, "num_env_steps_trained": 858000, "num_agent_steps_sampled": 858000, "num_agent_steps_trained": 858000}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0132402709173, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353220362311686, "mean_inference_ms": 0.23461348560097517, "mean_action_processing_ms": 0.05716770675585044, "mean_env_wait_ms": 0.574323405218952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024819374084472656, "StateBufferConnector_ms": 0.001708984375, "ViewRequirementAgentConnector_ms": 0.043517351150512695}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0132402709173, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.199644263297, -3528.4020535901964, -3525.5867742712453, -3526.1733371785153, -3526.674022028206, -3527.1456991296436, -3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353220362311686, "mean_inference_ms": 0.23461348560097517, "mean_action_processing_ms": 0.05716770675585044, "mean_env_wait_ms": 0.574323405218952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024819374084472656, "StateBufferConnector_ms": 0.001708984375, "ViewRequirementAgentConnector_ms": 0.043517351150512695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 858000, "num_agent_steps_trained": 858000, "num_env_steps_sampled": 858000, "num_env_steps_trained": 858000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.11631185004433, "num_env_steps_trained_throughput_per_sec": 190.11631185004433, "timesteps_total": 858000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 858000, "timers": {"training_iteration_time_ms": 1898.909, "sample_time_ms": 1891.886, "load_time_ms": 0.216, "load_throughput": 1665324.187, "learn_time_ms": 6.276, "learn_throughput": 57363.015, "synch_weights_time_ms": 0.501}, "counters": {"num_env_steps_sampled": 858000, "num_env_steps_trained": 858000, "num_agent_steps_sampled": 858000, "num_agent_steps_trained": 858000}, "done": false, "episodes_total": 2864, "training_iteration": 521, "trial_id": "6192e_00000", "date": "2023-08-04_11-30-01", "timestamp": 1691137801, "time_this_iter_s": 11.363659858703613, "time_total_s": 5821.018721818924, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2450.5596981048584, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 20.35625, "ram_util_percent": 64.89375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.4449157714844, "policy_loss": -8798437.975, "vf_loss": 20752279.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6503.0, "diff_num_grad_updates_vs_sampler_policy": 6502.0}}, "num_env_steps_sampled": 860160, "num_env_steps_trained": 860160, "num_agent_steps_sampled": 860160, "num_agent_steps_trained": 860160}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.05407542577, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3532364978578615, "mean_inference_ms": 0.23461453237960117, "mean_action_processing_ms": 0.057167310386947834, "mean_env_wait_ms": 0.5743126536667204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017092227935791016, "ViewRequirementAgentConnector_ms": 0.043565988540649414}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.05407542577, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.152528770019, -3526.487531936589, -3527.636938880334, -3525.586773770158, -3526.117347581406, -3527.738261063218, -3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3532364978578615, "mean_inference_ms": 0.23461453237960117, "mean_action_processing_ms": 0.057167310386947834, "mean_env_wait_ms": 0.5743126536667204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0017092227935791016, "ViewRequirementAgentConnector_ms": 0.043565988540649414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860160, "num_agent_steps_trained": 860160, "num_env_steps_sampled": 860160, "num_env_steps_trained": 860160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.39894114920716, "num_env_steps_trained_throughput_per_sec": 189.39894114920716, "timesteps_total": 860160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 860160, "timers": {"training_iteration_time_ms": 1899.034, "sample_time_ms": 1891.899, "load_time_ms": 0.214, "load_throughput": 1679401.001, "learn_time_ms": 6.375, "learn_throughput": 56466.762, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 860160, "num_env_steps_trained": 860160, "num_agent_steps_sampled": 860160, "num_agent_steps_trained": 860160}, "done": false, "episodes_total": 2870, "training_iteration": 522, "trial_id": "6192e_00000", "date": "2023-08-04_11-30-12", "timestamp": 1691137812, "time_this_iter_s": 11.406722068786621, "time_total_s": 5832.425443887711, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2461.966420173645, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 19.1, "ram_util_percent": 65.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2203369140625, "policy_loss": -1276522.0125, "vf_loss": 20753510.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6533.0, "diff_num_grad_updates_vs_sampler_policy": 6532.0}}, "num_env_steps_sampled": 862320, "num_env_steps_trained": 862320, "num_agent_steps_sampled": 862320, "num_agent_steps_trained": 862320}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.06986454813, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353249047460128, "mean_inference_ms": 0.2346162277222199, "mean_action_processing_ms": 0.05716699509642232, "mean_env_wait_ms": 0.5743030876820105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017104148864746094, "ViewRequirementAgentConnector_ms": 0.04352831840515137}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.06986454813, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.633909005543, -3527.1556020547678, -3527.4861833002665, -3526.86522505578, -3525.81900634063, -3526.8709976036507, -3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353249047460128, "mean_inference_ms": 0.2346162277222199, "mean_action_processing_ms": 0.05716699509642232, "mean_env_wait_ms": 0.5743030876820105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.0017104148864746094, "ViewRequirementAgentConnector_ms": 0.04352831840515137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 862320, "num_agent_steps_trained": 862320, "num_env_steps_sampled": 862320, "num_env_steps_trained": 862320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.78142434262963, "num_env_steps_trained_throughput_per_sec": 190.78142434262963, "timesteps_total": 862320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 862320, "timers": {"training_iteration_time_ms": 1892.567, "sample_time_ms": 1885.442, "load_time_ms": 0.219, "load_throughput": 1640892.676, "learn_time_ms": 6.377, "learn_throughput": 56457.261, "synch_weights_time_ms": 0.497}, "counters": {"num_env_steps_sampled": 862320, "num_env_steps_trained": 862320, "num_agent_steps_sampled": 862320, "num_agent_steps_trained": 862320}, "done": false, "episodes_total": 2876, "training_iteration": 523, "trial_id": "6192e_00000", "date": "2023-08-04_11-30-24", "timestamp": 1691137824, "time_this_iter_s": 11.32412600517273, "time_total_s": 5843.749569892883, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2473.2905461788177, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 19.575000000000003, "ram_util_percent": 65.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3340270996094, "policy_loss": -4549828.19375, "vf_loss": 20773634.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6563.0, "diff_num_grad_updates_vs_sampler_policy": 6562.0}}, "num_env_steps_sampled": 864480, "num_env_steps_trained": 864480, "num_agent_steps_sampled": 864480, "num_agent_steps_trained": 864480}, "sampler_results": {"episode_reward_max": -3525.47454207936, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.1055957377725, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353259557547516, "mean_inference_ms": 0.2346180538921794, "mean_action_processing_ms": 0.05716674698526674, "mean_env_wait_ms": 0.574294332950208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499818801879883, "StateBufferConnector_ms": 0.0017099380493164062, "ViewRequirementAgentConnector_ms": 0.04357767105102539}}, "episode_reward_max": -3525.47454207936, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.1055957377725, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.9716243702724, -3526.655928774672, -3527.6741321883137, -3525.47454207936, -3527.546177344648, -3526.807159583473, -3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353259557547516, "mean_inference_ms": 0.2346180538921794, "mean_action_processing_ms": 0.05716674698526674, "mean_env_wait_ms": 0.574294332950208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499818801879883, "StateBufferConnector_ms": 0.0017099380493164062, "ViewRequirementAgentConnector_ms": 0.04357767105102539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864480, "num_agent_steps_trained": 864480, "num_env_steps_sampled": 864480, "num_env_steps_trained": 864480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.35323557758068, "num_env_steps_trained_throughput_per_sec": 190.35323557758068, "timesteps_total": 864480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 864480, "timers": {"training_iteration_time_ms": 1892.436, "sample_time_ms": 1885.413, "load_time_ms": 0.215, "load_throughput": 1678094.51, "learn_time_ms": 6.284, "learn_throughput": 57290.104, "synch_weights_time_ms": 0.494}, "counters": {"num_env_steps_sampled": 864480, "num_env_steps_trained": 864480, "num_agent_steps_sampled": 864480, "num_agent_steps_trained": 864480}, "done": false, "episodes_total": 2882, "training_iteration": 524, "trial_id": "6192e_00000", "date": "2023-08-04_11-30-35", "timestamp": 1691137835, "time_this_iter_s": 11.349653720855713, "time_total_s": 5855.099223613739, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2484.6401998996735, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 19.03125, "ram_util_percent": 65.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.15167236328125, "policy_loss": -3154696.38125, "vf_loss": 20732585.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6593.0, "diff_num_grad_updates_vs_sampler_policy": 6592.0}}, "num_env_steps_sampled": 866640, "num_env_steps_trained": 866640, "num_agent_steps_sampled": 866640, "num_agent_steps_trained": 866640}, "sampler_results": {"episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.091918912286, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353266669739915, "mean_inference_ms": 0.23462040026820008, "mean_action_processing_ms": 0.05716666786986895, "mean_env_wait_ms": 0.5742902767683791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025064945220947266, "StateBufferConnector_ms": 0.0017175674438476562, "ViewRequirementAgentConnector_ms": 0.04361987113952637}}, "episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.091918912286, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.505543051352, -3528.1863110536774, -3527.346943271489, -3526.4347159765875, -3526.1714484126783, -3526.41598354397, -3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353266669739915, "mean_inference_ms": 0.23462040026820008, "mean_action_processing_ms": 0.05716666786986895, "mean_env_wait_ms": 0.5742902767683791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025064945220947266, "StateBufferConnector_ms": 0.0017175674438476562, "ViewRequirementAgentConnector_ms": 0.04361987113952637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 866640, "num_agent_steps_trained": 866640, "num_env_steps_sampled": 866640, "num_env_steps_trained": 866640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.99650906424844, "num_env_steps_trained_throughput_per_sec": 189.99650906424844, "timesteps_total": 866640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 866640, "timers": {"training_iteration_time_ms": 1889.697, "sample_time_ms": 1882.608, "load_time_ms": 0.221, "load_throughput": 1631143.394, "learn_time_ms": 6.327, "learn_throughput": 56899.994, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 866640, "num_env_steps_trained": 866640, "num_agent_steps_sampled": 866640, "num_agent_steps_trained": 866640}, "done": false, "episodes_total": 2888, "training_iteration": 525, "trial_id": "6192e_00000", "date": "2023-08-04_11-30-46", "timestamp": 1691137846, "time_this_iter_s": 11.37068796157837, "time_total_s": 5866.469911575317, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2496.010887861252, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 17.9375, "ram_util_percent": 65.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3297119140625, "policy_loss": -2902995.61875, "vf_loss": 20739507.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6623.0, "diff_num_grad_updates_vs_sampler_policy": 6622.0}}, "num_env_steps_sampled": 868800, "num_env_steps_trained": 868800, "num_agent_steps_sampled": 868800, "num_agent_steps_trained": 868800}, "sampler_results": {"episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.063096845654, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353276934999676, "mean_inference_ms": 0.23462255342478464, "mean_action_processing_ms": 0.0571666014448164, "mean_env_wait_ms": 0.5742838760768633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499103546142578, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.0435791015625}}, "episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.063096845654, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.8023947519314, -3525.902290897523, -3526.299612431649, -3526.9486330715386, -3526.3796422149458, -3526.552044961965, -3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353276934999676, "mean_inference_ms": 0.23462255342478464, "mean_action_processing_ms": 0.0571666014448164, "mean_env_wait_ms": 0.5742838760768633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499103546142578, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.0435791015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 868800, "num_agent_steps_trained": 868800, "num_env_steps_sampled": 868800, "num_env_steps_trained": 868800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.50587522128652, "num_env_steps_trained_throughput_per_sec": 190.50587522128652, "timesteps_total": 868800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 868800, "timers": {"training_iteration_time_ms": 1893.349, "sample_time_ms": 1886.214, "load_time_ms": 0.22, "load_throughput": 1635383.342, "learn_time_ms": 6.369, "learn_throughput": 56524.469, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 868800, "num_env_steps_trained": 868800, "num_agent_steps_sampled": 868800, "num_agent_steps_trained": 868800}, "done": false, "episodes_total": 2894, "training_iteration": 526, "trial_id": "6192e_00000", "date": "2023-08-04_11-30-58", "timestamp": 1691137858, "time_this_iter_s": 11.340497970581055, "time_total_s": 5877.810409545898, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2507.351385831833, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 19.38125, "ram_util_percent": 65.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.253564453125, "policy_loss": -3046412.925, "vf_loss": 20750176.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6653.0, "diff_num_grad_updates_vs_sampler_policy": 6652.0}}, "num_env_steps_sampled": 870960, "num_env_steps_trained": 870960, "num_agent_steps_sampled": 870960, "num_agent_steps_trained": 870960}, "sampler_results": {"episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0746526532084, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353289753319204, "mean_inference_ms": 0.23462459373023128, "mean_action_processing_ms": 0.05716652616702066, "mean_env_wait_ms": 0.574276545176962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024945735931396484, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.043634891510009766}}, "episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0746526532084, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.5973082313335, -3528.189767404918, -3526.502683208804, -3526.730752994536, -3526.2806057416865, -3527.669228059958, -3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353289753319204, "mean_inference_ms": 0.23462459373023128, "mean_action_processing_ms": 0.05716652616702066, "mean_env_wait_ms": 0.574276545176962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024945735931396484, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.043634891510009766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 870960, "num_agent_steps_trained": 870960, "num_env_steps_sampled": 870960, "num_env_steps_trained": 870960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.85889758990228, "num_env_steps_trained_throughput_per_sec": 190.85889758990228, "timesteps_total": 870960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 870960, "timers": {"training_iteration_time_ms": 1888.903, "sample_time_ms": 1881.847, "load_time_ms": 0.213, "load_throughput": 1688792.574, "learn_time_ms": 6.303, "learn_throughput": 57112.631, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 870960, "num_env_steps_trained": 870960, "num_agent_steps_sampled": 870960, "num_agent_steps_trained": 870960}, "done": false, "episodes_total": 2900, "training_iteration": 527, "trial_id": "6192e_00000", "date": "2023-08-04_11-31-09", "timestamp": 1691137869, "time_this_iter_s": 11.319341897964478, "time_total_s": 5889.129751443863, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2518.6707277297974, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 18.65625, "ram_util_percent": 64.96875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.230419921875, "policy_loss": -7122323.2, "vf_loss": 20745867.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6683.0, "diff_num_grad_updates_vs_sampler_policy": 6682.0}}, "num_env_steps_sampled": 873120, "num_env_steps_trained": 873120, "num_agent_steps_sampled": 873120, "num_agent_steps_trained": 873120}, "sampler_results": {"episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.057294049463, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353304856654069, "mean_inference_ms": 0.23462677757838538, "mean_action_processing_ms": 0.057166513244354566, "mean_env_wait_ms": 0.5742701281379723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025191307067871094, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.043656349182128906}}, "episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.057294049463, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.1438540831587, -3526.7624705985395, -3527.2982918764774, -3525.586773994352, -3526.171911360115, -3526.672177107092, -3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353304856654069, "mean_inference_ms": 0.23462677757838538, "mean_action_processing_ms": 0.057166513244354566, "mean_env_wait_ms": 0.5742701281379723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025191307067871094, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.043656349182128906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 873120, "num_agent_steps_trained": 873120, "num_env_steps_sampled": 873120, "num_env_steps_trained": 873120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.2470877938862, "num_env_steps_trained_throughput_per_sec": 190.2470877938862, "timesteps_total": 873120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 873120, "timers": {"training_iteration_time_ms": 1890.761, "sample_time_ms": 1883.753, "load_time_ms": 0.214, "load_throughput": 1680522.471, "learn_time_ms": 6.263, "learn_throughput": 57483.123, "synch_weights_time_ms": 0.501}, "counters": {"num_env_steps_sampled": 873120, "num_env_steps_trained": 873120, "num_agent_steps_sampled": 873120, "num_agent_steps_trained": 873120}, "done": false, "episodes_total": 2906, "training_iteration": 528, "trial_id": "6192e_00000", "date": "2023-08-04_11-31-20", "timestamp": 1691137880, "time_this_iter_s": 11.355747699737549, "time_total_s": 5900.4854991436005, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2530.026475429535, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 19.506249999999998, "ram_util_percent": 64.96875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2428344726562, "policy_loss": -4863459.2875, "vf_loss": 20747146.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6713.0, "diff_num_grad_updates_vs_sampler_policy": 6712.0}}, "num_env_steps_sampled": 875280, "num_env_steps_trained": 875280, "num_agent_steps_sampled": 875280, "num_agent_steps_trained": 875280}, "sampler_results": {"episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.108282442072, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353321572555075, "mean_inference_ms": 0.23462922479275433, "mean_action_processing_ms": 0.057166577220434556, "mean_env_wait_ms": 0.5742660332193935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025281906127929688, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.04361724853515625}}, "episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.108282442072, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.880559816163, -3526.495584708348, -3526.5540541612004, -3526.4701263084416, -3526.0642714588193, -3526.115715685423, -3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353321572555075, "mean_inference_ms": 0.23462922479275433, "mean_action_processing_ms": 0.057166577220434556, "mean_env_wait_ms": 0.5742660332193935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025281906127929688, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.04361724853515625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 875280, "num_agent_steps_trained": 875280, "num_env_steps_sampled": 875280, "num_env_steps_trained": 875280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.2853001447855, "num_env_steps_trained_throughput_per_sec": 190.2853001447855, "timesteps_total": 875280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 875280, "timers": {"training_iteration_time_ms": 1892.804, "sample_time_ms": 1885.768, "load_time_ms": 0.214, "load_throughput": 1681083.768, "learn_time_ms": 6.281, "learn_throughput": 57315.983, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 875280, "num_env_steps_trained": 875280, "num_agent_steps_sampled": 875280, "num_agent_steps_trained": 875280}, "done": false, "episodes_total": 2912, "training_iteration": 529, "trial_id": "6192e_00000", "date": "2023-08-04_11-31-32", "timestamp": 1691137892, "time_this_iter_s": 11.35348892211914, "time_total_s": 5911.83898806572, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2541.379964351654, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 19.370588235294118, "ram_util_percent": 64.91176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2156066894531, "policy_loss": -1338.059375, "vf_loss": 20752194.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6743.0, "diff_num_grad_updates_vs_sampler_policy": 6742.0}}, "num_env_steps_sampled": 877440, "num_env_steps_trained": 877440, "num_agent_steps_sampled": 877440, "num_agent_steps_trained": 877440}, "sampler_results": {"episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.1604905831905, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353340594802054, "mean_inference_ms": 0.23463205555256075, "mean_action_processing_ms": 0.057166750254102804, "mean_env_wait_ms": 0.5742627329186527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002526998519897461, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.043657779693603516}}, "episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.1604905831905, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.7868014831743, -3527.7245806202186, -3525.7996109384794, -3528.678168947958, -3528.0872098396862, -3529.222346629324, -3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353340594802054, "mean_inference_ms": 0.23463205555256075, "mean_action_processing_ms": 0.057166750254102804, "mean_env_wait_ms": 0.5742627329186527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002526998519897461, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.043657779693603516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 877440, "num_agent_steps_trained": 877440, "num_env_steps_sampled": 877440, "num_env_steps_trained": 877440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.24970458859434, "num_env_steps_trained_throughput_per_sec": 190.24970458859434, "timesteps_total": 877440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 877440, "timers": {"training_iteration_time_ms": 1892.096, "sample_time_ms": 1885.003, "load_time_ms": 0.214, "load_throughput": 1682207.487, "learn_time_ms": 6.348, "learn_throughput": 56713.42, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 877440, "num_env_steps_trained": 877440, "num_agent_steps_sampled": 877440, "num_agent_steps_trained": 877440}, "done": false, "episodes_total": 2918, "training_iteration": 530, "trial_id": "6192e_00000", "date": "2023-08-04_11-31-43", "timestamp": 1691137903, "time_this_iter_s": 11.355792999267578, "time_total_s": 5923.194781064987, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2552.7357573509216, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 21.825000000000003, "ram_util_percent": 64.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2512145996094, "policy_loss": -2658322.215625, "vf_loss": 20747881.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6773.0, "diff_num_grad_updates_vs_sampler_policy": 6772.0}}, "num_env_steps_sampled": 879600, "num_env_steps_trained": 879600, "num_agent_steps_sampled": 879600, "num_agent_steps_trained": 879600}, "sampler_results": {"episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.113220553422, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353359470494944, "mean_inference_ms": 0.23463520229444548, "mean_action_processing_ms": 0.05716698660909664, "mean_env_wait_ms": 0.5742576974992355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025255680084228516, "StateBufferConnector_ms": 0.0017178058624267578, "ViewRequirementAgentConnector_ms": 0.04366660118103027}}, "episode_reward_max": -3525.586767820499, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.113220553422, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.2189351969582, -3527.6594602965156, -3527.8786538051913, -3527.1387852716985, -3527.059001846596, -3527.7939914941644, -3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353359470494944, "mean_inference_ms": 0.23463520229444548, "mean_action_processing_ms": 0.05716698660909664, "mean_env_wait_ms": 0.5742576974992355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025255680084228516, "StateBufferConnector_ms": 0.0017178058624267578, "ViewRequirementAgentConnector_ms": 0.04366660118103027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 879600, "num_agent_steps_trained": 879600, "num_env_steps_sampled": 879600, "num_env_steps_trained": 879600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.1724535675049, "num_env_steps_trained_throughput_per_sec": 190.1724535675049, "timesteps_total": 879600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 879600, "timers": {"training_iteration_time_ms": 1893.76, "sample_time_ms": 1886.628, "load_time_ms": 0.215, "load_throughput": 1675301.72, "learn_time_ms": 6.383, "learn_throughput": 56395.478, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 879600, "num_env_steps_trained": 879600, "num_agent_steps_sampled": 879600, "num_agent_steps_trained": 879600}, "done": false, "episodes_total": 2924, "training_iteration": 531, "trial_id": "6192e_00000", "date": "2023-08-04_11-31-54", "timestamp": 1691137914, "time_this_iter_s": 11.360299825668335, "time_total_s": 5934.5550808906555, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2564.09605717659, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 22.15, "ram_util_percent": 64.96875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.143701171875, "policy_loss": 297009.653125, "vf_loss": 20729168.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6803.0, "diff_num_grad_updates_vs_sampler_policy": 6802.0}}, "num_env_steps_sampled": 881760, "num_env_steps_trained": 881760, "num_agent_steps_sampled": 881760, "num_agent_steps_trained": 881760}, "sampler_results": {"episode_reward_max": -3525.5784239550812, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.1015422662736, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353377840099696, "mean_inference_ms": 0.23463801796641953, "mean_action_processing_ms": 0.05716717417143693, "mean_env_wait_ms": 0.5742491069772534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002516031265258789, "StateBufferConnector_ms": 0.0017085075378417969, "ViewRequirementAgentConnector_ms": 0.04353070259094238}}, "episode_reward_max": -3525.5784239550812, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.1015422662736, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.8284679995086, -3526.4476963104694, -3527.4751770801577, -3526.108621685456, -3526.2370748350036, -3527.49091869517, -3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353377840099696, "mean_inference_ms": 0.23463801796641953, "mean_action_processing_ms": 0.05716717417143693, "mean_env_wait_ms": 0.5742491069772534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002516031265258789, "StateBufferConnector_ms": 0.0017085075378417969, "ViewRequirementAgentConnector_ms": 0.04353070259094238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 881760, "num_agent_steps_trained": 881760, "num_env_steps_sampled": 881760, "num_env_steps_trained": 881760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.8597985134486, "num_env_steps_trained_throughput_per_sec": 189.8597985134486, "timesteps_total": 881760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 881760, "timers": {"training_iteration_time_ms": 1896.026, "sample_time_ms": 1888.922, "load_time_ms": 0.216, "load_throughput": 1664222.903, "learn_time_ms": 6.341, "learn_throughput": 56773.767, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 881760, "num_env_steps_trained": 881760, "num_agent_steps_sampled": 881760, "num_agent_steps_trained": 881760}, "done": false, "episodes_total": 2930, "training_iteration": 532, "trial_id": "6192e_00000", "date": "2023-08-04_11-32-06", "timestamp": 1691137926, "time_this_iter_s": 11.379162788391113, "time_total_s": 5945.934243679047, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2575.475219964981, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 19.75, "ram_util_percent": 64.95625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.15283203125, "policy_loss": -1829879.95625, "vf_loss": 20729706.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6833.0, "diff_num_grad_updates_vs_sampler_policy": 6832.0}}, "num_env_steps_sampled": 883920, "num_env_steps_trained": 883920, "num_agent_steps_sampled": 883920, "num_agent_steps_trained": 883920}, "sampler_results": {"episode_reward_max": -3525.5784239550812, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.081196576665, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3533962155518084, "mean_inference_ms": 0.23464112477316904, "mean_action_processing_ms": 0.05716740210988687, "mean_env_wait_ms": 0.5742384251293181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025250911712646484, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.04348111152648926}}, "episode_reward_max": -3525.5784239550812, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.081196576665, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.88689523248, -3526.5693305705267, -3527.077303452797, -3527.3912470774926, -3526.498704774867, -3528.7532131344356, -3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3533962155518084, "mean_inference_ms": 0.23464112477316904, "mean_action_processing_ms": 0.05716740210988687, "mean_env_wait_ms": 0.5742384251293181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025250911712646484, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.04348111152648926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 883920, "num_agent_steps_trained": 883920, "num_env_steps_sampled": 883920, "num_env_steps_trained": 883920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.28390931848986, "num_env_steps_trained_throughput_per_sec": 190.28390931848986, "timesteps_total": 883920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 883920, "timers": {"training_iteration_time_ms": 1892.448, "sample_time_ms": 1885.332, "load_time_ms": 0.217, "load_throughput": 1656009.476, "learn_time_ms": 6.351, "learn_throughput": 56680.848, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 883920, "num_env_steps_trained": 883920, "num_agent_steps_sampled": 883920, "num_agent_steps_trained": 883920}, "done": false, "episodes_total": 2936, "training_iteration": 533, "trial_id": "6192e_00000", "date": "2023-08-04_11-32-17", "timestamp": 1691137937, "time_this_iter_s": 11.353546857833862, "time_total_s": 5957.2877905368805, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2586.828766822815, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 17.318749999999998, "ram_util_percent": 64.91875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.20404052734375, "policy_loss": -4065131.65, "vf_loss": 20732690.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6863.0, "diff_num_grad_updates_vs_sampler_policy": 6862.0}}, "num_env_steps_sampled": 886080, "num_env_steps_trained": 886080, "num_agent_steps_sampled": 886080, "num_agent_steps_trained": 886080}, "sampler_results": {"episode_reward_max": -3525.5784239550812, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0562982999622, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353407452617103, "mean_inference_ms": 0.23464416418504555, "mean_action_processing_ms": 0.05716763080167329, "mean_env_wait_ms": 0.5742260036757222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532482147216797, "StateBufferConnector_ms": 0.0017008781433105469, "ViewRequirementAgentConnector_ms": 0.043532609939575195}}, "episode_reward_max": -3525.5784239550812, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0562982999622, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.9481222547174, -3528.663368977913, -3525.5867711565247, -3528.300625535747, -3526.520825168994, -3526.8187473495163, -3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353407452617103, "mean_inference_ms": 0.23464416418504555, "mean_action_processing_ms": 0.05716763080167329, "mean_env_wait_ms": 0.5742260036757222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532482147216797, "StateBufferConnector_ms": 0.0017008781433105469, "ViewRequirementAgentConnector_ms": 0.043532609939575195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 886080, "num_agent_steps_trained": 886080, "num_env_steps_sampled": 886080, "num_env_steps_trained": 886080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.13496557229655, "num_env_steps_trained_throughput_per_sec": 191.13496557229655, "timesteps_total": 886080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 886080, "timers": {"training_iteration_time_ms": 1885.023, "sample_time_ms": 1877.969, "load_time_ms": 0.215, "load_throughput": 1674187.205, "learn_time_ms": 6.304, "learn_throughput": 57109.174, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 886080, "num_env_steps_trained": 886080, "num_agent_steps_sampled": 886080, "num_agent_steps_trained": 886080}, "done": false, "episodes_total": 2942, "training_iteration": 534, "trial_id": "6192e_00000", "date": "2023-08-04_11-32-29", "timestamp": 1691137949, "time_this_iter_s": 11.302933931350708, "time_total_s": 5968.590724468231, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2598.1317007541656, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 19.98125, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2998107910156, "policy_loss": -5252467.5625, "vf_loss": 20761299.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6893.0, "diff_num_grad_updates_vs_sampler_policy": 6892.0}}, "num_env_steps_sampled": 888240, "num_env_steps_trained": 888240, "num_agent_steps_sampled": 888240, "num_agent_steps_trained": 888240}, "sampler_results": {"episode_reward_max": -3525.5784239550812, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0677775711833, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353416534959173, "mean_inference_ms": 0.23464690624591558, "mean_action_processing_ms": 0.057167787762636674, "mean_env_wait_ms": 0.5742141669984524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025436878204345703, "StateBufferConnector_ms": 0.0017092227935791016, "ViewRequirementAgentConnector_ms": 0.043514251708984375}}, "episode_reward_max": -3525.5784239550812, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0677775711833, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.913616967171, -3526.5223813646376, -3526.4858863044433, -3527.8066880078263, -3526.569324935766, -3526.650595860799, -3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353416534959173, "mean_inference_ms": 0.23464690624591558, "mean_action_processing_ms": 0.057167787762636674, "mean_env_wait_ms": 0.5742141669984524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025436878204345703, "StateBufferConnector_ms": 0.0017092227935791016, "ViewRequirementAgentConnector_ms": 0.043514251708984375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888240, "num_agent_steps_trained": 888240, "num_env_steps_sampled": 888240, "num_env_steps_trained": 888240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.12300656907476, "num_env_steps_trained_throughput_per_sec": 190.12300656907476, "timesteps_total": 888240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 888240, "timers": {"training_iteration_time_ms": 1888.619, "sample_time_ms": 1881.61, "load_time_ms": 0.214, "load_throughput": 1681832.747, "learn_time_ms": 6.254, "learn_throughput": 57561.574, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 888240, "num_env_steps_trained": 888240, "num_agent_steps_sampled": 888240, "num_agent_steps_trained": 888240}, "done": false, "episodes_total": 2948, "training_iteration": 535, "trial_id": "6192e_00000", "date": "2023-08-04_11-32-40", "timestamp": 1691137960, "time_this_iter_s": 11.363162279129028, "time_total_s": 5979.95388674736, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2609.4948630332947, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 18.875000000000004, "ram_util_percent": 65.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.27247924804686, "policy_loss": -2454352.7, "vf_loss": 20752788.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6923.0, "diff_num_grad_updates_vs_sampler_policy": 6922.0}}, "num_env_steps_sampled": 890400, "num_env_steps_trained": 890400, "num_agent_steps_sampled": 890400, "num_agent_steps_trained": 890400}, "sampler_results": {"episode_reward_max": -3525.5784239550812, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0829997621936, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353423445414964, "mean_inference_ms": 0.23464971262444678, "mean_action_processing_ms": 0.05716795914306287, "mean_env_wait_ms": 0.5742059060686738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025527477264404297, "StateBufferConnector_ms": 0.0017142295837402344, "ViewRequirementAgentConnector_ms": 0.04355621337890625}}, "episode_reward_max": -3525.5784239550812, "episode_reward_min": -3534.4648107778553, "episode_reward_mean": -3527.0829997621936, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.0192527849713, -3527.6627513716144, -3534.4648107778553, -3527.2622187143775, -3526.0731314307623, -3528.942472053942, -3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353423445414964, "mean_inference_ms": 0.23464971262444678, "mean_action_processing_ms": 0.05716795914306287, "mean_env_wait_ms": 0.5742059060686738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025527477264404297, "StateBufferConnector_ms": 0.0017142295837402344, "ViewRequirementAgentConnector_ms": 0.04355621337890625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 890400, "num_agent_steps_trained": 890400, "num_env_steps_sampled": 890400, "num_env_steps_trained": 890400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.21071980371948, "num_env_steps_trained_throughput_per_sec": 190.21071980371948, "timesteps_total": 890400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 890400, "timers": {"training_iteration_time_ms": 1891.632, "sample_time_ms": 1884.632, "load_time_ms": 0.219, "load_throughput": 1640714.376, "learn_time_ms": 6.242, "learn_throughput": 57669.517, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 890400, "num_env_steps_trained": 890400, "num_agent_steps_sampled": 890400, "num_agent_steps_trained": 890400}, "done": false, "episodes_total": 2954, "training_iteration": 536, "trial_id": "6192e_00000", "date": "2023-08-04_11-32-51", "timestamp": 1691137971, "time_this_iter_s": 11.357841968536377, "time_total_s": 5991.311728715897, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2620.852705001831, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 19.85625, "ram_util_percent": 65.24375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2361755371094, "policy_loss": -5886895.9625, "vf_loss": 20758652.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6953.0, "diff_num_grad_updates_vs_sampler_policy": 6952.0}}, "num_env_steps_sampled": 892560, "num_env_steps_trained": 892560, "num_agent_steps_sampled": 892560, "num_agent_steps_trained": 892560}, "sampler_results": {"episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.977455983699, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353431468282388, "mean_inference_ms": 0.2346521600993763, "mean_action_processing_ms": 0.057168099221124404, "mean_env_wait_ms": 0.5741963206482322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025568008422851562, "StateBufferConnector_ms": 0.0017163753509521484, "ViewRequirementAgentConnector_ms": 0.043557167053222656}}, "episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.977455983699, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.354306652095, -3526.2467434672476, -3528.206799021313, -3526.499289112347, -3526.169329135586, -3529.0887616734153, -3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353431468282388, "mean_inference_ms": 0.2346521600993763, "mean_action_processing_ms": 0.057168099221124404, "mean_env_wait_ms": 0.5741963206482322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025568008422851562, "StateBufferConnector_ms": 0.0017163753509521484, "ViewRequirementAgentConnector_ms": 0.043557167053222656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 892560, "num_agent_steps_trained": 892560, "num_env_steps_sampled": 892560, "num_env_steps_trained": 892560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.0107468727347, "num_env_steps_trained_throughput_per_sec": 190.0107468727347, "timesteps_total": 892560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 892560, "timers": {"training_iteration_time_ms": 1895.822, "sample_time_ms": 1888.762, "load_time_ms": 0.219, "load_throughput": 1645004.292, "learn_time_ms": 6.286, "learn_throughput": 57268.81, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 892560, "num_env_steps_trained": 892560, "num_agent_steps_sampled": 892560, "num_agent_steps_trained": 892560}, "done": false, "episodes_total": 2960, "training_iteration": 537, "trial_id": "6192e_00000", "date": "2023-08-04_11-33-03", "timestamp": 1691137983, "time_this_iter_s": 11.3699951171875, "time_total_s": 6002.681723833084, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2632.2227001190186, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 20.59375, "ram_util_percent": 65.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1407836914062, "policy_loss": 308294.040625, "vf_loss": 20732950.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6983.0, "diff_num_grad_updates_vs_sampler_policy": 6982.0}}, "num_env_steps_sampled": 894720, "num_env_steps_trained": 894720, "num_agent_steps_sampled": 894720, "num_agent_steps_trained": 894720}, "sampler_results": {"episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.968170117744, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353437908732562, "mean_inference_ms": 0.23465401036898267, "mean_action_processing_ms": 0.05716814161240056, "mean_env_wait_ms": 0.5741853230984336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002557992935180664, "StateBufferConnector_ms": 0.0017247200012207031, "ViewRequirementAgentConnector_ms": 0.0435025691986084}}, "episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.968170117744, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.360530193661, -3526.236482606108, -3528.264701744535, -3528.1452405930722, -3526.5658849016986, -3526.436417656121, -3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353437908732562, "mean_inference_ms": 0.23465401036898267, "mean_action_processing_ms": 0.05716814161240056, "mean_env_wait_ms": 0.5741853230984336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002557992935180664, "StateBufferConnector_ms": 0.0017247200012207031, "ViewRequirementAgentConnector_ms": 0.0435025691986084}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 894720, "num_agent_steps_trained": 894720, "num_env_steps_sampled": 894720, "num_env_steps_trained": 894720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.37987604720317, "num_env_steps_trained_throughput_per_sec": 190.37987604720317, "timesteps_total": 894720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 894720, "timers": {"training_iteration_time_ms": 1892.817, "sample_time_ms": 1885.827, "load_time_ms": 0.217, "load_throughput": 1660562.455, "learn_time_ms": 6.231, "learn_throughput": 57779.636, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 894720, "num_env_steps_trained": 894720, "num_agent_steps_sampled": 894720, "num_agent_steps_trained": 894720}, "done": false, "episodes_total": 2966, "training_iteration": 538, "trial_id": "6192e_00000", "date": "2023-08-04_11-33-14", "timestamp": 1691137994, "time_this_iter_s": 11.347970008850098, "time_total_s": 6014.029693841934, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2643.5706701278687, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 19.36875, "ram_util_percent": 65.05625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2132263183594, "policy_loss": -4034136.328125, "vf_loss": 20731307.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7013.0, "diff_num_grad_updates_vs_sampler_policy": 7012.0}}, "num_env_steps_sampled": 896880, "num_env_steps_trained": 896880, "num_agent_steps_sampled": 896880, "num_agent_steps_trained": 896880}, "sampler_results": {"episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.93836920586, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353441076481856, "mean_inference_ms": 0.23465500828261723, "mean_action_processing_ms": 0.057168088245954964, "mean_env_wait_ms": 0.574170365688218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025315284729003906, "StateBufferConnector_ms": 0.0017244815826416016, "ViewRequirementAgentConnector_ms": 0.04342365264892578}}, "episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.93836920586, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.5867684078867, -3526.4929895570085, -3528.5876556134735, -3527.628578101514, -3526.645912883274, -3528.7872528641988, -3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353441076481856, "mean_inference_ms": 0.23465500828261723, "mean_action_processing_ms": 0.057168088245954964, "mean_env_wait_ms": 0.574170365688218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025315284729003906, "StateBufferConnector_ms": 0.0017244815826416016, "ViewRequirementAgentConnector_ms": 0.04342365264892578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896880, "num_agent_steps_trained": 896880, "num_env_steps_sampled": 896880, "num_env_steps_trained": 896880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.99854113127924, "num_env_steps_trained_throughput_per_sec": 190.99854113127924, "timesteps_total": 896880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 896880, "timers": {"training_iteration_time_ms": 1887.658, "sample_time_ms": 1880.638, "load_time_ms": 0.219, "load_throughput": 1646259.747, "learn_time_ms": 6.251, "learn_throughput": 57592.97, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 896880, "num_env_steps_trained": 896880, "num_agent_steps_sampled": 896880, "num_agent_steps_trained": 896880}, "done": false, "episodes_total": 2972, "training_iteration": 539, "trial_id": "6192e_00000", "date": "2023-08-04_11-33-25", "timestamp": 1691138005, "time_this_iter_s": 11.31103777885437, "time_total_s": 6025.340731620789, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2654.881707906723, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 22.018749999999997, "ram_util_percent": 65.11875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.40985717773435, "policy_loss": -5918474.59375, "vf_loss": 20750281.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7043.0, "diff_num_grad_updates_vs_sampler_policy": 7042.0}}, "num_env_steps_sampled": 899040, "num_env_steps_trained": 899040, "num_agent_steps_sampled": 899040, "num_agent_steps_trained": 899040}, "sampler_results": {"episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.923955683268, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353444345651968, "mean_inference_ms": 0.23465560783149664, "mean_action_processing_ms": 0.057168001689868984, "mean_env_wait_ms": 0.5741543968083276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002534151077270508, "StateBufferConnector_ms": 0.0017271041870117188, "ViewRequirementAgentConnector_ms": 0.04339861869812012}}, "episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.923955683268, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.870279686744, -3525.586767820499, -3527.4193489269696, -3529.094480143183, -3527.597041218165, -3525.6408535553237, -3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353444345651968, "mean_inference_ms": 0.23465560783149664, "mean_action_processing_ms": 0.057168001689868984, "mean_env_wait_ms": 0.5741543968083276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002534151077270508, "StateBufferConnector_ms": 0.0017271041870117188, "ViewRequirementAgentConnector_ms": 0.04339861869812012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 899040, "num_agent_steps_trained": 899040, "num_env_steps_sampled": 899040, "num_env_steps_trained": 899040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.8697302073471, "num_env_steps_trained_throughput_per_sec": 190.8697302073471, "timesteps_total": 899040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 899040, "timers": {"training_iteration_time_ms": 1885.501, "sample_time_ms": 1878.478, "load_time_ms": 0.216, "load_throughput": 1664039.497, "learn_time_ms": 6.254, "learn_throughput": 57559.818, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 899040, "num_env_steps_trained": 899040, "num_agent_steps_sampled": 899040, "num_agent_steps_trained": 899040}, "done": false, "episodes_total": 2978, "training_iteration": 540, "trial_id": "6192e_00000", "date": "2023-08-04_11-33-37", "timestamp": 1691138017, "time_this_iter_s": 11.31867790222168, "time_total_s": 6036.65940952301, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2666.2003858089447, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 20.30625, "ram_util_percent": 65.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2919494628906, "policy_loss": -1695009.4125, "vf_loss": 20747700.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7073.0, "diff_num_grad_updates_vs_sampler_policy": 7072.0}}, "num_env_steps_sampled": 901200, "num_env_steps_trained": 901200, "num_agent_steps_sampled": 901200, "num_agent_steps_trained": 901200}, "sampler_results": {"episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.9020598952548, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3534514126555965, "mean_inference_ms": 0.23465639198163304, "mean_action_processing_ms": 0.05716796392098963, "mean_env_wait_ms": 0.5741353698884981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002543210983276367, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.04339885711669922}}, "episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.9020598952548, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.033577969531, -3527.208231075356, -3526.47631150821, -3525.8058664654272, -3526.007436820483, -3525.800604724126, -3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3534514126555965, "mean_inference_ms": 0.23465639198163304, "mean_action_processing_ms": 0.05716796392098963, "mean_env_wait_ms": 0.5741353698884981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002543210983276367, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.04339885711669922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 901200, "num_agent_steps_trained": 901200, "num_env_steps_sampled": 901200, "num_env_steps_trained": 901200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.09832462163553, "num_env_steps_trained_throughput_per_sec": 190.09832462163553, "timesteps_total": 901200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 901200, "timers": {"training_iteration_time_ms": 1891.192, "sample_time_ms": 1884.13, "load_time_ms": 0.22, "load_throughput": 1638577.797, "learn_time_ms": 6.304, "learn_throughput": 57105.935, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 901200, "num_env_steps_trained": 901200, "num_agent_steps_sampled": 901200, "num_agent_steps_trained": 901200}, "done": false, "episodes_total": 2984, "training_iteration": 541, "trial_id": "6192e_00000", "date": "2023-08-04_11-33-48", "timestamp": 1691138028, "time_this_iter_s": 11.364646911621094, "time_total_s": 6048.024056434631, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2677.565032720566, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 22.056250000000002, "ram_util_percent": 65.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1521423339844, "policy_loss": -1058951.678125, "vf_loss": 20733862.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7103.0, "diff_num_grad_updates_vs_sampler_policy": 7102.0}}, "num_env_steps_sampled": 903360, "num_env_steps_trained": 903360, "num_agent_steps_sampled": 903360, "num_agent_steps_trained": 903360}, "sampler_results": {"episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.9377710414533, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353458372346287, "mean_inference_ms": 0.23465670437949868, "mean_action_processing_ms": 0.057167837389492965, "mean_env_wait_ms": 0.5741149114539571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002536773681640625, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.04338240623474121}}, "episode_reward_max": -3525.5784239550812, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.9377710414533, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.921642742487, -3526.779092305388, -3526.868520702733, -3526.8014413513897, -3526.243760363742, -3527.107303705727, -3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353458372346287, "mean_inference_ms": 0.23465670437949868, "mean_action_processing_ms": 0.057167837389492965, "mean_env_wait_ms": 0.5741149114539571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002536773681640625, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.04338240623474121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 903360, "num_agent_steps_trained": 903360, "num_env_steps_sampled": 903360, "num_env_steps_trained": 903360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.48217109176892, "num_env_steps_trained_throughput_per_sec": 190.48217109176892, "timesteps_total": 903360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 903360, "timers": {"training_iteration_time_ms": 1892.97, "sample_time_ms": 1885.958, "load_time_ms": 0.215, "load_throughput": 1675859.534, "learn_time_ms": 6.241, "learn_throughput": 57682.736, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 903360, "num_env_steps_trained": 903360, "num_agent_steps_sampled": 903360, "num_agent_steps_trained": 903360}, "done": false, "episodes_total": 2990, "training_iteration": 542, "trial_id": "6192e_00000", "date": "2023-08-04_11-33-59", "timestamp": 1691138039, "time_this_iter_s": 11.341929912567139, "time_total_s": 6059.3659863471985, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2688.906962633133, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 18.96875, "ram_util_percent": 65.09375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1585998535156, "policy_loss": 294397.98125, "vf_loss": 20733244.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7133.0, "diff_num_grad_updates_vs_sampler_policy": 7132.0}}, "num_env_steps_sampled": 905520, "num_env_steps_trained": 905520, "num_agent_steps_sampled": 905520, "num_agent_steps_trained": 905520}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.919392748253, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3534642567792865, "mean_inference_ms": 0.23465694280910335, "mean_action_processing_ms": 0.05716768443284142, "mean_env_wait_ms": 0.5740933659410955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025403499603271484, "StateBufferConnector_ms": 0.0017173290252685547, "ViewRequirementAgentConnector_ms": 0.0433650016784668}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3529.4307292562553, "episode_reward_mean": -3526.919392748253, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.2691736542897, -3526.008014607723, -3526.4590940770727, -3527.952852676506, -3526.494321780413, -3526.2136258651253, -3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3534642567792865, "mean_inference_ms": 0.23465694280910335, "mean_action_processing_ms": 0.05716768443284142, "mean_env_wait_ms": 0.5740933659410955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025403499603271484, "StateBufferConnector_ms": 0.0017173290252685547, "ViewRequirementAgentConnector_ms": 0.0433650016784668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 905520, "num_agent_steps_trained": 905520, "num_env_steps_sampled": 905520, "num_env_steps_trained": 905520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.99794921207123, "num_env_steps_trained_throughput_per_sec": 190.99794921207123, "timesteps_total": 905520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 905520, "timers": {"training_iteration_time_ms": 1888.612, "sample_time_ms": 1881.678, "load_time_ms": 0.213, "load_throughput": 1688414.894, "learn_time_ms": 6.176, "learn_throughput": 58286.604, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 905520, "num_env_steps_trained": 905520, "num_agent_steps_sampled": 905520, "num_agent_steps_trained": 905520}, "done": false, "episodes_total": 2996, "training_iteration": 543, "trial_id": "6192e_00000", "date": "2023-08-04_11-34-11", "timestamp": 1691138051, "time_this_iter_s": 11.311026811599731, "time_total_s": 6070.677013158798, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2700.2179894447327, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 18.941176470588236, "ram_util_percent": 65.12941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2643188476562, "policy_loss": -3246819.825, "vf_loss": 20750732.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7163.0, "diff_num_grad_updates_vs_sampler_policy": 7162.0}}, "num_env_steps_sampled": 907680, "num_env_steps_trained": 907680, "num_agent_steps_sampled": 907680, "num_agent_steps_trained": 907680}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.9718590756556, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3534729437059685, "mean_inference_ms": 0.23465727530219155, "mean_action_processing_ms": 0.05716757174236974, "mean_env_wait_ms": 0.5740754631397755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025472640991210938, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.043415069580078125}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.9718590756556, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.206867609891, -3527.7806065269347, -3526.829810654603, -3526.7092528297485, -3528.01949095865, -3526.8416917220916, -3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3534729437059685, "mean_inference_ms": 0.23465727530219155, "mean_action_processing_ms": 0.05716757174236974, "mean_env_wait_ms": 0.5740754631397755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025472640991210938, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.043415069580078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 907680, "num_agent_steps_trained": 907680, "num_env_steps_sampled": 907680, "num_env_steps_trained": 907680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.72785371450783, "num_env_steps_trained_throughput_per_sec": 189.72785371450783, "timesteps_total": 907680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 907680, "timers": {"training_iteration_time_ms": 1891.837, "sample_time_ms": 1884.844, "load_time_ms": 0.216, "load_throughput": 1666426.929, "learn_time_ms": 6.218, "learn_throughput": 57897.5, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 907680, "num_env_steps_trained": 907680, "num_agent_steps_sampled": 907680, "num_agent_steps_trained": 907680}, "done": false, "episodes_total": 3002, "training_iteration": 544, "trial_id": "6192e_00000", "date": "2023-08-04_11-34-22", "timestamp": 1691138062, "time_this_iter_s": 11.386766910552979, "time_total_s": 6082.063780069351, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2711.6047563552856, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 22.21875, "ram_util_percent": 65.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3199096679688, "policy_loss": -6367333.875, "vf_loss": 20734471.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7193.0, "diff_num_grad_updates_vs_sampler_policy": 7192.0}}, "num_env_steps_sampled": 909840, "num_env_steps_trained": 909840, "num_agent_steps_sampled": 909840, "num_agent_steps_trained": 909840}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.9501704695354, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353485271186957, "mean_inference_ms": 0.23465766860514492, "mean_action_processing_ms": 0.05716745327046428, "mean_env_wait_ms": 0.5740583152434006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025250911712646484, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.043437957763671875}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.9501704695354, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.4518788907967, -3528.4642604528935, -3526.8849775448234, -3527.072018711253, -3526.5277129562164, -3527.040947451639, -3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353485271186957, "mean_inference_ms": 0.23465766860514492, "mean_action_processing_ms": 0.05716745327046428, "mean_env_wait_ms": 0.5740583152434006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025250911712646484, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.043437957763671875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 909840, "num_agent_steps_trained": 909840, "num_env_steps_sampled": 909840, "num_env_steps_trained": 909840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.6047740313629, "num_env_steps_trained_throughput_per_sec": 189.6047740313629, "timesteps_total": 909840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 909840, "timers": {"training_iteration_time_ms": 1899.579, "sample_time_ms": 1892.548, "load_time_ms": 0.215, "load_throughput": 1674001.596, "learn_time_ms": 6.25, "learn_throughput": 57600.0, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 909840, "num_env_steps_trained": 909840, "num_agent_steps_sampled": 909840, "num_agent_steps_trained": 909840}, "done": false, "episodes_total": 3008, "training_iteration": 545, "trial_id": "6192e_00000", "date": "2023-08-04_11-34-34", "timestamp": 1691138074, "time_this_iter_s": 11.394398927688599, "time_total_s": 6093.45817899704, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2722.9991552829742, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 19.78125, "ram_util_percent": 65.34375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.17424926757815, "policy_loss": -1459006.8375, "vf_loss": 20726574.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7223.0, "diff_num_grad_updates_vs_sampler_policy": 7222.0}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.891166551066, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353499532334643, "mean_inference_ms": 0.23465771079922476, "mean_action_processing_ms": 0.057167282530640066, "mean_env_wait_ms": 0.5740373585547287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025322437286376953, "StateBufferConnector_ms": 0.0017249584197998047, "ViewRequirementAgentConnector_ms": 0.04345703125}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.891166551066, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5647992876907, -3529.4307292562553, -3526.8150131452135, -3527.4219241533324, -3526.7183470886025, -3526.574108360895, -3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353499532334643, "mean_inference_ms": 0.23465771079922476, "mean_action_processing_ms": 0.057167282530640066, "mean_env_wait_ms": 0.5740373585547287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025322437286376953, "StateBufferConnector_ms": 0.0017249584197998047, "ViewRequirementAgentConnector_ms": 0.04345703125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.6087107857573, "num_env_steps_trained_throughput_per_sec": 190.6087107857573, "timesteps_total": 912000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 1890.398, "sample_time_ms": 1883.394, "load_time_ms": 0.216, "load_throughput": 1667346.996, "learn_time_ms": 6.23, "learn_throughput": 57781.183, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3014, "training_iteration": 546, "trial_id": "6192e_00000", "date": "2023-08-04_11-34-45", "timestamp": 1691138085, "time_this_iter_s": 11.334160089492798, "time_total_s": 6104.792339086533, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2734.333315372467, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 19.49375, "ram_util_percent": 65.19375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.25609130859374, "policy_loss": -1673543.790625, "vf_loss": 20750668.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7253.0, "diff_num_grad_updates_vs_sampler_policy": 7252.0}}, "num_env_steps_sampled": 914160, "num_env_steps_trained": 914160, "num_agent_steps_sampled": 914160, "num_agent_steps_trained": 914160}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.8416409218557, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35351630784173, "mean_inference_ms": 0.23465775466026081, "mean_action_processing_ms": 0.05716714268084276, "mean_env_wait_ms": 0.5740164484856846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002527952194213867, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.04340076446533203}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.8416409218557, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.3469265202402, -3527.1555168692003, -3526.8305315699185, -3526.946285073067, -3528.651871205597, -3526.945189514227, -3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35351630784173, "mean_inference_ms": 0.23465775466026081, "mean_action_processing_ms": 0.05716714268084276, "mean_env_wait_ms": 0.5740164484856846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002527952194213867, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.04340076446533203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 914160, "num_agent_steps_trained": 914160, "num_env_steps_sampled": 914160, "num_env_steps_trained": 914160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.86471644064918, "num_env_steps_trained_throughput_per_sec": 189.86471644064918, "timesteps_total": 914160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 914160, "timers": {"training_iteration_time_ms": 1894.525, "sample_time_ms": 1887.553, "load_time_ms": 0.218, "load_throughput": 1655101.874, "learn_time_ms": 6.207, "learn_throughput": 57994.901, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 914160, "num_env_steps_trained": 914160, "num_agent_steps_sampled": 914160, "num_agent_steps_trained": 914160}, "done": false, "episodes_total": 3020, "training_iteration": 547, "trial_id": "6192e_00000", "date": "2023-08-04_11-34-56", "timestamp": 1691138096, "time_this_iter_s": 11.37862491607666, "time_total_s": 6116.170964002609, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2745.7119402885437, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 22.99375, "ram_util_percent": 65.20625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.36408081054685, "policy_loss": -4292034.4, "vf_loss": 20750356.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7283.0, "diff_num_grad_updates_vs_sampler_policy": 7282.0}}, "num_env_steps_sampled": 916320, "num_env_steps_trained": 916320, "num_agent_steps_sampled": 916320, "num_agent_steps_trained": 916320}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.8042180270813, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353531957290068, "mean_inference_ms": 0.23465747702325712, "mean_action_processing_ms": 0.057166973728536165, "mean_env_wait_ms": 0.5739934788024749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025246143341064453, "StateBufferConnector_ms": 0.0017066001892089844, "ViewRequirementAgentConnector_ms": 0.04335451126098633}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.8042180270813, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.9482513934436, -3527.187872438105, -3527.2693906898403, -3525.5784239550812, -3527.813344357635, -3526.4065526409695, -3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353531957290068, "mean_inference_ms": 0.23465747702325712, "mean_action_processing_ms": 0.057166973728536165, "mean_env_wait_ms": 0.5739934788024749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025246143341064453, "StateBufferConnector_ms": 0.0017066001892089844, "ViewRequirementAgentConnector_ms": 0.04335451126098633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 916320, "num_agent_steps_trained": 916320, "num_env_steps_sampled": 916320, "num_env_steps_trained": 916320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.5811803617819, "num_env_steps_trained_throughput_per_sec": 190.5811803617819, "timesteps_total": 916320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 916320, "timers": {"training_iteration_time_ms": 1893.724, "sample_time_ms": 1886.751, "load_time_ms": 0.215, "load_throughput": 1673816.029, "learn_time_ms": 6.209, "learn_throughput": 57983.766, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 916320, "num_env_steps_trained": 916320, "num_agent_steps_sampled": 916320, "num_agent_steps_trained": 916320}, "done": false, "episodes_total": 3026, "training_iteration": 548, "trial_id": "6192e_00000", "date": "2023-08-04_11-35-08", "timestamp": 1691138108, "time_this_iter_s": 11.335778951644897, "time_total_s": 6127.506742954254, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2757.0477192401886, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 19.4, "ram_util_percent": 64.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2234619140625, "policy_loss": -3421601.253125, "vf_loss": 20739274.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7313.0, "diff_num_grad_updates_vs_sampler_policy": 7312.0}}, "num_env_steps_sampled": 918480, "num_env_steps_trained": 918480, "num_agent_steps_sampled": 918480, "num_agent_steps_trained": 918480}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.7878159758798, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353545192385235, "mean_inference_ms": 0.23465675605978134, "mean_action_processing_ms": 0.05716677897777734, "mean_env_wait_ms": 0.5739695694291249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025229454040527344, "StateBufferConnector_ms": 0.0017113685607910156, "ViewRequirementAgentConnector_ms": 0.043381690979003906}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3530.119466863943, "episode_reward_mean": -3526.7878159758798, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.4464707564703, -3526.1796524322554, -3526.0019268596043, -3525.705440597934, -3527.198552229522, -3528.562675958897, -3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353545192385235, "mean_inference_ms": 0.23465675605978134, "mean_action_processing_ms": 0.05716677897777734, "mean_env_wait_ms": 0.5739695694291249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025229454040527344, "StateBufferConnector_ms": 0.0017113685607910156, "ViewRequirementAgentConnector_ms": 0.043381690979003906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918480, "num_agent_steps_trained": 918480, "num_env_steps_sampled": 918480, "num_env_steps_trained": 918480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.55191044467028, "num_env_steps_trained_throughput_per_sec": 190.55191044467028, "timesteps_total": 918480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 918480, "timers": {"training_iteration_time_ms": 1890.534, "sample_time_ms": 1883.534, "load_time_ms": 0.219, "load_throughput": 1642141.86, "learn_time_ms": 6.233, "learn_throughput": 57754.662, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 918480, "num_env_steps_trained": 918480, "num_agent_steps_sampled": 918480, "num_agent_steps_trained": 918480}, "done": false, "episodes_total": 3032, "training_iteration": 549, "trial_id": "6192e_00000", "date": "2023-08-04_11-35-19", "timestamp": 1691138119, "time_this_iter_s": 11.33762264251709, "time_total_s": 6138.844365596771, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2768.3853418827057, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 18.825000000000003, "ram_util_percent": 64.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1411499023437, "policy_loss": -1127272.325, "vf_loss": 20730322.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7343.0, "diff_num_grad_updates_vs_sampler_policy": 7342.0}}, "num_env_steps_sampled": 920640, "num_env_steps_trained": 920640, "num_agent_steps_sampled": 920640, "num_agent_steps_trained": 920640}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.8255696824035, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353563654446977, "mean_inference_ms": 0.23465584737517578, "mean_action_processing_ms": 0.05716661056363688, "mean_env_wait_ms": 0.5739460535209322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025184154510498047, "StateBufferConnector_ms": 0.001718759536743164, "ViewRequirementAgentConnector_ms": 0.04337453842163086}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.8255696824035, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5923696198893, -3526.1925301273586, -3526.093544704238, -3526.047193932423, -3528.4187181971974, -3526.670395920811, -3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353563654446977, "mean_inference_ms": 0.23465584737517578, "mean_action_processing_ms": 0.05716661056363688, "mean_env_wait_ms": 0.5739460535209322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025184154510498047, "StateBufferConnector_ms": 0.001718759536743164, "ViewRequirementAgentConnector_ms": 0.04337453842163086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920640, "num_agent_steps_trained": 920640, "num_env_steps_sampled": 920640, "num_env_steps_trained": 920640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.7877697378296, "num_env_steps_trained_throughput_per_sec": 189.7877697378296, "timesteps_total": 920640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 920640, "timers": {"training_iteration_time_ms": 1894.628, "sample_time_ms": 1887.562, "load_time_ms": 0.219, "load_throughput": 1640892.676, "learn_time_ms": 6.291, "learn_throughput": 57223.666, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 920640, "num_env_steps_trained": 920640, "num_agent_steps_sampled": 920640, "num_agent_steps_trained": 920640}, "done": false, "episodes_total": 3038, "training_iteration": 550, "trial_id": "6192e_00000", "date": "2023-08-04_11-35-30", "timestamp": 1691138130, "time_this_iter_s": 11.383503913879395, "time_total_s": 6150.227869510651, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2779.768845796585, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 18.75, "ram_util_percent": 64.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.4123168945313, "policy_loss": -2641457.565625, "vf_loss": 20760020.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7373.0, "diff_num_grad_updates_vs_sampler_policy": 7372.0}}, "num_env_steps_sampled": 922800, "num_env_steps_trained": 922800, "num_agent_steps_sampled": 922800, "num_agent_steps_trained": 922800}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.8148191516625, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353587928877229, "mean_inference_ms": 0.23465467992923839, "mean_action_processing_ms": 0.05716645890445933, "mean_env_wait_ms": 0.5739190799420354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025200843811035156, "StateBufferConnector_ms": 0.0017197132110595703, "ViewRequirementAgentConnector_ms": 0.043358802795410156}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.8148191516625, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.504387120464, -3526.600686151983, -3526.7012531722853, -3528.0909470027837, -3527.622604391533, -3526.305387675482, -3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353587928877229, "mean_inference_ms": 0.23465467992923839, "mean_action_processing_ms": 0.05716645890445933, "mean_env_wait_ms": 0.5739190799420354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025200843811035156, "StateBufferConnector_ms": 0.0017197132110595703, "ViewRequirementAgentConnector_ms": 0.043358802795410156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 922800, "num_agent_steps_trained": 922800, "num_env_steps_sampled": 922800, "num_env_steps_trained": 922800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.52803859074857, "num_env_steps_trained_throughput_per_sec": 190.52803859074857, "timesteps_total": 922800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 922800, "timers": {"training_iteration_time_ms": 1891.872, "sample_time_ms": 1884.853, "load_time_ms": 0.219, "load_throughput": 1640892.676, "learn_time_ms": 6.249, "learn_throughput": 57613.406, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 922800, "num_env_steps_trained": 922800, "num_agent_steps_sampled": 922800, "num_agent_steps_trained": 922800}, "done": false, "episodes_total": 3044, "training_iteration": 551, "trial_id": "6192e_00000", "date": "2023-08-04_11-35-42", "timestamp": 1691138142, "time_this_iter_s": 11.339184045791626, "time_total_s": 6161.567053556442, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2791.1080298423767, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 19.425, "ram_util_percent": 64.85624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.48692626953124, "policy_loss": -9573828.05, "vf_loss": 20762315.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7403.0, "diff_num_grad_updates_vs_sampler_policy": 7402.0}}, "num_env_steps_sampled": 924960, "num_env_steps_trained": 924960, "num_agent_steps_sampled": 924960, "num_agent_steps_trained": 924960}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.81030160061, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353613418254027, "mean_inference_ms": 0.23465378995179137, "mean_action_processing_ms": 0.057166401661030146, "mean_env_wait_ms": 0.5738925658481321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025157928466796875, "StateBufferConnector_ms": 0.0017197132110595703, "ViewRequirementAgentConnector_ms": 0.04343438148498535}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.81030160061, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.9995748308665, -3525.5867570636697, -3526.5836908791607, -3527.3726977010037, -3525.9104867252245, -3527.9014101172247, -3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353613418254027, "mean_inference_ms": 0.23465378995179137, "mean_action_processing_ms": 0.057166401661030146, "mean_env_wait_ms": 0.5738925658481321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025157928466796875, "StateBufferConnector_ms": 0.0017197132110595703, "ViewRequirementAgentConnector_ms": 0.04343438148498535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924960, "num_agent_steps_trained": 924960, "num_env_steps_sampled": 924960, "num_env_steps_trained": 924960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.83574174367075, "num_env_steps_trained_throughput_per_sec": 189.83574174367075, "timesteps_total": 924960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 924960, "timers": {"training_iteration_time_ms": 1895.921, "sample_time_ms": 1888.936, "load_time_ms": 0.22, "load_throughput": 1638222.242, "learn_time_ms": 6.219, "learn_throughput": 57891.063, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 924960, "num_env_steps_trained": 924960, "num_agent_steps_sampled": 924960, "num_agent_steps_trained": 924960}, "done": false, "episodes_total": 3050, "training_iteration": 552, "trial_id": "6192e_00000", "date": "2023-08-04_11-35-53", "timestamp": 1691138153, "time_this_iter_s": 11.380468130111694, "time_total_s": 6172.947521686554, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2802.4884979724884, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 21.543750000000003, "ram_util_percent": 64.94375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.1493774414063, "policy_loss": -360849.8625, "vf_loss": 20730023.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7433.0, "diff_num_grad_updates_vs_sampler_policy": 7432.0}}, "num_env_steps_sampled": 927120, "num_env_steps_trained": 927120, "num_agent_steps_sampled": 927120, "num_agent_steps_trained": 927120}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.8212262559678, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3536369158983215, "mean_inference_ms": 0.23465275468759317, "mean_action_processing_ms": 0.05716635502539255, "mean_env_wait_ms": 0.5738663533520361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513885498046875, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.04340815544128418}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.8212262559678, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.728513128576, -3525.8954066810456, -3527.4904739088024, -3527.943968723155, -3527.351764197563, -3526.6646671883145, -3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3536369158983215, "mean_inference_ms": 0.23465275468759317, "mean_action_processing_ms": 0.05716635502539255, "mean_env_wait_ms": 0.5738663533520361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513885498046875, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.04340815544128418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 927120, "num_agent_steps_trained": 927120, "num_env_steps_sampled": 927120, "num_env_steps_trained": 927120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.4274754430188, "num_env_steps_trained_throughput_per_sec": 190.4274754430188, "timesteps_total": 927120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 927120, "timers": {"training_iteration_time_ms": 1892.824, "sample_time_ms": 1885.889, "load_time_ms": 0.217, "load_throughput": 1656009.476, "learn_time_ms": 6.16, "learn_throughput": 58440.23, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 927120, "num_env_steps_trained": 927120, "num_agent_steps_sampled": 927120, "num_agent_steps_trained": 927120}, "done": false, "episodes_total": 3056, "training_iteration": 553, "trial_id": "6192e_00000", "date": "2023-08-04_11-36-05", "timestamp": 1691138165, "time_this_iter_s": 11.345111846923828, "time_total_s": 6184.292633533478, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2813.8336098194122, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 19.60625, "ram_util_percent": 64.94375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3506591796875, "policy_loss": -5111006.7875, "vf_loss": 20766662.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7463.0, "diff_num_grad_updates_vs_sampler_policy": 7462.0}}, "num_env_steps_sampled": 929280, "num_env_steps_trained": 929280, "num_agent_steps_sampled": 929280, "num_agent_steps_trained": 929280}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.834334188158, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353657525486176, "mean_inference_ms": 0.2346514852685196, "mean_action_processing_ms": 0.05716627881324852, "mean_env_wait_ms": 0.573838320332774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025091171264648438, "StateBufferConnector_ms": 0.0017185211181640625, "ViewRequirementAgentConnector_ms": 0.0434267520904541}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.834334188158, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.8254702595405, -3526.9745097366936, -3527.841246688391, -3525.9789843960025, -3526.03988890175, -3526.6801012487877, -3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353657525486176, "mean_inference_ms": 0.2346514852685196, "mean_action_processing_ms": 0.05716627881324852, "mean_env_wait_ms": 0.573838320332774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025091171264648438, "StateBufferConnector_ms": 0.0017185211181640625, "ViewRequirementAgentConnector_ms": 0.0434267520904541}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 929280, "num_agent_steps_trained": 929280, "num_env_steps_sampled": 929280, "num_env_steps_trained": 929280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.8857843649953, "num_env_steps_trained_throughput_per_sec": 190.8857843649953, "timesteps_total": 929280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 929280, "timers": {"training_iteration_time_ms": 1887.903, "sample_time_ms": 1881.015, "load_time_ms": 0.215, "load_throughput": 1672888.81, "learn_time_ms": 6.141, "learn_throughput": 58626.291, "synch_weights_time_ms": 0.501}, "counters": {"num_env_steps_sampled": 929280, "num_env_steps_trained": 929280, "num_agent_steps_sampled": 929280, "num_agent_steps_trained": 929280}, "done": false, "episodes_total": 3062, "training_iteration": 554, "trial_id": "6192e_00000", "date": "2023-08-04_11-36-16", "timestamp": 1691138176, "time_this_iter_s": 11.317831993103027, "time_total_s": 6195.610465526581, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2825.1514418125153, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 18.976470588235294, "ram_util_percent": 64.9470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.31910400390626, "policy_loss": -10666090.221875, "vf_loss": 20736716.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7493.0, "diff_num_grad_updates_vs_sampler_policy": 7492.0}}, "num_env_steps_sampled": 931440, "num_env_steps_trained": 931440, "num_agent_steps_sampled": 931440, "num_agent_steps_trained": 931440}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.8651937807035, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353684009908407, "mean_inference_ms": 0.234650557047633, "mean_action_processing_ms": 0.05716629259825808, "mean_env_wait_ms": 0.5738137034288805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025119781494140625, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.043485403060913086}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.8651937807035, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6297862645156, -3526.7309375647014, -3526.6429313765707, -3526.3055211506107, -3526.540206403189, -3525.873734894622, -3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353684009908407, "mean_inference_ms": 0.234650557047633, "mean_action_processing_ms": 0.05716629259825808, "mean_env_wait_ms": 0.5738137034288805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025119781494140625, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.043485403060913086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 931440, "num_agent_steps_trained": 931440, "num_env_steps_sampled": 931440, "num_env_steps_trained": 931440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.14784954868355, "num_env_steps_trained_throughput_per_sec": 189.14784954868355, "timesteps_total": 931440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 931440, "timers": {"training_iteration_time_ms": 1896.484, "sample_time_ms": 1889.536, "load_time_ms": 0.212, "load_throughput": 1699436.624, "learn_time_ms": 6.205, "learn_throughput": 58020.751, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 931440, "num_env_steps_trained": 931440, "num_agent_steps_sampled": 931440, "num_agent_steps_trained": 931440}, "done": false, "episodes_total": 3068, "training_iteration": 555, "trial_id": "6192e_00000", "date": "2023-08-04_11-36-27", "timestamp": 1691138187, "time_this_iter_s": 11.421684980392456, "time_total_s": 6207.032150506973, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2836.5731267929077, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 21.56875, "ram_util_percent": 65.20625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3425048828125, "policy_loss": -7474941.528125, "vf_loss": 20765528.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7523.0, "diff_num_grad_updates_vs_sampler_policy": 7522.0}}, "num_env_steps_sampled": 933600, "num_env_steps_trained": 933600, "num_agent_steps_sampled": 933600, "num_agent_steps_trained": 933600}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.8978474981477, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353710215243671, "mean_inference_ms": 0.2346499410953866, "mean_action_processing_ms": 0.05716637374101743, "mean_env_wait_ms": 0.5737919887922289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025177001953125, "StateBufferConnector_ms": 0.0017228126525878906, "ViewRequirementAgentConnector_ms": 0.043486833572387695}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.8978474981477, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6738879178697, -3528.1086369996146, -3526.5553859390784, -3527.5359530136316, -3527.840080864023, -3525.776499241337, -3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353710215243671, "mean_inference_ms": 0.2346499410953866, "mean_action_processing_ms": 0.05716637374101743, "mean_env_wait_ms": 0.5737919887922289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025177001953125, "StateBufferConnector_ms": 0.0017228126525878906, "ViewRequirementAgentConnector_ms": 0.043486833572387695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 933600, "num_agent_steps_trained": 933600, "num_env_steps_sampled": 933600, "num_env_steps_trained": 933600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.55136938458807, "num_env_steps_trained_throughput_per_sec": 190.55136938458807, "timesteps_total": 933600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 933600, "timers": {"training_iteration_time_ms": 1895.48, "sample_time_ms": 1888.489, "load_time_ms": 0.213, "load_throughput": 1687282.87, "learn_time_ms": 6.206, "learn_throughput": 58011.835, "synch_weights_time_ms": 0.542}, "counters": {"num_env_steps_sampled": 933600, "num_env_steps_trained": 933600, "num_agent_steps_sampled": 933600, "num_agent_steps_trained": 933600}, "done": false, "episodes_total": 3074, "training_iteration": 556, "trial_id": "6192e_00000", "date": "2023-08-04_11-36-39", "timestamp": 1691138199, "time_this_iter_s": 11.338075160980225, "time_total_s": 6218.3702256679535, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2847.911201953888, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 19.46875, "ram_util_percent": 65.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.40757446289064, "policy_loss": -9461328.325, "vf_loss": 20845355.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7553.0, "diff_num_grad_updates_vs_sampler_policy": 7552.0}}, "num_env_steps_sampled": 935760, "num_env_steps_trained": 935760, "num_agent_steps_sampled": 935760, "num_agent_steps_trained": 935760}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.9466430617545, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353740779550846, "mean_inference_ms": 0.2346497684463562, "mean_action_processing_ms": 0.05716651909622276, "mean_env_wait_ms": 0.5737691281606808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.04348039627075195}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.9466430617545, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.9456084814283, -3525.984329095883, -3527.3682502086344, -3527.1044246583524, -3525.586756177743, -3527.863083111038, -3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353740779550846, "mean_inference_ms": 0.2346497684463562, "mean_action_processing_ms": 0.05716651909622276, "mean_env_wait_ms": 0.5737691281606808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505064010620117, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.04348039627075195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 935760, "num_agent_steps_trained": 935760, "num_env_steps_sampled": 935760, "num_env_steps_trained": 935760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.07222545838366, "num_env_steps_trained_throughput_per_sec": 190.07222545838366, "timesteps_total": 935760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 935760, "timers": {"training_iteration_time_ms": 1891.467, "sample_time_ms": 1884.514, "load_time_ms": 0.219, "load_throughput": 1646978.01, "learn_time_ms": 6.175, "learn_throughput": 58299.656, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 935760, "num_env_steps_trained": 935760, "num_agent_steps_sampled": 935760, "num_agent_steps_trained": 935760}, "done": false, "episodes_total": 3080, "training_iteration": 557, "trial_id": "6192e_00000", "date": "2023-08-04_11-36-50", "timestamp": 1691138210, "time_this_iter_s": 11.366022825241089, "time_total_s": 6229.736248493195, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2859.277224779129, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 26.40625, "ram_util_percent": 65.23125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.09547119140626, "policy_loss": 328468.209375, "vf_loss": 20729243.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7583.0, "diff_num_grad_updates_vs_sampler_policy": 7582.0}}, "num_env_steps_sampled": 937920, "num_env_steps_trained": 937920, "num_agent_steps_sampled": 937920, "num_agent_steps_trained": 937920}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.9367690892127, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353768734197662, "mean_inference_ms": 0.23464965288000955, "mean_action_processing_ms": 0.057166650024408856, "mean_env_wait_ms": 0.5737455922017514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499103546142578, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.04344749450683594}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3526.9367690892127, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.7325586343272, -3527.250461557469, -3526.5798895235253, -3525.8903941788863, -3526.687383046455, -3526.4852053390036, -3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353768734197662, "mean_inference_ms": 0.23464965288000955, "mean_action_processing_ms": 0.057166650024408856, "mean_env_wait_ms": 0.5737455922017514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499103546142578, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.04344749450683594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 937920, "num_agent_steps_trained": 937920, "num_env_steps_sampled": 937920, "num_env_steps_trained": 937920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.72662498525818, "num_env_steps_trained_throughput_per_sec": 190.72662498525818, "timesteps_total": 937920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 937920, "timers": {"training_iteration_time_ms": 1888.864, "sample_time_ms": 1881.879, "load_time_ms": 0.219, "load_throughput": 1647337.377, "learn_time_ms": 6.226, "learn_throughput": 57819.904, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 937920, "num_env_steps_trained": 937920, "num_agent_steps_sampled": 937920, "num_agent_steps_trained": 937920}, "done": false, "episodes_total": 3086, "training_iteration": 558, "trial_id": "6192e_00000", "date": "2023-08-04_11-37-01", "timestamp": 1691138221, "time_this_iter_s": 11.327167987823486, "time_total_s": 6241.063416481018, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2870.6043927669525, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 23.0625, "ram_util_percent": 64.9875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.3205200195313, "policy_loss": -5898607.340625, "vf_loss": 20744563.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7613.0, "diff_num_grad_updates_vs_sampler_policy": 7612.0}}, "num_env_steps_sampled": 940080, "num_env_steps_trained": 940080, "num_agent_steps_sampled": 940080, "num_agent_steps_trained": 940080}, "sampler_results": {"episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3527.0218996076933, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353791870982917, "mean_inference_ms": 0.23464962987129367, "mean_action_processing_ms": 0.05716682136134118, "mean_env_wait_ms": 0.5737254570833392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002500772476196289, "StateBufferConnector_ms": 0.001726388931274414, "ViewRequirementAgentConnector_ms": 0.04349780082702637}}, "episode_reward_max": -3525.3493893222894, "episode_reward_min": -3533.547945914034, "episode_reward_mean": -3527.0218996076933, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.478626944487, -3525.3493893222894, -3527.024430826886, -3525.8588963722145, -3526.4325042418, -3526.0827172068953, -3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353791870982917, "mean_inference_ms": 0.23464962987129367, "mean_action_processing_ms": 0.05716682136134118, "mean_env_wait_ms": 0.5737254570833392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002500772476196289, "StateBufferConnector_ms": 0.001726388931274414, "ViewRequirementAgentConnector_ms": 0.04349780082702637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 940080, "num_agent_steps_trained": 940080, "num_env_steps_sampled": 940080, "num_env_steps_trained": 940080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.86277772912416, "num_env_steps_trained_throughput_per_sec": 190.86277772912416, "timesteps_total": 940080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 940080, "timers": {"training_iteration_time_ms": 1887.375, "sample_time_ms": 1880.347, "load_time_ms": 0.215, "load_throughput": 1674187.205, "learn_time_ms": 6.249, "learn_throughput": 57607.911, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 940080, "num_env_steps_trained": 940080, "num_agent_steps_sampled": 940080, "num_agent_steps_trained": 940080}, "done": false, "episodes_total": 3092, "training_iteration": 559, "trial_id": "6192e_00000", "date": "2023-08-04_11-37-13", "timestamp": 1691138233, "time_this_iter_s": 11.319008827209473, "time_total_s": 6252.3824253082275, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2881.923401594162, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 18.425, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.39130249023435, "policy_loss": -6889736.5796875, "vf_loss": 20756849.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7643.0, "diff_num_grad_updates_vs_sampler_policy": 7642.0}}, "num_env_steps_sampled": 942240, "num_env_steps_trained": 942240, "num_agent_steps_sampled": 942240, "num_agent_steps_trained": 942240}, "sampler_results": {"episode_reward_max": -3525.4478482798627, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.192042979021, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353814991375792, "mean_inference_ms": 0.23464966481499733, "mean_action_processing_ms": 0.057167034143732635, "mean_env_wait_ms": 0.5737103709579937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024878978729248047, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.04355025291442871}}, "episode_reward_max": -3525.4478482798627, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.192042979021, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.597082633251, -3527.374615744564, -3530.119466863943, -3527.037328710985, -3527.0131646784025, -3526.8669209743994, -3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353814991375792, "mean_inference_ms": 0.23464966481499733, "mean_action_processing_ms": 0.057167034143732635, "mean_env_wait_ms": 0.5737103709579937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024878978729248047, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.04355025291442871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 942240, "num_agent_steps_trained": 942240, "num_env_steps_sampled": 942240, "num_env_steps_trained": 942240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.80521310559632, "num_env_steps_trained_throughput_per_sec": 189.80521310559632, "timesteps_total": 942240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 942240, "timers": {"training_iteration_time_ms": 1893.448, "sample_time_ms": 1886.459, "load_time_ms": 0.215, "load_throughput": 1671222.402, "learn_time_ms": 6.244, "learn_throughput": 57657.406, "synch_weights_time_ms": 0.498}, "counters": {"num_env_steps_sampled": 942240, "num_env_steps_trained": 942240, "num_agent_steps_sampled": 942240, "num_agent_steps_trained": 942240}, "done": false, "episodes_total": 3098, "training_iteration": 560, "trial_id": "6192e_00000", "date": "2023-08-04_11-37-24", "timestamp": 1691138244, "time_this_iter_s": 11.38211989402771, "time_total_s": 6263.764545202255, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2893.3055214881897, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 19.50625, "ram_util_percent": 64.69375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.14716186523435, "policy_loss": 35216.44375, "vf_loss": 20728213.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7673.0, "diff_num_grad_updates_vs_sampler_policy": 7672.0}}, "num_env_steps_sampled": 944400, "num_env_steps_trained": 944400, "num_agent_steps_sampled": 944400, "num_agent_steps_trained": 944400}, "sampler_results": {"episode_reward_max": -3525.4478482798627, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.2020349138475, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093, -3525.9017368192567, -3526.6452067998807, -3527.2841326613343, -3533.802711486452, -3527.7833100022067, -3525.5906753191516], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3538409584645805, "mean_inference_ms": 0.2346498536511024, "mean_action_processing_ms": 0.05716724925163305, "mean_env_wait_ms": 0.5736938730319683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024785995483398438, "StateBufferConnector_ms": 0.001718759536743164, "ViewRequirementAgentConnector_ms": 0.04347801208496094}}, "episode_reward_max": -3525.4478482798627, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.2020349138475, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.3388266982925, -3526.094463190823, -3527.5468657503993, -3526.3586183975376, -3526.4419721777235, -3525.8998369880983, -3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093, -3525.9017368192567, -3526.6452067998807, -3527.2841326613343, -3533.802711486452, -3527.7833100022067, -3525.5906753191516], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3538409584645805, "mean_inference_ms": 0.2346498536511024, "mean_action_processing_ms": 0.05716724925163305, "mean_env_wait_ms": 0.5736938730319683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024785995483398438, "StateBufferConnector_ms": 0.001718759536743164, "ViewRequirementAgentConnector_ms": 0.04347801208496094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944400, "num_agent_steps_trained": 944400, "num_env_steps_sampled": 944400, "num_env_steps_trained": 944400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.4250022696217, "num_env_steps_trained_throughput_per_sec": 189.4250022696217, "timesteps_total": 944400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 944400, "timers": {"training_iteration_time_ms": 1901.767, "sample_time_ms": 1894.754, "load_time_ms": 0.221, "load_throughput": 1629910.881, "learn_time_ms": 6.254, "learn_throughput": 57559.818, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 944400, "num_env_steps_trained": 944400, "num_agent_steps_sampled": 944400, "num_agent_steps_trained": 944400}, "done": false, "episodes_total": 3104, "training_iteration": 561, "trial_id": "6192e_00000", "date": "2023-08-04_11-37-36", "timestamp": 1691138256, "time_this_iter_s": 11.404983043670654, "time_total_s": 6275.169528245926, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2904.7105045318604, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 21.0625, "ram_util_percent": 64.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2343505859375, "policy_loss": -1715967.7625, "vf_loss": 20738539.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7703.0, "diff_num_grad_updates_vs_sampler_policy": 7702.0}}, "num_env_steps_sampled": 946560, "num_env_steps_trained": 946560, "num_agent_steps_sampled": 946560, "num_agent_steps_trained": 946560}, "sampler_results": {"episode_reward_max": -3525.4478482798627, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.2360052206095, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093, -3525.9017368192567, -3526.6452067998807, -3527.2841326613343, -3533.802711486452, -3527.7833100022067, -3525.5906753191516, -3525.586730095887, -3527.4136901845122, -3530.1888411000004, -3525.884745690008, -3527.37702693726, -3526.626579871396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353861257841797, "mean_inference_ms": 0.23464980026407878, "mean_action_processing_ms": 0.05716740870302999, "mean_env_wait_ms": 0.5736762437761146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024793148040771484, "StateBufferConnector_ms": 0.0017244815826416016, "ViewRequirementAgentConnector_ms": 0.04346442222595215}}, "episode_reward_max": -3525.4478482798627, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.2360052206095, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.803116509484, -3525.620609389053, -3526.8414337381187, -3525.9344353582624, -3525.5867549420464, -3525.5867549420464, -3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093, -3525.9017368192567, -3526.6452067998807, -3527.2841326613343, -3533.802711486452, -3527.7833100022067, -3525.5906753191516, -3525.586730095887, -3527.4136901845122, -3530.1888411000004, -3525.884745690008, -3527.37702693726, -3526.626579871396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353861257841797, "mean_inference_ms": 0.23464980026407878, "mean_action_processing_ms": 0.05716740870302999, "mean_env_wait_ms": 0.5736762437761146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024793148040771484, "StateBufferConnector_ms": 0.0017244815826416016, "ViewRequirementAgentConnector_ms": 0.04346442222595215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 946560, "num_agent_steps_trained": 946560, "num_env_steps_sampled": 946560, "num_env_steps_trained": 946560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.03484043923797, "num_env_steps_trained_throughput_per_sec": 191.03484043923797, "timesteps_total": 946560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 946560, "timers": {"training_iteration_time_ms": 1890.139, "sample_time_ms": 1883.187, "load_time_ms": 0.218, "load_throughput": 1648416.419, "learn_time_ms": 6.201, "learn_throughput": 58056.892, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 946560, "num_env_steps_trained": 946560, "num_agent_steps_sampled": 946560, "num_agent_steps_trained": 946560}, "done": false, "episodes_total": 3110, "training_iteration": 562, "trial_id": "6192e_00000", "date": "2023-08-04_11-37-47", "timestamp": 1691138267, "time_this_iter_s": 11.308928966522217, "time_total_s": 6286.478457212448, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2916.0194334983826, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 19.05625, "ram_util_percent": 64.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.234765625, "policy_loss": -7760516.3875, "vf_loss": 20731035.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7733.0, "diff_num_grad_updates_vs_sampler_policy": 7732.0}}, "num_env_steps_sampled": 948720, "num_env_steps_trained": 948720, "num_agent_steps_sampled": 948720, "num_agent_steps_trained": 948720}, "sampler_results": {"episode_reward_max": -3525.4478482798627, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.271268948451, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093, -3525.9017368192567, -3526.6452067998807, -3527.2841326613343, -3533.802711486452, -3527.7833100022067, -3525.5906753191516, -3525.586730095887, -3527.4136901845122, -3530.1888411000004, -3525.884745690008, -3527.37702693726, -3526.626579871396, -3526.2407308707734, -3526.362241417921, -3526.433603336158, -3527.2760040078556, -3527.4184155813655, -3526.1684824491017], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3538817931467495, "mean_inference_ms": 0.23465027285746307, "mean_action_processing_ms": 0.05716768283827491, "mean_env_wait_ms": 0.5736612525481882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024750232696533203, "StateBufferConnector_ms": 0.0017158985137939453, "ViewRequirementAgentConnector_ms": 0.043463706970214844}}, "episode_reward_max": -3525.4478482798627, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.271268948451, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.726531728121, -3527.5414738203563, -3526.7261678656646, -3527.4046750726948, -3527.4612527174777, -3525.4478482798627, -3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093, -3525.9017368192567, -3526.6452067998807, -3527.2841326613343, -3533.802711486452, -3527.7833100022067, -3525.5906753191516, -3525.586730095887, -3527.4136901845122, -3530.1888411000004, -3525.884745690008, -3527.37702693726, -3526.626579871396, -3526.2407308707734, -3526.362241417921, -3526.433603336158, -3527.2760040078556, -3527.4184155813655, -3526.1684824491017], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3538817931467495, "mean_inference_ms": 0.23465027285746307, "mean_action_processing_ms": 0.05716768283827491, "mean_env_wait_ms": 0.5736612525481882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024750232696533203, "StateBufferConnector_ms": 0.0017158985137939453, "ViewRequirementAgentConnector_ms": 0.043463706970214844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948720, "num_agent_steps_trained": 948720, "num_env_steps_sampled": 948720, "num_env_steps_trained": 948720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.81296762650294, "num_env_steps_trained_throughput_per_sec": 189.81296762650294, "timesteps_total": 948720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 948720, "timers": {"training_iteration_time_ms": 1891.747, "sample_time_ms": 1884.716, "load_time_ms": 0.22, "load_throughput": 1634144.416, "learn_time_ms": 6.26, "learn_throughput": 57504.796, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 948720, "num_env_steps_trained": 948720, "num_agent_steps_sampled": 948720, "num_agent_steps_trained": 948720}, "done": false, "episodes_total": 3116, "training_iteration": 563, "trial_id": "6192e_00000", "date": "2023-08-04_11-37-58", "timestamp": 1691138278, "time_this_iter_s": 11.381574869155884, "time_total_s": 6297.860032081604, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2927.4010083675385, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 20.35, "ram_util_percent": 64.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.16904907226564, "policy_loss": -3735809.609375, "vf_loss": 20742403.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7763.0, "diff_num_grad_updates_vs_sampler_policy": 7762.0}}, "num_env_steps_sampled": 950880, "num_env_steps_trained": 950880, "num_agent_steps_sampled": 950880, "num_agent_steps_trained": 950880}, "sampler_results": {"episode_reward_max": -3525.586729727808, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.289681706001, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093, -3525.9017368192567, -3526.6452067998807, -3527.2841326613343, -3533.802711486452, -3527.7833100022067, -3525.5906753191516, -3525.586730095887, -3527.4136901845122, -3530.1888411000004, -3525.884745690008, -3527.37702693726, -3526.626579871396, -3526.2407308707734, -3526.362241417921, -3526.433603336158, -3527.2760040078556, -3527.4184155813655, -3526.1684824491017, -3526.651687267784, -3528.309511623039, -3527.7595039164066, -3525.586729727808, -3527.3376747173843, -3526.5041179867003], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3538995143572325, "mean_inference_ms": 0.2346503174875499, "mean_action_processing_ms": 0.057167862478908475, "mean_env_wait_ms": 0.5736461321731794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002476215362548828, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.04349398612976074}}, "episode_reward_max": -3525.586729727808, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.289681706001, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.437985727123, -3525.734057412672, -3526.558847135211, -3527.4940400025407, -3526.6832963521865, -3526.5435126489297, -3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093, -3525.9017368192567, -3526.6452067998807, -3527.2841326613343, -3533.802711486452, -3527.7833100022067, -3525.5906753191516, -3525.586730095887, -3527.4136901845122, -3530.1888411000004, -3525.884745690008, -3527.37702693726, -3526.626579871396, -3526.2407308707734, -3526.362241417921, -3526.433603336158, -3527.2760040078556, -3527.4184155813655, -3526.1684824491017, -3526.651687267784, -3528.309511623039, -3527.7595039164066, -3525.586729727808, -3527.3376747173843, -3526.5041179867003], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3538995143572325, "mean_inference_ms": 0.2346503174875499, "mean_action_processing_ms": 0.057167862478908475, "mean_env_wait_ms": 0.5736461321731794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002476215362548828, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.04349398612976074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 950880, "num_agent_steps_trained": 950880, "num_env_steps_sampled": 950880, "num_env_steps_trained": 950880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.619506999789, "num_env_steps_trained_throughput_per_sec": 190.619506999789, "timesteps_total": 950880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 950880, "timers": {"training_iteration_time_ms": 1891.102, "sample_time_ms": 1884.134, "load_time_ms": 0.214, "load_throughput": 1684271.545, "learn_time_ms": 6.21, "learn_throughput": 57967.738, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 950880, "num_env_steps_trained": 950880, "num_agent_steps_sampled": 950880, "num_agent_steps_trained": 950880}, "done": false, "episodes_total": 3122, "training_iteration": 564, "trial_id": "6192e_00000", "date": "2023-08-04_11-38-10", "timestamp": 1691138290, "time_this_iter_s": 11.333655834197998, "time_total_s": 6309.193687915802, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2938.7346642017365, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 18.675000000000004, "ram_util_percent": 64.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-11, "entropy_coeff": 0.1, "policy_entropy": -322.2055908203125, "policy_loss": -3561101.55, "vf_loss": 20737136.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7793.0, "diff_num_grad_updates_vs_sampler_policy": 7792.0}}, "num_env_steps_sampled": 953040, "num_env_steps_trained": 953040, "num_agent_steps_sampled": 953040, "num_agent_steps_trained": 953040}, "sampler_results": {"episode_reward_max": -3525.586729727808, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.3371637693617, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093, -3525.9017368192567, -3526.6452067998807, -3527.2841326613343, -3533.802711486452, -3527.7833100022067, -3525.5906753191516, -3525.586730095887, -3527.4136901845122, -3530.1888411000004, -3525.884745690008, -3527.37702693726, -3526.626579871396, -3526.2407308707734, -3526.362241417921, -3526.433603336158, -3527.2760040078556, -3527.4184155813655, -3526.1684824491017, -3526.651687267784, -3528.309511623039, -3527.7595039164066, -3525.586729727808, -3527.3376747173843, -3526.5041179867003, -3528.742817593963, -3527.5513365736992, -3526.9093690938257, -3527.0859905389834, -3528.2655773370534, -3526.6448544772597], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353918286070075, "mean_inference_ms": 0.2346501735197782, "mean_action_processing_ms": 0.05716803591107646, "mean_env_wait_ms": 0.5736320491265019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024871826171875, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.04357028007507324}}, "episode_reward_max": -3525.586729727808, "episode_reward_min": -3535.5441885832124, "episode_reward_mean": -3527.3371637693617, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.1822666172147, -3526.3836486957875, -3528.498800176345, -3526.272105864443, -3526.0975009510703, -3533.547945914034, -3526.8371808093325, -3526.423529192916, -3526.1402954970363, -3525.823637122593, -3525.8877697600997, -3525.7265322712933, -3528.0353009303544, -3525.979167277634, -3525.5867313966164, -3527.724197791829, -3527.770490642728, -3526.1660852947093, -3526.1108365603413, -3527.2990219683006, -3526.7710721631, -3528.2560037801063, -3526.446985973741, -3526.1261411431296, -3527.8090657093517, -3528.0909223418407, -3529.215093021667, -3525.758874663175, -3525.745885720417, -3527.577566857307, -3526.0733063211133, -3527.1128958549652, -3527.7079583437785, -3528.1679739489364, -3526.386882806516, -3528.281836963165, -3527.147645226393, -3528.550665720484, -3525.942765015586, -3527.1163647535664, -3526.771833347341, -3526.100585464914, -3528.061358440884, -3527.317479288278, -3526.5220340504284, -3528.215198806803, -3527.343150169689, -3527.3667961120523, -3527.5283163535246, -3526.1684230939227, -3526.485312296756, -3533.478002310247, -3527.666499829879, -3526.5782341604972, -3526.825934818634, -3526.6209258193526, -3525.58672992224, -3525.5867299283423, -3532.3978072980544, -3526.005779408201, -3528.4006257649157, -3527.923198047629, -3527.0946868605865, -3527.3168467483392, -3527.642957780228, -3527.626317442061, -3527.603872451515, -3528.1893011261445, -3535.5441885832124, -3527.634264664093, -3525.9017368192567, -3526.6452067998807, -3527.2841326613343, -3533.802711486452, -3527.7833100022067, -3525.5906753191516, -3525.586730095887, -3527.4136901845122, -3530.1888411000004, -3525.884745690008, -3527.37702693726, -3526.626579871396, -3526.2407308707734, -3526.362241417921, -3526.433603336158, -3527.2760040078556, -3527.4184155813655, -3526.1684824491017, -3526.651687267784, -3528.309511623039, -3527.7595039164066, -3525.586729727808, -3527.3376747173843, -3526.5041179867003, -3528.742817593963, -3527.5513365736992, -3526.9093690938257, -3527.0859905389834, -3528.2655773370534, -3526.6448544772597], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353918286070075, "mean_inference_ms": 0.2346501735197782, "mean_action_processing_ms": 0.05716803591107646, "mean_env_wait_ms": 0.5736320491265019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024871826171875, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.04357028007507324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 953040, "num_agent_steps_trained": 953040, "num_env_steps_sampled": 953040, "num_env_steps_trained": 953040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.28588765510474, "num_env_steps_trained_throughput_per_sec": 190.28588765510474, "timesteps_total": 953040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 953040, "timers": {"training_iteration_time_ms": 1890.171, "sample_time_ms": 1883.156, "load_time_ms": 0.216, "load_throughput": 1669559.31, "learn_time_ms": 6.261, "learn_throughput": 57497.57, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 953040, "num_env_steps_trained": 953040, "num_agent_steps_sampled": 953040, "num_agent_steps_trained": 953040}, "done": true, "episodes_total": 3128, "training_iteration": 565, "trial_id": "6192e_00000", "date": "2023-08-04_11-38-21", "timestamp": 1691138301, "time_this_iter_s": 11.353457927703857, "time_total_s": 6320.547145843506, "pid": 41515, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[399000, 5e-08], [402600, 8e-08], [406200, 2.5e-08], [409800, 2.5e-08], [413400, 2.5e-08], [417000, 2.5e-08], [420600, 1e-08], [424200, 1e-08], [427800, 1e-08], [431400, 5e-09], [435000, 5e-09], [438600, 5e-09], [442200, 5e-09], [445800, 1e-09], [449400, 1e-09], [453000, 1e-09], [456600, 1e-09], [460200, 5e-10], [463800, 5e-10], [467400, 2.5e-10], [471000, 2.5e-10], [474600, 1e-10], [478200, 1e-10], [481800, 5e-11], [485400, 5e-11], [489000, 1e-11]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 399780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17db19b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2950.0881221294403, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 24.311764705882354, "ram_util_percent": 64.78823529411764}}
